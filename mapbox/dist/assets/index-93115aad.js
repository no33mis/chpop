function Wy(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const i in r)if(i!=="default"&&!(i in t)){const s=Object.getOwnPropertyDescriptor(r,i);s&&Object.defineProperty(t,i,s.get?s:{enumerable:!0,get:()=>r[i]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();var bI=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function rm(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var im={exports:{}},W={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Vs=Symbol.for("react.element"),Xy=Symbol.for("react.portal"),Yy=Symbol.for("react.fragment"),$y=Symbol.for("react.strict_mode"),qy=Symbol.for("react.profiler"),Zy=Symbol.for("react.provider"),Qy=Symbol.for("react.context"),Ky=Symbol.for("react.forward_ref"),Jy=Symbol.for("react.suspense"),e1=Symbol.for("react.memo"),t1=Symbol.for("react.lazy"),jh=Symbol.iterator;function n1(t){return t===null||typeof t!="object"?null:(t=jh&&t[jh]||t["@@iterator"],typeof t=="function"?t:null)}var sm={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},om=Object.assign,am={};function wi(t,e,n){this.props=t,this.context=e,this.refs=am,this.updater=n||sm}wi.prototype.isReactComponent={};wi.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};wi.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function lm(){}lm.prototype=wi.prototype;function $c(t,e,n){this.props=t,this.context=e,this.refs=am,this.updater=n||sm}var qc=$c.prototype=new lm;qc.constructor=$c;om(qc,wi.prototype);qc.isPureReactComponent=!0;var Gh=Array.isArray,um=Object.prototype.hasOwnProperty,Zc={current:null},cm={key:!0,ref:!0,__self:!0,__source:!0};function fm(t,e,n){var r,i={},s=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)um.call(e,r)&&!cm.hasOwnProperty(r)&&(i[r]=e[r]);var a=arguments.length-2;if(a===1)i.children=n;else if(1<a){for(var l=Array(a),u=0;u<a;u++)l[u]=arguments[u+2];i.children=l}if(t&&t.defaultProps)for(r in a=t.defaultProps,a)i[r]===void 0&&(i[r]=a[r]);return{$$typeof:Vs,type:t,key:s,ref:o,props:i,_owner:Zc.current}}function r1(t,e){return{$$typeof:Vs,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Qc(t){return typeof t=="object"&&t!==null&&t.$$typeof===Vs}function i1(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var Hh=/\/+/g;function Al(t,e){return typeof t=="object"&&t!==null&&t.key!=null?i1(""+t.key):e.toString(36)}function jo(t,e,n,r,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case Vs:case Xy:o=!0}}if(o)return o=t,i=i(o),t=r===""?"."+Al(o,0):r,Gh(i)?(n="",t!=null&&(n=t.replace(Hh,"$&/")+"/"),jo(i,e,n,"",function(u){return u})):i!=null&&(Qc(i)&&(i=r1(i,n+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(Hh,"$&/")+"/")+t)),e.push(i)),1;if(o=0,r=r===""?".":r+":",Gh(t))for(var a=0;a<t.length;a++){s=t[a];var l=r+Al(s,a);o+=jo(s,e,n,l,i)}else if(l=n1(t),typeof l=="function")for(t=l.call(t),a=0;!(s=t.next()).done;)s=s.value,l=r+Al(s,a++),o+=jo(s,e,n,l,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function ho(t,e,n){if(t==null)return t;var r=[],i=0;return jo(t,r,"","",function(s){return e.call(n,s,i++)}),r}function s1(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Ge={current:null},Go={transition:null},o1={ReactCurrentDispatcher:Ge,ReactCurrentBatchConfig:Go,ReactCurrentOwner:Zc};W.Children={map:ho,forEach:function(t,e,n){ho(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return ho(t,function(){e++}),e},toArray:function(t){return ho(t,function(e){return e})||[]},only:function(t){if(!Qc(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};W.Component=wi;W.Fragment=Yy;W.Profiler=qy;W.PureComponent=$c;W.StrictMode=$y;W.Suspense=Jy;W.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=o1;W.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=om({},t.props),i=t.key,s=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=Zc.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)um.call(e,l)&&!cm.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=n;else if(1<l){a=Array(l);for(var u=0;u<l;u++)a[u]=arguments[u+2];r.children=a}return{$$typeof:Vs,type:t.type,key:i,ref:s,props:r,_owner:o}};W.createContext=function(t){return t={$$typeof:Qy,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:Zy,_context:t},t.Consumer=t};W.createElement=fm;W.createFactory=function(t){var e=fm.bind(null,t);return e.type=t,e};W.createRef=function(){return{current:null}};W.forwardRef=function(t){return{$$typeof:Ky,render:t}};W.isValidElement=Qc;W.lazy=function(t){return{$$typeof:t1,_payload:{_status:-1,_result:t},_init:s1}};W.memo=function(t,e){return{$$typeof:e1,type:t,compare:e===void 0?null:e}};W.startTransition=function(t){var e=Go.transition;Go.transition={};try{t()}finally{Go.transition=e}};W.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};W.useCallback=function(t,e){return Ge.current.useCallback(t,e)};W.useContext=function(t){return Ge.current.useContext(t)};W.useDebugValue=function(){};W.useDeferredValue=function(t){return Ge.current.useDeferredValue(t)};W.useEffect=function(t,e){return Ge.current.useEffect(t,e)};W.useId=function(){return Ge.current.useId()};W.useImperativeHandle=function(t,e,n){return Ge.current.useImperativeHandle(t,e,n)};W.useInsertionEffect=function(t,e){return Ge.current.useInsertionEffect(t,e)};W.useLayoutEffect=function(t,e){return Ge.current.useLayoutEffect(t,e)};W.useMemo=function(t,e){return Ge.current.useMemo(t,e)};W.useReducer=function(t,e,n){return Ge.current.useReducer(t,e,n)};W.useRef=function(t){return Ge.current.useRef(t)};W.useState=function(t){return Ge.current.useState(t)};W.useSyncExternalStore=function(t,e,n){return Ge.current.useSyncExternalStore(t,e,n)};W.useTransition=function(){return Ge.current.useTransition()};W.version="18.2.0";im.exports=W;var z=im.exports;const Ce=rm(z);var hm={exports:{}},lt={},dm={exports:{}},gm={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(D,V){var j=D.length;D.push(V);e:for(;0<j;){var le=j-1>>>1,oe=D[le];if(0<i(oe,V))D[le]=V,D[j]=oe,j=le;else break e}}function n(D){return D.length===0?null:D[0]}function r(D){if(D.length===0)return null;var V=D[0],j=D.pop();if(j!==V){D[0]=j;e:for(var le=0,oe=D.length,xr=oe>>>1;le<xr;){var Et=2*(le+1)-1,Pi=D[Et],Zt=Et+1,pe=D[Zt];if(0>i(Pi,j))Zt<oe&&0>i(pe,Pi)?(D[le]=pe,D[Zt]=j,le=Zt):(D[le]=Pi,D[Et]=j,le=Et);else if(Zt<oe&&0>i(pe,j))D[le]=pe,D[Zt]=j,le=Zt;else break e}}return V}function i(D,V){var j=D.sortIndex-V.sortIndex;return j!==0?j:D.id-V.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var l=[],u=[],c=1,f=null,h=3,p=!1,E=!1,w=!1,S=typeof setTimeout=="function"?setTimeout:null,_=typeof clearTimeout=="function"?clearTimeout:null,m=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function y(D){for(var V=n(u);V!==null;){if(V.callback===null)r(u);else if(V.startTime<=D)r(u),V.sortIndex=V.expirationTime,e(l,V);else break;V=n(u)}}function b(D){if(w=!1,y(D),!E)if(n(l)!==null)E=!0,xi(x);else{var V=n(u);V!==null&&Ar(b,V.startTime-D)}}function x(D,V){E=!1,w&&(w=!1,_(C),C=-1),p=!0;var j=h;try{for(y(V),f=n(l);f!==null&&(!(f.expirationTime>V)||D&&!B());){var le=f.callback;if(typeof le=="function"){f.callback=null,h=f.priorityLevel;var oe=le(f.expirationTime<=V);V=t.unstable_now(),typeof oe=="function"?f.callback=oe:f===n(l)&&r(l),y(V)}else r(l);f=n(l)}if(f!==null)var xr=!0;else{var Et=n(u);Et!==null&&Ar(b,Et.startTime-V),xr=!1}return xr}finally{f=null,h=j,p=!1}}var P=!1,L=null,C=-1,O=5,I=-1;function B(){return!(t.unstable_now()-I<O)}function $(){if(L!==null){var D=t.unstable_now();I=D;var V=!0;try{V=L(!0,D)}finally{V?K():(P=!1,L=null)}}else P=!1}var K;if(typeof m=="function")K=function(){m($)};else if(typeof MessageChannel<"u"){var X=new MessageChannel,qt=X.port2;X.port1.onmessage=$,K=function(){qt.postMessage(null)}}else K=function(){S($,0)};function xi(D){L=D,P||(P=!0,K())}function Ar(D,V){C=S(function(){D(t.unstable_now())},V)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(D){D.callback=null},t.unstable_continueExecution=function(){E||p||(E=!0,xi(x))},t.unstable_forceFrameRate=function(D){0>D||125<D?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):O=0<D?Math.floor(1e3/D):5},t.unstable_getCurrentPriorityLevel=function(){return h},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(D){switch(h){case 1:case 2:case 3:var V=3;break;default:V=h}var j=h;h=V;try{return D()}finally{h=j}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(D,V){switch(D){case 1:case 2:case 3:case 4:case 5:break;default:D=3}var j=h;h=D;try{return V()}finally{h=j}},t.unstable_scheduleCallback=function(D,V,j){var le=t.unstable_now();switch(typeof j=="object"&&j!==null?(j=j.delay,j=typeof j=="number"&&0<j?le+j:le):j=le,D){case 1:var oe=-1;break;case 2:oe=250;break;case 5:oe=1073741823;break;case 4:oe=1e4;break;default:oe=5e3}return oe=j+oe,D={id:c++,callback:V,priorityLevel:D,startTime:j,expirationTime:oe,sortIndex:-1},j>le?(D.sortIndex=j,e(u,D),n(l)===null&&D===n(u)&&(w?(_(C),C=-1):w=!0,Ar(b,j-le))):(D.sortIndex=oe,e(l,D),E||p||(E=!0,xi(x))),D},t.unstable_shouldYield=B,t.unstable_wrapCallback=function(D){var V=h;return function(){var j=h;h=V;try{return D.apply(this,arguments)}finally{h=j}}}})(gm);dm.exports=gm;var a1=dm.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var pm=z,at=a1;function R(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var mm=new Set,gs={};function yr(t,e){si(t,e),si(t+"Capture",e)}function si(t,e){for(gs[t]=e,t=0;t<e.length;t++)mm.add(e[t])}var un=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Lu=Object.prototype.hasOwnProperty,l1=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Wh={},Xh={};function u1(t){return Lu.call(Xh,t)?!0:Lu.call(Wh,t)?!1:l1.test(t)?Xh[t]=!0:(Wh[t]=!0,!1)}function c1(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function f1(t,e,n,r){if(e===null||typeof e>"u"||c1(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function He(t,e,n,r,i,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var Re={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Re[t]=new He(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Re[e]=new He(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Re[t]=new He(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Re[t]=new He(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Re[t]=new He(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Re[t]=new He(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Re[t]=new He(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Re[t]=new He(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Re[t]=new He(t,5,!1,t.toLowerCase(),null,!1,!1)});var Kc=/[\-:]([a-z])/g;function Jc(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Kc,Jc);Re[e]=new He(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Kc,Jc);Re[e]=new He(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Kc,Jc);Re[e]=new He(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Re[t]=new He(t,1,!1,t.toLowerCase(),null,!1,!1)});Re.xlinkHref=new He("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Re[t]=new He(t,1,!1,t.toLowerCase(),null,!0,!0)});function ef(t,e,n,r){var i=Re.hasOwnProperty(e)?Re[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(f1(e,n,i,r)&&(n=null),r||i===null?u1(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(e=i.attributeName,r=i.attributeNamespace,n===null?t.removeAttribute(e):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var mn=pm.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,go=Symbol.for("react.element"),Fr=Symbol.for("react.portal"),Ur=Symbol.for("react.fragment"),tf=Symbol.for("react.strict_mode"),Cu=Symbol.for("react.profiler"),_m=Symbol.for("react.provider"),vm=Symbol.for("react.context"),nf=Symbol.for("react.forward_ref"),Mu=Symbol.for("react.suspense"),Ru=Symbol.for("react.suspense_list"),rf=Symbol.for("react.memo"),xn=Symbol.for("react.lazy"),ym=Symbol.for("react.offscreen"),Yh=Symbol.iterator;function Ni(t){return t===null||typeof t!="object"?null:(t=Yh&&t[Yh]||t["@@iterator"],typeof t=="function"?t:null)}var fe=Object.assign,xl;function Zi(t){if(xl===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);xl=e&&e[1]||""}return`
`+xl+t}var Pl=!1;function Ll(t,e){if(!t||Pl)return"";Pl=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var r=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){r=u}t.call(e.prototype)}else{try{throw Error()}catch(u){r=u}t()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var i=u.stack.split(`
`),s=r.stack.split(`
`),o=i.length-1,a=s.length-1;1<=o&&0<=a&&i[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(i[o]!==s[a]){if(o!==1||a!==1)do if(o--,a--,0>a||i[o]!==s[a]){var l=`
`+i[o].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=o&&0<=a);break}}}finally{Pl=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Zi(t):""}function h1(t){switch(t.tag){case 5:return Zi(t.type);case 16:return Zi("Lazy");case 13:return Zi("Suspense");case 19:return Zi("SuspenseList");case 0:case 2:case 15:return t=Ll(t.type,!1),t;case 11:return t=Ll(t.type.render,!1),t;case 1:return t=Ll(t.type,!0),t;default:return""}}function Iu(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Ur:return"Fragment";case Fr:return"Portal";case Cu:return"Profiler";case tf:return"StrictMode";case Mu:return"Suspense";case Ru:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case vm:return(t.displayName||"Context")+".Consumer";case _m:return(t._context.displayName||"Context")+".Provider";case nf:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case rf:return e=t.displayName||null,e!==null?e:Iu(t.type)||"Memo";case xn:e=t._payload,t=t._init;try{return Iu(t(e))}catch{}}return null}function d1(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Iu(e);case 8:return e===tf?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Hn(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function Em(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function g1(t){var e=Em(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,s=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(o){r=""+o,s.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function po(t){t._valueTracker||(t._valueTracker=g1(t))}function wm(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=Em(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function la(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Ou(t,e){var n=e.checked;return fe({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function $h(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Hn(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function Tm(t,e){e=e.checked,e!=null&&ef(t,"checked",e,!1)}function ku(t,e){Tm(t,e);var n=Hn(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Nu(t,e.type,n):e.hasOwnProperty("defaultValue")&&Nu(t,e.type,Hn(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function qh(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Nu(t,e,n){(e!=="number"||la(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Qi=Array.isArray;function Qr(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Hn(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function Du(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(R(91));return fe({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Zh(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(R(92));if(Qi(n)){if(1<n.length)throw Error(R(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Hn(n)}}function bm(t,e){var n=Hn(e.value),r=Hn(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function Qh(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function Sm(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Fu(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?Sm(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var mo,Am=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(mo=mo||document.createElement("div"),mo.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=mo.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function ps(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var ns={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},p1=["Webkit","ms","Moz","O"];Object.keys(ns).forEach(function(t){p1.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),ns[e]=ns[t]})});function xm(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||ns.hasOwnProperty(t)&&ns[t]?(""+e).trim():e+"px"}function Pm(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=xm(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}var m1=fe({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Uu(t,e){if(e){if(m1[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(R(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(R(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(R(61))}if(e.style!=null&&typeof e.style!="object")throw Error(R(62))}}function Bu(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var zu=null;function sf(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Vu=null,Kr=null,Jr=null;function Kh(t){if(t=Hs(t)){if(typeof Vu!="function")throw Error(R(280));var e=t.stateNode;e&&(e=Za(e),Vu(t.stateNode,t.type,e))}}function Lm(t){Kr?Jr?Jr.push(t):Jr=[t]:Kr=t}function Cm(){if(Kr){var t=Kr,e=Jr;if(Jr=Kr=null,Kh(t),e)for(t=0;t<e.length;t++)Kh(e[t])}}function Mm(t,e){return t(e)}function Rm(){}var Cl=!1;function Im(t,e,n){if(Cl)return t(e,n);Cl=!0;try{return Mm(t,e,n)}finally{Cl=!1,(Kr!==null||Jr!==null)&&(Rm(),Cm())}}function ms(t,e){var n=t.stateNode;if(n===null)return null;var r=Za(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(R(231,e,typeof n));return n}var ju=!1;if(un)try{var Di={};Object.defineProperty(Di,"passive",{get:function(){ju=!0}}),window.addEventListener("test",Di,Di),window.removeEventListener("test",Di,Di)}catch{ju=!1}function _1(t,e,n,r,i,s,o,a,l){var u=Array.prototype.slice.call(arguments,3);try{e.apply(n,u)}catch(c){this.onError(c)}}var rs=!1,ua=null,ca=!1,Gu=null,v1={onError:function(t){rs=!0,ua=t}};function y1(t,e,n,r,i,s,o,a,l){rs=!1,ua=null,_1.apply(v1,arguments)}function E1(t,e,n,r,i,s,o,a,l){if(y1.apply(this,arguments),rs){if(rs){var u=ua;rs=!1,ua=null}else throw Error(R(198));ca||(ca=!0,Gu=u)}}function Er(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function Om(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Jh(t){if(Er(t)!==t)throw Error(R(188))}function w1(t){var e=t.alternate;if(!e){if(e=Er(t),e===null)throw Error(R(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(i===null)break;var s=i.alternate;if(s===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===n)return Jh(i),t;if(s===r)return Jh(i),e;s=s.sibling}throw Error(R(188))}if(n.return!==r.return)n=i,r=s;else{for(var o=!1,a=i.child;a;){if(a===n){o=!0,n=i,r=s;break}if(a===r){o=!0,r=i,n=s;break}a=a.sibling}if(!o){for(a=s.child;a;){if(a===n){o=!0,n=s,r=i;break}if(a===r){o=!0,r=s,n=i;break}a=a.sibling}if(!o)throw Error(R(189))}}if(n.alternate!==r)throw Error(R(190))}if(n.tag!==3)throw Error(R(188));return n.stateNode.current===n?t:e}function km(t){return t=w1(t),t!==null?Nm(t):null}function Nm(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=Nm(t);if(e!==null)return e;t=t.sibling}return null}var Dm=at.unstable_scheduleCallback,ed=at.unstable_cancelCallback,T1=at.unstable_shouldYield,b1=at.unstable_requestPaint,ge=at.unstable_now,S1=at.unstable_getCurrentPriorityLevel,of=at.unstable_ImmediatePriority,Fm=at.unstable_UserBlockingPriority,fa=at.unstable_NormalPriority,A1=at.unstable_LowPriority,Um=at.unstable_IdlePriority,Xa=null,Ht=null;function x1(t){if(Ht&&typeof Ht.onCommitFiberRoot=="function")try{Ht.onCommitFiberRoot(Xa,t,void 0,(t.current.flags&128)===128)}catch{}}var Pt=Math.clz32?Math.clz32:C1,P1=Math.log,L1=Math.LN2;function C1(t){return t>>>=0,t===0?32:31-(P1(t)/L1|0)|0}var _o=64,vo=4194304;function Ki(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function ha(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,i=t.suspendedLanes,s=t.pingedLanes,o=n&268435455;if(o!==0){var a=o&~i;a!==0?r=Ki(a):(s&=o,s!==0&&(r=Ki(s)))}else o=n&~i,o!==0?r=Ki(o):s!==0&&(r=Ki(s));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-Pt(e),i=1<<n,r|=t[n],e&=~i;return r}function M1(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function R1(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var o=31-Pt(s),a=1<<o,l=i[o];l===-1?(!(a&n)||a&r)&&(i[o]=M1(a,e)):l<=e&&(t.expiredLanes|=a),s&=~a}}function Hu(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function Bm(){var t=_o;return _o<<=1,!(_o&4194240)&&(_o=64),t}function Ml(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function js(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Pt(e),t[e]=n}function I1(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-Pt(n),s=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~s}}function af(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-Pt(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var Q=0;function zm(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var Vm,lf,jm,Gm,Hm,Wu=!1,yo=[],kn=null,Nn=null,Dn=null,_s=new Map,vs=new Map,Ln=[],O1="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function td(t,e){switch(t){case"focusin":case"focusout":kn=null;break;case"dragenter":case"dragleave":Nn=null;break;case"mouseover":case"mouseout":Dn=null;break;case"pointerover":case"pointerout":_s.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":vs.delete(e.pointerId)}}function Fi(t,e,n,r,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},e!==null&&(e=Hs(e),e!==null&&lf(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function k1(t,e,n,r,i){switch(e){case"focusin":return kn=Fi(kn,t,e,n,r,i),!0;case"dragenter":return Nn=Fi(Nn,t,e,n,r,i),!0;case"mouseover":return Dn=Fi(Dn,t,e,n,r,i),!0;case"pointerover":var s=i.pointerId;return _s.set(s,Fi(_s.get(s)||null,t,e,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,vs.set(s,Fi(vs.get(s)||null,t,e,n,r,i)),!0}return!1}function Wm(t){var e=ir(t.target);if(e!==null){var n=Er(e);if(n!==null){if(e=n.tag,e===13){if(e=Om(n),e!==null){t.blockedOn=e,Hm(t.priority,function(){jm(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Ho(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=Xu(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);zu=r,n.target.dispatchEvent(r),zu=null}else return e=Hs(n),e!==null&&lf(e),t.blockedOn=n,!1;e.shift()}return!0}function nd(t,e,n){Ho(t)&&n.delete(e)}function N1(){Wu=!1,kn!==null&&Ho(kn)&&(kn=null),Nn!==null&&Ho(Nn)&&(Nn=null),Dn!==null&&Ho(Dn)&&(Dn=null),_s.forEach(nd),vs.forEach(nd)}function Ui(t,e){t.blockedOn===e&&(t.blockedOn=null,Wu||(Wu=!0,at.unstable_scheduleCallback(at.unstable_NormalPriority,N1)))}function ys(t){function e(i){return Ui(i,t)}if(0<yo.length){Ui(yo[0],t);for(var n=1;n<yo.length;n++){var r=yo[n];r.blockedOn===t&&(r.blockedOn=null)}}for(kn!==null&&Ui(kn,t),Nn!==null&&Ui(Nn,t),Dn!==null&&Ui(Dn,t),_s.forEach(e),vs.forEach(e),n=0;n<Ln.length;n++)r=Ln[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<Ln.length&&(n=Ln[0],n.blockedOn===null);)Wm(n),n.blockedOn===null&&Ln.shift()}var ei=mn.ReactCurrentBatchConfig,da=!0;function D1(t,e,n,r){var i=Q,s=ei.transition;ei.transition=null;try{Q=1,uf(t,e,n,r)}finally{Q=i,ei.transition=s}}function F1(t,e,n,r){var i=Q,s=ei.transition;ei.transition=null;try{Q=4,uf(t,e,n,r)}finally{Q=i,ei.transition=s}}function uf(t,e,n,r){if(da){var i=Xu(t,e,n,r);if(i===null)zl(t,e,r,ga,n),td(t,r);else if(k1(i,t,e,n,r))r.stopPropagation();else if(td(t,r),e&4&&-1<O1.indexOf(t)){for(;i!==null;){var s=Hs(i);if(s!==null&&Vm(s),s=Xu(t,e,n,r),s===null&&zl(t,e,r,ga,n),s===i)break;i=s}i!==null&&r.stopPropagation()}else zl(t,e,r,null,n)}}var ga=null;function Xu(t,e,n,r){if(ga=null,t=sf(r),t=ir(t),t!==null)if(e=Er(t),e===null)t=null;else if(n=e.tag,n===13){if(t=Om(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return ga=t,null}function Xm(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(S1()){case of:return 1;case Fm:return 4;case fa:case A1:return 16;case Um:return 536870912;default:return 16}default:return 16}}var Mn=null,cf=null,Wo=null;function Ym(){if(Wo)return Wo;var t,e=cf,n=e.length,r,i="value"in Mn?Mn.value:Mn.textContent,s=i.length;for(t=0;t<n&&e[t]===i[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===i[s-r];r++);return Wo=i.slice(t,1<r?1-r:void 0)}function Xo(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Eo(){return!0}function rd(){return!1}function ut(t){function e(n,r,i,s,o){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(s):s[a]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?Eo:rd,this.isPropagationStopped=rd,this}return fe(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Eo)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Eo)},persist:function(){},isPersistent:Eo}),e}var Ti={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ff=ut(Ti),Gs=fe({},Ti,{view:0,detail:0}),U1=ut(Gs),Rl,Il,Bi,Ya=fe({},Gs,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:hf,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Bi&&(Bi&&t.type==="mousemove"?(Rl=t.screenX-Bi.screenX,Il=t.screenY-Bi.screenY):Il=Rl=0,Bi=t),Rl)},movementY:function(t){return"movementY"in t?t.movementY:Il}}),id=ut(Ya),B1=fe({},Ya,{dataTransfer:0}),z1=ut(B1),V1=fe({},Gs,{relatedTarget:0}),Ol=ut(V1),j1=fe({},Ti,{animationName:0,elapsedTime:0,pseudoElement:0}),G1=ut(j1),H1=fe({},Ti,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),W1=ut(H1),X1=fe({},Ti,{data:0}),sd=ut(X1),Y1={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},$1={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},q1={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Z1(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=q1[t])?!!e[t]:!1}function hf(){return Z1}var Q1=fe({},Gs,{key:function(t){if(t.key){var e=Y1[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Xo(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?$1[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:hf,charCode:function(t){return t.type==="keypress"?Xo(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Xo(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),K1=ut(Q1),J1=fe({},Ya,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),od=ut(J1),eE=fe({},Gs,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:hf}),tE=ut(eE),nE=fe({},Ti,{propertyName:0,elapsedTime:0,pseudoElement:0}),rE=ut(nE),iE=fe({},Ya,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),sE=ut(iE),oE=[9,13,27,32],df=un&&"CompositionEvent"in window,is=null;un&&"documentMode"in document&&(is=document.documentMode);var aE=un&&"TextEvent"in window&&!is,$m=un&&(!df||is&&8<is&&11>=is),ad=String.fromCharCode(32),ld=!1;function qm(t,e){switch(t){case"keyup":return oE.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Zm(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Br=!1;function lE(t,e){switch(t){case"compositionend":return Zm(e);case"keypress":return e.which!==32?null:(ld=!0,ad);case"textInput":return t=e.data,t===ad&&ld?null:t;default:return null}}function uE(t,e){if(Br)return t==="compositionend"||!df&&qm(t,e)?(t=Ym(),Wo=cf=Mn=null,Br=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return $m&&e.locale!=="ko"?null:e.data;default:return null}}var cE={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function ud(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!cE[t.type]:e==="textarea"}function Qm(t,e,n,r){Lm(r),e=pa(e,"onChange"),0<e.length&&(n=new ff("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var ss=null,Es=null;function fE(t){l0(t,0)}function $a(t){var e=jr(t);if(wm(e))return t}function hE(t,e){if(t==="change")return e}var Km=!1;if(un){var kl;if(un){var Nl="oninput"in document;if(!Nl){var cd=document.createElement("div");cd.setAttribute("oninput","return;"),Nl=typeof cd.oninput=="function"}kl=Nl}else kl=!1;Km=kl&&(!document.documentMode||9<document.documentMode)}function fd(){ss&&(ss.detachEvent("onpropertychange",Jm),Es=ss=null)}function Jm(t){if(t.propertyName==="value"&&$a(Es)){var e=[];Qm(e,Es,t,sf(t)),Im(fE,e)}}function dE(t,e,n){t==="focusin"?(fd(),ss=e,Es=n,ss.attachEvent("onpropertychange",Jm)):t==="focusout"&&fd()}function gE(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return $a(Es)}function pE(t,e){if(t==="click")return $a(e)}function mE(t,e){if(t==="input"||t==="change")return $a(e)}function _E(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Mt=typeof Object.is=="function"?Object.is:_E;function ws(t,e){if(Mt(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!Lu.call(e,i)||!Mt(t[i],e[i]))return!1}return!0}function hd(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function dd(t,e){var n=hd(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=hd(n)}}function e0(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?e0(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function t0(){for(var t=window,e=la();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=la(t.document)}return e}function gf(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function vE(t){var e=t0(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&e0(n.ownerDocument.documentElement,n)){if(r!==null&&gf(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,s=Math.min(r.start,i);r=r.end===void 0?s:Math.min(r.end,i),!t.extend&&s>r&&(i=r,r=s,s=i),i=dd(n,s);var o=dd(n,r);i&&o&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var yE=un&&"documentMode"in document&&11>=document.documentMode,zr=null,Yu=null,os=null,$u=!1;function gd(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;$u||zr==null||zr!==la(r)||(r=zr,"selectionStart"in r&&gf(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),os&&ws(os,r)||(os=r,r=pa(Yu,"onSelect"),0<r.length&&(e=new ff("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=zr)))}function wo(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Vr={animationend:wo("Animation","AnimationEnd"),animationiteration:wo("Animation","AnimationIteration"),animationstart:wo("Animation","AnimationStart"),transitionend:wo("Transition","TransitionEnd")},Dl={},n0={};un&&(n0=document.createElement("div").style,"AnimationEvent"in window||(delete Vr.animationend.animation,delete Vr.animationiteration.animation,delete Vr.animationstart.animation),"TransitionEvent"in window||delete Vr.transitionend.transition);function qa(t){if(Dl[t])return Dl[t];if(!Vr[t])return t;var e=Vr[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in n0)return Dl[t]=e[n];return t}var r0=qa("animationend"),i0=qa("animationiteration"),s0=qa("animationstart"),o0=qa("transitionend"),a0=new Map,pd="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Xn(t,e){a0.set(t,e),yr(e,[t])}for(var Fl=0;Fl<pd.length;Fl++){var Ul=pd[Fl],EE=Ul.toLowerCase(),wE=Ul[0].toUpperCase()+Ul.slice(1);Xn(EE,"on"+wE)}Xn(r0,"onAnimationEnd");Xn(i0,"onAnimationIteration");Xn(s0,"onAnimationStart");Xn("dblclick","onDoubleClick");Xn("focusin","onFocus");Xn("focusout","onBlur");Xn(o0,"onTransitionEnd");si("onMouseEnter",["mouseout","mouseover"]);si("onMouseLeave",["mouseout","mouseover"]);si("onPointerEnter",["pointerout","pointerover"]);si("onPointerLeave",["pointerout","pointerover"]);yr("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));yr("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));yr("onBeforeInput",["compositionend","keypress","textInput","paste"]);yr("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));yr("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));yr("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ji="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),TE=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ji));function md(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,E1(r,e,void 0,t),t.currentTarget=null}function l0(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;e:{var s=void 0;if(e)for(var o=r.length-1;0<=o;o--){var a=r[o],l=a.instance,u=a.currentTarget;if(a=a.listener,l!==s&&i.isPropagationStopped())break e;md(i,a,u),s=l}else for(o=0;o<r.length;o++){if(a=r[o],l=a.instance,u=a.currentTarget,a=a.listener,l!==s&&i.isPropagationStopped())break e;md(i,a,u),s=l}}}if(ca)throw t=Gu,ca=!1,Gu=null,t}function re(t,e){var n=e[Ju];n===void 0&&(n=e[Ju]=new Set);var r=t+"__bubble";n.has(r)||(u0(e,t,2,!1),n.add(r))}function Bl(t,e,n){var r=0;e&&(r|=4),u0(n,t,r,e)}var To="_reactListening"+Math.random().toString(36).slice(2);function Ts(t){if(!t[To]){t[To]=!0,mm.forEach(function(n){n!=="selectionchange"&&(TE.has(n)||Bl(n,!1,t),Bl(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[To]||(e[To]=!0,Bl("selectionchange",!1,e))}}function u0(t,e,n,r){switch(Xm(e)){case 1:var i=D1;break;case 4:i=F1;break;default:i=uf}n=i.bind(null,e,n,t),i=void 0,!ju||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function zl(t,e,n,r,i){var s=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var a=r.stateNode.containerInfo;if(a===i||a.nodeType===8&&a.parentNode===i)break;if(o===4)for(o=r.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;o=o.return}for(;a!==null;){if(o=ir(a),o===null)return;if(l=o.tag,l===5||l===6){r=s=o;continue e}a=a.parentNode}}r=r.return}Im(function(){var u=s,c=sf(n),f=[];e:{var h=a0.get(t);if(h!==void 0){var p=ff,E=t;switch(t){case"keypress":if(Xo(n)===0)break e;case"keydown":case"keyup":p=K1;break;case"focusin":E="focus",p=Ol;break;case"focusout":E="blur",p=Ol;break;case"beforeblur":case"afterblur":p=Ol;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=id;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=z1;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=tE;break;case r0:case i0:case s0:p=G1;break;case o0:p=rE;break;case"scroll":p=U1;break;case"wheel":p=sE;break;case"copy":case"cut":case"paste":p=W1;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=od}var w=(e&4)!==0,S=!w&&t==="scroll",_=w?h!==null?h+"Capture":null:h;w=[];for(var m=u,y;m!==null;){y=m;var b=y.stateNode;if(y.tag===5&&b!==null&&(y=b,_!==null&&(b=ms(m,_),b!=null&&w.push(bs(m,b,y)))),S)break;m=m.return}0<w.length&&(h=new p(h,E,null,n,c),f.push({event:h,listeners:w}))}}if(!(e&7)){e:{if(h=t==="mouseover"||t==="pointerover",p=t==="mouseout"||t==="pointerout",h&&n!==zu&&(E=n.relatedTarget||n.fromElement)&&(ir(E)||E[cn]))break e;if((p||h)&&(h=c.window===c?c:(h=c.ownerDocument)?h.defaultView||h.parentWindow:window,p?(E=n.relatedTarget||n.toElement,p=u,E=E?ir(E):null,E!==null&&(S=Er(E),E!==S||E.tag!==5&&E.tag!==6)&&(E=null)):(p=null,E=u),p!==E)){if(w=id,b="onMouseLeave",_="onMouseEnter",m="mouse",(t==="pointerout"||t==="pointerover")&&(w=od,b="onPointerLeave",_="onPointerEnter",m="pointer"),S=p==null?h:jr(p),y=E==null?h:jr(E),h=new w(b,m+"leave",p,n,c),h.target=S,h.relatedTarget=y,b=null,ir(c)===u&&(w=new w(_,m+"enter",E,n,c),w.target=y,w.relatedTarget=S,b=w),S=b,p&&E)t:{for(w=p,_=E,m=0,y=w;y;y=Lr(y))m++;for(y=0,b=_;b;b=Lr(b))y++;for(;0<m-y;)w=Lr(w),m--;for(;0<y-m;)_=Lr(_),y--;for(;m--;){if(w===_||_!==null&&w===_.alternate)break t;w=Lr(w),_=Lr(_)}w=null}else w=null;p!==null&&_d(f,h,p,w,!1),E!==null&&S!==null&&_d(f,S,E,w,!0)}}e:{if(h=u?jr(u):window,p=h.nodeName&&h.nodeName.toLowerCase(),p==="select"||p==="input"&&h.type==="file")var x=hE;else if(ud(h))if(Km)x=mE;else{x=gE;var P=dE}else(p=h.nodeName)&&p.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(x=pE);if(x&&(x=x(t,u))){Qm(f,x,n,c);break e}P&&P(t,h,u),t==="focusout"&&(P=h._wrapperState)&&P.controlled&&h.type==="number"&&Nu(h,"number",h.value)}switch(P=u?jr(u):window,t){case"focusin":(ud(P)||P.contentEditable==="true")&&(zr=P,Yu=u,os=null);break;case"focusout":os=Yu=zr=null;break;case"mousedown":$u=!0;break;case"contextmenu":case"mouseup":case"dragend":$u=!1,gd(f,n,c);break;case"selectionchange":if(yE)break;case"keydown":case"keyup":gd(f,n,c)}var L;if(df)e:{switch(t){case"compositionstart":var C="onCompositionStart";break e;case"compositionend":C="onCompositionEnd";break e;case"compositionupdate":C="onCompositionUpdate";break e}C=void 0}else Br?qm(t,n)&&(C="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(C="onCompositionStart");C&&($m&&n.locale!=="ko"&&(Br||C!=="onCompositionStart"?C==="onCompositionEnd"&&Br&&(L=Ym()):(Mn=c,cf="value"in Mn?Mn.value:Mn.textContent,Br=!0)),P=pa(u,C),0<P.length&&(C=new sd(C,t,null,n,c),f.push({event:C,listeners:P}),L?C.data=L:(L=Zm(n),L!==null&&(C.data=L)))),(L=aE?lE(t,n):uE(t,n))&&(u=pa(u,"onBeforeInput"),0<u.length&&(c=new sd("onBeforeInput","beforeinput",null,n,c),f.push({event:c,listeners:u}),c.data=L))}l0(f,e)})}function bs(t,e,n){return{instance:t,listener:e,currentTarget:n}}function pa(t,e){for(var n=e+"Capture",r=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=ms(t,n),s!=null&&r.unshift(bs(t,s,i)),s=ms(t,e),s!=null&&r.push(bs(t,s,i))),t=t.return}return r}function Lr(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function _d(t,e,n,r,i){for(var s=e._reactName,o=[];n!==null&&n!==r;){var a=n,l=a.alternate,u=a.stateNode;if(l!==null&&l===r)break;a.tag===5&&u!==null&&(a=u,i?(l=ms(n,s),l!=null&&o.unshift(bs(n,l,a))):i||(l=ms(n,s),l!=null&&o.push(bs(n,l,a)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var bE=/\r\n?/g,SE=/\u0000|\uFFFD/g;function vd(t){return(typeof t=="string"?t:""+t).replace(bE,`
`).replace(SE,"")}function bo(t,e,n){if(e=vd(e),vd(t)!==e&&n)throw Error(R(425))}function ma(){}var qu=null,Zu=null;function Qu(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Ku=typeof setTimeout=="function"?setTimeout:void 0,AE=typeof clearTimeout=="function"?clearTimeout:void 0,yd=typeof Promise=="function"?Promise:void 0,xE=typeof queueMicrotask=="function"?queueMicrotask:typeof yd<"u"?function(t){return yd.resolve(null).then(t).catch(PE)}:Ku;function PE(t){setTimeout(function(){throw t})}function Vl(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){t.removeChild(i),ys(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);ys(e)}function Fn(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function Ed(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var bi=Math.random().toString(36).slice(2),zt="__reactFiber$"+bi,Ss="__reactProps$"+bi,cn="__reactContainer$"+bi,Ju="__reactEvents$"+bi,LE="__reactListeners$"+bi,CE="__reactHandles$"+bi;function ir(t){var e=t[zt];if(e)return e;for(var n=t.parentNode;n;){if(e=n[cn]||n[zt]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=Ed(t);t!==null;){if(n=t[zt])return n;t=Ed(t)}return e}t=n,n=t.parentNode}return null}function Hs(t){return t=t[zt]||t[cn],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function jr(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(R(33))}function Za(t){return t[Ss]||null}var ec=[],Gr=-1;function Yn(t){return{current:t}}function se(t){0>Gr||(t.current=ec[Gr],ec[Gr]=null,Gr--)}function te(t,e){Gr++,ec[Gr]=t.current,t.current=e}var Wn={},Fe=Yn(Wn),$e=Yn(!1),fr=Wn;function oi(t,e){var n=t.type.contextTypes;if(!n)return Wn;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in n)i[s]=e[s];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function qe(t){return t=t.childContextTypes,t!=null}function _a(){se($e),se(Fe)}function wd(t,e,n){if(Fe.current!==Wn)throw Error(R(168));te(Fe,e),te($e,n)}function c0(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(R(108,d1(t)||"Unknown",i));return fe({},n,r)}function va(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Wn,fr=Fe.current,te(Fe,t),te($e,$e.current),!0}function Td(t,e,n){var r=t.stateNode;if(!r)throw Error(R(169));n?(t=c0(t,e,fr),r.__reactInternalMemoizedMergedChildContext=t,se($e),se(Fe),te(Fe,t)):se($e),te($e,n)}var nn=null,Qa=!1,jl=!1;function f0(t){nn===null?nn=[t]:nn.push(t)}function ME(t){Qa=!0,f0(t)}function $n(){if(!jl&&nn!==null){jl=!0;var t=0,e=Q;try{var n=nn;for(Q=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}nn=null,Qa=!1}catch(i){throw nn!==null&&(nn=nn.slice(t+1)),Dm(of,$n),i}finally{Q=e,jl=!1}}return null}var Hr=[],Wr=0,ya=null,Ea=0,dt=[],gt=0,hr=null,on=1,an="";function tr(t,e){Hr[Wr++]=Ea,Hr[Wr++]=ya,ya=t,Ea=e}function h0(t,e,n){dt[gt++]=on,dt[gt++]=an,dt[gt++]=hr,hr=t;var r=on;t=an;var i=32-Pt(r)-1;r&=~(1<<i),n+=1;var s=32-Pt(e)+i;if(30<s){var o=i-i%5;s=(r&(1<<o)-1).toString(32),r>>=o,i-=o,on=1<<32-Pt(e)+i|n<<i|r,an=s+t}else on=1<<s|n<<i|r,an=t}function pf(t){t.return!==null&&(tr(t,1),h0(t,1,0))}function mf(t){for(;t===ya;)ya=Hr[--Wr],Hr[Wr]=null,Ea=Hr[--Wr],Hr[Wr]=null;for(;t===hr;)hr=dt[--gt],dt[gt]=null,an=dt[--gt],dt[gt]=null,on=dt[--gt],dt[gt]=null}var st=null,rt=null,ae=!1,At=null;function d0(t,e){var n=pt(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function bd(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,st=t,rt=Fn(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,st=t,rt=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=hr!==null?{id:on,overflow:an}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=pt(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,st=t,rt=null,!0):!1;default:return!1}}function tc(t){return(t.mode&1)!==0&&(t.flags&128)===0}function nc(t){if(ae){var e=rt;if(e){var n=e;if(!bd(t,e)){if(tc(t))throw Error(R(418));e=Fn(n.nextSibling);var r=st;e&&bd(t,e)?d0(r,n):(t.flags=t.flags&-4097|2,ae=!1,st=t)}}else{if(tc(t))throw Error(R(418));t.flags=t.flags&-4097|2,ae=!1,st=t}}}function Sd(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;st=t}function So(t){if(t!==st)return!1;if(!ae)return Sd(t),ae=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Qu(t.type,t.memoizedProps)),e&&(e=rt)){if(tc(t))throw g0(),Error(R(418));for(;e;)d0(t,e),e=Fn(e.nextSibling)}if(Sd(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(R(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){rt=Fn(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}rt=null}}else rt=st?Fn(t.stateNode.nextSibling):null;return!0}function g0(){for(var t=rt;t;)t=Fn(t.nextSibling)}function ai(){rt=st=null,ae=!1}function _f(t){At===null?At=[t]:At.push(t)}var RE=mn.ReactCurrentBatchConfig;function bt(t,e){if(t&&t.defaultProps){e=fe({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}var wa=Yn(null),Ta=null,Xr=null,vf=null;function yf(){vf=Xr=Ta=null}function Ef(t){var e=wa.current;se(wa),t._currentValue=e}function rc(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function ti(t,e){Ta=t,vf=Xr=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Ye=!0),t.firstContext=null)}function vt(t){var e=t._currentValue;if(vf!==t)if(t={context:t,memoizedValue:e,next:null},Xr===null){if(Ta===null)throw Error(R(308));Xr=t,Ta.dependencies={lanes:0,firstContext:t}}else Xr=Xr.next=t;return e}var sr=null;function wf(t){sr===null?sr=[t]:sr.push(t)}function p0(t,e,n,r){var i=e.interleaved;return i===null?(n.next=n,wf(e)):(n.next=i.next,i.next=n),e.interleaved=n,fn(t,r)}function fn(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Pn=!1;function Tf(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function m0(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function ln(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Un(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,Y&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,fn(t,n)}return i=r.interleaved,i===null?(e.next=e,wf(r)):(e.next=i.next,i.next=e),r.interleaved=e,fn(t,n)}function Yo(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,af(t,n)}}function Ad(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?i=s=o:s=s.next=o,n=n.next}while(n!==null);s===null?i=s=e:s=s.next=e}else i=s=e;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function ba(t,e,n,r){var i=t.updateQueue;Pn=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,a=i.shared.pending;if(a!==null){i.shared.pending=null;var l=a,u=l.next;l.next=null,o===null?s=u:o.next=u,o=l;var c=t.alternate;c!==null&&(c=c.updateQueue,a=c.lastBaseUpdate,a!==o&&(a===null?c.firstBaseUpdate=u:a.next=u,c.lastBaseUpdate=l))}if(s!==null){var f=i.baseState;o=0,c=u=l=null,a=s;do{var h=a.lane,p=a.eventTime;if((r&h)===h){c!==null&&(c=c.next={eventTime:p,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var E=t,w=a;switch(h=e,p=n,w.tag){case 1:if(E=w.payload,typeof E=="function"){f=E.call(p,f,h);break e}f=E;break e;case 3:E.flags=E.flags&-65537|128;case 0:if(E=w.payload,h=typeof E=="function"?E.call(p,f,h):E,h==null)break e;f=fe({},f,h);break e;case 2:Pn=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,h=i.effects,h===null?i.effects=[a]:h.push(a))}else p={eventTime:p,lane:h,tag:a.tag,payload:a.payload,callback:a.callback,next:null},c===null?(u=c=p,l=f):c=c.next=p,o|=h;if(a=a.next,a===null){if(a=i.shared.pending,a===null)break;h=a,a=h.next,h.next=null,i.lastBaseUpdate=h,i.shared.pending=null}}while(1);if(c===null&&(l=f),i.baseState=l,i.firstBaseUpdate=u,i.lastBaseUpdate=c,e=i.shared.interleaved,e!==null){i=e;do o|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);gr|=o,t.lanes=o,t.memoizedState=f}}function xd(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(R(191,i));i.call(r)}}}var _0=new pm.Component().refs;function ic(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:fe({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Ka={isMounted:function(t){return(t=t._reactInternals)?Er(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=je(),i=zn(t),s=ln(r,i);s.payload=e,n!=null&&(s.callback=n),e=Un(t,s,i),e!==null&&(Lt(e,t,i,r),Yo(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=je(),i=zn(t),s=ln(r,i);s.tag=1,s.payload=e,n!=null&&(s.callback=n),e=Un(t,s,i),e!==null&&(Lt(e,t,i,r),Yo(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=je(),r=zn(t),i=ln(n,r);i.tag=2,e!=null&&(i.callback=e),e=Un(t,i,r),e!==null&&(Lt(e,t,r,n),Yo(e,t,r))}};function Pd(t,e,n,r,i,s,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,s,o):e.prototype&&e.prototype.isPureReactComponent?!ws(n,r)||!ws(i,s):!0}function v0(t,e,n){var r=!1,i=Wn,s=e.contextType;return typeof s=="object"&&s!==null?s=vt(s):(i=qe(e)?fr:Fe.current,r=e.contextTypes,s=(r=r!=null)?oi(t,i):Wn),e=new e(n,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Ka,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function Ld(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Ka.enqueueReplaceState(e,e.state,null)}function sc(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs=_0,Tf(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=vt(s):(s=qe(e)?fr:Fe.current,i.context=oi(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(ic(t,e,s,n),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&Ka.enqueueReplaceState(i,i.state,null),ba(t,n,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function zi(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(R(309));var r=n.stateNode}if(!r)throw Error(R(147,t));var i=r,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var a=i.refs;a===_0&&(a=i.refs={}),o===null?delete a[s]:a[s]=o},e._stringRef=s,e)}if(typeof t!="string")throw Error(R(284));if(!n._owner)throw Error(R(290,t))}return t}function Ao(t,e){throw t=Object.prototype.toString.call(e),Error(R(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function Cd(t){var e=t._init;return e(t._payload)}function y0(t){function e(_,m){if(t){var y=_.deletions;y===null?(_.deletions=[m],_.flags|=16):y.push(m)}}function n(_,m){if(!t)return null;for(;m!==null;)e(_,m),m=m.sibling;return null}function r(_,m){for(_=new Map;m!==null;)m.key!==null?_.set(m.key,m):_.set(m.index,m),m=m.sibling;return _}function i(_,m){return _=Vn(_,m),_.index=0,_.sibling=null,_}function s(_,m,y){return _.index=y,t?(y=_.alternate,y!==null?(y=y.index,y<m?(_.flags|=2,m):y):(_.flags|=2,m)):(_.flags|=1048576,m)}function o(_){return t&&_.alternate===null&&(_.flags|=2),_}function a(_,m,y,b){return m===null||m.tag!==6?(m=ql(y,_.mode,b),m.return=_,m):(m=i(m,y),m.return=_,m)}function l(_,m,y,b){var x=y.type;return x===Ur?c(_,m,y.props.children,b,y.key):m!==null&&(m.elementType===x||typeof x=="object"&&x!==null&&x.$$typeof===xn&&Cd(x)===m.type)?(b=i(m,y.props),b.ref=zi(_,m,y),b.return=_,b):(b=Jo(y.type,y.key,y.props,null,_.mode,b),b.ref=zi(_,m,y),b.return=_,b)}function u(_,m,y,b){return m===null||m.tag!==4||m.stateNode.containerInfo!==y.containerInfo||m.stateNode.implementation!==y.implementation?(m=Zl(y,_.mode,b),m.return=_,m):(m=i(m,y.children||[]),m.return=_,m)}function c(_,m,y,b,x){return m===null||m.tag!==7?(m=ur(y,_.mode,b,x),m.return=_,m):(m=i(m,y),m.return=_,m)}function f(_,m,y){if(typeof m=="string"&&m!==""||typeof m=="number")return m=ql(""+m,_.mode,y),m.return=_,m;if(typeof m=="object"&&m!==null){switch(m.$$typeof){case go:return y=Jo(m.type,m.key,m.props,null,_.mode,y),y.ref=zi(_,null,m),y.return=_,y;case Fr:return m=Zl(m,_.mode,y),m.return=_,m;case xn:var b=m._init;return f(_,b(m._payload),y)}if(Qi(m)||Ni(m))return m=ur(m,_.mode,y,null),m.return=_,m;Ao(_,m)}return null}function h(_,m,y,b){var x=m!==null?m.key:null;if(typeof y=="string"&&y!==""||typeof y=="number")return x!==null?null:a(_,m,""+y,b);if(typeof y=="object"&&y!==null){switch(y.$$typeof){case go:return y.key===x?l(_,m,y,b):null;case Fr:return y.key===x?u(_,m,y,b):null;case xn:return x=y._init,h(_,m,x(y._payload),b)}if(Qi(y)||Ni(y))return x!==null?null:c(_,m,y,b,null);Ao(_,y)}return null}function p(_,m,y,b,x){if(typeof b=="string"&&b!==""||typeof b=="number")return _=_.get(y)||null,a(m,_,""+b,x);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case go:return _=_.get(b.key===null?y:b.key)||null,l(m,_,b,x);case Fr:return _=_.get(b.key===null?y:b.key)||null,u(m,_,b,x);case xn:var P=b._init;return p(_,m,y,P(b._payload),x)}if(Qi(b)||Ni(b))return _=_.get(y)||null,c(m,_,b,x,null);Ao(m,b)}return null}function E(_,m,y,b){for(var x=null,P=null,L=m,C=m=0,O=null;L!==null&&C<y.length;C++){L.index>C?(O=L,L=null):O=L.sibling;var I=h(_,L,y[C],b);if(I===null){L===null&&(L=O);break}t&&L&&I.alternate===null&&e(_,L),m=s(I,m,C),P===null?x=I:P.sibling=I,P=I,L=O}if(C===y.length)return n(_,L),ae&&tr(_,C),x;if(L===null){for(;C<y.length;C++)L=f(_,y[C],b),L!==null&&(m=s(L,m,C),P===null?x=L:P.sibling=L,P=L);return ae&&tr(_,C),x}for(L=r(_,L);C<y.length;C++)O=p(L,_,C,y[C],b),O!==null&&(t&&O.alternate!==null&&L.delete(O.key===null?C:O.key),m=s(O,m,C),P===null?x=O:P.sibling=O,P=O);return t&&L.forEach(function(B){return e(_,B)}),ae&&tr(_,C),x}function w(_,m,y,b){var x=Ni(y);if(typeof x!="function")throw Error(R(150));if(y=x.call(y),y==null)throw Error(R(151));for(var P=x=null,L=m,C=m=0,O=null,I=y.next();L!==null&&!I.done;C++,I=y.next()){L.index>C?(O=L,L=null):O=L.sibling;var B=h(_,L,I.value,b);if(B===null){L===null&&(L=O);break}t&&L&&B.alternate===null&&e(_,L),m=s(B,m,C),P===null?x=B:P.sibling=B,P=B,L=O}if(I.done)return n(_,L),ae&&tr(_,C),x;if(L===null){for(;!I.done;C++,I=y.next())I=f(_,I.value,b),I!==null&&(m=s(I,m,C),P===null?x=I:P.sibling=I,P=I);return ae&&tr(_,C),x}for(L=r(_,L);!I.done;C++,I=y.next())I=p(L,_,C,I.value,b),I!==null&&(t&&I.alternate!==null&&L.delete(I.key===null?C:I.key),m=s(I,m,C),P===null?x=I:P.sibling=I,P=I);return t&&L.forEach(function($){return e(_,$)}),ae&&tr(_,C),x}function S(_,m,y,b){if(typeof y=="object"&&y!==null&&y.type===Ur&&y.key===null&&(y=y.props.children),typeof y=="object"&&y!==null){switch(y.$$typeof){case go:e:{for(var x=y.key,P=m;P!==null;){if(P.key===x){if(x=y.type,x===Ur){if(P.tag===7){n(_,P.sibling),m=i(P,y.props.children),m.return=_,_=m;break e}}else if(P.elementType===x||typeof x=="object"&&x!==null&&x.$$typeof===xn&&Cd(x)===P.type){n(_,P.sibling),m=i(P,y.props),m.ref=zi(_,P,y),m.return=_,_=m;break e}n(_,P);break}else e(_,P);P=P.sibling}y.type===Ur?(m=ur(y.props.children,_.mode,b,y.key),m.return=_,_=m):(b=Jo(y.type,y.key,y.props,null,_.mode,b),b.ref=zi(_,m,y),b.return=_,_=b)}return o(_);case Fr:e:{for(P=y.key;m!==null;){if(m.key===P)if(m.tag===4&&m.stateNode.containerInfo===y.containerInfo&&m.stateNode.implementation===y.implementation){n(_,m.sibling),m=i(m,y.children||[]),m.return=_,_=m;break e}else{n(_,m);break}else e(_,m);m=m.sibling}m=Zl(y,_.mode,b),m.return=_,_=m}return o(_);case xn:return P=y._init,S(_,m,P(y._payload),b)}if(Qi(y))return E(_,m,y,b);if(Ni(y))return w(_,m,y,b);Ao(_,y)}return typeof y=="string"&&y!==""||typeof y=="number"?(y=""+y,m!==null&&m.tag===6?(n(_,m.sibling),m=i(m,y),m.return=_,_=m):(n(_,m),m=ql(y,_.mode,b),m.return=_,_=m),o(_)):n(_,m)}return S}var li=y0(!0),E0=y0(!1),Ws={},Wt=Yn(Ws),As=Yn(Ws),xs=Yn(Ws);function or(t){if(t===Ws)throw Error(R(174));return t}function bf(t,e){switch(te(xs,e),te(As,t),te(Wt,Ws),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Fu(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Fu(e,t)}se(Wt),te(Wt,e)}function ui(){se(Wt),se(As),se(xs)}function w0(t){or(xs.current);var e=or(Wt.current),n=Fu(e,t.type);e!==n&&(te(As,t),te(Wt,n))}function Sf(t){As.current===t&&(se(Wt),se(As))}var ue=Yn(0);function Sa(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Gl=[];function Af(){for(var t=0;t<Gl.length;t++)Gl[t]._workInProgressVersionPrimary=null;Gl.length=0}var $o=mn.ReactCurrentDispatcher,Hl=mn.ReactCurrentBatchConfig,dr=0,ce=null,Ee=null,Se=null,Aa=!1,as=!1,Ps=0,IE=0;function Ie(){throw Error(R(321))}function xf(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Mt(t[n],e[n]))return!1;return!0}function Pf(t,e,n,r,i,s){if(dr=s,ce=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,$o.current=t===null||t.memoizedState===null?DE:FE,t=n(r,i),as){s=0;do{if(as=!1,Ps=0,25<=s)throw Error(R(301));s+=1,Se=Ee=null,e.updateQueue=null,$o.current=UE,t=n(r,i)}while(as)}if($o.current=xa,e=Ee!==null&&Ee.next!==null,dr=0,Se=Ee=ce=null,Aa=!1,e)throw Error(R(300));return t}function Lf(){var t=Ps!==0;return Ps=0,t}function Bt(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Se===null?ce.memoizedState=Se=t:Se=Se.next=t,Se}function yt(){if(Ee===null){var t=ce.alternate;t=t!==null?t.memoizedState:null}else t=Ee.next;var e=Se===null?ce.memoizedState:Se.next;if(e!==null)Se=e,Ee=t;else{if(t===null)throw Error(R(310));Ee=t,t={memoizedState:Ee.memoizedState,baseState:Ee.baseState,baseQueue:Ee.baseQueue,queue:Ee.queue,next:null},Se===null?ce.memoizedState=Se=t:Se=Se.next=t}return Se}function Ls(t,e){return typeof e=="function"?e(t):e}function Wl(t){var e=yt(),n=e.queue;if(n===null)throw Error(R(311));n.lastRenderedReducer=t;var r=Ee,i=r.baseQueue,s=n.pending;if(s!==null){if(i!==null){var o=i.next;i.next=s.next,s.next=o}r.baseQueue=i=s,n.pending=null}if(i!==null){s=i.next,r=r.baseState;var a=o=null,l=null,u=s;do{var c=u.lane;if((dr&c)===c)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:t(r,u.action);else{var f={lane:c,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(a=l=f,o=r):l=l.next=f,ce.lanes|=c,gr|=c}u=u.next}while(u!==null&&u!==s);l===null?o=r:l.next=a,Mt(r,e.memoizedState)||(Ye=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=l,n.lastRenderedState=r}if(t=n.interleaved,t!==null){i=t;do s=i.lane,ce.lanes|=s,gr|=s,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Xl(t){var e=yt(),n=e.queue;if(n===null)throw Error(R(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,s=e.memoizedState;if(i!==null){n.pending=null;var o=i=i.next;do s=t(s,o.action),o=o.next;while(o!==i);Mt(s,e.memoizedState)||(Ye=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),n.lastRenderedState=s}return[s,r]}function T0(){}function b0(t,e){var n=ce,r=yt(),i=e(),s=!Mt(r.memoizedState,i);if(s&&(r.memoizedState=i,Ye=!0),r=r.queue,Cf(x0.bind(null,n,r,t),[t]),r.getSnapshot!==e||s||Se!==null&&Se.memoizedState.tag&1){if(n.flags|=2048,Cs(9,A0.bind(null,n,r,i,e),void 0,null),Ae===null)throw Error(R(349));dr&30||S0(n,e,i)}return i}function S0(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=ce.updateQueue,e===null?(e={lastEffect:null,stores:null},ce.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function A0(t,e,n,r){e.value=n,e.getSnapshot=r,P0(e)&&L0(t)}function x0(t,e,n){return n(function(){P0(e)&&L0(t)})}function P0(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Mt(t,n)}catch{return!0}}function L0(t){var e=fn(t,1);e!==null&&Lt(e,t,1,-1)}function Md(t){var e=Bt();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ls,lastRenderedState:t},e.queue=t,t=t.dispatch=NE.bind(null,ce,t),[e.memoizedState,t]}function Cs(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=ce.updateQueue,e===null?(e={lastEffect:null,stores:null},ce.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function C0(){return yt().memoizedState}function qo(t,e,n,r){var i=Bt();ce.flags|=t,i.memoizedState=Cs(1|e,n,void 0,r===void 0?null:r)}function Ja(t,e,n,r){var i=yt();r=r===void 0?null:r;var s=void 0;if(Ee!==null){var o=Ee.memoizedState;if(s=o.destroy,r!==null&&xf(r,o.deps)){i.memoizedState=Cs(e,n,s,r);return}}ce.flags|=t,i.memoizedState=Cs(1|e,n,s,r)}function Rd(t,e){return qo(8390656,8,t,e)}function Cf(t,e){return Ja(2048,8,t,e)}function M0(t,e){return Ja(4,2,t,e)}function R0(t,e){return Ja(4,4,t,e)}function I0(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function O0(t,e,n){return n=n!=null?n.concat([t]):null,Ja(4,4,I0.bind(null,e,t),n)}function Mf(){}function k0(t,e){var n=yt();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&xf(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function N0(t,e){var n=yt();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&xf(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function D0(t,e,n){return dr&21?(Mt(n,e)||(n=Bm(),ce.lanes|=n,gr|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Ye=!0),t.memoizedState=n)}function OE(t,e){var n=Q;Q=n!==0&&4>n?n:4,t(!0);var r=Hl.transition;Hl.transition={};try{t(!1),e()}finally{Q=n,Hl.transition=r}}function F0(){return yt().memoizedState}function kE(t,e,n){var r=zn(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},U0(t))B0(e,n);else if(n=p0(t,e,n,r),n!==null){var i=je();Lt(n,t,r,i),z0(n,e,r)}}function NE(t,e,n){var r=zn(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(U0(t))B0(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,a=s(o,n);if(i.hasEagerState=!0,i.eagerState=a,Mt(a,o)){var l=e.interleaved;l===null?(i.next=i,wf(e)):(i.next=l.next,l.next=i),e.interleaved=i;return}}catch{}finally{}n=p0(t,e,i,r),n!==null&&(i=je(),Lt(n,t,r,i),z0(n,e,r))}}function U0(t){var e=t.alternate;return t===ce||e!==null&&e===ce}function B0(t,e){as=Aa=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function z0(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,af(t,n)}}var xa={readContext:vt,useCallback:Ie,useContext:Ie,useEffect:Ie,useImperativeHandle:Ie,useInsertionEffect:Ie,useLayoutEffect:Ie,useMemo:Ie,useReducer:Ie,useRef:Ie,useState:Ie,useDebugValue:Ie,useDeferredValue:Ie,useTransition:Ie,useMutableSource:Ie,useSyncExternalStore:Ie,useId:Ie,unstable_isNewReconciler:!1},DE={readContext:vt,useCallback:function(t,e){return Bt().memoizedState=[t,e===void 0?null:e],t},useContext:vt,useEffect:Rd,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,qo(4194308,4,I0.bind(null,e,t),n)},useLayoutEffect:function(t,e){return qo(4194308,4,t,e)},useInsertionEffect:function(t,e){return qo(4,2,t,e)},useMemo:function(t,e){var n=Bt();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=Bt();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=kE.bind(null,ce,t),[r.memoizedState,t]},useRef:function(t){var e=Bt();return t={current:t},e.memoizedState=t},useState:Md,useDebugValue:Mf,useDeferredValue:function(t){return Bt().memoizedState=t},useTransition:function(){var t=Md(!1),e=t[0];return t=OE.bind(null,t[1]),Bt().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=ce,i=Bt();if(ae){if(n===void 0)throw Error(R(407));n=n()}else{if(n=e(),Ae===null)throw Error(R(349));dr&30||S0(r,e,n)}i.memoizedState=n;var s={value:n,getSnapshot:e};return i.queue=s,Rd(x0.bind(null,r,s,t),[t]),r.flags|=2048,Cs(9,A0.bind(null,r,s,n,e),void 0,null),n},useId:function(){var t=Bt(),e=Ae.identifierPrefix;if(ae){var n=an,r=on;n=(r&~(1<<32-Pt(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Ps++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=IE++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},FE={readContext:vt,useCallback:k0,useContext:vt,useEffect:Cf,useImperativeHandle:O0,useInsertionEffect:M0,useLayoutEffect:R0,useMemo:N0,useReducer:Wl,useRef:C0,useState:function(){return Wl(Ls)},useDebugValue:Mf,useDeferredValue:function(t){var e=yt();return D0(e,Ee.memoizedState,t)},useTransition:function(){var t=Wl(Ls)[0],e=yt().memoizedState;return[t,e]},useMutableSource:T0,useSyncExternalStore:b0,useId:F0,unstable_isNewReconciler:!1},UE={readContext:vt,useCallback:k0,useContext:vt,useEffect:Cf,useImperativeHandle:O0,useInsertionEffect:M0,useLayoutEffect:R0,useMemo:N0,useReducer:Xl,useRef:C0,useState:function(){return Xl(Ls)},useDebugValue:Mf,useDeferredValue:function(t){var e=yt();return Ee===null?e.memoizedState=t:D0(e,Ee.memoizedState,t)},useTransition:function(){var t=Xl(Ls)[0],e=yt().memoizedState;return[t,e]},useMutableSource:T0,useSyncExternalStore:b0,useId:F0,unstable_isNewReconciler:!1};function ci(t,e){try{var n="",r=e;do n+=h1(r),r=r.return;while(r);var i=n}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function Yl(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function oc(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var BE=typeof WeakMap=="function"?WeakMap:Map;function V0(t,e,n){n=ln(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){La||(La=!0,mc=r),oc(t,e)},n}function j0(t,e,n){n=ln(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){oc(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){oc(t,e),typeof r!="function"&&(Bn===null?Bn=new Set([this]):Bn.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function Id(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new BE;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=JE.bind(null,t,e,n),e.then(t,t))}function Od(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function kd(t,e,n,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=ln(-1,1),e.tag=2,Un(n,e,1))),n.lanes|=1),t)}var zE=mn.ReactCurrentOwner,Ye=!1;function Be(t,e,n,r){e.child=t===null?E0(e,null,n,r):li(e,t.child,n,r)}function Nd(t,e,n,r,i){n=n.render;var s=e.ref;return ti(e,i),r=Pf(t,e,n,r,s,i),n=Lf(),t!==null&&!Ye?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,hn(t,e,i)):(ae&&n&&pf(e),e.flags|=1,Be(t,e,r,i),e.child)}function Dd(t,e,n,r,i){if(t===null){var s=n.type;return typeof s=="function"&&!Uf(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=s,G0(t,e,s,r,i)):(t=Jo(n.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var o=s.memoizedProps;if(n=n.compare,n=n!==null?n:ws,n(o,r)&&t.ref===e.ref)return hn(t,e,i)}return e.flags|=1,t=Vn(s,r),t.ref=e.ref,t.return=e,e.child=t}function G0(t,e,n,r,i){if(t!==null){var s=t.memoizedProps;if(ws(s,r)&&t.ref===e.ref)if(Ye=!1,e.pendingProps=r=s,(t.lanes&i)!==0)t.flags&131072&&(Ye=!0);else return e.lanes=t.lanes,hn(t,e,i)}return ac(t,e,n,r,i)}function H0(t,e,n){var r=e.pendingProps,i=r.children,s=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},te($r,et),et|=n;else{if(!(n&1073741824))return t=s!==null?s.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,te($r,et),et|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:n,te($r,et),et|=r}else s!==null?(r=s.baseLanes|n,e.memoizedState=null):r=n,te($r,et),et|=r;return Be(t,e,i,n),e.child}function W0(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function ac(t,e,n,r,i){var s=qe(n)?fr:Fe.current;return s=oi(e,s),ti(e,i),n=Pf(t,e,n,r,s,i),r=Lf(),t!==null&&!Ye?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,hn(t,e,i)):(ae&&r&&pf(e),e.flags|=1,Be(t,e,n,i),e.child)}function Fd(t,e,n,r,i){if(qe(n)){var s=!0;va(e)}else s=!1;if(ti(e,i),e.stateNode===null)Zo(t,e),v0(e,n,r),sc(e,n,r,i),r=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,u=n.contextType;typeof u=="object"&&u!==null?u=vt(u):(u=qe(n)?fr:Fe.current,u=oi(e,u));var c=n.getDerivedStateFromProps,f=typeof c=="function"||typeof o.getSnapshotBeforeUpdate=="function";f||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==r||l!==u)&&Ld(e,o,r,u),Pn=!1;var h=e.memoizedState;o.state=h,ba(e,r,o,i),l=e.memoizedState,a!==r||h!==l||$e.current||Pn?(typeof c=="function"&&(ic(e,n,c,r),l=e.memoizedState),(a=Pn||Pd(e,n,a,r,h,l,u))?(f||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),o.props=r,o.state=l,o.context=u,r=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,m0(t,e),a=e.memoizedProps,u=e.type===e.elementType?a:bt(e.type,a),o.props=u,f=e.pendingProps,h=o.context,l=n.contextType,typeof l=="object"&&l!==null?l=vt(l):(l=qe(n)?fr:Fe.current,l=oi(e,l));var p=n.getDerivedStateFromProps;(c=typeof p=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==f||h!==l)&&Ld(e,o,r,l),Pn=!1,h=e.memoizedState,o.state=h,ba(e,r,o,i);var E=e.memoizedState;a!==f||h!==E||$e.current||Pn?(typeof p=="function"&&(ic(e,n,p,r),E=e.memoizedState),(u=Pn||Pd(e,n,u,r,h,E,l)||!1)?(c||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,E,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,E,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=E),o.props=r,o.state=E,o.context=l,r=u):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=1024),r=!1)}return lc(t,e,n,r,s,i)}function lc(t,e,n,r,i,s){W0(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return i&&Td(e,n,!1),hn(t,e,s);r=e.stateNode,zE.current=e;var a=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=li(e,t.child,null,s),e.child=li(e,null,a,s)):Be(t,e,a,s),e.memoizedState=r.state,i&&Td(e,n,!0),e.child}function X0(t){var e=t.stateNode;e.pendingContext?wd(t,e.pendingContext,e.pendingContext!==e.context):e.context&&wd(t,e.context,!1),bf(t,e.containerInfo)}function Ud(t,e,n,r,i){return ai(),_f(i),e.flags|=256,Be(t,e,n,r),e.child}var uc={dehydrated:null,treeContext:null,retryLane:0};function cc(t){return{baseLanes:t,cachePool:null,transitions:null}}function Y0(t,e,n){var r=e.pendingProps,i=ue.current,s=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(i&2)!==0),a?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),te(ue,i&1),t===null)return nc(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,s?(r=e.mode,s=e.child,o={mode:"hidden",children:o},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=nl(o,r,0,null),t=ur(t,r,n,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=cc(n),e.memoizedState=uc,t):Rf(e,o));if(i=t.memoizedState,i!==null&&(a=i.dehydrated,a!==null))return VE(t,e,o,r,a,i,n);if(s){s=r.fallback,o=e.mode,i=t.child,a=i.sibling;var l={mode:"hidden",children:r.children};return!(o&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=Vn(i,l),r.subtreeFlags=i.subtreeFlags&14680064),a!==null?s=Vn(a,s):(s=ur(s,o,n,null),s.flags|=2),s.return=e,r.return=e,r.sibling=s,e.child=r,r=s,s=e.child,o=t.child.memoizedState,o=o===null?cc(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=t.childLanes&~n,e.memoizedState=uc,r}return s=t.child,t=s.sibling,r=Vn(s,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function Rf(t,e){return e=nl({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function xo(t,e,n,r){return r!==null&&_f(r),li(e,t.child,null,n),t=Rf(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function VE(t,e,n,r,i,s,o){if(n)return e.flags&256?(e.flags&=-257,r=Yl(Error(R(422))),xo(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=r.fallback,i=e.mode,r=nl({mode:"visible",children:r.children},i,0,null),s=ur(s,i,o,null),s.flags|=2,r.return=e,s.return=e,r.sibling=s,e.child=r,e.mode&1&&li(e,t.child,null,o),e.child.memoizedState=cc(o),e.memoizedState=uc,s);if(!(e.mode&1))return xo(t,e,o,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var a=r.dgst;return r=a,s=Error(R(419)),r=Yl(s,r,void 0),xo(t,e,o,r)}if(a=(o&t.childLanes)!==0,Ye||a){if(r=Ae,r!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|o)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,fn(t,i),Lt(r,t,i,-1))}return Ff(),r=Yl(Error(R(421))),xo(t,e,o,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=ew.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,rt=Fn(i.nextSibling),st=e,ae=!0,At=null,t!==null&&(dt[gt++]=on,dt[gt++]=an,dt[gt++]=hr,on=t.id,an=t.overflow,hr=e),e=Rf(e,r.children),e.flags|=4096,e)}function Bd(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),rc(t.return,e,n)}function $l(t,e,n,r,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function $0(t,e,n){var r=e.pendingProps,i=r.revealOrder,s=r.tail;if(Be(t,e,r.children,n),r=ue.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Bd(t,n,e);else if(t.tag===19)Bd(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(te(ue,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&Sa(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),$l(e,!1,i,n,s);break;case"backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&Sa(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}$l(e,!0,n,null,s);break;case"together":$l(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Zo(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function hn(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),gr|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(R(153));if(e.child!==null){for(t=e.child,n=Vn(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Vn(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function jE(t,e,n){switch(e.tag){case 3:X0(e),ai();break;case 5:w0(e);break;case 1:qe(e.type)&&va(e);break;case 4:bf(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;te(wa,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(te(ue,ue.current&1),e.flags|=128,null):n&e.child.childLanes?Y0(t,e,n):(te(ue,ue.current&1),t=hn(t,e,n),t!==null?t.sibling:null);te(ue,ue.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return $0(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),te(ue,ue.current),r)break;return null;case 22:case 23:return e.lanes=0,H0(t,e,n)}return hn(t,e,n)}var q0,fc,Z0,Q0;q0=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};fc=function(){};Z0=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,or(Wt.current);var s=null;switch(n){case"input":i=Ou(t,i),r=Ou(t,r),s=[];break;case"select":i=fe({},i,{value:void 0}),r=fe({},r,{value:void 0}),s=[];break;case"textarea":i=Du(t,i),r=Du(t,r),s=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=ma)}Uu(n,r);var o;n=null;for(u in i)if(!r.hasOwnProperty(u)&&i.hasOwnProperty(u)&&i[u]!=null)if(u==="style"){var a=i[u];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(gs.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in r){var l=r[u];if(a=i!=null?i[u]:void 0,r.hasOwnProperty(u)&&l!==a&&(l!=null||a!=null))if(u==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(n||(n={}),n[o]=l[o])}else n||(s||(s=[]),s.push(u,n)),n=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(s=s||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(gs.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&re("scroll",t),s||a===l||(s=[])):(s=s||[]).push(u,l))}n&&(s=s||[]).push("style",n);var u=s;(e.updateQueue=u)&&(e.flags|=4)}};Q0=function(t,e,n,r){n!==r&&(e.flags|=4)};function Vi(t,e){if(!ae)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Oe(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function GE(t,e,n){var r=e.pendingProps;switch(mf(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Oe(e),null;case 1:return qe(e.type)&&_a(),Oe(e),null;case 3:return r=e.stateNode,ui(),se($e),se(Fe),Af(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(So(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,At!==null&&(yc(At),At=null))),fc(t,e),Oe(e),null;case 5:Sf(e);var i=or(xs.current);if(n=e.type,t!==null&&e.stateNode!=null)Z0(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(R(166));return Oe(e),null}if(t=or(Wt.current),So(e)){r=e.stateNode,n=e.type;var s=e.memoizedProps;switch(r[zt]=e,r[Ss]=s,t=(e.mode&1)!==0,n){case"dialog":re("cancel",r),re("close",r);break;case"iframe":case"object":case"embed":re("load",r);break;case"video":case"audio":for(i=0;i<Ji.length;i++)re(Ji[i],r);break;case"source":re("error",r);break;case"img":case"image":case"link":re("error",r),re("load",r);break;case"details":re("toggle",r);break;case"input":$h(r,s),re("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},re("invalid",r);break;case"textarea":Zh(r,s),re("invalid",r)}Uu(n,s),i=null;for(var o in s)if(s.hasOwnProperty(o)){var a=s[o];o==="children"?typeof a=="string"?r.textContent!==a&&(s.suppressHydrationWarning!==!0&&bo(r.textContent,a,t),i=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(s.suppressHydrationWarning!==!0&&bo(r.textContent,a,t),i=["children",""+a]):gs.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&re("scroll",r)}switch(n){case"input":po(r),qh(r,s,!0);break;case"textarea":po(r),Qh(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=ma)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=Sm(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[zt]=e,t[Ss]=r,q0(t,e,!1,!1),e.stateNode=t;e:{switch(o=Bu(n,r),n){case"dialog":re("cancel",t),re("close",t),i=r;break;case"iframe":case"object":case"embed":re("load",t),i=r;break;case"video":case"audio":for(i=0;i<Ji.length;i++)re(Ji[i],t);i=r;break;case"source":re("error",t),i=r;break;case"img":case"image":case"link":re("error",t),re("load",t),i=r;break;case"details":re("toggle",t),i=r;break;case"input":$h(t,r),i=Ou(t,r),re("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=fe({},r,{value:void 0}),re("invalid",t);break;case"textarea":Zh(t,r),i=Du(t,r),re("invalid",t);break;default:i=r}Uu(n,i),a=i;for(s in a)if(a.hasOwnProperty(s)){var l=a[s];s==="style"?Pm(t,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&Am(t,l)):s==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&ps(t,l):typeof l=="number"&&ps(t,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(gs.hasOwnProperty(s)?l!=null&&s==="onScroll"&&re("scroll",t):l!=null&&ef(t,s,l,o))}switch(n){case"input":po(t),qh(t,r,!1);break;case"textarea":po(t),Qh(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Hn(r.value));break;case"select":t.multiple=!!r.multiple,s=r.value,s!=null?Qr(t,!!r.multiple,s,!1):r.defaultValue!=null&&Qr(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=ma)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Oe(e),null;case 6:if(t&&e.stateNode!=null)Q0(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(R(166));if(n=or(xs.current),or(Wt.current),So(e)){if(r=e.stateNode,n=e.memoizedProps,r[zt]=e,(s=r.nodeValue!==n)&&(t=st,t!==null))switch(t.tag){case 3:bo(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&bo(r.nodeValue,n,(t.mode&1)!==0)}s&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[zt]=e,e.stateNode=r}return Oe(e),null;case 13:if(se(ue),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(ae&&rt!==null&&e.mode&1&&!(e.flags&128))g0(),ai(),e.flags|=98560,s=!1;else if(s=So(e),r!==null&&r.dehydrated!==null){if(t===null){if(!s)throw Error(R(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(R(317));s[zt]=e}else ai(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Oe(e),s=!1}else At!==null&&(yc(At),At=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||ue.current&1?we===0&&(we=3):Ff())),e.updateQueue!==null&&(e.flags|=4),Oe(e),null);case 4:return ui(),fc(t,e),t===null&&Ts(e.stateNode.containerInfo),Oe(e),null;case 10:return Ef(e.type._context),Oe(e),null;case 17:return qe(e.type)&&_a(),Oe(e),null;case 19:if(se(ue),s=e.memoizedState,s===null)return Oe(e),null;if(r=(e.flags&128)!==0,o=s.rendering,o===null)if(r)Vi(s,!1);else{if(we!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=Sa(t),o!==null){for(e.flags|=128,Vi(s,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)s=n,t=r,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,t=o.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return te(ue,ue.current&1|2),e.child}t=t.sibling}s.tail!==null&&ge()>fi&&(e.flags|=128,r=!0,Vi(s,!1),e.lanes=4194304)}else{if(!r)if(t=Sa(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Vi(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!ae)return Oe(e),null}else 2*ge()-s.renderingStartTime>fi&&n!==1073741824&&(e.flags|=128,r=!0,Vi(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(n=s.last,n!==null?n.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=ge(),e.sibling=null,n=ue.current,te(ue,r?n&1|2:n&1),e):(Oe(e),null);case 22:case 23:return Df(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?et&1073741824&&(Oe(e),e.subtreeFlags&6&&(e.flags|=8192)):Oe(e),null;case 24:return null;case 25:return null}throw Error(R(156,e.tag))}function HE(t,e){switch(mf(e),e.tag){case 1:return qe(e.type)&&_a(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return ui(),se($e),se(Fe),Af(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Sf(e),null;case 13:if(se(ue),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(R(340));ai()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return se(ue),null;case 4:return ui(),null;case 10:return Ef(e.type._context),null;case 22:case 23:return Df(),null;case 24:return null;default:return null}}var Po=!1,De=!1,WE=typeof WeakSet=="function"?WeakSet:Set,F=null;function Yr(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){de(t,e,r)}else n.current=null}function hc(t,e,n){try{n()}catch(r){de(t,e,r)}}var zd=!1;function XE(t,e){if(qu=da,t=t0(),gf(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var o=0,a=-1,l=-1,u=0,c=0,f=t,h=null;t:for(;;){for(var p;f!==n||i!==0&&f.nodeType!==3||(a=o+i),f!==s||r!==0&&f.nodeType!==3||(l=o+r),f.nodeType===3&&(o+=f.nodeValue.length),(p=f.firstChild)!==null;)h=f,f=p;for(;;){if(f===t)break t;if(h===n&&++u===i&&(a=o),h===s&&++c===r&&(l=o),(p=f.nextSibling)!==null)break;f=h,h=f.parentNode}f=p}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(Zu={focusedElem:t,selectionRange:n},da=!1,F=e;F!==null;)if(e=F,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,F=t;else for(;F!==null;){e=F;try{var E=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(E!==null){var w=E.memoizedProps,S=E.memoizedState,_=e.stateNode,m=_.getSnapshotBeforeUpdate(e.elementType===e.type?w:bt(e.type,w),S);_.__reactInternalSnapshotBeforeUpdate=m}break;case 3:var y=e.stateNode.containerInfo;y.nodeType===1?y.textContent="":y.nodeType===9&&y.documentElement&&y.removeChild(y.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(R(163))}}catch(b){de(e,e.return,b)}if(t=e.sibling,t!==null){t.return=e.return,F=t;break}F=e.return}return E=zd,zd=!1,E}function ls(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&hc(e,n,s)}i=i.next}while(i!==r)}}function el(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function dc(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function K0(t){var e=t.alternate;e!==null&&(t.alternate=null,K0(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[zt],delete e[Ss],delete e[Ju],delete e[LE],delete e[CE])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function J0(t){return t.tag===5||t.tag===3||t.tag===4}function Vd(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||J0(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function gc(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=ma));else if(r!==4&&(t=t.child,t!==null))for(gc(t,e,n),t=t.sibling;t!==null;)gc(t,e,n),t=t.sibling}function pc(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(pc(t,e,n),t=t.sibling;t!==null;)pc(t,e,n),t=t.sibling}var Le=null,St=!1;function En(t,e,n){for(n=n.child;n!==null;)e_(t,e,n),n=n.sibling}function e_(t,e,n){if(Ht&&typeof Ht.onCommitFiberUnmount=="function")try{Ht.onCommitFiberUnmount(Xa,n)}catch{}switch(n.tag){case 5:De||Yr(n,e);case 6:var r=Le,i=St;Le=null,En(t,e,n),Le=r,St=i,Le!==null&&(St?(t=Le,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Le.removeChild(n.stateNode));break;case 18:Le!==null&&(St?(t=Le,n=n.stateNode,t.nodeType===8?Vl(t.parentNode,n):t.nodeType===1&&Vl(t,n),ys(t)):Vl(Le,n.stateNode));break;case 4:r=Le,i=St,Le=n.stateNode.containerInfo,St=!0,En(t,e,n),Le=r,St=i;break;case 0:case 11:case 14:case 15:if(!De&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var s=i,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&hc(n,e,o),i=i.next}while(i!==r)}En(t,e,n);break;case 1:if(!De&&(Yr(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){de(n,e,a)}En(t,e,n);break;case 21:En(t,e,n);break;case 22:n.mode&1?(De=(r=De)||n.memoizedState!==null,En(t,e,n),De=r):En(t,e,n);break;default:En(t,e,n)}}function jd(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new WE),e.forEach(function(r){var i=tw.bind(null,t,r);n.has(r)||(n.add(r),r.then(i,i))})}}function Tt(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var s=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:Le=a.stateNode,St=!1;break e;case 3:Le=a.stateNode.containerInfo,St=!0;break e;case 4:Le=a.stateNode.containerInfo,St=!0;break e}a=a.return}if(Le===null)throw Error(R(160));e_(s,o,i),Le=null,St=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(u){de(i,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)t_(e,t),e=e.sibling}function t_(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Tt(e,t),Nt(t),r&4){try{ls(3,t,t.return),el(3,t)}catch(w){de(t,t.return,w)}try{ls(5,t,t.return)}catch(w){de(t,t.return,w)}}break;case 1:Tt(e,t),Nt(t),r&512&&n!==null&&Yr(n,n.return);break;case 5:if(Tt(e,t),Nt(t),r&512&&n!==null&&Yr(n,n.return),t.flags&32){var i=t.stateNode;try{ps(i,"")}catch(w){de(t,t.return,w)}}if(r&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,o=n!==null?n.memoizedProps:s,a=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{a==="input"&&s.type==="radio"&&s.name!=null&&Tm(i,s),Bu(a,o);var u=Bu(a,s);for(o=0;o<l.length;o+=2){var c=l[o],f=l[o+1];c==="style"?Pm(i,f):c==="dangerouslySetInnerHTML"?Am(i,f):c==="children"?ps(i,f):ef(i,c,f,u)}switch(a){case"input":ku(i,s);break;case"textarea":bm(i,s);break;case"select":var h=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var p=s.value;p!=null?Qr(i,!!s.multiple,p,!1):h!==!!s.multiple&&(s.defaultValue!=null?Qr(i,!!s.multiple,s.defaultValue,!0):Qr(i,!!s.multiple,s.multiple?[]:"",!1))}i[Ss]=s}catch(w){de(t,t.return,w)}}break;case 6:if(Tt(e,t),Nt(t),r&4){if(t.stateNode===null)throw Error(R(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(w){de(t,t.return,w)}}break;case 3:if(Tt(e,t),Nt(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{ys(e.containerInfo)}catch(w){de(t,t.return,w)}break;case 4:Tt(e,t),Nt(t);break;case 13:Tt(e,t),Nt(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(kf=ge())),r&4&&jd(t);break;case 22:if(c=n!==null&&n.memoizedState!==null,t.mode&1?(De=(u=De)||c,Tt(e,t),De=u):Tt(e,t),Nt(t),r&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!c&&t.mode&1)for(F=t,c=t.child;c!==null;){for(f=F=c;F!==null;){switch(h=F,p=h.child,h.tag){case 0:case 11:case 14:case 15:ls(4,h,h.return);break;case 1:Yr(h,h.return);var E=h.stateNode;if(typeof E.componentWillUnmount=="function"){r=h,n=h.return;try{e=r,E.props=e.memoizedProps,E.state=e.memoizedState,E.componentWillUnmount()}catch(w){de(r,n,w)}}break;case 5:Yr(h,h.return);break;case 22:if(h.memoizedState!==null){Hd(f);continue}}p!==null?(p.return=h,F=p):Hd(f)}c=c.sibling}e:for(c=null,f=t;;){if(f.tag===5){if(c===null){c=f;try{i=f.stateNode,u?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(a=f.stateNode,l=f.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=xm("display",o))}catch(w){de(t,t.return,w)}}}else if(f.tag===6){if(c===null)try{f.stateNode.nodeValue=u?"":f.memoizedProps}catch(w){de(t,t.return,w)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===t)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===t)break e;for(;f.sibling===null;){if(f.return===null||f.return===t)break e;c===f&&(c=null),f=f.return}c===f&&(c=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:Tt(e,t),Nt(t),r&4&&jd(t);break;case 21:break;default:Tt(e,t),Nt(t)}}function Nt(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(J0(n)){var r=n;break e}n=n.return}throw Error(R(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(ps(i,""),r.flags&=-33);var s=Vd(t);pc(t,s,i);break;case 3:case 4:var o=r.stateNode.containerInfo,a=Vd(t);gc(t,a,o);break;default:throw Error(R(161))}}catch(l){de(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function YE(t,e,n){F=t,n_(t)}function n_(t,e,n){for(var r=(t.mode&1)!==0;F!==null;){var i=F,s=i.child;if(i.tag===22&&r){var o=i.memoizedState!==null||Po;if(!o){var a=i.alternate,l=a!==null&&a.memoizedState!==null||De;a=Po;var u=De;if(Po=o,(De=l)&&!u)for(F=i;F!==null;)o=F,l=o.child,o.tag===22&&o.memoizedState!==null?Wd(i):l!==null?(l.return=o,F=l):Wd(i);for(;s!==null;)F=s,n_(s),s=s.sibling;F=i,Po=a,De=u}Gd(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,F=s):Gd(t)}}function Gd(t){for(;F!==null;){var e=F;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:De||el(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!De)if(n===null)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:bt(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&xd(e,s,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}xd(e,o,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var c=u.memoizedState;if(c!==null){var f=c.dehydrated;f!==null&&ys(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(R(163))}De||e.flags&512&&dc(e)}catch(h){de(e,e.return,h)}}if(e===t){F=null;break}if(n=e.sibling,n!==null){n.return=e.return,F=n;break}F=e.return}}function Hd(t){for(;F!==null;){var e=F;if(e===t){F=null;break}var n=e.sibling;if(n!==null){n.return=e.return,F=n;break}F=e.return}}function Wd(t){for(;F!==null;){var e=F;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{el(4,e)}catch(l){de(e,n,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(l){de(e,i,l)}}var s=e.return;try{dc(e)}catch(l){de(e,s,l)}break;case 5:var o=e.return;try{dc(e)}catch(l){de(e,o,l)}}}catch(l){de(e,e.return,l)}if(e===t){F=null;break}var a=e.sibling;if(a!==null){a.return=e.return,F=a;break}F=e.return}}var $E=Math.ceil,Pa=mn.ReactCurrentDispatcher,If=mn.ReactCurrentOwner,mt=mn.ReactCurrentBatchConfig,Y=0,Ae=null,ve=null,Me=0,et=0,$r=Yn(0),we=0,Ms=null,gr=0,tl=0,Of=0,us=null,Xe=null,kf=0,fi=1/0,tn=null,La=!1,mc=null,Bn=null,Lo=!1,Rn=null,Ca=0,cs=0,_c=null,Qo=-1,Ko=0;function je(){return Y&6?ge():Qo!==-1?Qo:Qo=ge()}function zn(t){return t.mode&1?Y&2&&Me!==0?Me&-Me:RE.transition!==null?(Ko===0&&(Ko=Bm()),Ko):(t=Q,t!==0||(t=window.event,t=t===void 0?16:Xm(t.type)),t):1}function Lt(t,e,n,r){if(50<cs)throw cs=0,_c=null,Error(R(185));js(t,n,r),(!(Y&2)||t!==Ae)&&(t===Ae&&(!(Y&2)&&(tl|=n),we===4&&Cn(t,Me)),Ze(t,r),n===1&&Y===0&&!(e.mode&1)&&(fi=ge()+500,Qa&&$n()))}function Ze(t,e){var n=t.callbackNode;R1(t,e);var r=ha(t,t===Ae?Me:0);if(r===0)n!==null&&ed(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&ed(n),e===1)t.tag===0?ME(Xd.bind(null,t)):f0(Xd.bind(null,t)),xE(function(){!(Y&6)&&$n()}),n=null;else{switch(zm(r)){case 1:n=of;break;case 4:n=Fm;break;case 16:n=fa;break;case 536870912:n=Um;break;default:n=fa}n=c_(n,r_.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function r_(t,e){if(Qo=-1,Ko=0,Y&6)throw Error(R(327));var n=t.callbackNode;if(ni()&&t.callbackNode!==n)return null;var r=ha(t,t===Ae?Me:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=Ma(t,r);else{e=r;var i=Y;Y|=2;var s=s_();(Ae!==t||Me!==e)&&(tn=null,fi=ge()+500,lr(t,e));do try{QE();break}catch(a){i_(t,a)}while(1);yf(),Pa.current=s,Y=i,ve!==null?e=0:(Ae=null,Me=0,e=we)}if(e!==0){if(e===2&&(i=Hu(t),i!==0&&(r=i,e=vc(t,i))),e===1)throw n=Ms,lr(t,0),Cn(t,r),Ze(t,ge()),n;if(e===6)Cn(t,r);else{if(i=t.current.alternate,!(r&30)&&!qE(i)&&(e=Ma(t,r),e===2&&(s=Hu(t),s!==0&&(r=s,e=vc(t,s))),e===1))throw n=Ms,lr(t,0),Cn(t,r),Ze(t,ge()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(R(345));case 2:nr(t,Xe,tn);break;case 3:if(Cn(t,r),(r&130023424)===r&&(e=kf+500-ge(),10<e)){if(ha(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){je(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=Ku(nr.bind(null,t,Xe,tn),e);break}nr(t,Xe,tn);break;case 4:if(Cn(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var o=31-Pt(r);s=1<<o,o=e[o],o>i&&(i=o),r&=~s}if(r=i,r=ge()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*$E(r/1960))-r,10<r){t.timeoutHandle=Ku(nr.bind(null,t,Xe,tn),r);break}nr(t,Xe,tn);break;case 5:nr(t,Xe,tn);break;default:throw Error(R(329))}}}return Ze(t,ge()),t.callbackNode===n?r_.bind(null,t):null}function vc(t,e){var n=us;return t.current.memoizedState.isDehydrated&&(lr(t,e).flags|=256),t=Ma(t,e),t!==2&&(e=Xe,Xe=n,e!==null&&yc(e)),t}function yc(t){Xe===null?Xe=t:Xe.push.apply(Xe,t)}function qE(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!Mt(s(),i))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Cn(t,e){for(e&=~Of,e&=~tl,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Pt(e),r=1<<n;t[n]=-1,e&=~r}}function Xd(t){if(Y&6)throw Error(R(327));ni();var e=ha(t,0);if(!(e&1))return Ze(t,ge()),null;var n=Ma(t,e);if(t.tag!==0&&n===2){var r=Hu(t);r!==0&&(e=r,n=vc(t,r))}if(n===1)throw n=Ms,lr(t,0),Cn(t,e),Ze(t,ge()),n;if(n===6)throw Error(R(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,nr(t,Xe,tn),Ze(t,ge()),null}function Nf(t,e){var n=Y;Y|=1;try{return t(e)}finally{Y=n,Y===0&&(fi=ge()+500,Qa&&$n())}}function pr(t){Rn!==null&&Rn.tag===0&&!(Y&6)&&ni();var e=Y;Y|=1;var n=mt.transition,r=Q;try{if(mt.transition=null,Q=1,t)return t()}finally{Q=r,mt.transition=n,Y=e,!(Y&6)&&$n()}}function Df(){et=$r.current,se($r)}function lr(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,AE(n)),ve!==null)for(n=ve.return;n!==null;){var r=n;switch(mf(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&_a();break;case 3:ui(),se($e),se(Fe),Af();break;case 5:Sf(r);break;case 4:ui();break;case 13:se(ue);break;case 19:se(ue);break;case 10:Ef(r.type._context);break;case 22:case 23:Df()}n=n.return}if(Ae=t,ve=t=Vn(t.current,null),Me=et=e,we=0,Ms=null,Of=tl=gr=0,Xe=us=null,sr!==null){for(e=0;e<sr.length;e++)if(n=sr[e],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,s=n.pending;if(s!==null){var o=s.next;s.next=i,r.next=o}n.pending=r}sr=null}return t}function i_(t,e){do{var n=ve;try{if(yf(),$o.current=xa,Aa){for(var r=ce.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}Aa=!1}if(dr=0,Se=Ee=ce=null,as=!1,Ps=0,If.current=null,n===null||n.return===null){we=1,Ms=e,ve=null;break}e:{var s=t,o=n.return,a=n,l=e;if(e=Me,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,c=a,f=c.tag;if(!(c.mode&1)&&(f===0||f===11||f===15)){var h=c.alternate;h?(c.updateQueue=h.updateQueue,c.memoizedState=h.memoizedState,c.lanes=h.lanes):(c.updateQueue=null,c.memoizedState=null)}var p=Od(o);if(p!==null){p.flags&=-257,kd(p,o,a,s,e),p.mode&1&&Id(s,u,e),e=p,l=u;var E=e.updateQueue;if(E===null){var w=new Set;w.add(l),e.updateQueue=w}else E.add(l);break e}else{if(!(e&1)){Id(s,u,e),Ff();break e}l=Error(R(426))}}else if(ae&&a.mode&1){var S=Od(o);if(S!==null){!(S.flags&65536)&&(S.flags|=256),kd(S,o,a,s,e),_f(ci(l,a));break e}}s=l=ci(l,a),we!==4&&(we=2),us===null?us=[s]:us.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var _=V0(s,l,e);Ad(s,_);break e;case 1:a=l;var m=s.type,y=s.stateNode;if(!(s.flags&128)&&(typeof m.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(Bn===null||!Bn.has(y)))){s.flags|=65536,e&=-e,s.lanes|=e;var b=j0(s,a,e);Ad(s,b);break e}}s=s.return}while(s!==null)}a_(n)}catch(x){e=x,ve===n&&n!==null&&(ve=n=n.return);continue}break}while(1)}function s_(){var t=Pa.current;return Pa.current=xa,t===null?xa:t}function Ff(){(we===0||we===3||we===2)&&(we=4),Ae===null||!(gr&268435455)&&!(tl&268435455)||Cn(Ae,Me)}function Ma(t,e){var n=Y;Y|=2;var r=s_();(Ae!==t||Me!==e)&&(tn=null,lr(t,e));do try{ZE();break}catch(i){i_(t,i)}while(1);if(yf(),Y=n,Pa.current=r,ve!==null)throw Error(R(261));return Ae=null,Me=0,we}function ZE(){for(;ve!==null;)o_(ve)}function QE(){for(;ve!==null&&!T1();)o_(ve)}function o_(t){var e=u_(t.alternate,t,et);t.memoizedProps=t.pendingProps,e===null?a_(t):ve=e,If.current=null}function a_(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=HE(n,e),n!==null){n.flags&=32767,ve=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{we=6,ve=null;return}}else if(n=GE(n,e,et),n!==null){ve=n;return}if(e=e.sibling,e!==null){ve=e;return}ve=e=t}while(e!==null);we===0&&(we=5)}function nr(t,e,n){var r=Q,i=mt.transition;try{mt.transition=null,Q=1,KE(t,e,n,r)}finally{mt.transition=i,Q=r}return null}function KE(t,e,n,r){do ni();while(Rn!==null);if(Y&6)throw Error(R(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(R(177));t.callbackNode=null,t.callbackPriority=0;var s=n.lanes|n.childLanes;if(I1(t,s),t===Ae&&(ve=Ae=null,Me=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Lo||(Lo=!0,c_(fa,function(){return ni(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=mt.transition,mt.transition=null;var o=Q;Q=1;var a=Y;Y|=4,If.current=null,XE(t,n),t_(n,t),vE(Zu),da=!!qu,Zu=qu=null,t.current=n,YE(n),b1(),Y=a,Q=o,mt.transition=s}else t.current=n;if(Lo&&(Lo=!1,Rn=t,Ca=i),s=t.pendingLanes,s===0&&(Bn=null),x1(n.stateNode),Ze(t,ge()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(La)throw La=!1,t=mc,mc=null,t;return Ca&1&&t.tag!==0&&ni(),s=t.pendingLanes,s&1?t===_c?cs++:(cs=0,_c=t):cs=0,$n(),null}function ni(){if(Rn!==null){var t=zm(Ca),e=mt.transition,n=Q;try{if(mt.transition=null,Q=16>t?16:t,Rn===null)var r=!1;else{if(t=Rn,Rn=null,Ca=0,Y&6)throw Error(R(331));var i=Y;for(Y|=4,F=t.current;F!==null;){var s=F,o=s.child;if(F.flags&16){var a=s.deletions;if(a!==null){for(var l=0;l<a.length;l++){var u=a[l];for(F=u;F!==null;){var c=F;switch(c.tag){case 0:case 11:case 15:ls(8,c,s)}var f=c.child;if(f!==null)f.return=c,F=f;else for(;F!==null;){c=F;var h=c.sibling,p=c.return;if(K0(c),c===u){F=null;break}if(h!==null){h.return=p,F=h;break}F=p}}}var E=s.alternate;if(E!==null){var w=E.child;if(w!==null){E.child=null;do{var S=w.sibling;w.sibling=null,w=S}while(w!==null)}}F=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,F=o;else e:for(;F!==null;){if(s=F,s.flags&2048)switch(s.tag){case 0:case 11:case 15:ls(9,s,s.return)}var _=s.sibling;if(_!==null){_.return=s.return,F=_;break e}F=s.return}}var m=t.current;for(F=m;F!==null;){o=F;var y=o.child;if(o.subtreeFlags&2064&&y!==null)y.return=o,F=y;else e:for(o=m;F!==null;){if(a=F,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:el(9,a)}}catch(x){de(a,a.return,x)}if(a===o){F=null;break e}var b=a.sibling;if(b!==null){b.return=a.return,F=b;break e}F=a.return}}if(Y=i,$n(),Ht&&typeof Ht.onPostCommitFiberRoot=="function")try{Ht.onPostCommitFiberRoot(Xa,t)}catch{}r=!0}return r}finally{Q=n,mt.transition=e}}return!1}function Yd(t,e,n){e=ci(n,e),e=V0(t,e,1),t=Un(t,e,1),e=je(),t!==null&&(js(t,1,e),Ze(t,e))}function de(t,e,n){if(t.tag===3)Yd(t,t,n);else for(;e!==null;){if(e.tag===3){Yd(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Bn===null||!Bn.has(r))){t=ci(n,t),t=j0(e,t,1),e=Un(e,t,1),t=je(),e!==null&&(js(e,1,t),Ze(e,t));break}}e=e.return}}function JE(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=je(),t.pingedLanes|=t.suspendedLanes&n,Ae===t&&(Me&n)===n&&(we===4||we===3&&(Me&130023424)===Me&&500>ge()-kf?lr(t,0):Of|=n),Ze(t,e)}function l_(t,e){e===0&&(t.mode&1?(e=vo,vo<<=1,!(vo&130023424)&&(vo=4194304)):e=1);var n=je();t=fn(t,e),t!==null&&(js(t,e,n),Ze(t,n))}function ew(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),l_(t,n)}function tw(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(R(314))}r!==null&&r.delete(e),l_(t,n)}var u_;u_=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||$e.current)Ye=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Ye=!1,jE(t,e,n);Ye=!!(t.flags&131072)}else Ye=!1,ae&&e.flags&1048576&&h0(e,Ea,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Zo(t,e),t=e.pendingProps;var i=oi(e,Fe.current);ti(e,n),i=Pf(null,e,r,t,i,n);var s=Lf();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,qe(r)?(s=!0,va(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,Tf(e),i.updater=Ka,e.stateNode=i,i._reactInternals=e,sc(e,r,t,n),e=lc(null,e,r,!0,s,n)):(e.tag=0,ae&&s&&pf(e),Be(null,e,i,n),e=e.child),e;case 16:r=e.elementType;e:{switch(Zo(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=rw(r),t=bt(r,t),i){case 0:e=ac(null,e,r,t,n);break e;case 1:e=Fd(null,e,r,t,n);break e;case 11:e=Nd(null,e,r,t,n);break e;case 14:e=Dd(null,e,r,bt(r.type,t),n);break e}throw Error(R(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:bt(r,i),ac(t,e,r,i,n);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:bt(r,i),Fd(t,e,r,i,n);case 3:e:{if(X0(e),t===null)throw Error(R(387));r=e.pendingProps,s=e.memoizedState,i=s.element,m0(t,e),ba(e,r,null,n);var o=e.memoizedState;if(r=o.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=ci(Error(R(423)),e),e=Ud(t,e,r,n,i);break e}else if(r!==i){i=ci(Error(R(424)),e),e=Ud(t,e,r,n,i);break e}else for(rt=Fn(e.stateNode.containerInfo.firstChild),st=e,ae=!0,At=null,n=E0(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(ai(),r===i){e=hn(t,e,n);break e}Be(t,e,r,n)}e=e.child}return e;case 5:return w0(e),t===null&&nc(e),r=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,o=i.children,Qu(r,i)?o=null:s!==null&&Qu(r,s)&&(e.flags|=32),W0(t,e),Be(t,e,o,n),e.child;case 6:return t===null&&nc(e),null;case 13:return Y0(t,e,n);case 4:return bf(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=li(e,null,r,n):Be(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:bt(r,i),Nd(t,e,r,i,n);case 7:return Be(t,e,e.pendingProps,n),e.child;case 8:return Be(t,e,e.pendingProps.children,n),e.child;case 12:return Be(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,s=e.memoizedProps,o=i.value,te(wa,r._currentValue),r._currentValue=o,s!==null)if(Mt(s.value,o)){if(s.children===i.children&&!$e.current){e=hn(t,e,n);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var a=s.dependencies;if(a!==null){o=s.child;for(var l=a.firstContext;l!==null;){if(l.context===r){if(s.tag===1){l=ln(-1,n&-n),l.tag=2;var u=s.updateQueue;if(u!==null){u=u.shared;var c=u.pending;c===null?l.next=l:(l.next=c.next,c.next=l),u.pending=l}}s.lanes|=n,l=s.alternate,l!==null&&(l.lanes|=n),rc(s.return,n,e),a.lanes|=n;break}l=l.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(R(341));o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),rc(o,n,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}Be(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,ti(e,n),i=vt(i),r=r(i),e.flags|=1,Be(t,e,r,n),e.child;case 14:return r=e.type,i=bt(r,e.pendingProps),i=bt(r.type,i),Dd(t,e,r,i,n);case 15:return G0(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:bt(r,i),Zo(t,e),e.tag=1,qe(r)?(t=!0,va(e)):t=!1,ti(e,n),v0(e,r,i),sc(e,r,i,n),lc(null,e,r,!0,t,n);case 19:return $0(t,e,n);case 22:return H0(t,e,n)}throw Error(R(156,e.tag))};function c_(t,e){return Dm(t,e)}function nw(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function pt(t,e,n,r){return new nw(t,e,n,r)}function Uf(t){return t=t.prototype,!(!t||!t.isReactComponent)}function rw(t){if(typeof t=="function")return Uf(t)?1:0;if(t!=null){if(t=t.$$typeof,t===nf)return 11;if(t===rf)return 14}return 2}function Vn(t,e){var n=t.alternate;return n===null?(n=pt(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Jo(t,e,n,r,i,s){var o=2;if(r=t,typeof t=="function")Uf(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case Ur:return ur(n.children,i,s,e);case tf:o=8,i|=8;break;case Cu:return t=pt(12,n,e,i|2),t.elementType=Cu,t.lanes=s,t;case Mu:return t=pt(13,n,e,i),t.elementType=Mu,t.lanes=s,t;case Ru:return t=pt(19,n,e,i),t.elementType=Ru,t.lanes=s,t;case ym:return nl(n,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case _m:o=10;break e;case vm:o=9;break e;case nf:o=11;break e;case rf:o=14;break e;case xn:o=16,r=null;break e}throw Error(R(130,t==null?t:typeof t,""))}return e=pt(o,n,e,i),e.elementType=t,e.type=r,e.lanes=s,e}function ur(t,e,n,r){return t=pt(7,t,r,e),t.lanes=n,t}function nl(t,e,n,r){return t=pt(22,t,r,e),t.elementType=ym,t.lanes=n,t.stateNode={isHidden:!1},t}function ql(t,e,n){return t=pt(6,t,null,e),t.lanes=n,t}function Zl(t,e,n){return e=pt(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function iw(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Ml(0),this.expirationTimes=Ml(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ml(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Bf(t,e,n,r,i,s,o,a,l){return t=new iw(t,e,n,a,l),e===1?(e=1,s===!0&&(e|=8)):e=0,s=pt(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Tf(s),t}function sw(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Fr,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function f_(t){if(!t)return Wn;t=t._reactInternals;e:{if(Er(t)!==t||t.tag!==1)throw Error(R(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(qe(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(R(171))}if(t.tag===1){var n=t.type;if(qe(n))return c0(t,n,e)}return e}function h_(t,e,n,r,i,s,o,a,l){return t=Bf(n,r,!0,t,i,s,o,a,l),t.context=f_(null),n=t.current,r=je(),i=zn(n),s=ln(r,i),s.callback=e??null,Un(n,s,i),t.current.lanes=i,js(t,i,r),Ze(t,r),t}function rl(t,e,n,r){var i=e.current,s=je(),o=zn(i);return n=f_(n),e.context===null?e.context=n:e.pendingContext=n,e=ln(s,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=Un(i,e,o),t!==null&&(Lt(t,i,o,s),Yo(t,i,o)),o}function Ra(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function $d(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function zf(t,e){$d(t,e),(t=t.alternate)&&$d(t,e)}function ow(){return null}var d_=typeof reportError=="function"?reportError:function(t){console.error(t)};function Vf(t){this._internalRoot=t}il.prototype.render=Vf.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(R(409));rl(t,e,null,null)};il.prototype.unmount=Vf.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;pr(function(){rl(null,t,null,null)}),e[cn]=null}};function il(t){this._internalRoot=t}il.prototype.unstable_scheduleHydration=function(t){if(t){var e=Gm();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Ln.length&&e!==0&&e<Ln[n].priority;n++);Ln.splice(n,0,t),n===0&&Wm(t)}};function jf(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function sl(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function qd(){}function aw(t,e,n,r,i){if(i){if(typeof r=="function"){var s=r;r=function(){var u=Ra(o);s.call(u)}}var o=h_(e,r,t,0,null,!1,!1,"",qd);return t._reactRootContainer=o,t[cn]=o.current,Ts(t.nodeType===8?t.parentNode:t),pr(),o}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var a=r;r=function(){var u=Ra(l);a.call(u)}}var l=Bf(t,0,!1,null,null,!1,!1,"",qd);return t._reactRootContainer=l,t[cn]=l.current,Ts(t.nodeType===8?t.parentNode:t),pr(function(){rl(e,l,n,r)}),l}function ol(t,e,n,r,i){var s=n._reactRootContainer;if(s){var o=s;if(typeof i=="function"){var a=i;i=function(){var l=Ra(o);a.call(l)}}rl(e,o,t,i)}else o=aw(n,e,t,i,r);return Ra(o)}Vm=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Ki(e.pendingLanes);n!==0&&(af(e,n|1),Ze(e,ge()),!(Y&6)&&(fi=ge()+500,$n()))}break;case 13:pr(function(){var r=fn(t,1);if(r!==null){var i=je();Lt(r,t,1,i)}}),zf(t,1)}};lf=function(t){if(t.tag===13){var e=fn(t,134217728);if(e!==null){var n=je();Lt(e,t,134217728,n)}zf(t,134217728)}};jm=function(t){if(t.tag===13){var e=zn(t),n=fn(t,e);if(n!==null){var r=je();Lt(n,t,e,r)}zf(t,e)}};Gm=function(){return Q};Hm=function(t,e){var n=Q;try{return Q=t,e()}finally{Q=n}};Vu=function(t,e,n){switch(e){case"input":if(ku(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=Za(r);if(!i)throw Error(R(90));wm(r),ku(r,i)}}}break;case"textarea":bm(t,n);break;case"select":e=n.value,e!=null&&Qr(t,!!n.multiple,e,!1)}};Mm=Nf;Rm=pr;var lw={usingClientEntryPoint:!1,Events:[Hs,jr,Za,Lm,Cm,Nf]},ji={findFiberByHostInstance:ir,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},uw={bundleType:ji.bundleType,version:ji.version,rendererPackageName:ji.rendererPackageName,rendererConfig:ji.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:mn.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=km(t),t===null?null:t.stateNode},findFiberByHostInstance:ji.findFiberByHostInstance||ow,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Co=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Co.isDisabled&&Co.supportsFiber)try{Xa=Co.inject(uw),Ht=Co}catch{}}lt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=lw;lt.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!jf(e))throw Error(R(200));return sw(t,e,null,n)};lt.createRoot=function(t,e){if(!jf(t))throw Error(R(299));var n=!1,r="",i=d_;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=Bf(t,1,!1,null,null,n,!1,r,i),t[cn]=e.current,Ts(t.nodeType===8?t.parentNode:t),new Vf(e)};lt.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(R(188)):(t=Object.keys(t).join(","),Error(R(268,t)));return t=km(e),t=t===null?null:t.stateNode,t};lt.flushSync=function(t){return pr(t)};lt.hydrate=function(t,e,n){if(!sl(e))throw Error(R(200));return ol(null,t,e,!0,n)};lt.hydrateRoot=function(t,e,n){if(!jf(t))throw Error(R(405));var r=n!=null&&n.hydratedSources||null,i=!1,s="",o=d_;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=h_(e,null,t,1,n??null,i,!1,s,o),t[cn]=e.current,Ts(t),r)for(t=0;t<r.length;t++)n=r[t],i=n._getVersion,i=i(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new il(e)};lt.render=function(t,e,n){if(!sl(e))throw Error(R(200));return ol(null,t,e,!1,n)};lt.unmountComponentAtNode=function(t){if(!sl(t))throw Error(R(40));return t._reactRootContainer?(pr(function(){ol(null,null,t,!1,function(){t._reactRootContainer=null,t[cn]=null})}),!0):!1};lt.unstable_batchedUpdates=Nf;lt.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!sl(n))throw Error(R(200));if(t==null||t._reactInternals===void 0)throw Error(R(38));return ol(t,e,n,!1,r)};lt.version="18.2.0-next-9e3b772b8-20220608";function g_(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(g_)}catch(t){console.error(t)}}g_(),hm.exports=lt;var Gf=hm.exports,p_,Zd=Gf;p_=Zd.createRoot,Zd.hydrateRoot;const cw="modulepreload",fw=function(t){return"/"+t},Qd={},hw=function(e,n,r){if(!n||n.length===0)return e();const i=document.getElementsByTagName("link");return Promise.all(n.map(s=>{if(s=fw(s),s in Qd)return;Qd[s]=!0;const o=s.endsWith(".css"),a=o?'[rel="stylesheet"]':"";if(!!r)for(let c=i.length-1;c>=0;c--){const f=i[c];if(f.href===s&&(!o||f.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${s}"]${a}`))return;const u=document.createElement("link");if(u.rel=o?"stylesheet":cw,o||(u.as="script",u.crossOrigin=""),u.href=s,document.head.appendChild(u),o)return new Promise((c,f)=>{u.addEventListener("load",c),u.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${s}`)))})})).then(()=>e()).catch(s=>{const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=s,window.dispatchEvent(o),!o.defaultPrevented)throw s})},dw=z.createContext(null);function gw(t,e){const n=Array.isArray(t)?t[0]:t?t.x:0,r=Array.isArray(t)?t[1]:t?t.y:0,i=Array.isArray(e)?e[0]:e?e.x:0,s=Array.isArray(e)?e[1]:e?e.y:0;return n===i&&r===s}function rn(t,e){if(t===e)return!0;if(!t||!e)return!1;if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(!rn(t[n],e[n]))return!1;return!0}else if(Array.isArray(e))return!1;if(typeof t=="object"&&typeof e=="object"){const n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(const i of n)if(!e.hasOwnProperty(i)||!rn(t[i],e[i]))return!1;return!0}return!1}function pw(t){const e=t.clone();return e.pixelsToGLUnits=t.pixelsToGLUnits,e}function Kd(t,e){if(!t.getProjection)return;const n=t.getProjection(),r=e.getProjection();rn(n,r)||e.setProjection(n)}function Jd(t){return{longitude:t.center.lng,latitude:t.center.lat,zoom:t.zoom,pitch:t.pitch,bearing:t.bearing,padding:t.padding}}function eg(t,e){const n=e.viewState||e;let r=!1;if("longitude"in n&&"latitude"in n){const i=t.center;t.center=new i.constructor(n.longitude,n.latitude),r=r||i!==t.center}if("zoom"in n){const i=t.zoom;t.zoom=n.zoom,r=r||i!==t.zoom}if("bearing"in n){const i=t.bearing;t.bearing=n.bearing,r=r||i!==t.bearing}if("pitch"in n){const i=t.pitch;t.pitch=n.pitch,r=r||i!==t.pitch}return n.padding&&!t.isPaddingEqual(n.padding)&&(r=!0,t.padding=n.padding),r}const mw=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function tg(t){if(!t)return null;if(typeof t=="string"||("toJS"in t&&(t=t.toJS()),!t.layers))return t;const e={};for(const r of t.layers)e[r.id]=r;const n=t.layers.map(r=>{let i=null;"interactive"in r&&(i=Object.assign({},r),delete i.interactive);const s=e[r.ref];if(s){i=i||Object.assign({},r),delete i.ref;for(const o of mw)o in s&&(i[o]=s[o])}return i||r});return{...t,layers:n}}const ng={version:8,sources:{},layers:[]},rg={mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",click:"onClick",dblclick:"onDblClick",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",mouseout:"onMouseOut",contextmenu:"onContextMenu",touchstart:"onTouchStart",touchend:"onTouchEnd",touchmove:"onTouchMove",touchcancel:"onTouchCancel"},Ql={movestart:"onMoveStart",move:"onMove",moveend:"onMoveEnd",dragstart:"onDragStart",drag:"onDrag",dragend:"onDragEnd",zoomstart:"onZoomStart",zoom:"onZoom",zoomend:"onZoomEnd",rotatestart:"onRotateStart",rotate:"onRotate",rotateend:"onRotateEnd",pitchstart:"onPitchStart",pitch:"onPitch",pitchend:"onPitchEnd"},ig={wheel:"onWheel",boxzoomstart:"onBoxZoomStart",boxzoomend:"onBoxZoomEnd",boxzoomcancel:"onBoxZoomCancel",resize:"onResize",load:"onLoad",render:"onRender",idle:"onIdle",remove:"onRemove",data:"onData",styledata:"onStyleData",sourcedata:"onSourceData",error:"onError"},_w=["minZoom","maxZoom","minPitch","maxPitch","maxBounds","projection","renderWorldCopies"],vw=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate","touchPitch"];class hi{constructor(e,n,r){this._map=null,this._internalUpdate=!1,this._inRender=!1,this._hoveredFeatures=null,this._deferredEvents={move:!1,zoom:!1,pitch:!1,rotate:!1},this._onEvent=i=>{const s=this.props[ig[i.type]];s?s(i):i.type==="error"&&console.error(i.error)},this._onPointerEvent=i=>{(i.type==="mousemove"||i.type==="mouseout")&&this._updateHover(i);const s=this.props[rg[i.type]];s&&(this.props.interactiveLayerIds&&i.type!=="mouseover"&&i.type!=="mouseout"&&(i.features=this._hoveredFeatures||this._queryRenderedFeatures(i.point)),s(i),delete i.features)},this._onCameraEvent=i=>{if(!this._internalUpdate){const s=this.props[Ql[i.type]];s&&s(i)}i.type in this._deferredEvents&&(this._deferredEvents[i.type]=!1)},this._MapClass=e,this.props=n,this._initialize(r)}get map(){return this._map}get transform(){return this._renderTransform}setProps(e){const n=this.props;this.props=e;const r=this._updateSettings(e,n);r&&this._createShadowTransform(this._map);const i=this._updateSize(e),s=this._updateViewState(e,!0);this._updateStyle(e,n),this._updateStyleComponents(e,n),this._updateHandlers(e,n),(r||i||s&&!this._map.isMoving())&&this.redraw()}static reuse(e,n){const r=hi.savedMaps.pop();if(!r)return null;const i=r.map,s=i.getContainer();for(n.className=s.className;s.childNodes.length>0;)n.appendChild(s.childNodes[0]);i._container=n;const o=i._resizeObserver;o&&(o.disconnect(),o.observe(n)),r.setProps({...e,styleDiffing:!1}),i.resize();const{initialViewState:a}=e;return a&&(a.bounds?i.fitBounds(a.bounds,{...a.fitBoundsOptions,duration:0}):r._updateViewState(a,!1)),i.isStyleLoaded()?i.fire("load"):i.once("styledata",()=>i.fire("load")),i._update(),r}_initialize(e){const{props:n}=this,{mapStyle:r=ng}=n,i={...n,...n.initialViewState,accessToken:n.mapboxAccessToken||yw()||null,container:e,style:tg(r)},s=i.initialViewState||i.viewState||i;if(Object.assign(i,{center:[s.longitude||0,s.latitude||0],zoom:s.zoom||0,pitch:s.pitch||0,bearing:s.bearing||0}),n.gl){const c=HTMLCanvasElement.prototype.getContext;HTMLCanvasElement.prototype.getContext=()=>(HTMLCanvasElement.prototype.getContext=c,n.gl)}const o=new this._MapClass(i);s.padding&&o.setPadding(s.padding),n.cursor&&(o.getCanvas().style.cursor=n.cursor),this._createShadowTransform(o);const a=o._render;o._render=c=>{this._inRender=!0,a.call(o,c),this._inRender=!1};const l=o._renderTaskQueue.run;o._renderTaskQueue.run=c=>{l.call(o._renderTaskQueue,c),this._onBeforeRepaint()},o.on("render",()=>this._onAfterRepaint());const u=o.fire;o.fire=this._fireEvent.bind(this,u),o.on("resize",()=>{this._renderTransform.resize(o.transform.width,o.transform.height)}),o.on("styledata",()=>{this._updateStyleComponents(this.props,{}),Kd(o.transform,this._renderTransform)}),o.on("sourcedata",()=>this._updateStyleComponents(this.props,{}));for(const c in rg)o.on(c,this._onPointerEvent);for(const c in Ql)o.on(c,this._onCameraEvent);for(const c in ig)o.on(c,this._onEvent);this._map=o}recycle(){const n=this.map.getContainer().querySelector("[mapboxgl-children]");n==null||n.remove(),hi.savedMaps.push(this)}destroy(){this._map.remove()}redraw(){const e=this._map;!this._inRender&&e.style&&(e._frame&&(e._frame.cancel(),e._frame=null),e._render())}_createShadowTransform(e){const n=pw(e.transform);e.painter.transform=n,this._renderTransform=n}_updateSize(e){const{viewState:n}=e;if(n){const r=this._map;if(n.width!==r.transform.width||n.height!==r.transform.height)return r.resize(),!0}return!1}_updateViewState(e,n){if(this._internalUpdate)return!1;const r=this._map,i=this._renderTransform,{zoom:s,pitch:o,bearing:a}=i,l=r.isMoving();l&&(i.cameraElevationReference="sea");const u=eg(i,{...Jd(r.transform),...e});if(l&&(i.cameraElevationReference="ground"),u&&n){const c=this._deferredEvents;c.move=!0,c.zoom||(c.zoom=s!==i.zoom),c.rotate||(c.rotate=a!==i.bearing),c.pitch||(c.pitch=o!==i.pitch)}return l||eg(r.transform,e),u}_updateSettings(e,n){const r=this._map;let i=!1;for(const s of _w)if(s in e&&!rn(e[s],n[s])){i=!0;const o=r[`set${s[0].toUpperCase()}${s.slice(1)}`];o==null||o.call(r,e[s])}return i}_updateStyle(e,n){if(e.cursor!==n.cursor&&(this._map.getCanvas().style.cursor=e.cursor||""),e.mapStyle!==n.mapStyle){const{mapStyle:r=ng,styleDiffing:i=!0}=e,s={diff:i};return"localIdeographFontFamily"in e&&(s.localIdeographFontFamily=e.localIdeographFontFamily),this._map.setStyle(tg(r),s),!0}return!1}_updateStyleComponents(e,n){const r=this._map;let i=!1;return r.isStyleLoaded()&&("light"in e&&r.setLight&&!rn(e.light,n.light)&&(i=!0,r.setLight(e.light)),"fog"in e&&r.setFog&&!rn(e.fog,n.fog)&&(i=!0,r.setFog(e.fog)),"terrain"in e&&r.setTerrain&&!rn(e.terrain,n.terrain)&&(!e.terrain||r.getSource(e.terrain.source))&&(i=!0,r.setTerrain(e.terrain))),i}_updateHandlers(e,n){var r,i;const s=this._map;let o=!1;for(const a of vw){const l=(r=e[a])!==null&&r!==void 0?r:!0,u=(i=n[a])!==null&&i!==void 0?i:!0;rn(l,u)||(o=!0,l?s[a].enable(l):s[a].disable())}return o}_queryRenderedFeatures(e){const n=this._map,r=n.transform,{interactiveLayerIds:i=[]}=this.props;try{return n.transform=this._renderTransform,n.queryRenderedFeatures(e,{layers:i.filter(n.getLayer.bind(n))})}catch{return[]}finally{n.transform=r}}_updateHover(e){var n;const{props:r}=this;if(r.interactiveLayerIds&&(r.onMouseMove||r.onMouseEnter||r.onMouseLeave)){const s=e.type,o=((n=this._hoveredFeatures)===null||n===void 0?void 0:n.length)>0,a=this._queryRenderedFeatures(e.point),l=a.length>0;!l&&o&&(e.type="mouseleave",this._onPointerEvent(e)),this._hoveredFeatures=a,l&&!o&&(e.type="mouseenter",this._onPointerEvent(e)),e.type=s}else this._hoveredFeatures=null}_fireEvent(e,n,r){const i=this._map,s=i.transform,o=typeof n=="string"?n:n.type;return o==="move"&&this._updateViewState(this.props,!1),o in Ql&&(typeof n=="object"&&(n.viewState=Jd(s)),this._map.isMoving())?(i.transform=this._renderTransform,e.call(i,n,r),i.transform=s,i):(e.call(i,n,r),i)}_onBeforeRepaint(){const e=this._map;this._internalUpdate=!0;for(const r in this._deferredEvents)this._deferredEvents[r]&&e.fire(r);this._internalUpdate=!1;const n=this._map.transform;e.transform=this._renderTransform,this._onAfterRepaint=()=>{Kd(this._renderTransform,n),e.transform=n}}}hi.savedMaps=[];function yw(){let t=null;if(typeof location<"u"){const e=/access_token=([^&\/]*)/.exec(location.search);t=e&&e[1]}try{t=t||void 0}catch{}try{t=t||{}.REACT_APP_MAPBOX_ACCESS_TOKEN}catch{}return t}const Ew=["setMaxBounds","setMinZoom","setMaxZoom","setMinPitch","setMaxPitch","setRenderWorldCopies","setProjection","setStyle","addSource","removeSource","addLayer","removeLayer","setLayerZoomRange","setFilter","setPaintProperty","setLayoutProperty","setLight","setTerrain","setFog","remove"];function ww(t){if(!t)return null;const e=t.map,n={getMap:()=>e,getCenter:()=>t.transform.center,getZoom:()=>t.transform.zoom,getBearing:()=>t.transform.bearing,getPitch:()=>t.transform.pitch,getPadding:()=>t.transform.padding,getBounds:()=>t.transform.getBounds(),project:r=>{const i=e.transform;e.transform=t.transform;const s=e.project(r);return e.transform=i,s},unproject:r=>{const i=e.transform;e.transform=t.transform;const s=e.unproject(r);return e.transform=i,s},queryTerrainElevation:(r,i)=>{const s=e.transform;e.transform=t.transform;const o=e.queryTerrainElevation(r,i);return e.transform=s,o},queryRenderedFeatures:(r,i)=>{const s=e.transform;e.transform=t.transform;const o=e.queryRenderedFeatures(r,i);return e.transform=s,o}};for(const r of Tw(e))!(r in n)&&!Ew.includes(r)&&(n[r]=e[r].bind(e));return n}function Tw(t){const e=new Set;let n=t;for(;n;){for(const r of Object.getOwnPropertyNames(n))r[0]!=="_"&&typeof t[r]=="function"&&r!=="fire"&&r!=="setEventedParent"&&e.add(r);n=Object.getPrototypeOf(n)}return Array.from(e)}const bw=typeof document<"u"?z.useLayoutEffect:z.useEffect,Sw=["baseApiUrl","maxParallelImageRequests","workerClass","workerCount","workerUrl"];function Aw(t,e){for(const r of Sw)r in e&&(t[r]=e[r]);const{RTLTextPlugin:n="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-rtl-text/v0.2.3/mapbox-gl-rtl-text.js"}=e;n&&t.getRTLTextPluginStatus&&t.getRTLTextPluginStatus()==="unavailable"&&t.setRTLTextPlugin(n,r=>{r&&console.error(r)},!0)}const al=z.createContext(null);function xw(t,e,n){const r=z.useContext(dw),[i,s]=z.useState(null),o=z.useRef(),{current:a}=z.useRef({mapLib:null,map:null});z.useEffect(()=>{const c=t.mapLib;let f=!0,h;return Promise.resolve(c||n).then(p=>{if(!f)return;if(!p)throw new Error("Invalid mapLib");const E="Map"in p?p:p.default;if(!E.Map)throw new Error("Invalid mapLib");if(Aw(E,t),!E.supported||E.supported(t))t.reuseMaps&&(h=hi.reuse(t,o.current)),h||(h=new hi(E.Map,t,o.current)),a.map=ww(h),a.mapLib=E,s(h),r==null||r.onMapMount(a.map,t.id);else throw new Error("Map is not supported by this browser")}).catch(p=>{const{onError:E}=t;E?E({type:"error",target:null,originalEvent:null,error:p}):console.error(p)}),()=>{f=!1,h&&(r==null||r.onMapUnmount(t.id),t.reuseMaps?h.recycle():h.destroy())}},[]),bw(()=>{i&&i.setProps(t)}),z.useImperativeHandle(e,()=>a.map,[i]);const l=z.useMemo(()=>({position:"relative",width:"100%",height:"100%",...t.style}),[t.style]),u={height:"100%"};return z.createElement("div",{id:t.id,ref:o,style:l},i&&z.createElement(al.Provider,{value:a},z.createElement("div",{"mapboxgl-children":"",style:u},t.children)))}const Pw=/box|flex|grid|column|lineHeight|fontWeight|opacity|order|tabSize|zIndex/;function wr(t,e){if(!t||!e)return;const n=t.style;for(const r in e){const i=e[r];Number.isFinite(i)&&!Pw.test(r)?n[r]=`${i}px`:n[r]=i}}function Lw(t,e){const{map:n,mapLib:r}=z.useContext(al),i=z.useRef({props:t});i.current.props=t;const s=z.useMemo(()=>{let w=!1;z.Children.forEach(t.children,m=>{m&&(w=!0)});const S={...t,element:w?document.createElement("div"):null},_=new r.Marker(S);return _.setLngLat([t.longitude,t.latitude]),_.getElement().addEventListener("click",m=>{var y,b;(b=(y=i.current.props).onClick)===null||b===void 0||b.call(y,{type:"click",target:_,originalEvent:m})}),_.on("dragstart",m=>{var y,b;const x=m;x.lngLat=s.getLngLat(),(b=(y=i.current.props).onDragStart)===null||b===void 0||b.call(y,x)}),_.on("drag",m=>{var y,b;const x=m;x.lngLat=s.getLngLat(),(b=(y=i.current.props).onDrag)===null||b===void 0||b.call(y,x)}),_.on("dragend",m=>{var y,b;const x=m;x.lngLat=s.getLngLat(),(b=(y=i.current.props).onDragEnd)===null||b===void 0||b.call(y,x)}),_},[]);z.useEffect(()=>(s.addTo(n.getMap()),()=>{s.remove()}),[]);const{longitude:o,latitude:a,offset:l,style:u,draggable:c=!1,popup:f=null,rotation:h=0,rotationAlignment:p="auto",pitchAlignment:E="auto"}=t;return z.useEffect(()=>{wr(s.getElement(),u)},[u]),z.useImperativeHandle(e,()=>s,[]),(s.getLngLat().lng!==o||s.getLngLat().lat!==a)&&s.setLngLat([o,a]),l&&!gw(s.getOffset(),l)&&s.setOffset(l),s.isDraggable()!==c&&s.setDraggable(c),s.getRotation()!==h&&s.setRotation(h),s.getRotationAlignment()!==p&&s.setRotationAlignment(p),s.getPitchAlignment()!==E&&s.setPitchAlignment(E),s.getPopup()!==f&&s.setPopup(f),Gf.createPortal(t.children,s.getElement())}z.memo(z.forwardRef(Lw));function sg(t){return new Set(t?t.trim().split(/\s+/):[])}function Cw(t,e){const{map:n,mapLib:r}=z.useContext(al),i=z.useMemo(()=>document.createElement("div"),[]),s=z.useRef({props:t});s.current.props=t;const o=z.useMemo(()=>{const a={...t},l=new r.Popup(a);return l.setLngLat([t.longitude,t.latitude]),l.once("open",u=>{var c,f;(f=(c=s.current.props).onOpen)===null||f===void 0||f.call(c,u)}),l},[]);if(z.useEffect(()=>{const a=l=>{var u,c;(c=(u=s.current.props).onClose)===null||c===void 0||c.call(u,l)};return o.on("close",a),o.setDOMContent(i).addTo(n.getMap()),()=>{o.off("close",a),o.isOpen()&&o.remove()}},[]),z.useEffect(()=>{wr(o.getElement(),t.style)},[t.style]),z.useImperativeHandle(e,()=>o,[]),o.isOpen()&&((o.getLngLat().lng!==t.longitude||o.getLngLat().lat!==t.latitude)&&o.setLngLat([t.longitude,t.latitude]),t.offset&&!rn(o.options.offset,t.offset)&&o.setOffset(t.offset),(o.options.anchor!==t.anchor||o.options.maxWidth!==t.maxWidth)&&(o.options.anchor=t.anchor,o.setMaxWidth(t.maxWidth)),o.options.className!==t.className)){const a=sg(o.options.className),l=sg(t.className);for(const u of a)l.has(u)||o.removeClassName(u);for(const u of l)a.has(u)||o.addClassName(u);o.options.className=t.className}return Gf.createPortal(t.children,i)}z.memo(z.forwardRef(Cw));function Si(t,e,n,r){const i=z.useContext(al),s=z.useMemo(()=>t(i),[]);return z.useEffect(()=>{const o=r||n||e,a=typeof e=="function"&&typeof n=="function"?e:null,l=typeof n=="function"?n:typeof e=="function"?e:null,{map:u}=i;return u.hasControl(s)||(u.addControl(s,o==null?void 0:o.position),a&&a(i)),()=>{l&&l(i),u.hasControl(s)&&u.removeControl(s)}},[]),s}function Mw(t){const e=Si(({mapLib:n})=>new n.AttributionControl(t),{position:t.position});return z.useEffect(()=>{wr(e._container,t.style)},[t.style]),null}z.memo(Mw);function Rw(t){const e=Si(({mapLib:n})=>new n.FullscreenControl({container:t.containerId&&document.getElementById(t.containerId)}),{position:t.position});return z.useEffect(()=>{wr(e._controlContainer,t.style)},[t.style]),null}z.memo(Rw);function Iw(t,e){const n=z.useRef({props:t}),r=Si(({mapLib:i})=>{const s=new i.GeolocateControl(t),o=s._setupUI;return s._setupUI=a=>{s._container.hasChildNodes()||o(a)},s.on("geolocate",a=>{var l,u;(u=(l=n.current.props).onGeolocate)===null||u===void 0||u.call(l,a)}),s.on("error",a=>{var l,u;(u=(l=n.current.props).onError)===null||u===void 0||u.call(l,a)}),s.on("outofmaxbounds",a=>{var l,u;(u=(l=n.current.props).onOutOfMaxBounds)===null||u===void 0||u.call(l,a)}),s.on("trackuserlocationstart",a=>{var l,u;(u=(l=n.current.props).onTrackUserLocationStart)===null||u===void 0||u.call(l,a)}),s.on("trackuserlocationend",a=>{var l,u;(u=(l=n.current.props).onTrackUserLocationEnd)===null||u===void 0||u.call(l,a)}),s},{position:t.position});return n.current.props=t,z.useImperativeHandle(e,()=>r,[]),z.useEffect(()=>{wr(r._container,t.style)},[t.style]),null}z.memo(z.forwardRef(Iw));function Ow(t){const e=Si(({mapLib:n})=>new n.NavigationControl(t),{position:t.position});return z.useEffect(()=>{wr(e._container,t.style)},[t.style]),null}const kw=z.memo(Ow);function Nw(t){const e=Si(({mapLib:s})=>new s.ScaleControl(t),{position:t.position}),n=z.useRef(t),r=n.current;n.current=t;const{style:i}=t;return t.maxWidth!==void 0&&t.maxWidth!==r.maxWidth&&(e.options.maxWidth=t.maxWidth),t.unit!==void 0&&t.unit!==r.unit&&e.setUnit(t.unit),z.useEffect(()=>{wr(e._container,i)},[i]),null}z.memo(Nw);const Dw=hw(()=>import("./mapbox-gl-0fbc16f6.js").then(t=>t.m),[]),Fw=(()=>z.forwardRef(function(e,n){return xw(e,n,Dw)}))(),Uw=kw;function Rs(t){"@babel/helpers - typeof";return Rs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Rs(t)}function Bw(t,e){if(Rs(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(Rs(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function zw(t){var e=Bw(t,"string");return Rs(e)=="symbol"?e:String(e)}function d(t,e,n){return e=zw(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ia(t,e){if(!t)throw new Error(e||"loader assertion failed.")}const Hf=!!(typeof process!="object"||String(process)!=="[object process]"||process.browser),og=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version);og&&parseFloat(og[1]);const Vw="3.4.15";function dn(t,e){if(!t)throw new Error(e||"loaders.gl assertion failed.")}const ea=typeof process!="object"||String(process)!=="[object process]"||process.browser,jw=typeof window<"u"&&typeof window.orientation<"u",ag=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version);ag&&parseFloat(ag[1]);class Gw{constructor(e,n){d(this,"name",void 0),d(this,"workerThread",void 0),d(this,"isRunning",!0),d(this,"result",void 0),d(this,"_resolve",()=>{}),d(this,"_reject",()=>{}),this.name=e,this.workerThread=n,this.result=new Promise((r,i)=>{this._resolve=r,this._reject=i})}postMessage(e,n){this.workerThread.postMessage({source:"loaders.gl",type:e,payload:n})}done(e){dn(this.isRunning),this.isRunning=!1,this._resolve(e)}error(e){dn(this.isRunning),this.isRunning=!1,this._reject(e)}}let Kl=class{terminate(){}};const Jl=new Map;function Hw(t){dn(t.source&&!t.url||!t.source&&t.url);let e=Jl.get(t.source||t.url);return e||(t.url&&(e=Ww(t.url),Jl.set(t.url,e)),t.source&&(e=m_(t.source),Jl.set(t.source,e))),dn(e),e}function Ww(t){if(!t.startsWith("http"))return t;const e=Xw(t);return m_(e)}function m_(t){const e=new Blob([t],{type:"application/javascript"});return URL.createObjectURL(e)}function Xw(t){return`try {
  importScripts('`.concat(t,`');
} catch (error) {
  console.error(error);
  throw error;
}`)}function __(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2?arguments[2]:void 0;const r=n||new Set;if(t){if(lg(t))r.add(t);else if(lg(t.buffer))r.add(t.buffer);else if(!ArrayBuffer.isView(t)){if(e&&typeof t=="object")for(const i in t)__(t[i],e,r)}}return n===void 0?Array.from(r):[]}function lg(t){return t?t instanceof ArrayBuffer||typeof MessagePort<"u"&&t instanceof MessagePort||typeof ImageBitmap<"u"&&t instanceof ImageBitmap||typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas:!1}const eu=()=>{};class Ec{static isSupported(){return typeof Worker<"u"&&ea||typeof Kl<"u"&&!ea}constructor(e){d(this,"name",void 0),d(this,"source",void 0),d(this,"url",void 0),d(this,"terminated",!1),d(this,"worker",void 0),d(this,"onMessage",void 0),d(this,"onError",void 0),d(this,"_loadableURL","");const{name:n,source:r,url:i}=e;dn(r||i),this.name=n,this.source=r,this.url=i,this.onMessage=eu,this.onError=s=>console.log(s),this.worker=ea?this._createBrowserWorker():this._createNodeWorker()}destroy(){this.onMessage=eu,this.onError=eu,this.worker.terminate(),this.terminated=!0}get isRunning(){return!!this.onMessage}postMessage(e,n){n=n||__(e),this.worker.postMessage(e,n)}_getErrorFromErrorEvent(e){let n="Failed to load ";return n+="worker ".concat(this.name," from ").concat(this.url,". "),e.message&&(n+="".concat(e.message," in ")),e.lineno&&(n+=":".concat(e.lineno,":").concat(e.colno)),new Error(n)}_createBrowserWorker(){this._loadableURL=Hw({source:this.source,url:this.url});const e=new Worker(this._loadableURL,{name:this.name});return e.onmessage=n=>{n.data?this.onMessage(n.data):this.onError(new Error("No data received"))},e.onerror=n=>{this.onError(this._getErrorFromErrorEvent(n)),this.terminated=!0},e.onmessageerror=n=>console.error(n),e}_createNodeWorker(){let e;if(this.url){const r=this.url.includes(":/")||this.url.startsWith("/")?this.url:"./".concat(this.url);e=new Kl(r,{eval:!1})}else if(this.source)e=new Kl(this.source,{eval:!0});else throw new Error("no worker");return e.on("message",n=>{this.onMessage(n)}),e.on("error",n=>{this.onError(n)}),e.on("exit",n=>{}),e}}class Yw{static isSupported(){return Ec.isSupported()}constructor(e){d(this,"name","unnamed"),d(this,"source",void 0),d(this,"url",void 0),d(this,"maxConcurrency",1),d(this,"maxMobileConcurrency",1),d(this,"onDebug",()=>{}),d(this,"reuseWorkers",!0),d(this,"props",{}),d(this,"jobQueue",[]),d(this,"idleQueue",[]),d(this,"count",0),d(this,"isDestroyed",!1),this.source=e.source,this.url=e.url,this.setProps(e)}destroy(){this.idleQueue.forEach(e=>e.destroy()),this.isDestroyed=!0}setProps(e){this.props={...this.props,...e},e.name!==void 0&&(this.name=e.name),e.maxConcurrency!==void 0&&(this.maxConcurrency=e.maxConcurrency),e.maxMobileConcurrency!==void 0&&(this.maxMobileConcurrency=e.maxMobileConcurrency),e.reuseWorkers!==void 0&&(this.reuseWorkers=e.reuseWorkers),e.onDebug!==void 0&&(this.onDebug=e.onDebug)}async startJob(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:(s,o,a)=>s.done(a),r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:(s,o)=>s.error(o);const i=new Promise(s=>(this.jobQueue.push({name:e,onMessage:n,onError:r,onStart:s}),this));return this._startQueuedJob(),await i}async _startQueuedJob(){if(!this.jobQueue.length)return;const e=this._getAvailableWorker();if(!e)return;const n=this.jobQueue.shift();if(n){this.onDebug({message:"Starting job",name:n.name,workerThread:e,backlog:this.jobQueue.length});const r=new Gw(n.name,e);e.onMessage=i=>n.onMessage(r,i.type,i.payload),e.onError=i=>n.onError(r,i),n.onStart(r);try{await r.result}finally{this.returnWorkerToQueue(e)}}}returnWorkerToQueue(e){this.isDestroyed||!this.reuseWorkers||this.count>this._getMaxConcurrency()?(e.destroy(),this.count--):this.idleQueue.push(e),this.isDestroyed||this._startQueuedJob()}_getAvailableWorker(){if(this.idleQueue.length>0)return this.idleQueue.shift()||null;if(this.count<this._getMaxConcurrency()){this.count++;const e="".concat(this.name.toLowerCase()," (#").concat(this.count," of ").concat(this.maxConcurrency,")");return new Ec({name:e,source:this.source,url:this.url})}return null}_getMaxConcurrency(){return jw?this.maxMobileConcurrency:this.maxConcurrency}}const $w={maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:!0,onDebug:()=>{}};class sn{static isSupported(){return Ec.isSupported()}static getWorkerFarm(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return sn._workerFarm=sn._workerFarm||new sn({}),sn._workerFarm.setProps(e),sn._workerFarm}constructor(e){d(this,"props",void 0),d(this,"workerPools",new Map),this.props={...$w},this.setProps(e),this.workerPools=new Map}destroy(){for(const e of this.workerPools.values())e.destroy();this.workerPools=new Map}setProps(e){this.props={...this.props,...e};for(const n of this.workerPools.values())n.setProps(this._getWorkerPoolProps())}getWorkerPool(e){const{name:n,source:r,url:i}=e;let s=this.workerPools.get(n);return s||(s=new Yw({name:n,source:r,url:i}),s.setProps(this._getWorkerPoolProps()),this.workerPools.set(n,s)),s}_getWorkerPoolProps(){return{maxConcurrency:this.props.maxConcurrency,maxMobileConcurrency:this.props.maxMobileConcurrency,reuseWorkers:this.props.reuseWorkers,onDebug:this.props.onDebug}}}d(sn,"_workerFarm",void 0);const qw="latest";function Zw(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=e[t.id]||{},r="".concat(t.id,"-worker.js");let i=n.workerUrl;if(!i&&t.id==="compression"&&(i=e.workerUrl),e._workerType==="test"&&(i="modules/".concat(t.module,"/dist/").concat(r)),!i){let s=t.version;s==="latest"&&(s=qw);const o=s?"@".concat(s):"";i="https://unpkg.com/@loaders.gl/".concat(t.module).concat(o,"/dist/").concat(r)}return dn(i),i}function Qw(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Vw;dn(t,"no worker provided");const n=t.version;return!(!e||!n)}function Kw(t,e){return!sn.isSupported()||!ea&&!(e!=null&&e._nodeWorkers)?!1:t.worker&&(e==null?void 0:e.worker)}async function Jw(t,e,n,r,i){const s=t.id,o=Zw(t,n),l=sn.getWorkerFarm(n).getWorkerPool({name:s,url:o});n=JSON.parse(JSON.stringify(n)),r=JSON.parse(JSON.stringify(r||{}));const u=await l.startJob("process-on-worker",eT.bind(null,i));return u.postMessage("process",{input:e,options:n,context:r}),await(await u.result).result}async function eT(t,e,n,r){switch(n){case"done":e.done(r);break;case"error":e.error(new Error(r.error));break;case"process":const{id:i,input:s,options:o}=r;try{const a=await t(s,o);e.postMessage("done",{id:i,result:a})}catch(a){const l=a instanceof Error?a.message:"unknown error";e.postMessage("error",{id:i,error:l})}break;default:console.warn("parse-with-worker unknown message ".concat(n))}}function tT(t,e,n){if(n=n||t.byteLength,t.byteLength<n||e.byteLength<n)return!1;const r=new Uint8Array(t),i=new Uint8Array(e);for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0}function nT(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const r=e.map(a=>a instanceof ArrayBuffer?new Uint8Array(a):a),i=r.reduce((a,l)=>a+l.byteLength,0),s=new Uint8Array(i);let o=0;for(const a of r)s.set(a,o),o+=a.byteLength;return s.buffer}async function rT(t){const e=[];for await(const n of t)e.push(n);return nT(...e)}function ug(){let t;if(typeof window<"u"&&window.performance)t=window.performance.now();else if(typeof process<"u"&&process.hrtime){const e=process.hrtime();t=e[0]*1e3+e[1]/1e6}else t=Date.now();return t}class cg{constructor(e,n){d(this,"name",void 0),d(this,"type",void 0),d(this,"sampleSize",1),d(this,"time",void 0),d(this,"count",void 0),d(this,"samples",void 0),d(this,"lastTiming",void 0),d(this,"lastSampleTime",void 0),d(this,"lastSampleCount",void 0),d(this,"_count",0),d(this,"_time",0),d(this,"_samples",0),d(this,"_startTime",0),d(this,"_timerPending",!1),this.name=e,this.type=n,this.reset()}setSampleSize(e){return this.sampleSize=e,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(e){return this._count+=e,this._samples++,this._checkSampling(),this}subtractCount(e){return this._count-=e,this._samples++,this._checkSampling(),this}addTime(e){return this._time+=e,this.lastTiming=e,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=ug(),this._timerPending=!0,this}timeEnd(){return this._timerPending?(this.addTime(ug()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}}class Wf{constructor(e){d(this,"id",void 0),d(this,"stats",{}),this.id=e.id,this.stats={},this._initializeStats(e.stats),Object.seal(this)}get(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"count";return this._getOrCreate({name:e,type:n})}get size(){return Object.keys(this.stats).length}reset(){for(const e in this.stats)this.stats[e].reset();return this}forEach(e){for(const n in this.stats)e(this.stats[n])}getTable(){const e={};return this.forEach(n=>{e[n.name]={time:n.time||0,count:n.count||0,average:n.getAverageTime()||0,hz:n.getHz()||0}}),e}_initializeStats(){(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).forEach(n=>this._getOrCreate(n))}_getOrCreate(e){if(!e||!e.name)return null;const{name:n,type:r}=e;return this.stats[n]||(e instanceof cg?this.stats[n]=e:this.stats[n]=new cg(n,r)),this.stats[n]}}let iT="";const fg={};function sT(t){for(const e in fg)if(t.startsWith(e)){const n=fg[e];t=t.replace(e,n)}return!t.startsWith("http://")&&!t.startsWith("https://")&&(t="".concat(iT).concat(t)),t}function oT(t){return t&&typeof t=="object"&&t.isBuffer}function v_(t){if(oT(t))return t;if(t instanceof ArrayBuffer)return t;if(ArrayBuffer.isView(t))return t.byteOffset===0&&t.byteLength===t.buffer.byteLength?t.buffer:t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength);if(typeof t=="string"){const e=t;return new TextEncoder().encode(e).buffer}if(t&&typeof t=="object"&&t._toArrayBuffer)return t._toArrayBuffer();throw new Error("toArrayBuffer")}function y_(t){const e=t?t.lastIndexOf("/"):-1;return e>=0?t.substr(e+1):""}function aT(t){const e=t?t.lastIndexOf("/"):-1;return e>=0?t.substr(0,e):""}const lT=t=>typeof t=="boolean",fs=t=>typeof t=="function",Xs=t=>t!==null&&typeof t=="object",hg=t=>Xs(t)&&t.constructor==={}.constructor,uT=t=>t&&typeof t[Symbol.iterator]=="function",cT=t=>t&&typeof t[Symbol.asyncIterator]=="function",Tr=t=>typeof Response<"u"&&t instanceof Response||t&&t.arrayBuffer&&t.text&&t.json,br=t=>typeof Blob<"u"&&t instanceof Blob,fT=t=>t&&typeof t=="object"&&t.isBuffer,hT=t=>typeof ReadableStream<"u"&&t instanceof ReadableStream||Xs(t)&&fs(t.tee)&&fs(t.cancel)&&fs(t.getReader),dT=t=>Xs(t)&&fs(t.read)&&fs(t.pipe)&&lT(t.readable),E_=t=>hT(t)||dT(t),gT=/^data:([-\w.]+\/[-\w.+]+)(;|,)/,pT=/^([-\w.]+\/[-\w.+]+)/;function mT(t){const e=pT.exec(t);return e?e[1]:t}function dg(t){const e=gT.exec(t);return e?e[1]:""}const w_=/\?.*/;function _T(t){const e=t.match(w_);return e&&e[0]}function Xf(t){return t.replace(w_,"")}function ll(t){return Tr(t)?t.url:br(t)?t.name||"":typeof t=="string"?t:""}function Yf(t){if(Tr(t)){const e=t,n=e.headers.get("content-type")||"",r=Xf(e.url);return mT(n)||dg(r)}return br(t)?t.type||"":typeof t=="string"?dg(t):""}function vT(t){return Tr(t)?t.headers["content-length"]||-1:br(t)?t.size:typeof t=="string"?t.length:t instanceof ArrayBuffer||ArrayBuffer.isView(t)?t.byteLength:-1}async function T_(t){if(Tr(t))return t;const e={},n=vT(t);n>=0&&(e["content-length"]=String(n));const r=ll(t),i=Yf(t);i&&(e["content-type"]=i);const s=await wT(t);s&&(e["x-first-bytes"]=s),typeof t=="string"&&(t=new TextEncoder().encode(t));const o=new Response(t,{headers:e});return Object.defineProperty(o,"url",{value:r}),o}async function yT(t){if(!t.ok){const e=await ET(t);throw new Error(e)}}async function ET(t){let e="Failed to fetch resource ".concat(t.url," (").concat(t.status,"): ");try{const n=t.headers.get("Content-Type");let r=t.statusText;n.includes("application/json")&&(r+=" ".concat(await t.text())),e+=r,e=e.length>60?"".concat(e.slice(0,60),"..."):e}catch{}return e}async function wT(t){if(typeof t=="string")return"data:,".concat(t.slice(0,5));if(t instanceof Blob){const n=t.slice(0,5);return await new Promise(r=>{const i=new FileReader;i.onload=s=>{var o;return r(s==null||(o=s.target)===null||o===void 0?void 0:o.result)},i.readAsDataURL(n)})}if(t instanceof ArrayBuffer){const n=t.slice(0,5),r=TT(n);return"data:base64,".concat(r)}return null}function TT(t){let e="";const n=new Uint8Array(t);for(let r=0;r<n.byteLength;r++)e+=String.fromCharCode(n[r]);return btoa(e)}async function gg(t,e){if(typeof t=="string"){t=sT(t);let n=e;return e!=null&&e.fetch&&typeof(e==null?void 0:e.fetch)!="function"&&(n=e.fetch),await fetch(t,n)}return await T_(t)}function b_(t){if(typeof window<"u"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof process<"u"&&typeof process.versions=="object"&&process.versions.electron)return!0;const e=typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent,n=t||e;return!!(n&&n.indexOf("Electron")>=0)}function _n(){return!(typeof process=="object"&&String(process)==="[object process]"&&!process.browser)||b_()}const ta={self:typeof self<"u"&&self,window:typeof window<"u"&&window,global:typeof global<"u"&&global,document:typeof document<"u"&&document,process:typeof process=="object"&&process},Mo=ta.window||ta.self||ta.global,Gi=ta.process||{},S_=typeof __VERSION__<"u"?__VERSION__:"untranspiled source";_n();const tu=globalThis;function A_(t){if(!t&&!_n())return"Node";if(b_(t))return"Electron";const n=t||(typeof navigator<"u"?navigator:{}).userAgent||"";if(n.indexOf("Edge")>-1)return"Edge";const r=n.indexOf("MSIE ")!==-1,i=n.indexOf("Trident/")!==-1;return r||i?"IE":tu.chrome?"Chrome":tu.safari?"Safari":tu.mozInnerScreenX?"Firefox":"Unknown"}function bT(t){try{const e=window[t],n="__storage_test__";return e.setItem(n,n),e.removeItem(n),e}catch{return null}}class ST{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"sessionStorage";d(this,"storage",void 0),d(this,"id",void 0),d(this,"config",void 0),this.storage=bT(r),this.id=e,this.config=n,this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(e){if(Object.assign(this.config,e),this.storage){const n=JSON.stringify(this.config);this.storage.setItem(this.id,n)}}_loadConfiguration(){let e={};if(this.storage){const n=this.storage.getItem(this.id);e=n?JSON.parse(n):{}}return Object.assign(this.config,e),this}}function AT(t){let e;return t<10?e="".concat(t.toFixed(2),"ms"):t<100?e="".concat(t.toFixed(1),"ms"):t<1e3?e="".concat(t.toFixed(0),"ms"):e="".concat((t/1e3).toFixed(2),"s"),e}function xT(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:8;const n=Math.max(e-t.length,0);return"".concat(" ".repeat(n)).concat(t)}function nu(t,e,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:600;const i=t.src.replace(/\(/g,"%28").replace(/\)/g,"%29");t.width>r&&(n=Math.min(n,r/t.width));const s=t.width*n,o=t.height*n,a=["font-size:1px;","padding:".concat(Math.floor(o/2),"px ").concat(Math.floor(s/2),"px;"),"line-height:".concat(o,"px;"),"background:url(".concat(i,");"),"background-size:".concat(s,"px ").concat(o,"px;"),"color:transparent;"].join("");return["".concat(e," %c+"),a]}let Oa;(function(t){t[t.BLACK=30]="BLACK",t[t.RED=31]="RED",t[t.GREEN=32]="GREEN",t[t.YELLOW=33]="YELLOW",t[t.BLUE=34]="BLUE",t[t.MAGENTA=35]="MAGENTA",t[t.CYAN=36]="CYAN",t[t.WHITE=37]="WHITE",t[t.BRIGHT_BLACK=90]="BRIGHT_BLACK",t[t.BRIGHT_RED=91]="BRIGHT_RED",t[t.BRIGHT_GREEN=92]="BRIGHT_GREEN",t[t.BRIGHT_YELLOW=93]="BRIGHT_YELLOW",t[t.BRIGHT_BLUE=94]="BRIGHT_BLUE",t[t.BRIGHT_MAGENTA=95]="BRIGHT_MAGENTA",t[t.BRIGHT_CYAN=96]="BRIGHT_CYAN",t[t.BRIGHT_WHITE=97]="BRIGHT_WHITE"})(Oa||(Oa={}));function pg(t){return typeof t=="string"?Oa[t.toUpperCase()]||Oa.WHITE:t}function PT(t,e,n){return!_n&&typeof t=="string"&&(e&&(e=pg(e),t="\x1B[".concat(e,"m").concat(t,"\x1B[39m")),n&&(e=pg(n),t="\x1B[".concat(n+10,"m").concat(t,"\x1B[49m"))),t}function LT(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:["constructor"];const n=Object.getPrototypeOf(t),r=Object.getOwnPropertyNames(n);for(const i of r)typeof t[i]=="function"&&(e.find(s=>i===s)||(t[i]=t[i].bind(t)))}function ka(t,e){if(!t)throw new Error(e||"Assertion failed")}function Cr(){let t;if(_n&&"performance"in Mo){var e,n;t=Mo==null||(e=Mo.performance)===null||e===void 0||(n=e.now)===null||n===void 0?void 0:n.call(e)}else if("hrtime"in Gi){var r;const i=Gi==null||(r=Gi.hrtime)===null||r===void 0?void 0:r.call(Gi);t=i[0]*1e3+i[1]/1e6}else t=Date.now();return t}const Mr={debug:_n&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},CT={enabled:!0,level:0};function ht(){}const mg={},_g={once:!0};class Ys{constructor(){let{id:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{id:""};d(this,"id",void 0),d(this,"VERSION",S_),d(this,"_startTs",Cr()),d(this,"_deltaTs",Cr()),d(this,"_storage",void 0),d(this,"userData",{}),d(this,"LOG_THROTTLE_TIMEOUT",0),this.id=e,this.userData={},this._storage=new ST("__probe-".concat(this.id,"__"),CT),this.timeStamp("".concat(this.id," started")),LT(this),Object.seal(this)}set level(e){this.setLevel(e)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((Cr()-this._startTs).toPrecision(10))}getDelta(){return Number((Cr()-this._deltaTs).toPrecision(10))}set priority(e){this.level=e}get priority(){return this.level}getPriority(){return this.level}enable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return this._storage.setConfiguration({enabled:e}),this}setLevel(e){return this._storage.setConfiguration({level:e}),this}get(e){return this._storage.config[e]}set(e,n){this._storage.setConfiguration({[e]:n})}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}assert(e,n){ka(e,n)}warn(e){return this._getLogFunction(0,e,Mr.warn,arguments,_g)}error(e){return this._getLogFunction(0,e,Mr.error,arguments)}deprecated(e,n){return this.warn("`".concat(e,"` is deprecated and will be removed in a later version. Use `").concat(n,"` instead"))}removed(e,n){return this.error("`".concat(e,"` has been removed. Use `").concat(n,"` instead"))}probe(e,n){return this._getLogFunction(e,n,Mr.log,arguments,{time:!0,once:!0})}log(e,n){return this._getLogFunction(e,n,Mr.debug,arguments)}info(e,n){return this._getLogFunction(e,n,console.info,arguments)}once(e,n){for(var r=arguments.length,i=new Array(r>2?r-2:0),s=2;s<r;s++)i[s-2]=arguments[s];return this._getLogFunction(e,n,Mr.debug||Mr.info,arguments,_g)}table(e,n,r){return n?this._getLogFunction(e,n,console.table||ht,r&&[r],{tag:OT(n)}):ht}image(e){let{logLevel:n,priority:r,image:i,message:s="",scale:o=1}=e;return this._shouldLog(n||r)?_n?IT({image:i,message:s,scale:o}):RT():ht}time(e,n){return this._getLogFunction(e,n,console.time?console.time:console.info)}timeEnd(e,n){return this._getLogFunction(e,n,console.timeEnd?console.timeEnd:console.info)}timeStamp(e,n){return this._getLogFunction(e,n,console.timeStamp||ht)}group(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{collapsed:!1};const i=vg({logLevel:e,message:n,opts:r}),{collapsed:s}=r;return i.method=(s?console.groupCollapsed:console.group)||console.info,this._getLogFunction(i)}groupCollapsed(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.group(e,n,Object.assign({},r,{collapsed:!0}))}groupEnd(e){return this._getLogFunction(e,"",console.groupEnd||ht)}withGroup(e,n,r){this.group(e,n)();try{r()}finally{this.groupEnd(e)()}}trace(){console.trace&&console.trace()}_shouldLog(e){return this.isEnabled()&&this.getLevel()>=x_(e)}_getLogFunction(e,n,r,i,s){if(this._shouldLog(e)){s=vg({logLevel:e,message:n,args:i,opts:s}),r=r||s.method,ka(r),s.total=this.getTotal(),s.delta=this.getDelta(),this._deltaTs=Cr();const o=s.tag||s.message;if(s.once)if(!mg[o])mg[o]=Cr();else return ht;return n=MT(this.id,s.message,s),r.bind(console,n,...s.args)}return ht}}d(Ys,"VERSION",S_);function x_(t){if(!t)return 0;let e;switch(typeof t){case"number":e=t;break;case"object":e=t.logLevel||t.priority||0;break;default:return 0}return ka(Number.isFinite(e)&&e>=0),e}function vg(t){const{logLevel:e,message:n}=t;t.logLevel=x_(e);const r=t.args?Array.from(t.args):[];for(;r.length&&r.shift()!==n;);switch(typeof e){case"string":case"function":n!==void 0&&r.unshift(n),t.message=e;break;case"object":Object.assign(t,e);break}typeof t.message=="function"&&(t.message=t.message());const i=typeof t.message;return ka(i==="string"||i==="object"),Object.assign(t,{args:r},t.opts)}function MT(t,e,n){if(typeof e=="string"){const r=n.time?xT(AT(n.total)):"";e=n.time?"".concat(t,": ").concat(r,"  ").concat(e):"".concat(t,": ").concat(e),e=PT(e,n.color,n.background)}return e}function RT(t){return console.warn("removed"),ht}function IT(t){let{image:e,message:n="",scale:r=1}=t;if(typeof e=="string"){const s=new Image;return s.onload=()=>{const o=nu(s,n,r);console.log(...o)},s.src=e,ht}const i=e.nodeName||"";if(i.toLowerCase()==="img")return console.log(...nu(e,n,r)),ht;if(i.toLowerCase()==="canvas"){const s=new Image;return s.onload=()=>console.log(...nu(s,n,r)),s.src=e.toDataURL(),ht}return ht}function OT(t){for(const e in t)for(const n in t[e])return n||"untitled";return"empty"}const yg=new Ys({id:"loaders.gl"});class kT{log(){return()=>{}}info(){return()=>{}}warn(){return()=>{}}error(){return()=>{}}}class NT{constructor(){d(this,"console",void 0),this.console=console}log(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return this.console.log.bind(this.console,...n)}info(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return this.console.info.bind(this.console,...n)}warn(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return this.console.warn.bind(this.console,...n)}error(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return this.console.error.bind(this.console,...n)}}const P_={fetch:null,mimeType:void 0,nothrow:!1,log:new NT,CDN:"https://unpkg.com/@loaders.gl",worker:!0,maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:Hf,_nodeWorkers:!1,_workerType:"",limit:0,_limitMB:0,batchSize:"auto",batchDebounceMs:0,metadata:!1,transforms:[]},DT={throws:"nothrow",dataType:"(no longer used)",uri:"baseUri",method:"fetch.method",headers:"fetch.headers",body:"fetch.body",mode:"fetch.mode",credentials:"fetch.credentials",cache:"fetch.cache",redirect:"fetch.redirect",referrer:"fetch.referrer",referrerPolicy:"fetch.referrerPolicy",integrity:"fetch.integrity",keepalive:"fetch.keepalive",signal:"fetch.signal"};function L_(){globalThis.loaders=globalThis.loaders||{};const{loaders:t}=globalThis;return t._state=t._state||{},t._state}const C_=()=>{const t=L_();return t.globalOptions=t.globalOptions||{...P_},t.globalOptions};function FT(t,e,n,r){return n=n||[],n=Array.isArray(n)?n:[n],UT(t,n),zT(e,t,r)}function UT(t,e){Eg(t,null,P_,DT,e);for(const n of e){const r=t&&t[n.id]||{},i=n.options&&n.options[n.id]||{},s=n.deprecatedOptions&&n.deprecatedOptions[n.id]||{};Eg(r,n.id,i,s,e)}}function Eg(t,e,n,r,i){const s=e||"Top level",o=e?"".concat(e,"."):"";for(const a in t){const l=!e&&Xs(t[a]),u=a==="baseUri"&&!e,c=a==="workerUrl"&&e;if(!(a in n)&&!u&&!c){if(a in r)yg.warn("".concat(s," loader option '").concat(o).concat(a,"' no longer supported, use '").concat(r[a],"'"))();else if(!l){const f=BT(a,i);yg.warn("".concat(s," loader option '").concat(o).concat(a,"' not recognized. ").concat(f))()}}}}function BT(t,e){const n=t.toLowerCase();let r="";for(const i of e)for(const s in i.options){if(t===s)return"Did you mean '".concat(i.id,".").concat(s,"'?");const o=s.toLowerCase();(n.startsWith(o)||o.startsWith(n))&&(r=r||"Did you mean '".concat(i.id,".").concat(s,"'?"))}return r}function zT(t,e,n){const i={...t.options||{}};return VT(i,n),i.log===null&&(i.log=new kT),wg(i,C_()),wg(i,e),i}function wg(t,e){for(const n in e)if(n in e){const r=e[n];hg(r)&&hg(t[n])?t[n]={...t[n],...e[n]}:t[n]=e[n]}}function VT(t,e){e&&!("baseUri"in t)&&(t.baseUri=e)}function $f(t){var e;return t?(Array.isArray(t)&&(t=t[0]),Array.isArray((e=t)===null||e===void 0?void 0:e.extensions)):!1}function qf(t){var e,n;Ia(t,"null loader"),Ia($f(t),"invalid loader");let r;return Array.isArray(t)&&(r=t[1],t=t[0],t={...t,options:{...t.options,...r}}),((e=t)!==null&&e!==void 0&&e.parseTextSync||(n=t)!==null&&n!==void 0&&n.parseText)&&(t.text=!0),t.text||(t.binary=!0),t}const M_=()=>{const t=L_();return t.loaderRegistry=t.loaderRegistry||[],t.loaderRegistry};function jT(t){const e=M_();t=Array.isArray(t)?t:[t];for(const n of t){const r=qf(n);e.find(i=>r===i)||e.unshift(r)}}function GT(){return M_()}const HT=new Ys({id:"loaders.gl"}),WT=/\.([^.]+)$/;async function XT(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;if(!R_(t))return null;let i=Tg(t,e,{...n,nothrow:!0},r);if(i)return i;if(br(t)&&(t=await t.slice(0,10).arrayBuffer(),i=Tg(t,e,n,r)),!i&&!(n!=null&&n.nothrow))throw new Error(I_(t));return i}function Tg(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;if(!R_(t))return null;if(e&&!Array.isArray(e))return qf(e);let i=[];e&&(i=i.concat(e)),n!=null&&n.ignoreRegisteredLoaders||i.push(...GT()),$T(i);const s=YT(t,i,n,r);if(!s&&!(n!=null&&n.nothrow))throw new Error(I_(t));return s}function YT(t,e,n,r){const i=ll(t),s=Yf(t),o=Xf(i)||(r==null?void 0:r.url);let a=null,l="";if(n!=null&&n.mimeType&&(a=ru(e,n==null?void 0:n.mimeType),l="match forced by supplied MIME type ".concat(n==null?void 0:n.mimeType)),a=a||qT(e,o),l=l||(a?"matched url ".concat(o):""),a=a||ru(e,s),l=l||(a?"matched MIME type ".concat(s):""),a=a||QT(e,t),l=l||(a?"matched initial data ".concat(O_(t)):""),a=a||ru(e,n==null?void 0:n.fallbackMimeType),l=l||(a?"matched fallback MIME type ".concat(s):""),l){var u;HT.log(1,"selectLoader selected ".concat((u=a)===null||u===void 0?void 0:u.name,": ").concat(l,"."))}return a}function R_(t){return!(t instanceof Response&&t.status===204)}function I_(t){const e=ll(t),n=Yf(t);let r="No valid loader found (";r+=e?"".concat(y_(e),", "):"no url provided, ",r+="MIME type: ".concat(n?'"'.concat(n,'"'):"not provided",", ");const i=t?O_(t):"";return r+=i?' first bytes: "'.concat(i,'"'):"first bytes: not available",r+=")",r}function $T(t){for(const e of t)qf(e)}function qT(t,e){const n=e&&WT.exec(e),r=n&&n[1];return r?ZT(t,r):null}function ZT(t,e){e=e.toLowerCase();for(const n of t)for(const r of n.extensions)if(r.toLowerCase()===e)return n;return null}function ru(t,e){for(const n of t)if(n.mimeTypes&&n.mimeTypes.includes(e)||e==="application/x.".concat(n.id))return n;return null}function QT(t,e){if(!e)return null;for(const n of t)if(typeof e=="string"){if(KT(e,n))return n}else if(ArrayBuffer.isView(e)){if(bg(e.buffer,e.byteOffset,n))return n}else if(e instanceof ArrayBuffer&&bg(e,0,n))return n;return null}function KT(t,e){return e.testText?e.testText(t):(Array.isArray(e.tests)?e.tests:[e.tests]).some(r=>t.startsWith(r))}function bg(t,e,n){return(Array.isArray(n.tests)?n.tests:[n.tests]).some(i=>JT(t,e,n,i))}function JT(t,e,n,r){if(r instanceof ArrayBuffer)return tT(r,t,r.byteLength);switch(typeof r){case"function":return r(t,n);case"string":const i=wc(t,e,r.length);return r===i;default:return!1}}function O_(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5;return typeof t=="string"?t.slice(0,e):ArrayBuffer.isView(t)?wc(t.buffer,t.byteOffset,e):t instanceof ArrayBuffer?wc(t,0,e):""}function wc(t,e,n){if(t.byteLength<e+n)return"";const r=new DataView(t);let i="";for(let s=0;s<n;s++)i+=String.fromCharCode(r.getUint8(e+s));return i}const eb=256*1024;function*tb(t,e){const n=(e==null?void 0:e.chunkSize)||eb;let r=0;const i=new TextEncoder;for(;r<t.length;){const s=Math.min(t.length-r,n),o=t.slice(r,r+s);r+=s,yield i.encode(o)}}const nb=256*1024;function rb(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return function*(){const{chunkSize:n=nb}=e;let r=0;for(;r<t.byteLength;){const i=Math.min(t.byteLength-r,n),s=new ArrayBuffer(i),o=new Uint8Array(t,r,i);new Uint8Array(s).set(o),r+=i,yield s}}()}const ib=1024*1024;async function*sb(t,e){const n=(e==null?void 0:e.chunkSize)||ib;let r=0;for(;r<t.size;){const i=r+n,s=await t.slice(r,i).arrayBuffer();r=i,yield s}}function Sg(t,e){return Hf?ob(t,e):ab(t)}async function*ob(t,e){const n=t.getReader();let r;try{for(;;){const i=r||n.read();e!=null&&e._streamReadAhead&&(r=n.read());const{done:s,value:o}=await i;if(s)return;yield v_(o)}}catch{n.releaseLock()}}async function*ab(t,e){for await(const n of t)yield v_(n)}function lb(t,e){if(typeof t=="string")return tb(t,e);if(t instanceof ArrayBuffer)return rb(t,e);if(br(t))return sb(t,e);if(E_(t))return Sg(t,e);if(Tr(t))return Sg(t.body,e);throw new Error("makeIterator")}const k_="Cannot convert supplied data type";function ub(t,e,n){if(e.text&&typeof t=="string")return t;if(fT(t)&&(t=t.buffer),t instanceof ArrayBuffer){const r=t;return e.text&&!e.binary?new TextDecoder("utf8").decode(r):r}if(ArrayBuffer.isView(t)){if(e.text&&!e.binary)return new TextDecoder("utf8").decode(t);let r=t.buffer;const i=t.byteLength||t.length;return(t.byteOffset!==0||i!==r.byteLength)&&(r=r.slice(t.byteOffset,t.byteOffset+i)),r}throw new Error(k_)}async function cb(t,e,n){const r=t instanceof ArrayBuffer||ArrayBuffer.isView(t);if(typeof t=="string"||r)return ub(t,e);if(br(t)&&(t=await T_(t)),Tr(t)){const i=t;return await yT(i),e.binary?await i.arrayBuffer():await i.text()}if(E_(t)&&(t=lb(t,n)),uT(t)||cT(t))return rT(t);throw new Error(k_)}function N_(t,e){const n=C_(),r=t||n;return typeof r.fetch=="function"?r.fetch:Xs(r.fetch)?i=>gg(i,r):e!=null&&e.fetch?e==null?void 0:e.fetch:gg}function fb(t,e,n){if(n)return n;const r={fetch:N_(e,t),...t};if(r.url){const i=Xf(r.url);r.baseUrl=i,r.queryString=_T(r.url),r.filename=y_(i),r.baseUrl=aT(i)}return Array.isArray(r.loaders)||(r.loaders=null),r}function hb(t,e){if(!e&&t&&!Array.isArray(t))return t;let n;if(t&&(n=Array.isArray(t)?t:[t]),e&&e.loaders){const r=Array.isArray(e.loaders)?e.loaders:[e.loaders];n=n?[...n,...r]:r}return n&&n.length?n:null}async function Zf(t,e,n,r){dn(!r||typeof r=="object"),e&&!Array.isArray(e)&&!$f(e)&&(r=void 0,n=e,e=void 0),t=await t,n=n||{};const i=ll(t),o=hb(e,r),a=await XT(t,o,n);return a?(n=FT(n,a,o,i),r=fb({url:i,parse:Zf,loaders:o},n,r||null),await db(a,t,n,r)):null}async function db(t,e,n,r){if(Qw(t),Tr(e)){const i=e,{ok:s,redirected:o,status:a,statusText:l,type:u,url:c}=i,f=Object.fromEntries(i.headers.entries());r.response={headers:f,ok:s,redirected:o,status:a,statusText:l,type:u,url:c}}if(e=await cb(e,t,n),t.parseTextSync&&typeof e=="string")return n.dataType="text",t.parseTextSync(e,n,r,t);if(Kw(t,n))return await Jw(t,e,n,r,Zf);if(t.parseText&&typeof e=="string")return await t.parseText(e,n,r,t);if(t.parse)return await t.parse(e,n,r,t);throw dn(!t.parseSync),new Error("".concat(t.id," loader - no parser found and worker is disabled"))}async function Tc(t,e,n,r){!Array.isArray(e)&&!$f(e)&&(n=e,e=void 0);const i=N_(n);let s=t;return typeof t=="string"&&(s=await i(t)),br(t)&&(s=await i(t)),await Zf(s,e,n)}const gb="3.4.15",{_parseImageNode:pb}=globalThis,bc=typeof Image<"u",Sc=typeof ImageBitmap<"u",mb=!!pb,Ac=Hf?!0:mb;function _b(t){switch(t){case"auto":return Sc||bc||Ac;case"imagebitmap":return Sc;case"image":return bc;case"data":return Ac;default:throw new Error("@loaders.gl/images: image ".concat(t," not supported in this environment"))}}function vb(){if(Sc)return"imagebitmap";if(bc)return"image";if(Ac)return"data";throw new Error("Install '@loaders.gl/polyfills' to parse images under Node.js")}function yb(t){const e=wb(t);if(!e)throw new Error("Not an image");return e}function Eb(t){switch(yb(t)){case"data":return t;case"image":case"imagebitmap":const e=document.createElement("canvas"),n=e.getContext("2d");if(!n)throw new Error("getImageData");return e.width=t.width,e.height=t.height,n.drawImage(t,0,0),n.getImageData(0,0,t.width,t.height);default:throw new Error("getImageData")}}function wb(t){return typeof ImageBitmap<"u"&&t instanceof ImageBitmap?"imagebitmap":typeof Image<"u"&&t instanceof Image?"image":t&&typeof t=="object"&&t.data&&t.width&&t.height?"data":null}const Tb=/^data:image\/svg\+xml/,bb=/\.svg((\?|#).*)?$/;function Qf(t){return t&&(Tb.test(t)||bb.test(t))}function Sb(t,e){if(Qf(e)){let r=new TextDecoder().decode(t);try{typeof unescape=="function"&&typeof encodeURIComponent=="function"&&(r=unescape(encodeURIComponent(r)))}catch(s){throw new Error(s.message)}return"data:image/svg+xml;base64,".concat(btoa(r))}return D_(t,e)}function D_(t,e){if(Qf(e))throw new Error("SVG cannot be parsed directly to imagebitmap");return new Blob([new Uint8Array(t)])}async function F_(t,e,n){const r=Sb(t,n),i=self.URL||self.webkitURL,s=typeof r!="string"&&i.createObjectURL(r);try{return await Ab(s||r,e)}finally{s&&i.revokeObjectURL(s)}}async function Ab(t,e){const n=new Image;return n.src=t,e.image&&e.image.decode&&n.decode?(await n.decode(),n):await new Promise((r,i)=>{try{n.onload=()=>r(n),n.onerror=s=>i(new Error("Could not load image ".concat(t,": ").concat(s)))}catch(s){i(s)}})}const xb={};let Ag=!0;async function Pb(t,e,n){let r;Qf(n)?r=await F_(t,e,n):r=D_(t,n);const i=e&&e.imagebitmap;return await Lb(r,i)}async function Lb(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if((Cb(e)||!Ag)&&(e=null),e)try{return await createImageBitmap(t,e)}catch(n){console.warn(n),Ag=!1}return await createImageBitmap(t)}function Cb(t){for(const e in t||xb)return!1;return!0}function Mb(t){return!kb(t,"ftyp",4)||!(t[8]&96)?null:Rb(t)}function Rb(t){switch(Ib(t,8,12).replace("\0"," ").trim()){case"avif":case"avis":return{extension:"avif",mimeType:"image/avif"};default:return null}}function Ib(t,e,n){return String.fromCharCode(...t.slice(e,n))}function Ob(t){return[...t].map(e=>e.charCodeAt(0))}function kb(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const r=Ob(e);for(let i=0;i<r.length;++i)if(r[i]!==t[i+n])return!1;return!0}const Vt=!1,hs=!0;function U_(t){const e=$s(t);return Db(e)||Bb(e)||Fb(e)||Ub(e)||Nb(e)}function Nb(t){const e=new Uint8Array(t instanceof DataView?t.buffer:t),n=Mb(e);return n?{mimeType:n.mimeType,width:0,height:0}:null}function Db(t){const e=$s(t);return e.byteLength>=24&&e.getUint32(0,Vt)===2303741511?{mimeType:"image/png",width:e.getUint32(16,Vt),height:e.getUint32(20,Vt)}:null}function Fb(t){const e=$s(t);return e.byteLength>=10&&e.getUint32(0,Vt)===1195984440?{mimeType:"image/gif",width:e.getUint16(6,hs),height:e.getUint16(8,hs)}:null}function Ub(t){const e=$s(t);return e.byteLength>=14&&e.getUint16(0,Vt)===16973&&e.getUint32(2,hs)===e.byteLength?{mimeType:"image/bmp",width:e.getUint32(18,hs),height:e.getUint32(22,hs)}:null}function Bb(t){const e=$s(t);if(!(e.byteLength>=3&&e.getUint16(0,Vt)===65496&&e.getUint8(2)===255))return null;const{tableMarkers:r,sofMarkers:i}=zb();let s=2;for(;s+9<e.byteLength;){const o=e.getUint16(s,Vt);if(i.has(o))return{mimeType:"image/jpeg",height:e.getUint16(s+5,Vt),width:e.getUint16(s+7,Vt)};if(!r.has(o))return null;s+=2,s+=e.getUint16(s,Vt)}return null}function zb(){const t=new Set([65499,65476,65484,65501,65534]);for(let n=65504;n<65520;++n)t.add(n);return{tableMarkers:t,sofMarkers:new Set([65472,65473,65474,65475,65477,65478,65479,65481,65482,65483,65485,65486,65487,65502])}}function $s(t){if(t instanceof DataView)return t;if(ArrayBuffer.isView(t))return new DataView(t.buffer);if(t instanceof ArrayBuffer)return new DataView(t);throw new Error("toDataView")}async function Vb(t,e){const{mimeType:n}=U_(t)||{},r=globalThis._parseImageNode;return Ia(r),await r(t,n)}async function jb(t,e,n){e=e||{};const i=(e.image||{}).type||"auto",{url:s}=n||{},o=Gb(i);let a;switch(o){case"imagebitmap":a=await Pb(t,e,s);break;case"image":a=await F_(t,e,s);break;case"data":a=await Vb(t);break;default:Ia(!1)}return i==="data"&&(a=Eb(a)),a}function Gb(t){switch(t){case"auto":case"data":return vb();default:return _b(t),t}}const Hb=["png","jpg","jpeg","gif","webp","bmp","ico","svg","avif"],Wb=["image/png","image/jpeg","image/gif","image/webp","image/avif","image/bmp","image/vnd.microsoft.icon","image/svg+xml"],Xb={image:{type:"auto",decode:!0}},Yb={id:"image",module:"images",name:"Images",version:gb,mimeTypes:Wb,extensions:Hb,parse:jb,tests:[t=>!!U_(new DataView(t))],options:Xb},Z=new Ys({id:"deck"});let xc={};function $b(t){xc=t}function Ne(t,e,n,r){Z.level>0&&xc[t]&&xc[t].call(null,e,n,r)}function qb(t){const e=t[0],n=t[t.length-1];return e==="{"&&n==="}"||e==="["&&n==="]"}const Zb={id:"JSON",name:"JSON",module:"",version:"",options:{},extensions:["json","geojson"],mimeTypes:["application/json","application/geo+json"],testText:qb,parseTextSync:JSON.parse};function Qb(){const t="8.9.35",e=globalThis.deck&&globalThis.deck.VERSION;if(e&&e!==t)throw new Error("deck.gl - multiple versions detected: ".concat(e," vs ").concat(t));return e||(Z.log(1,"deck.gl ".concat(t))(),globalThis.deck={...globalThis.deck,VERSION:t,version:t,log:Z,_registerLoggers:$b},jT([Zb,[Yb,{imagebitmap:{premultiplyAlpha:"none"}}]])),t}const Kb=Qb(),q={DEFAULT:-1,LNGLAT:1,METER_OFFSETS:2,LNGLAT_OFFSETS:3,CARTESIAN:0};Object.defineProperty(q,"IDENTITY",{get:()=>(Z.deprecated("COORDINATE_SYSTEM.IDENTITY","COORDINATE_SYSTEM.CARTESIAN")(),0)});const jt={WEB_MERCATOR:1,GLOBE:2,WEB_MERCATOR_AUTO_OFFSET:4,IDENTITY:0},Is={common:0,meters:1,pixels:2},xg={click:{handler:"onClick"},panstart:{handler:"onDragStart"},panmove:{handler:"onDrag"},panend:{handler:"onDragEnd"}},U=new Ys({id:"luma.gl"});function ze(t,e){if(!t)throw new Error(e||"luma.gl: assertion failed.")}const Jb="Invalid WebGLRenderingContext",eS="Requires WebGL2";function ul(t){return typeof WebGLRenderingContext<"u"&&t instanceof WebGLRenderingContext||typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?!0:!!(t&&Number.isFinite(t._version))}function H(t){return typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?!0:!!(t&&t._version===2)}function tS(t){return H(t)?t:null}function cl(t){return ze(ul(t),Jb),t}function Ve(t){return ze(H(t),eS),t}const es={};function nS(t){globalThis.console&&globalThis.console.error&&globalThis.console.error(t)}function rS(t){globalThis.console&&globalThis.console.log&&globalThis.console.log(t)}function iS(t,e){es[t]=!0,e!==void 0&&nS(e)}function sS(t){const e=t.getError;t.getError=function(){let r;do r=e.apply(t),r!==0&&(es[r]=!0);while(r!==0);for(r in es)if(es[r])return delete es[r],parseInt(r,10);return 0}}const qs=function t(e){const n=e.gl;this.ext=e,this.isAlive=!0,this.hasBeenBound=!1,this.elementArrayBuffer=null,this.attribs=new Array(e.maxVertexAttribs);for(let r=0;r<this.attribs.length;r++){const i=new t.VertexAttrib(n);this.attribs[r]=i}this.maxAttrib=0};qs.VertexAttrib=function(e){this.enabled=!1,this.buffer=null,this.size=4,this.type=5126,this.normalized=!1,this.stride=16,this.offset=0,this.cached="",this.recache()};qs.VertexAttrib.prototype.recache=function(){this.cached=[this.size,this.type,this.normalized,this.stride,this.offset].join(":")};const Sr=function(e){const n=this;this.gl=e,sS(e);const r=this.original={getParameter:e.getParameter,enableVertexAttribArray:e.enableVertexAttribArray,disableVertexAttribArray:e.disableVertexAttribArray,bindBuffer:e.bindBuffer,getVertexAttrib:e.getVertexAttrib,vertexAttribPointer:e.vertexAttribPointer};e.getParameter=function(s){return s===n.VERTEX_ARRAY_BINDING_OES?n.currentVertexArrayObject===n.defaultVertexArrayObject?null:n.currentVertexArrayObject:r.getParameter.apply(this,arguments)},e.enableVertexAttribArray=function(s){const o=n.currentVertexArrayObject;o.maxAttrib=Math.max(o.maxAttrib,s);const a=o.attribs[s];return a.enabled=!0,r.enableVertexAttribArray.apply(this,arguments)},e.disableVertexAttribArray=function(s){const o=n.currentVertexArrayObject;o.maxAttrib=Math.max(o.maxAttrib,s);const a=o.attribs[s];return a.enabled=!1,r.disableVertexAttribArray.apply(this,arguments)},e.bindBuffer=function(s,o){switch(s){case 34962:n.currentArrayBuffer=o;break;case 34963:n.currentVertexArrayObject.elementArrayBuffer=o;break}return r.bindBuffer.apply(this,arguments)},e.getVertexAttrib=function(s,o){const l=n.currentVertexArrayObject.attribs[s];switch(o){case 34975:return l.buffer;case 34338:return l.enabled;case 34339:return l.size;case 34340:return l.stride;case 34341:return l.type;case 34922:return l.normalized;default:return r.getVertexAttrib.apply(this,arguments)}},e.vertexAttribPointer=function(s,o,a,l,u,c){const f=n.currentVertexArrayObject;f.maxAttrib=Math.max(f.maxAttrib,s);const h=f.attribs[s];return h.buffer=n.currentArrayBuffer,h.size=o,h.type=a,h.normalized=l,h.stride=u,h.offset=c,h.recache(),r.vertexAttribPointer.apply(this,arguments)},e.instrumentExtension&&e.instrumentExtension(this,"OES_vertex_array_object"),e.canvas&&e.canvas.addEventListener("webglcontextrestored",()=>{rS("OESVertexArrayObject emulation library context restored"),n.reset_()},!0),this.reset_()};Sr.prototype.VERTEX_ARRAY_BINDING_OES=34229;Sr.prototype.reset_=function(){if(this.vertexArrayObjects!==void 0)for(let r=0;r<this.vertexArrayObjects.length;++r)this.vertexArrayObjects.isAlive=!1;const n=this.gl;this.maxVertexAttribs=n.getParameter(34921),this.defaultVertexArrayObject=new qs(this),this.currentVertexArrayObject=null,this.currentArrayBuffer=null,this.vertexArrayObjects=[this.defaultVertexArrayObject],this.bindVertexArrayOES(null)};Sr.prototype.createVertexArrayOES=function(){const e=new qs(this);return this.vertexArrayObjects.push(e),e};Sr.prototype.deleteVertexArrayOES=function(e){e.isAlive=!1,this.vertexArrayObjects.splice(this.vertexArrayObjects.indexOf(e),1),this.currentVertexArrayObject===e&&this.bindVertexArrayOES(null)};Sr.prototype.isVertexArrayOES=function(e){return!!(e&&e instanceof qs&&e.hasBeenBound&&e.ext===this)};Sr.prototype.bindVertexArrayOES=function(e){const n=this.gl;if(e&&!e.isAlive){iS(1282,"bindVertexArrayOES: attempt to bind deleted arrayObject");return}const r=this.original,i=this.currentVertexArrayObject;this.currentVertexArrayObject=e||this.defaultVertexArrayObject,this.currentVertexArrayObject.hasBeenBound=!0;const s=this.currentVertexArrayObject;if(i===s)return;(!i||s.elementArrayBuffer!==i.elementArrayBuffer)&&r.bindBuffer.call(n,34963,s.elementArrayBuffer);let o=this.currentArrayBuffer;const a=Math.max(i?i.maxAttrib:0,s.maxAttrib);for(let l=0;l<=a;l++){const u=s.attribs[l],c=i?i.attribs[l]:null;if((!i||u.enabled!==c.enabled)&&(u.enabled?r.enableVertexAttribArray.call(n,l):r.disableVertexAttribArray.call(n,l)),u.enabled){let f=!1;(!i||u.buffer!==c.buffer)&&(o!==u.buffer&&(r.bindBuffer.call(n,34962,u.buffer),o=u.buffer),f=!0),(f||u.cached!==c.cached)&&r.vertexAttribPointer.call(n,l,u.size,u.type,u.normalized,u.stride,u.offset)}}this.currentArrayBuffer!==o&&r.bindBuffer.call(n,34962,this.currentArrayBuffer)};function oS(t){if(typeof t.createVertexArray=="function")return;const e=t.getSupportedExtensions;t.getSupportedExtensions=function(){const i=e.call(this)||[];return i.indexOf("OES_vertex_array_object")<0&&i.push("OES_vertex_array_object"),i};const n=t.getExtension;t.getExtension=function(i){const s=n.call(this,i);return s||(i!=="OES_vertex_array_object"?null:(t.__OESVertexArrayObject||(this.__OESVertexArrayObject=new Sr(this)),this.__OESVertexArrayObject))}}const Pg="OES_element_index",Lg="WEBGL_draw_buffers",aS="EXT_disjoint_timer_query",lS="EXT_disjoint_timer_query_webgl2",uS="EXT_texture_filter_anisotropic",Cg="WEBGL_debug_renderer_info",cS=35723,fS=4352,hS=36795,dS=34047,gS=37445,pS=37446,ee=t=>H(t)?void 0:0,mS={3074:t=>H(t)?void 0:36064,[cS]:t=>H(t)?void 0:fS,35977:ee,32937:ee,[hS]:(t,e)=>{const n=H(t)?t.getExtension(lS):t.getExtension(aS);return n&&n.GPU_DISJOINT_EXT?e(n.GPU_DISJOINT_EXT):0},[gS]:(t,e)=>{const n=t.getExtension(Cg);return e(n&&n.UNMASKED_VENDOR_WEBGL||7936)},[pS]:(t,e)=>{const n=t.getExtension(Cg);return e(n&&n.UNMASKED_RENDERER_WEBGL||7937)},[dS]:(t,e)=>{const n=t.luma.extensions[uS];return n?e(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT):1},32883:ee,35071:ee,37447:ee,36063:(t,e)=>{if(!H(t)){const n=t.getExtension(Lg);return n?e(n.MAX_COLOR_ATTACHMENTS_WEBGL):0}},35379:ee,35374:ee,35377:ee,34852:t=>{if(!H(t)){const e=t.getExtension(Lg);return e?e.MAX_DRAW_BUFFERS_WEBGL:0}},36203:t=>t.getExtension(Pg)?2147483647:65535,33001:t=>t.getExtension(Pg)?16777216:65535,33e3:t=>16777216,37157:ee,35373:ee,35657:ee,36183:ee,37137:ee,34045:ee,35978:ee,35979:ee,35968:ee,35376:ee,35375:ee,35659:ee,37154:ee,35371:ee,35658:ee,35076:ee,35077:ee,35380:ee};function _S(t,e,n){const r=mS[n],i=typeof r=="function"?r(t,e,n):r;return i!==void 0?i:e(n)}const vS="OES_vertex_array_object",B_="ANGLE_instanced_arrays",yS="WEBGL_draw_buffers",ES="EXT_disjoint_timer_query",wS="EXT_texture_filter_anisotropic",TS="VertexArray requires WebGL2 or OES_vertex_array_object extension";function bS(t,e){return{webgl2:H(t),ext:t.getExtension(e)}}const z_={[vS]:{meta:{suffix:"OES"},createVertexArray:()=>{ze(!1,TS)},deleteVertexArray:()=>{},bindVertexArray:()=>{},isVertexArray:()=>!1},[B_]:{meta:{suffix:"ANGLE"},vertexAttribDivisor(t,e){ze(e===0,"WebGL instanced rendering not supported")},drawElementsInstanced:()=>{},drawArraysInstanced:()=>{}},[yS]:{meta:{suffix:"WEBGL"},drawBuffers:()=>{ze(!1)}},[ES]:{meta:{suffix:"EXT"},createQuery:()=>{ze(!1)},deleteQuery:()=>{ze(!1)},beginQuery:()=>{ze(!1)},endQuery:()=>{},getQuery(t,e){return this.getQueryObject(t,e)},getQueryParameter(t,e){return this.getQueryObject(t,e)},getQueryObject:()=>{}}},iu={readBuffer:(t,e,n)=>{H(t)&&e(n)},getVertexAttrib:(t,e,n,r)=>{const{webgl2:i,ext:s}=bS(t,B_);let o;switch(r){case 35069:o=i?void 0:!1;break;case 35070:o=!i&&!s?0:void 0;break}return o!==void 0?o:e(n,r)},getProgramParameter:(t,e,n,r)=>{if(!H(t))switch(r){case 35967:return 35981;case 35971:return 0;case 35382:return 0}return e(n,r)},getInternalformatParameter:(t,e,n,r,i)=>{if(!H(t))switch(i){case 32937:return new Int32Array([0])}return t.getInternalformatParameter(n,r,i)},getTexParameter(t,e,n,r){switch(r){case 34046:const{extensions:i}=t.luma,s=i[wS];r=s&&s.TEXTURE_MAX_ANISOTROPY_EXT||34046;break}return e(n,r)},getParameter:_S,hint(t,e,n,r){return e(n,r)}};function SS(t){t.luma=t.luma||{};const{luma:e}=t;return e.polyfilled||(oS(t),AS(t),PS(t,z_),xS(t,{target:e,target2:t}),e.polyfilled=!0),t}globalThis.polyfillContext=SS;function AS(t){t.luma.extensions={};const e=t.getSupportedExtensions()||[];for(const n of e)t.luma[n]=t.getExtension(n)}function xS(t,e){let{target:n,target2:r}=e;Object.keys(iu).forEach(i=>{if(typeof iu[i]=="function"){const s=t[i]?t[i].bind(t):()=>{},o=iu[i].bind(null,t,s);n[i]=o,r[i]=o}})}function PS(t,e){for(const n of Object.getOwnPropertyNames(e))n!=="overrides"&&LS(t,{extension:n,target:t.luma,target2:t})}function LS(t,e){let{extension:n,target:r,target2:i}=e;const s=z_[n];ze(s);const{meta:o={}}=s,{suffix:a=""}=o,l=t.getExtension(n);for(const u of Object.keys(s)){const c="".concat(u).concat(a);let f=null;u==="meta"||typeof t[u]=="function"||(l&&typeof l[c]=="function"?f=function(){return l[c](...arguments)}:typeof s[u]=="function"&&(f=s[u].bind(r))),f&&(r[u]=f,i[u]=f)}}const Kf={3042:!1,32773:new Float32Array([0,0,0,0]),32777:32774,34877:32774,32969:1,32968:0,32971:1,32970:0,3106:new Float32Array([0,0,0,0]),3107:[!0,!0,!0,!0],2884:!1,2885:1029,2929:!1,2931:1,2932:513,2928:new Float32Array([0,1]),2930:!0,3024:!0,36006:null,2886:2305,33170:4352,2849:1,32823:!1,32824:0,10752:0,32938:1,32939:!1,3089:!1,3088:new Int32Array([0,0,1024,1024]),2960:!1,2961:0,2968:4294967295,36005:4294967295,2962:519,2967:0,2963:4294967295,34816:519,36003:0,36004:4294967295,2964:7680,2965:7680,2966:7680,34817:7680,34818:7680,34819:7680,2978:[0,0,1024,1024],3333:4,3317:4,37440:!1,37441:!1,37443:37444,35723:4352,36010:null,35977:!1,3330:0,3332:0,3331:0,3314:0,32878:0,3316:0,3315:0,32877:0},wn=(t,e,n)=>e?t.enable(n):t.disable(n),Mg=(t,e,n)=>t.hint(n,e),Qe=(t,e,n)=>t.pixelStorei(n,e),CS=(t,e)=>{const n=H(t)?36009:36160;return t.bindFramebuffer(n,e)},MS=(t,e)=>t.bindFramebuffer(36008,e);function Hi(t){return Array.isArray(t)||ArrayBuffer.isView(t)}const RS={3042:wn,32773:(t,e)=>t.blendColor(...e),32777:"blendEquation",34877:"blendEquation",32969:"blendFunc",32968:"blendFunc",32971:"blendFunc",32970:"blendFunc",3106:(t,e)=>t.clearColor(...e),3107:(t,e)=>t.colorMask(...e),2884:wn,2885:(t,e)=>t.cullFace(e),2929:wn,2931:(t,e)=>t.clearDepth(e),2932:(t,e)=>t.depthFunc(e),2928:(t,e)=>t.depthRange(...e),2930:(t,e)=>t.depthMask(e),3024:wn,35723:Mg,36006:CS,2886:(t,e)=>t.frontFace(e),33170:Mg,2849:(t,e)=>t.lineWidth(e),32823:wn,32824:"polygonOffset",10752:"polygonOffset",35977:wn,32938:"sampleCoverage",32939:"sampleCoverage",3089:wn,3088:(t,e)=>t.scissor(...e),2960:wn,2961:(t,e)=>t.clearStencil(e),2968:(t,e)=>t.stencilMaskSeparate(1028,e),36005:(t,e)=>t.stencilMaskSeparate(1029,e),2962:"stencilFuncFront",2967:"stencilFuncFront",2963:"stencilFuncFront",34816:"stencilFuncBack",36003:"stencilFuncBack",36004:"stencilFuncBack",2964:"stencilOpFront",2965:"stencilOpFront",2966:"stencilOpFront",34817:"stencilOpBack",34818:"stencilOpBack",34819:"stencilOpBack",2978:(t,e)=>t.viewport(...e),3333:Qe,3317:Qe,37440:Qe,37441:Qe,37443:Qe,3330:Qe,3332:Qe,3331:Qe,36010:MS,3314:Qe,32878:Qe,3316:Qe,3315:Qe,32877:Qe,framebuffer:(t,e)=>{const n=e&&"handle"in e?e.handle:e;return t.bindFramebuffer(36160,n)},blend:(t,e)=>e?t.enable(3042):t.disable(3042),blendColor:(t,e)=>t.blendColor(...e),blendEquation:(t,e)=>{e=Hi(e)?e:[e,e],t.blendEquationSeparate(...e)},blendFunc:(t,e)=>{e=Hi(e)&&e.length===2?[...e,...e]:e,t.blendFuncSeparate(...e)},clearColor:(t,e)=>t.clearColor(...e),clearDepth:(t,e)=>t.clearDepth(e),clearStencil:(t,e)=>t.clearStencil(e),colorMask:(t,e)=>t.colorMask(...e),cull:(t,e)=>e?t.enable(2884):t.disable(2884),cullFace:(t,e)=>t.cullFace(e),depthTest:(t,e)=>e?t.enable(2929):t.disable(2929),depthFunc:(t,e)=>t.depthFunc(e),depthMask:(t,e)=>t.depthMask(e),depthRange:(t,e)=>t.depthRange(...e),dither:(t,e)=>e?t.enable(3024):t.disable(3024),derivativeHint:(t,e)=>{t.hint(35723,e)},frontFace:(t,e)=>t.frontFace(e),mipmapHint:(t,e)=>t.hint(33170,e),lineWidth:(t,e)=>t.lineWidth(e),polygonOffsetFill:(t,e)=>e?t.enable(32823):t.disable(32823),polygonOffset:(t,e)=>t.polygonOffset(...e),sampleCoverage:(t,e)=>t.sampleCoverage(...e),scissorTest:(t,e)=>e?t.enable(3089):t.disable(3089),scissor:(t,e)=>t.scissor(...e),stencilTest:(t,e)=>e?t.enable(2960):t.disable(2960),stencilMask:(t,e)=>{e=Hi(e)?e:[e,e];const[n,r]=e;t.stencilMaskSeparate(1028,n),t.stencilMaskSeparate(1029,r)},stencilFunc:(t,e)=>{e=Hi(e)&&e.length===3?[...e,...e]:e;const[n,r,i,s,o,a]=e;t.stencilFuncSeparate(1028,n,r,i),t.stencilFuncSeparate(1029,s,o,a)},stencilOp:(t,e)=>{e=Hi(e)&&e.length===3?[...e,...e]:e;const[n,r,i,s,o,a]=e;t.stencilOpSeparate(1028,n,r,i),t.stencilOpSeparate(1029,s,o,a)},viewport:(t,e)=>t.viewport(...e)};function he(t,e,n){return e[t]!==void 0?e[t]:n[t]}const IS={blendEquation:(t,e,n)=>t.blendEquationSeparate(he(32777,e,n),he(34877,e,n)),blendFunc:(t,e,n)=>t.blendFuncSeparate(he(32969,e,n),he(32968,e,n),he(32971,e,n),he(32970,e,n)),polygonOffset:(t,e,n)=>t.polygonOffset(he(32824,e,n),he(10752,e,n)),sampleCoverage:(t,e,n)=>t.sampleCoverage(he(32938,e,n),he(32939,e,n)),stencilFuncFront:(t,e,n)=>t.stencilFuncSeparate(1028,he(2962,e,n),he(2967,e,n),he(2963,e,n)),stencilFuncBack:(t,e,n)=>t.stencilFuncSeparate(1029,he(34816,e,n),he(36003,e,n),he(36004,e,n)),stencilOpFront:(t,e,n)=>t.stencilOpSeparate(1028,he(2964,e,n),he(2965,e,n),he(2966,e,n)),stencilOpBack:(t,e,n)=>t.stencilOpSeparate(1029,he(34817,e,n),he(34818,e,n),he(34819,e,n))},Rg={enable:(t,e)=>t({[e]:!0}),disable:(t,e)=>t({[e]:!1}),pixelStorei:(t,e,n)=>t({[e]:n}),hint:(t,e,n)=>t({[e]:n}),bindFramebuffer:(t,e,n)=>{switch(e){case 36160:return t({36006:n,36010:n});case 36009:return t({36006:n});case 36008:return t({36010:n});default:return null}},blendColor:(t,e,n,r,i)=>t({32773:new Float32Array([e,n,r,i])}),blendEquation:(t,e)=>t({32777:e,34877:e}),blendEquationSeparate:(t,e,n)=>t({32777:e,34877:n}),blendFunc:(t,e,n)=>t({32969:e,32968:n,32971:e,32970:n}),blendFuncSeparate:(t,e,n,r,i)=>t({32969:e,32968:n,32971:r,32970:i}),clearColor:(t,e,n,r,i)=>t({3106:new Float32Array([e,n,r,i])}),clearDepth:(t,e)=>t({2931:e}),clearStencil:(t,e)=>t({2961:e}),colorMask:(t,e,n,r,i)=>t({3107:[e,n,r,i]}),cullFace:(t,e)=>t({2885:e}),depthFunc:(t,e)=>t({2932:e}),depthRange:(t,e,n)=>t({2928:new Float32Array([e,n])}),depthMask:(t,e)=>t({2930:e}),frontFace:(t,e)=>t({2886:e}),lineWidth:(t,e)=>t({2849:e}),polygonOffset:(t,e,n)=>t({32824:e,10752:n}),sampleCoverage:(t,e,n)=>t({32938:e,32939:n}),scissor:(t,e,n,r,i)=>t({3088:new Int32Array([e,n,r,i])}),stencilMask:(t,e)=>t({2968:e,36005:e}),stencilMaskSeparate:(t,e,n)=>t({[e===1028?2968:36005]:n}),stencilFunc:(t,e,n,r)=>t({2962:e,2967:n,2963:r,34816:e,36003:n,36004:r}),stencilFuncSeparate:(t,e,n,r,i)=>t({[e===1028?2962:34816]:n,[e===1028?2967:36003]:r,[e===1028?2963:36004]:i}),stencilOp:(t,e,n,r)=>t({2964:e,2965:n,2966:r,34817:e,34818:n,34819:r}),stencilOpSeparate:(t,e,n,r,i)=>t({[e===1028?2964:34817]:n,[e===1028?2965:34818]:r,[e===1028?2966:34819]:i}),viewport:(t,e,n,r,i)=>t({2978:[e,n,r,i]})},Dt=(t,e)=>t.isEnabled(e),Ig={3042:Dt,2884:Dt,2929:Dt,3024:Dt,32823:Dt,32926:Dt,32928:Dt,3089:Dt,2960:Dt,35977:Dt};function V_(t){for(const e in t)return!1;return!0}function OS(t,e){if(t===e)return!0;const n=Array.isArray(t)||ArrayBuffer.isView(t),r=Array.isArray(e)||ArrayBuffer.isView(e);if(n&&r&&t.length===e.length){for(let i=0;i<t.length;++i)if(t[i]!==e[i])return!1;return!0}return!1}function Og(t,e){const n=t[e].bind(t);t[e]=function(){const i=arguments.length<=0?void 0:arguments[0];return i in t.state.cache?t.state.enable?t.state.cache[i]:n(...arguments):n(...arguments)},Object.defineProperty(t[e],"name",{value:"".concat(e,"-from-cache"),configurable:!1})}function kS(t,e,n){const r=t[e].bind(t);t[e]=function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];const{valueChanged:l,oldValue:u}=n(t.state._updateCache,...o);return l&&r(...o),u},Object.defineProperty(t[e],"name",{value:"".concat(e,"-to-cache"),configurable:!1})}function NS(t){const e=t.useProgram.bind(t);t.useProgram=function(r){t.state.program!==r&&(e(r),t.state.program=r)}}class DS{constructor(e){let{copyState:n=!1,log:r=()=>{}}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.program=null,this.stateStack=[],this.enable=!0,this.cache=n?US(e):Object.assign({},Kf),this.log=r,this._updateCache=this._updateCache.bind(this),Object.seal(this)}push(){this.stateStack.push({})}pop(){ze(this.stateStack.length>0);const e=this.stateStack[this.stateStack.length-1];gn(this.gl,e),this.stateStack.pop()}_updateCache(e){let n=!1,r;const i=this.stateStack.length>0&&this.stateStack[this.stateStack.length-1];for(const s in e){ze(s!==void 0);const o=e[s],a=this.cache[s];OS(o,a)||(n=!0,r=a,i&&!(s in i)&&(i[s]=a),this.cache[s]=o)}return{valueChanged:n,oldValue:r}}}function j_(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{enable:n=!0,copyState:r}=e;if(ze(r!==void 0),!t.state){const{polyfillContext:i}=globalThis;i&&i(t),t.state=new DS(t,{copyState:r}),NS(t);for(const s in Rg){const o=Rg[s];kS(t,s,o)}Og(t,"getParameter"),Og(t,"isEnabled")}return t.state.enable=n,t}function FS(t){t.state||j_(t,{copyState:!1}),t.state.push()}function kg(t){ze(t.state),t.state.pop()}function gn(t,e){if(ze(ul(t),"setParameters requires a WebGL context"),V_(e))return;const n={};for(const i in e){const s=Number(i),o=RS[i];o&&(typeof o=="string"?n[o]=!0:o(t,e[i],s))}const r=t.state&&t.state.cache;if(r)for(const i in n){const s=IS[i];s(t,e,r)}}function US(t,e){if(e=e||Kf,typeof e=="number"){const i=e,s=Ig[i];return s?s(t,i):t.getParameter(i)}const n=Array.isArray(e)?e:Object.keys(e),r={};for(const i of n){const s=Ig[i];r[i]=s?s(t,Number(i)):t.getParameter(Number(i))}return r}function BS(t){gn(t,Kf)}function Ct(t,e,n){if(V_(e))return n(t);const{nocatch:r=!0}=e;FS(t),gn(t,e);let i;if(r)i=n(t),kg(t);else try{i=n(t)}finally{kg(t)}return i}function mr(t){const{luma:e}=t;if(t.canvas&&e){const n=e.canvasSizeInfo,r="clientWidth"in n?n.clientWidth:t.canvas.clientWidth;return r?t.drawingBufferWidth/r:1}return 1}function su(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const r=mr(t),i=t.drawingBufferWidth,s=t.drawingBufferHeight;return VS(e,r,i,s,n)}function zS(t){const e=typeof window>"u"?1:window.devicePixelRatio||1;return Number.isFinite(t)?t<=0?1:t:t?e:1}function VS(t,e,n,r,i){const s=Ng(t[0],e,n);let o=Dg(t[1],e,r,i),a=Ng(t[0]+1,e,n);const l=a===n-1?a:a-1;a=Dg(t[1]+1,e,r,i);let u;return i?(a=a===0?a:a+1,u=o,o=a):u=a===r-1?a:a-1,{x:s,y:o,width:Math.max(l-s+1,1),height:Math.max(u-o+1,1)}}function Ng(t,e,n){return Math.min(Math.round(t*e),n-1)}function Dg(t,e,n,r){return r?Math.max(0,n-1-Math.round(t*e)):Math.min(Math.round(t*e),n-1)}const Jf=_n(),jS=Jf&&typeof document<"u",G_={webgl2:!0,webgl1:!0,throwOnError:!0,manageState:!0,canvas:null,debug:!1,width:800,height:600};function H_(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};ze(Jf,`createGLContext only available in the browser.
Create your own headless context or use 'createHeadlessContext' from @luma.gl/test-utils`),t=Object.assign({},G_,t);const{width:e,height:n}=t;function r(a){if(t.throwOnError)throw new Error(a);return console.error(a),null}t.onError=r;let i;const{canvas:s}=t,o=XS({canvas:s,width:e,height:n,onError:r});return i=WS(o,t),i?(i=eh(i,t),YS(i),i):null}function eh(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!t||t._instrumented)return t;t._version=t._version||$S(t),t.luma=t.luma||{},t.luma.canvasSizeInfo=t.luma.canvasSizeInfo||{},e=Object.assign({},G_,e);const{manageState:n,debug:r}=e;return n&&j_(t,{copyState:!1,log:function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return U.log(1,...s)()}}),Jf&&r&&(globalThis.makeDebugContext?(t=globalThis.makeDebugContext(t,e),U.level=Math.max(U.level,1)):U.warn('WebGL debug mode not activated. import "@luma.gl/debug" to enable.')()),t._instrumented=!0,t}function GS(t){const e=t.getParameter(7936),n=t.getParameter(7937),r=t.getExtension("WEBGL_debug_renderer_info"),i=r&&t.getParameter(r.UNMASKED_VENDOR_WEBGL||7936),s=r&&t.getParameter(r.UNMASKED_RENDERER_WEBGL||7937);return{vendor:i||e,renderer:s||n,vendorMasked:e,rendererMasked:n,version:t.getParameter(7938),shadingLanguageVersion:t.getParameter(35724)}}function HS(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t.canvas){const r=zS(e.useDevicePixels);qS(t,r,e);return}const n=t.getExtension("STACKGL_resize_drawingbuffer");n&&"width"in e&&"height"in e&&n.resize(e.width,e.height)}function WS(t,e){const{onError:n}=e;let r=null;const i=l=>r=l.statusMessage||r;t.addEventListener("webglcontextcreationerror",i,!1);const{webgl1:s=!0,webgl2:o=!0}=e;let a=null;return o&&(a=a||t.getContext("webgl2",e),a=a||t.getContext("experimental-webgl2",e)),s&&(a=a||t.getContext("webgl",e),a=a||t.getContext("experimental-webgl",e)),t.removeEventListener("webglcontextcreationerror",i,!1),a?(e.onContextLost&&t.addEventListener("webglcontextlost",e.onContextLost,!1),e.onContextRestored&&t.addEventListener("webglcontextrestored",e.onContextRestored,!1),a):n("Failed to create ".concat(o&&!s?"WebGL2":"WebGL"," context: ").concat(r||"Unknown error"))}function XS(t){let{canvas:e,width:n=800,height:r=600,onError:i}=t,s;return typeof e=="string"?(jS&&document.readyState==="complete"||i("createGLContext called on canvas '".concat(e,"' before page was loaded")),s=document.getElementById(e)):e?s=e:(s=document.createElement("canvas"),s.id="lumagl-canvas",s.style.width=Number.isFinite(n)?"".concat(n,"px"):"100%",s.style.height=Number.isFinite(r)?"".concat(r,"px"):"100%",document.body.insertBefore(s,document.body.firstChild)),s}function YS(t){const e=H(t)?"WebGL2":"WebGL1",n=GS(t),r=n?"(".concat(n.vendor,",").concat(n.renderer,")"):"",i=t.debug?" debug":"";U.info(1,"".concat(e).concat(i," context ").concat(r))()}function $S(t){return typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?2:1}function qS(t,e,n){let r="width"in n?n.width:t.canvas.clientWidth,i="height"in n?n.height:t.canvas.clientHeight;(!r||!i)&&(U.log(1,"Canvas clientWidth/clientHeight is 0")(),e=1,r=t.canvas.width||1,i=t.canvas.height||1),t.luma=t.luma||{},t.luma.canvasSizeInfo=t.luma.canvasSizeInfo||{};const s=t.luma.canvasSizeInfo;if(s.clientWidth!==r||s.clientHeight!==i||s.devicePixelRatio!==e){let o=e;const a=Math.floor(r*o),l=Math.floor(i*o);t.canvas.width=a,t.canvas.height=l,(t.drawingBufferWidth!==a||t.drawingBufferHeight!==l)&&(U.warn("Device pixel ratio clamped")(),o=Math.min(t.drawingBufferWidth/r,t.drawingBufferHeight/i),t.canvas.width=Math.floor(r*o),t.canvas.height=Math.floor(i*o)),Object.assign(t.luma.canvasSizeInfo,{clientWidth:r,clientHeight:i,devicePixelRatio:e})}}const ds="8.5.21",ZS="set luma.log.level=1 (or higher) to trace rendering";class QS{constructor(){this.stats=new Map}get(e){return this.stats.has(e)||this.stats.set(e,new Wf({id:e})),this.stats.get(e)}}const ar=new QS;if(globalThis.luma&&globalThis.luma.VERSION!==ds)throw new Error("luma.gl - multiple VERSIONs detected: ".concat(globalThis.luma.VERSION," vs ").concat(ds));globalThis.luma||(_n()&&U.log(1,"luma.gl ".concat(ds," - ").concat(ZS))(),globalThis.luma=globalThis.luma||{VERSION:ds,version:ds,log:U,stats:ar,globals:{modules:{},nodeIO:{}}});function KS(t){return typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame(t):setTimeout(t,1e3/60)}function JS(t){return typeof window<"u"&&window.cancelAnimationFrame?window.cancelAnimationFrame(t):clearTimeout(t)}function k(t,e){if(!t)throw new Error(e||"luma.gl: assertion failed.")}function ou(t,e){if(typeof e!="string")return e;const n=Number(e);if(!isNaN(n))return n;e=e.replace(/^.*\./,"");const r=t[e];return k(r!==void 0,"Accessing undefined constant GL.".concat(e)),r}function jn(t,e){e=Number(e);for(const n in t)if(t[n]===e)return"GL.".concat(n);return String(e)}const au={};function Xt(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"id";au[t]=au[t]||1;const e=au[t]++;return"".concat(t,"-").concat(e)}function Fg(t){return k(typeof t=="number","Input must be a number"),t&&(t&t-1)===0}function di(t){let e=!0;for(const n in t){e=!1;break}return e}function W_(t,e,n,r){const i="See luma.gl ".concat(n," Upgrade Guide at https://luma.gl/docs/upgrade-guide"),s=Object.getPrototypeOf(t);r.forEach(o=>{s.methodName||(s[o]=()=>{throw U.removed("Calling removed method ".concat(e,".").concat(o,": "),i)(),new Error(o)})})}const Rr="Resource subclass must define virtual methods";let vn=class{get[Symbol.toStringTag](){return"Resource"}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};cl(e);const{id:r,userData:i={}}=n;this.gl=e,this.gl2=e,this.id=r||Xt(this[Symbol.toStringTag]),this.userData=i,this._bound=!1,this._handle=n.handle,this._handle===void 0&&(this._handle=this._createHandle()),this.byteLength=0,this._addStats()}toString(){return"".concat(this[Symbol.toStringTag]||this.constructor.name,"(").concat(this.id,")")}get handle(){return this._handle}delete(){let{deleteChildren:e=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=this._handle&&this._deleteHandle(this._handle);return this._handle&&this._removeStats(),this._handle=null,n&&e&&n.filter(Boolean).forEach(r=>r.delete()),this}bind(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.handle;if(typeof e!="function")return this._bindHandle(e),this;let n;return this._bound?n=e():(this._bindHandle(this.handle),this._bound=!0,n=e(),this._bound=!1,this._bindHandle(null)),n}unbind(){this.bind(null)}getParameter(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};e=ou(this.gl,e),k(e);const i=(this.constructor.PARAMETERS||{})[e];if(i){const s=H(this.gl);if(!((!("webgl2"in i)||s)&&(!("extension"in i)||this.gl.getExtension(i.extension)))){const a=i.webgl1,l="webgl2"in i?i.webgl2:i.webgl1;return s?l:a}}return this._getParameter(e,n)}getParameters(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{parameters:n,keys:r}=e,i=this.constructor.PARAMETERS||{},s=H(this.gl),o={},a=n||Object.keys(i);for(const l of a){const u=i[l];if(u&&(!("webgl2"in u)||s)&&(!("extension"in u)||this.gl.getExtension(u.extension))){const f=r?jn(this.gl,l):l;o[f]=this.getParameter(l,e),r&&u.type==="GLenum"&&(o[f]=jn(this.gl,o[f]))}}return o}setParameter(e,n){e=ou(this.gl,e),k(e);const i=(this.constructor.PARAMETERS||{})[e];if(i){const s=H(this.gl);if(!((!("webgl2"in i)||s)&&(!("extension"in i)||this.gl.getExtension(i.extension))))throw new Error("Parameter not available on this platform");i.type==="GLenum"&&(n=ou(n))}return this._setParameter(e,n),this}setParameters(e){for(const n in e)this.setParameter(n,e[n]);return this}stubRemovedMethods(e,n,r){return W_(this,e,n,r)}initialize(e){}_createHandle(){throw new Error(Rr)}_deleteHandle(){throw new Error(Rr)}_bindHandle(e){throw new Error(Rr)}_getOptsFromHandle(){throw new Error(Rr)}_getParameter(e,n){throw new Error(Rr)}_setParameter(e,n){throw new Error(Rr)}_context(){return this.gl.luma=this.gl.luma||{},this.gl.luma}_addStats(){const e=this[Symbol.toStringTag],n=ar.get("Resource Counts");n.get("Resources Created").incrementCount(),n.get("".concat(e,"s Created")).incrementCount(),n.get("".concat(e,"s Active")).incrementCount()}_removeStats(){const e=this[Symbol.toStringTag];ar.get("Resource Counts").get("".concat(e,"s Active")).decrementCount()}_trackAllocatedMemory(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this[Symbol.toStringTag];this._trackAllocatedMemoryForContext(e,n),this._trackAllocatedMemoryForContext(e,n,this.gl.canvas&&this.gl.canvas.id),this.byteLength=e}_trackAllocatedMemoryForContext(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this[Symbol.toStringTag],r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";const i=ar.get("Memory Usage".concat(r));i.get("GPU Memory").addCount(e),i.get("".concat(n," Memory")).addCount(e)}_trackDeallocatedMemory(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this[Symbol.toStringTag];this._trackDeallocatedMemoryForContext(e),this._trackDeallocatedMemoryForContext(e,this.gl.canvas&&this.gl.canvas.id),this.byteLength=0}_trackDeallocatedMemoryForContext(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this[Symbol.toStringTag],n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";const r=ar.get("Memory Usage".concat(n));r.get("GPU Memory").subtractCount(this.byteLength),r.get("".concat(e," Memory")).subtractCount(this.byteLength)}};const eA="Failed to deduce GL constant from typed array";function Pc(t){switch(ArrayBuffer.isView(t)?t.constructor:t){case Float32Array:return 5126;case Uint16Array:return 5123;case Uint32Array:return 5125;case Uint8Array:return 5121;case Uint8ClampedArray:return 5121;case Int8Array:return 5120;case Int16Array:return 5122;case Int32Array:return 5124;default:throw new Error(eA)}}function Os(t){let{clamped:e=!0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};switch(t){case 5126:return Float32Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return e?Uint8ClampedArray:Uint8Array;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Failed to deduce typed array type from GL constant")}}function tA(t){let{data:e,width:n,height:r,bytesPerPixel:i=4,temp:s}=t;const o=n*i;s=s||new Uint8Array(o);for(let a=0;a<r/2;++a){const l=a*o,u=(r-a-1)*o;s.set(e.subarray(l,l+o)),e.copyWithin(l,u,u+o),e.set(s,u)}}function nA(t){let{data:e,width:n,height:r}=t;const i=Math.round(n/2),s=Math.round(r/2),o=new Uint8Array(i*s*4);for(let a=0;a<s;a++)for(let l=0;l<i;l++)for(let u=0;u<4;u++)o[(a*i+l)*4+u]=e[(a*2*n+l*2)*4+u];return{data:o,width:i,height:s}}function Lc(t,e,n){const{removedProps:r={},deprecatedProps:i={},replacedProps:s={}}=n;for(const a in r)if(a in e){const u=r[a]?"".concat(t,".").concat(r[a]):"N/A";U.removed("".concat(t,".").concat(a),u)()}for(const a in i)if(a in e){const l=i[a];U.deprecated("".concat(t,".").concat(a),"".concat(t,".").concat(l))()}let o=null;for(const a in s)if(a in e){const l=s[a];U.deprecated("".concat(t,".").concat(a),"".concat(t,".").concat(l))(),o=o||Object.assign({},e),o[l]=e[a],delete o[a]}return o||e}const rA={offset:0,stride:0,type:5126,size:1,divisor:0,normalized:!1,integer:!1},iA={deprecatedProps:{instanced:"divisor",isInstanced:"divisor"}};class nt{static getBytesPerElement(e){return Os(e.type||5126).BYTES_PER_ELEMENT}static getBytesPerVertex(e){return k(e.size),Os(e.type||5126).BYTES_PER_ELEMENT*e.size}static resolve(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new nt(rA,...n)}constructor(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];n.forEach(i=>this._assign(i)),Object.freeze(this)}toString(){return JSON.stringify(this)}get BYTES_PER_ELEMENT(){return nt.getBytesPerElement(this)}get BYTES_PER_VERTEX(){return nt.getBytesPerVertex(this)}_assign(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return e=Lc("Accessor",e,iA),e.type!==void 0&&(this.type=e.type,(e.type===5124||e.type===5125)&&(this.integer=!0)),e.size!==void 0&&(this.size=e.size),e.offset!==void 0&&(this.offset=e.offset),e.stride!==void 0&&(this.stride=e.stride),e.normalized!==void 0&&(this.normalized=e.normalized),e.integer!==void 0&&(this.integer=e.integer),e.divisor!==void 0&&(this.divisor=e.divisor),e.buffer!==void 0&&(this.buffer=e.buffer),e.index!==void 0&&(typeof e.index=="boolean"?this.index=e.index?1:0:this.index=e.index),e.instanced!==void 0&&(this.divisor=e.instanced?1:0),e.isInstanced!==void 0&&(this.divisor=e.isInstanced?1:0),this}}const Ug=10,X_={offset:"accessor.offset",stride:"accessor.stride",type:"accessor.type",size:"accessor.size",divisor:"accessor.divisor",normalized:"accessor.normalized",integer:"accessor.integer",instanced:"accessor.divisor",isInstanced:"accessor.divisor"},sA={removedProps:{},replacedProps:{bytes:"byteLength"},deprecatedProps:X_},oA={removedProps:X_};class J extends vn{get[Symbol.toStringTag](){return"Buffer"}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.stubRemovedMethods("Buffer","v6.0",["layout","setLayout","getIndexedParameter"]),this.target=n.target||(this.gl.webgl2?36662:34962),this.initialize(n),Object.seal(this)}getElementCount(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.accessor;return Math.round(this.byteLength/nt.getBytesPerElement(e))}getVertexCount(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.accessor;return Math.round(this.byteLength/nt.getBytesPerVertex(e))}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return ArrayBuffer.isView(e)&&(e={data:e}),Number.isFinite(e)&&(e={byteLength:e}),e=Lc("Buffer",e,sA),this.usage=e.usage||35044,this.debugData=null,this.setAccessor(Object.assign({},e,e.accessor)),e.data?this._setData(e.data,e.offset,e.byteLength):this._setByteLength(e.byteLength||0),this}setProps(e){return e=Lc("Buffer",e,oA),"accessor"in e&&this.setAccessor(e.accessor),this}setAccessor(e){return e=Object.assign({},e),delete e.buffer,this.accessor=new nt(e),this}reallocate(e){return e>this.byteLength?(this._setByteLength(e),!0):(this.bytesUsed=e,!1)}setData(e){return this.initialize(e)}subData(e){ArrayBuffer.isView(e)&&(e={data:e});const{data:n,offset:r=0,srcOffset:i=0}=e,s=e.byteLength||e.length;k(n);const o=this.gl.webgl2?36663:this.target;return this.gl.bindBuffer(o,this.handle),i!==0||s!==void 0?(Ve(this.gl),this.gl.bufferSubData(this.target,r,n,i,s)):this.gl.bufferSubData(o,r,n),this.gl.bindBuffer(o,null),this.debugData=null,this._inferType(n),this}copyData(e){let{sourceBuffer:n,readOffset:r=0,writeOffset:i=0,size:s}=e;const{gl:o}=this;return Ve(o),o.bindBuffer(36662,n.handle),o.bindBuffer(36663,this.handle),o.copyBufferSubData(36662,36663,r,i,s),o.bindBuffer(36662,null),o.bindBuffer(36663,null),this.debugData=null,this}getData(){let{dstData:e=null,srcByteOffset:n=0,dstOffset:r=0,length:i=0}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Ve(this.gl);const s=Os(this.accessor.type||5126,{clamped:!1}),o=this._getAvailableElementCount(n),a=r;let l,u;e?(u=e.length,l=u-a):(l=Math.min(o,i||o),u=a+l);const c=Math.min(o,l);return i=i||c,k(i<=c),e=e||new s(u),this.gl.bindBuffer(36662,this.handle),this.gl.getBufferSubData(36662,n,e,r,i),this.gl.bindBuffer(36662,null),e}bind(){let{target:e=this.target,index:n=this.accessor&&this.accessor.index,offset:r=0,size:i}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return e===35345||e===35982?i!==void 0?this.gl.bindBufferRange(e,n,this.handle,r,i):(k(r===0),this.gl.bindBufferBase(e,n,this.handle)):this.gl.bindBuffer(e,this.handle),this}unbind(){let{target:e=this.target,index:n=this.accessor&&this.accessor.index}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return e===35345||e===35982?this.gl.bindBufferBase(e,n,null):this.gl.bindBuffer(e,null),this}getDebugData(){return this.debugData?{data:this.debugData,changed:!1}:(this.debugData=this.getData({length:Math.min(Ug,this.byteLength)}),{data:this.debugData,changed:!0})}invalidateDebugData(){this.debugData=null}_setData(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e.byteLength+n;k(ArrayBuffer.isView(e)),this._trackDeallocatedMemory();const i=this._getTarget();this.gl.bindBuffer(i,this.handle),this.gl.bufferData(i,r,this.usage),this.gl.bufferSubData(i,n,e),this.gl.bindBuffer(i,null),this.debugData=e.slice(0,Ug),this.bytesUsed=r,this._trackAllocatedMemory(r);const s=Pc(e);return k(s),this.setAccessor(new nt(this.accessor,{type:s})),this}_setByteLength(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.usage;k(e>=0),this._trackDeallocatedMemory();let r=e;e===0&&(r=new Float32Array(0));const i=this._getTarget();return this.gl.bindBuffer(i,this.handle),this.gl.bufferData(i,r,n),this.gl.bindBuffer(i,null),this.usage=n,this.debugData=null,this.bytesUsed=e,this._trackAllocatedMemory(e),this}_getTarget(){return this.gl.webgl2?36663:this.target}_getAvailableElementCount(e){const n=Os(this.accessor.type||5126,{clamped:!1}),r=e/n.BYTES_PER_ELEMENT;return this.getElementCount()-r}_inferType(e){this.accessor.type||this.setAccessor(new nt(this.accessor,{type:Pc(e)}))}_createHandle(){return this.gl.createBuffer()}_deleteHandle(){this.gl.deleteBuffer(this.handle),this._trackDeallocatedMemory()}_getParameter(e){this.gl.bindBuffer(this.target,this.handle);const n=this.gl.getBufferParameter(this.target,e);return this.gl.bindBuffer(this.target,null),n}get type(){return U.deprecated("Buffer.type","Buffer.accessor.type")(),this.accessor.type}get bytes(){return U.deprecated("Buffer.bytes","Buffer.byteLength")(),this.byteLength}setByteLength(e){return U.deprecated("setByteLength","reallocate")(),this.reallocate(e)}updateAccessor(e){return U.deprecated("updateAccessor(...)","setAccessor(new Accessor(buffer.accessor, ...)")(),this.accessor=new nt(this.accessor,e),this}}const th={6407:{dataFormat:6407,types:[5121,33635]},6408:{dataFormat:6408,types:[5121,32819,32820]},6406:{dataFormat:6406,types:[5121]},6409:{dataFormat:6409,types:[5121]},6410:{dataFormat:6410,types:[5121]},33326:{dataFormat:6403,types:[5126],gl2:!0},33328:{dataFormat:33319,types:[5126],gl2:!0},34837:{dataFormat:6407,types:[5126],gl2:!0},34836:{dataFormat:6408,types:[5126],gl2:!0}},Y_={6403:1,36244:1,33319:2,33320:2,6407:3,36248:3,6408:4,36249:4,6402:1,34041:1,6406:1,6409:1,6410:2},$_={5126:4,5125:4,5124:4,5123:2,5122:2,5131:2,5120:1,5121:1};function aA(t,e){const n=th[e];if(!n)return!1;if(n.gl1===void 0&&n.gl2===void 0)return!0;const r=H(t)&&n.gl2||n.gl1;return typeof r=="string"?t.getExtension(r):r}function lA(t,e){const n=th[e];switch(n&&n.types[0]){case 5126:return t.getExtension("OES_texture_float_linear");case 5131:return t.getExtension("OES_texture_half_float_linear");default:return!0}}const uA=[9729,9728],Bg=globalThis.WebGLBuffer||function(){};class gi extends vn{get[Symbol.toStringTag](){return"Texture"}static isSupported(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{format:r,linearFiltering:i}=n;let s=!0;return r&&(s=s&&aA(e,r),s=s&&(!i||lA(e,r))),s}constructor(e,n){const{id:r=Xt("texture"),handle:i,target:s}=n;super(e,{id:r,handle:i}),this.target=s,this.textureUnit=void 0,this.loaded=!1,this.width=void 0,this.height=void 0,this.depth=void 0,this.format=void 0,this.type=void 0,this.dataFormat=void 0,this.border=void 0,this.textureUnit=void 0,this.mipmaps=void 0}toString(){return"Texture(".concat(this.id,",").concat(this.width,"x").concat(this.height,")")}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=e.data;if(n instanceof Promise)return n.then(m=>this.initialize(Object.assign({},e,{pixels:m,data:m}))),this;const r=typeof HTMLVideoElement<"u"&&n instanceof HTMLVideoElement;if(r&&n.readyState<HTMLVideoElement.HAVE_METADATA)return this._video=null,n.addEventListener("loadeddata",()=>this.initialize(e)),this;const{pixels:i=null,format:s=6408,border:o=0,recreate:a=!1,parameters:l={},pixelStore:u={},textureUnit:c=void 0}=e;n||(n=i);let{width:f,height:h,dataFormat:p,type:E,compressed:w=!1,mipmaps:S=!0}=e;const{depth:_=0}=e;return{width:f,height:h,compressed:w,dataFormat:p,type:E}=this._deduceParameters({format:s,type:E,dataFormat:p,compressed:w,data:n,width:f,height:h}),this.width=f,this.height=h,this.depth=_,this.format=s,this.type=E,this.dataFormat=p,this.border=o,this.textureUnit=c,Number.isFinite(this.textureUnit)&&(this.gl.activeTexture(33984+this.textureUnit),this.gl.bindTexture(this.target,this.handle)),S&&this._isNPOT()&&(U.warn("texture: ".concat(this," is Non-Power-Of-Two, disabling mipmaping"))(),S=!1,this._updateForNPOT(l)),this.mipmaps=S,this.setImageData({data:n,width:f,height:h,depth:_,format:s,type:E,dataFormat:p,border:o,mipmaps:S,parameters:u,compressed:w}),S&&this.generateMipmap(),this.setParameters(l),a&&(this.data=n),r&&(this._video={video:n,parameters:l,lastTime:n.readyState>=HTMLVideoElement.HAVE_CURRENT_DATA?n.currentTime:-1}),this}update(){if(this._video){const{video:e,parameters:n,lastTime:r}=this._video;if(r===e.currentTime||e.readyState<HTMLVideoElement.HAVE_CURRENT_DATA)return;this.setSubImageData({data:e,parameters:n}),this.mipmaps&&this.generateMipmap(),this._video.lastTime=e.currentTime}}resize(e){let{height:n,width:r,mipmaps:i=!1}=e;return r!==this.width||n!==this.height?this.initialize({width:r,height:n,format:this.format,type:this.type,dataFormat:this.dataFormat,border:this.border,mipmaps:i}):this}generateMipmap(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this._isNPOT()?(U.warn("texture: ".concat(this," is Non-Power-Of-Two, disabling mipmaping"))(),this):(this.mipmaps=!0,this.gl.bindTexture(this.target,this.handle),Ct(this.gl,e,()=>{this.gl.generateMipmap(this.target)}),this.gl.bindTexture(this.target,null),this)}setImageData(e){this._trackDeallocatedMemory("Texture");const{target:n=this.target,pixels:r=null,level:i=0,format:s=this.format,border:o=this.border,offset:a=0,parameters:l={}}=e;let{data:u=null,type:c=this.type,width:f=this.width,height:h=this.height,dataFormat:p=this.dataFormat,compressed:E=!1}=e;u||(u=r),{type:c,dataFormat:p,compressed:E,width:f,height:h}=this._deduceParameters({format:s,type:c,dataFormat:p,compressed:E,data:u,width:f,height:h});const{gl:w}=this;w.bindTexture(this.target,this.handle);let S=null;({data:u,dataType:S}=this._getDataType({data:u,compressed:E}));let _,m=0;if(Ct(this.gl,l,()=>{switch(S){case"null":w.texImage2D(n,i,s,f,h,o,p,c,u);break;case"typed-array":w.texImage2D(n,i,s,f,h,o,p,c,u,a);break;case"buffer":_=Ve(w),_.bindBuffer(35052,u.handle||u),_.texImage2D(n,i,s,f,h,o,p,c,a),_.bindBuffer(35052,null);break;case"browser-object":H(w)?w.texImage2D(n,i,s,f,h,o,p,c,u):w.texImage2D(n,i,s,p,c,u);break;case"compressed":for(const[y,b]of u.entries())w.compressedTexImage2D(n,y,b.format,b.width,b.height,o,b.data),m+=b.levelSize;break;default:k(!1,"Unknown image data type")}}),S==="compressed")this._trackAllocatedMemory(m,"Texture");else if(u&&u.byteLength)this._trackAllocatedMemory(u.byteLength,"Texture");else{const y=Y_[this.dataFormat]||4,b=$_[this.type]||1;this._trackAllocatedMemory(this.width*this.height*y*b,"Texture")}return this.loaded=!0,this}setSubImageData(e){let{target:n=this.target,pixels:r=null,data:i=null,x:s=0,y:o=0,width:a=this.width,height:l=this.height,level:u=0,format:c=this.format,type:f=this.type,dataFormat:h=this.dataFormat,compressed:p=!1,offset:E=0,border:w=this.border,parameters:S={}}=e;if({type:f,dataFormat:h,compressed:p,width:a,height:l}=this._deduceParameters({format:c,type:f,dataFormat:h,compressed:p,data:i,width:a,height:l}),k(this.depth===0,"texSubImage not supported for 3D textures"),i||(i=r),i&&i.data){const _=i;i=_.data,a=_.shape[0],l=_.shape[1]}i instanceof J&&(i=i.handle),this.gl.bindTexture(this.target,this.handle),Ct(this.gl,S,()=>{if(p)this.gl.compressedTexSubImage2D(n,u,s,o,a,l,c,i);else if(i===null)this.gl.texSubImage2D(n,u,s,o,a,l,h,f,null);else if(ArrayBuffer.isView(i))this.gl.texSubImage2D(n,u,s,o,a,l,h,f,i,E);else if(i instanceof Bg){const _=Ve(this.gl);_.bindBuffer(35052,i),_.texSubImage2D(n,u,s,o,a,l,h,f,E),_.bindBuffer(35052,null)}else H(this.gl)?Ve(this.gl).texSubImage2D(n,u,s,o,a,l,h,f,i):this.gl.texSubImage2D(n,u,s,o,h,f,i)}),this.gl.bindTexture(this.target,null)}copyFramebuffer(){return U.error("Texture.copyFramebuffer({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}getActiveUnit(){return this.gl.getParameter(34016)-33984}bind(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.textureUnit;const{gl:n}=this;return e!==void 0&&(this.textureUnit=e,n.activeTexture(33984+e)),n.bindTexture(this.target,this.handle),e}unbind(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.textureUnit;const{gl:n}=this;return e!==void 0&&(this.textureUnit=e,n.activeTexture(33984+e)),n.bindTexture(this.target,null),e}_getDataType(e){let{data:n,compressed:r=!1}=e;return r?{data:n,dataType:"compressed"}:n===null?{data:n,dataType:"null"}:ArrayBuffer.isView(n)?{data:n,dataType:"typed-array"}:n instanceof J?{data:n.handle,dataType:"buffer"}:n instanceof Bg?{data:n,dataType:"buffer"}:{data:n,dataType:"browser-object"}}_deduceParameters(e){const{format:n,data:r}=e;let{width:i,height:s,dataFormat:o,type:a,compressed:l}=e;const u=th[n];return o=o||u&&u.dataFormat,a=a||u&&u.types[0],l=l||u&&u.compressed,{width:i,height:s}=this._deduceImageSize(r,i,s),{dataFormat:o,type:a,compressed:l,width:i,height:s,format:n,data:r}}_deduceImageSize(e,n,r){let i;return typeof ImageData<"u"&&e instanceof ImageData?i={width:e.width,height:e.height}:typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement?i={width:e.naturalWidth,height:e.naturalHeight}:typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement?i={width:e.width,height:e.height}:typeof ImageBitmap<"u"&&e instanceof ImageBitmap?i={width:e.width,height:e.height}:typeof HTMLVideoElement<"u"&&e instanceof HTMLVideoElement?i={width:e.videoWidth,height:e.videoHeight}:e?i={width:n,height:r}:i={width:n>=0?n:1,height:r>=0?r:1},k(i,"Could not deduced texture size"),k(n===void 0||i.width===n,"Deduced texture width does not match supplied width"),k(r===void 0||i.height===r,"Deduced texture height does not match supplied height"),i}_createHandle(){return this.gl.createTexture()}_deleteHandle(){this.gl.deleteTexture(this.handle),this._trackDeallocatedMemory("Texture")}_getParameter(e){switch(e){case 4096:return this.width;case 4097:return this.height;default:this.gl.bindTexture(this.target,this.handle);const n=this.gl.getTexParameter(this.target,e);return this.gl.bindTexture(this.target,null),n}}_setParameter(e,n){switch(this.gl.bindTexture(this.target,this.handle),n=this._getNPOTParam(e,n),e){case 33082:case 33083:this.gl.texParameterf(this.handle,e,n);break;case 4096:case 4097:k(!1);break;default:this.gl.texParameteri(this.target,e,n);break}return this.gl.bindTexture(this.target,null),this}_isNPOT(){return H(this.gl)||!this.width||!this.height?!1:!Fg(this.width)||!Fg(this.height)}_updateForNPOT(e){e[this.gl.TEXTURE_MIN_FILTER]===void 0&&(e[this.gl.TEXTURE_MIN_FILTER]=this.gl.LINEAR),e[this.gl.TEXTURE_WRAP_S]===void 0&&(e[this.gl.TEXTURE_WRAP_S]=this.gl.CLAMP_TO_EDGE),e[this.gl.TEXTURE_WRAP_T]===void 0&&(e[this.gl.TEXTURE_WRAP_T]=this.gl.CLAMP_TO_EDGE)}_getNPOTParam(e,n){if(this._isNPOT())switch(e){case 10241:uA.indexOf(n)===-1&&(n=9729);break;case 10242:case 10243:n!==33071&&(n=33071);break}return n}}let cA="";function fA(t,e){return k(typeof t=="string"),t=cA+t,new Promise((n,r)=>{try{const i=new Image;i.onload=()=>n(i),i.onerror=()=>r(new Error("Could not load image ".concat(t,"."))),i.crossOrigin=e&&e.crossOrigin||"anonymous",i.src=t}catch(i){r(i)}})}class Rt extends gi{get[Symbol.toStringTag](){return"Texture2D"}static isSupported(e,n){return gi.isSupported(e,n)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};cl(e),(n instanceof Promise||typeof n=="string")&&(n={data:n}),typeof n.data=="string"&&(n=Object.assign({},n,{data:fA(n.data)})),super(e,Object.assign({},n,{target:3553})),this.initialize(n),Object.seal(this)}}const Cc=[34069,34070,34071,34072,34073,34074];class q_ extends gi{get[Symbol.toStringTag](){return"TextureCube"}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};cl(e),super(e,Object.assign({},n,{target:34067})),this.initialize(n),Object.seal(this)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{mipmaps:n=!0,parameters:r={}}=e;return this.opts=e,this.setCubeMapImageData(e).then(()=>{this.loaded=!0,n&&this.generateMipmap(e),this.setParameters(r)}),this}subImage(e){let{face:n,data:r,x:i=0,y:s=0,mipmapLevel:o=0}=e;return this._subImage({target:n,data:r,x:i,y:s,mipmapLevel:o})}async setCubeMapImageData(e){let{width:n,height:r,pixels:i,data:s,border:o=0,format:a=6408,type:l=5121}=e;const{gl:u}=this,c=i||s,f=await Promise.all(Cc.map(h=>{const p=c[h];return Promise.all(Array.isArray(p)?p:[p])}));this.bind(),Cc.forEach((h,p)=>{f[p].length>1&&this.opts.mipmaps!==!1&&U.warn("".concat(this.id," has mipmap and multiple LODs."))(),f[p].forEach((E,w)=>{n&&r?u.texImage2D(h,w,a,n,r,o,a,l,E):u.texImage2D(h,w,a,a,l,E)})}),this.unbind()}setImageDataForFace(e){const{face:n,width:r,height:i,pixels:s,data:o,border:a=0,format:l=6408,type:u=5121}=e,{gl:c}=this,f=s||o;return this.bind(),f instanceof Promise?f.then(h=>this.setImageDataForFace(Object.assign({},e,{face:n,data:h,pixels:h}))):this.width||this.height?c.texImage2D(n,0,l,r,i,a,l,u,f):c.texImage2D(n,0,l,l,u,f),this}}q_.FACES=Cc;class hA extends gi{get[Symbol.toStringTag](){return"Texture3D"}static isSupported(e){return H(e)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Ve(e),n=Object.assign({depth:1},n,{target:32879,unpackFlipY:!1}),super(e,n),this.initialize(n),Object.seal(this)}setImageData(e){let{level:n=0,dataFormat:r=6408,width:i,height:s,depth:o=1,border:a=0,format:l,type:u=5121,offset:c=0,data:f,parameters:h={}}=e;if(this._trackDeallocatedMemory("Texture"),this.gl.bindTexture(this.target,this.handle),Ct(this.gl,h,()=>{ArrayBuffer.isView(f)&&this.gl.texImage3D(this.target,n,r,i,s,o,a,l,u,f),f instanceof J&&(this.gl.bindBuffer(35052,f.handle),this.gl.texImage3D(this.target,n,r,i,s,o,a,l,u,c))}),f&&f.byteLength)this._trackAllocatedMemory(f.byteLength,"Texture");else{const p=Y_[this.dataFormat]||4,E=$_[this.type]||1;this._trackAllocatedMemory(this.width*this.height*this.depth*p*E,"Texture")}return this.loaded=!0,this}}const Kn="EXT_color_buffer_float",zg={33189:{bpp:2},33190:{gl2:!0,bpp:3},36012:{gl2:!0,bpp:4},36168:{bpp:1},34041:{bpp:4},35056:{gl2:!0,bpp:4},36013:{gl2:!0,bpp:5},32854:{bpp:2},36194:{bpp:2},32855:{bpp:2},33321:{gl2:!0,bpp:1},33330:{gl2:!0,bpp:1},33329:{gl2:!0,bpp:1},33332:{gl2:!0,bpp:2},33331:{gl2:!0,bpp:2},33334:{gl2:!0,bpp:4},33333:{gl2:!0,bpp:4},33323:{gl2:!0,bpp:2},33336:{gl2:!0,bpp:2},33335:{gl2:!0,bpp:2},33338:{gl2:!0,bpp:4},33337:{gl2:!0,bpp:4},33340:{gl2:!0,bpp:8},33339:{gl2:!0,bpp:8},32849:{gl2:!0,bpp:3},32856:{gl2:!0,bpp:4},32857:{gl2:!0,bpp:4},36220:{gl2:!0,bpp:4},36238:{gl2:!0,bpp:4},36975:{gl2:!0,bpp:4},36214:{gl2:!0,bpp:8},36232:{gl2:!0,bpp:8},36226:{gl2:!0,bpp:16},36208:{gl2:!0,bpp:16},33325:{gl2:Kn,bpp:2},33327:{gl2:Kn,bpp:4},34842:{gl2:Kn,bpp:8},33326:{gl2:Kn,bpp:4},33328:{gl2:Kn,bpp:8},34836:{gl2:Kn,bpp:16},35898:{gl2:Kn,bpp:4}};function dA(t,e,n){const r=n[e];if(!r)return!1;const i=H(t)&&r.gl2||r.gl1;return typeof i=="string"?t.getExtension(i):i}class qr extends vn{get[Symbol.toStringTag](){return"Renderbuffer"}static isSupported(e){let{format:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{format:null};return!n||dA(e,n,zg)}static getSamplesForFormat(e,n){let{format:r}=n;return e.getInternalformatParameter(36161,r,32937)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.initialize(n),Object.seal(this)}initialize(e){let{format:n,width:r=1,height:i=1,samples:s=0}=e;return k(n,"Needs format"),this._trackDeallocatedMemory(),this.gl.bindRenderbuffer(36161,this.handle),s!==0&&H(this.gl)?this.gl.renderbufferStorageMultisample(36161,s,n,r,i):this.gl.renderbufferStorage(36161,n,r,i),this.format=n,this.width=r,this.height=i,this.samples=s,this._trackAllocatedMemory(this.width*this.height*(this.samples||1)*zg[this.format].bpp),this}resize(e){let{width:n,height:r}=e;return n!==this.width||r!==this.height?this.initialize({width:n,height:r,format:this.format,samples:this.samples}):this}_createHandle(){return this.gl.createRenderbuffer()}_deleteHandle(){this.gl.deleteRenderbuffer(this.handle),this._trackDeallocatedMemory()}_bindHandle(e){this.gl.bindRenderbuffer(36161,e)}_syncHandle(e){this.format=this.getParameter(36164),this.width=this.getParameter(36162),this.height=this.getParameter(36163),this.samples=this.getParameter(36011)}_getParameter(e){return this.gl.bindRenderbuffer(36161,this.handle),this.gl.getRenderbufferParameter(36161,e)}}const gA=256,pA=1024,mA=16384,Vg=6144,jg=6145,Gg=6146,Hg=34041,Z_="clear: bad arguments";function nh(t){let{framebuffer:e=null,color:n=null,depth:r=null,stencil:i=null}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const s={};e&&(s.framebuffer=e);let o=0;n&&(o|=mA,n!==!0&&(s.clearColor=n)),r&&(o|=gA,r!==!0&&(s.clearDepth=r)),i&&(o|=pA,r!==!0&&(s.clearStencil=r)),k(o!==0,Z_),Ct(t,s,()=>{t.clear(o)})}function _A(t){let{framebuffer:e=null,buffer:n=Vg,drawBuffer:r=0,value:i=[0,0,0,0]}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Ve(t),Ct(t,{framebuffer:e},()=>{switch(n){case Vg:switch(i.constructor){case Int32Array:t.clearBufferiv(n,r,i);break;case Uint32Array:t.clearBufferuiv(n,r,i);break;case Float32Array:default:t.clearBufferfv(n,r,i)}break;case jg:t.clearBufferfv(jg,0,[i]);break;case Gg:t.clearBufferiv(Gg,0,[i]);break;case Hg:const[s,o]=i;t.clearBufferfi(Hg,0,s,o);break;default:k(!1,Z_)}})}function vA(t){switch(t){case 6406:case 33326:case 6403:return 1;case 33328:case 33319:return 2;case 6407:case 34837:return 3;case 6408:case 34836:return 4;default:return k(!1),0}}function fl(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{sourceX:n=0,sourceY:r=0,sourceFormat:i=6408}=e;let{sourceAttachment:s=36064,target:o=null,sourceWidth:a,sourceHeight:l,sourceType:u}=e;const{framebuffer:c,deleteFramebuffer:f}=yA(t);k(c);const{gl:h,handle:p,attachments:E}=c;a=a||c.width,l=l||c.height,s===36064&&p===null&&(s=1028),k(E[s]),u=u||E[s].type,o=EA(o,u,i,a,l),u=u||Pc(o);const w=h.bindFramebuffer(36160,p);return h.readPixels(n,r,a,l,i,u,o),h.bindFramebuffer(36160,w||null),f&&c.delete(),o}function Wg(t){let{sourceAttachment:e=36064,targetMaxHeight:n=Number.MAX_SAFE_INTEGER}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=fl(t,{sourceAttachment:e}),{width:i,height:s}=t;for(;s>n;)({data:r,width:i,height:s}=nA({data:r,width:i,height:s}));tA({data:r,width:i,height:s});const o=document.createElement("canvas");o.width=i,o.height=s;const a=o.getContext("2d"),l=a.createImageData(i,s);return l.data.set(r),a.putImageData(l,0,0),o.toDataURL()}function yA(t){return t instanceof Te?{framebuffer:t,deleteFramebuffer:!1}:{framebuffer:CA(t),deleteFramebuffer:!0}}function EA(t,e,n,r,i){if(t)return t;e=e||5121;const s=Os(e,{clamped:!1}),o=vA(n);return new s(r*i*o)}const ie={WEBGL2:"WEBGL2",VERTEX_ARRAY_OBJECT:"VERTEX_ARRAY_OBJECT",TIMER_QUERY:"TIMER_QUERY",INSTANCED_RENDERING:"INSTANCED_RENDERING",MULTIPLE_RENDER_TARGETS:"MULTIPLE_RENDER_TARGETS",ELEMENT_INDEX_UINT32:"ELEMENT_INDEX_UINT32",BLEND_EQUATION_MINMAX:"BLEND_EQUATION_MINMAX",FLOAT_BLEND:"FLOAT_BLEND",COLOR_ENCODING_SRGB:"COLOR_ENCODING_SRGB",TEXTURE_DEPTH:"TEXTURE_DEPTH",TEXTURE_FLOAT:"TEXTURE_FLOAT",TEXTURE_HALF_FLOAT:"TEXTURE_HALF_FLOAT",TEXTURE_FILTER_LINEAR_FLOAT:"TEXTURE_FILTER_LINEAR_FLOAT",TEXTURE_FILTER_LINEAR_HALF_FLOAT:"TEXTURE_FILTER_LINEAR_HALF_FLOAT",TEXTURE_FILTER_ANISOTROPIC:"TEXTURE_FILTER_ANISOTROPIC",COLOR_ATTACHMENT_RGBA32F:"COLOR_ATTACHMENT_RGBA32F",COLOR_ATTACHMENT_FLOAT:"COLOR_ATTACHMENT_FLOAT",COLOR_ATTACHMENT_HALF_FLOAT:"COLOR_ATTACHMENT_HALF_FLOAT",GLSL_FRAG_DATA:"GLSL_FRAG_DATA",GLSL_FRAG_DEPTH:"GLSL_FRAG_DEPTH",GLSL_DERIVATIVES:"GLSL_DERIVATIVES",GLSL_TEXTURE_LOD:"GLSL_TEXTURE_LOD"};function wA(t){const e=new Rt(t,{format:6408,type:5126,dataFormat:6408}),n=new Te(t,{id:"test-framebuffer",check:!1,attachments:{36064:e}}),r=n.getStatus();return e.delete(),n.delete(),r===36053}const Q_={[ie.WEBGL2]:[!1,!0],[ie.VERTEX_ARRAY_OBJECT]:["OES_vertex_array_object",!0],[ie.TIMER_QUERY]:["EXT_disjoint_timer_query","EXT_disjoint_timer_query_webgl2"],[ie.INSTANCED_RENDERING]:["ANGLE_instanced_arrays",!0],[ie.MULTIPLE_RENDER_TARGETS]:["WEBGL_draw_buffers",!0],[ie.ELEMENT_INDEX_UINT32]:["OES_element_index_uint",!0],[ie.BLEND_EQUATION_MINMAX]:["EXT_blend_minmax",!0],[ie.FLOAT_BLEND]:["EXT_float_blend"],[ie.COLOR_ENCODING_SRGB]:["EXT_sRGB",!0],[ie.TEXTURE_DEPTH]:["WEBGL_depth_texture",!0],[ie.TEXTURE_FLOAT]:["OES_texture_float",!0],[ie.TEXTURE_HALF_FLOAT]:["OES_texture_half_float",!0],[ie.TEXTURE_FILTER_LINEAR_FLOAT]:["OES_texture_float_linear"],[ie.TEXTURE_FILTER_LINEAR_HALF_FLOAT]:["OES_texture_half_float_linear"],[ie.TEXTURE_FILTER_ANISOTROPIC]:["EXT_texture_filter_anisotropic"],[ie.COLOR_ATTACHMENT_RGBA32F]:[wA,"EXT_color_buffer_float"],[ie.COLOR_ATTACHMENT_FLOAT]:[!1,"EXT_color_buffer_float"],[ie.COLOR_ATTACHMENT_HALF_FLOAT]:["EXT_color_buffer_half_float"],[ie.GLSL_FRAG_DATA]:["WEBGL_draw_buffers",!0],[ie.GLSL_FRAG_DEPTH]:["EXT_frag_depth",!0],[ie.GLSL_DERIVATIVES]:["OES_standard_derivatives",!0],[ie.GLSL_TEXTURE_LOD]:["EXT_shader_texture_lod",!0]},TA=2;function K_(t,e){return J_(t,e)}function J_(t,e){return e=Array.isArray(e)?e:[e],e.every(n=>ev(t,n))}function bA(t){t.luma=t.luma||{},t.luma.caps=t.luma.caps||{};for(const e in Q_)t.luma.caps[e]===void 0&&(t.luma.caps[e]=ev(t,e));return t.luma.caps}function ev(t,e){return t.luma=t.luma||{},t.luma.caps=t.luma.caps||{},t.luma.caps[e]===void 0&&(t.luma.caps[e]=SA(t,e)),t.luma.caps[e]||U.log(TA,"Feature: ".concat(e," not supported"))(),t.luma.caps[e]}function SA(t,e){const n=Q_[e];k(n,e);let r;const i=H(t)&&n[1]||n[0];if(typeof i=="function")r=i(t);else if(Array.isArray(i)){r=!0;for(const s of i)r=r&&!!t.getExtension(s)}else typeof i=="string"?r=!!t.getExtension(i):typeof i=="boolean"?r=i:k(!1);return r}const Xg="Multiple render targets not supported";class Te extends vn{get[Symbol.toStringTag](){return"Framebuffer"}static isSupported(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{colorBufferFloat:r,colorBufferHalfFloat:i}=n;let s=!0;return r&&(s=!!(e.getExtension("EXT_color_buffer_float")||e.getExtension("WEBGL_color_buffer_float")||e.getExtension("OES_texture_float"))),i&&(s=s&&!!(e.getExtension("EXT_color_buffer_float")||e.getExtension("EXT_color_buffer_half_float"))),s}static getDefaultFramebuffer(e){return e.luma=e.luma||{},e.luma.defaultFramebuffer=e.luma.defaultFramebuffer||new Te(e,{id:"default-framebuffer",handle:null,attachments:{}}),e.luma.defaultFramebuffer}get MAX_COLOR_ATTACHMENTS(){const e=Ve(this.gl);return e.getParameter(e.MAX_COLOR_ATTACHMENTS)}get MAX_DRAW_BUFFERS(){const e=Ve(this.gl);return e.getParameter(e.MAX_DRAW_BUFFERS)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.width=null,this.height=null,this.attachments={},this.readBuffer=36064,this.drawBuffers=[36064],this.ownResources=[],this.initialize(n),Object.seal(this)}get color(){return this.attachments[36064]||null}get texture(){return this.attachments[36064]||null}get depth(){return this.attachments[36096]||this.attachments[33306]||null}get stencil(){return this.attachments[36128]||this.attachments[33306]||null}initialize(e){let{width:n=1,height:r=1,attachments:i=null,color:s=!0,depth:o=!0,stencil:a=!1,check:l=!0,readBuffer:u=void 0,drawBuffers:c=void 0}=e;if(k(n>=0&&r>=0,"Width and height need to be integers"),this.width=n,this.height=r,i)for(const f in i){const h=i[f];(Array.isArray(h)?h[0]:h).resize({width:n,height:r})}else i=this._createDefaultAttachments(s,o,a,n,r);this.update({clearAttachments:!0,attachments:i,readBuffer:u,drawBuffers:c}),i&&l&&this.checkStatus()}delete(){for(const e of this.ownResources)e.delete();return super.delete(),this}update(e){let{attachments:n={},readBuffer:r,drawBuffers:i,clearAttachments:s=!1,resizeAttachments:o=!0}=e;this.attach(n,{clearAttachments:s,resizeAttachments:o});const{gl:a}=this,l=a.bindFramebuffer(36160,this.handle);return r&&this._setReadBuffer(r),i&&this._setDrawBuffers(i),a.bindFramebuffer(36160,l||null),this}resize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{width:n,height:r}=e;if(this.handle===null)return k(n===void 0&&r===void 0),this.width=this.gl.drawingBufferWidth,this.height=this.gl.drawingBufferHeight,this;n===void 0&&(n=this.gl.drawingBufferWidth),r===void 0&&(r=this.gl.drawingBufferHeight),n!==this.width&&r!==this.height&&U.log(2,"Resizing framebuffer ".concat(this.id," to ").concat(n,"x").concat(r))();for(const i in this.attachments)this.attachments[i].resize({width:n,height:r});return this.width=n,this.height=r,this}attach(e){let{clearAttachments:n=!1,resizeAttachments:r=!0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const i={};n&&Object.keys(this.attachments).forEach(o=>{i[o]=null}),Object.assign(i,e);const s=this.gl.bindFramebuffer(36160,this.handle);for(const o in i){k(o!==void 0,"Misspelled framebuffer binding point?");const a=Number(o),l=i[a];let u=l;if(!u)this._unattach(a);else if(u instanceof qr)this._attachRenderbuffer({attachment:a,renderbuffer:u});else if(Array.isArray(l)){const[c,f=0,h=0]=l;u=c,this._attachTexture({attachment:a,texture:c,layer:f,level:h})}else this._attachTexture({attachment:a,texture:u,layer:0,level:0});r&&u&&u.resize({width:this.width,height:this.height})}this.gl.bindFramebuffer(36160,s||null),Object.assign(this.attachments,e),Object.keys(this.attachments).filter(o=>!this.attachments[o]).forEach(o=>{delete this.attachments[o]})}checkStatus(){const e=this.getStatus();if(e!==36053)throw new Error(xA(e));return this}getStatus(){const{gl:e}=this,n=e.bindFramebuffer(36160,this.handle),r=e.checkFramebufferStatus(36160);return e.bindFramebuffer(36160,n||null),r}clear(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{color:n,depth:r,stencil:i,drawBuffers:s=[]}=e,o=this.gl.bindFramebuffer(36160,this.handle);return(n||r||i)&&nh(this.gl,{color:n,depth:r,stencil:i}),s.forEach((a,l)=>{_A(this.gl,{drawBuffer:l,value:a})}),this.gl.bindFramebuffer(36160,o||null),this}readPixels(){return U.error("Framebuffer.readPixels() is no logner supported, use readPixelsToArray(framebuffer)")(),null}readPixelsToBuffer(){return U.error("Framebuffer.readPixelsToBuffer()is no logner supported, use readPixelsToBuffer(framebuffer)")(),null}copyToDataUrl(){return U.error("Framebuffer.copyToDataUrl() is no logner supported, use copyToDataUrl(framebuffer)")(),null}copyToImage(){return U.error("Framebuffer.copyToImage() is no logner supported, use copyToImage(framebuffer)")(),null}copyToTexture(){return U.error("Framebuffer.copyToTexture({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}blit(){return U.error("Framebuffer.blit({...}) is no logner supported, use blit(source, target, opts)")(),null}invalidate(e){let{attachments:n=[],x:r=0,y:i=0,width:s,height:o}=e;const a=Ve(this.gl),l=a.bindFramebuffer(36008,this.handle);return r===0&&i===0&&s===void 0&&o===void 0?a.invalidateFramebuffer(36008,n):a.invalidateFramebuffer(36008,n,r,i,s,o),a.bindFramebuffer(36008,l),this}getAttachmentParameter(e,n,r){let i=this._getAttachmentParameterFallback(n);return i===null&&(this.gl.bindFramebuffer(36160,this.handle),i=this.gl.getFramebufferAttachmentParameter(36160,e,n),this.gl.bindFramebuffer(36160,null)),r&&i>1e3&&(i=jn(this.gl,i)),i}getAttachmentParameters(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:36064,n=arguments.length>1?arguments[1]:void 0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.constructor.ATTACHMENT_PARAMETERS||[];const i={};for(const s of r){const o=n?jn(this.gl,s):s;i[o]=this.getAttachmentParameter(e,s,n)}return i}getParameters(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;const n=Object.keys(this.attachments),r={};for(const i of n){const s=Number(i),o=e?jn(this.gl,s):s;r[o]=this.getAttachmentParameters(s,e)}return r}show(){return typeof window<"u"&&window.open(Wg(this),"luma-debug-texture"),this}log(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";if(e>U.level||typeof window>"u")return this;n=n||"Framebuffer ".concat(this.id);const r=Wg(this,{targetMaxHeight:100});return U.image({logLevel:e,message:n,image:r},n)(),this}bind(){let{target:e=36160}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.gl.bindFramebuffer(e,this.handle),this}unbind(){let{target:e=36160}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.gl.bindFramebuffer(e,null),this}_createDefaultAttachments(e,n,r,i,s){let o=null;return e&&(o=o||{},o[36064]=new Rt(this.gl,{id:"".concat(this.id,"-color0"),pixels:null,format:6408,type:5121,width:i,height:s,mipmaps:!1,parameters:{10241:9729,10240:9729,10242:33071,10243:33071}}),this.ownResources.push(o[36064])),n&&r?(o=o||{},o[33306]=new qr(this.gl,{id:"".concat(this.id,"-depth-stencil"),format:35056,width:i,height:111}),this.ownResources.push(o[33306])):n?(o=o||{},o[36096]=new qr(this.gl,{id:"".concat(this.id,"-depth"),format:33189,width:i,height:s}),this.ownResources.push(o[36096])):r&&k(!1),o}_unattach(e){const n=this.attachments[e];n&&(n instanceof qr?this.gl.framebufferRenderbuffer(36160,e,36161,null):this.gl.framebufferTexture2D(36160,e,3553,null,0),delete this.attachments[e])}_attachRenderbuffer(e){let{attachment:n=36064,renderbuffer:r}=e;const{gl:i}=this;i.framebufferRenderbuffer(36160,n,36161,r.handle),this.attachments[n]=r}_attachTexture(e){let{attachment:n=36064,texture:r,layer:i,level:s}=e;const{gl:o}=this;switch(o.bindTexture(r.target,r.handle),r.target){case 35866:case 32879:Ve(o).framebufferTextureLayer(36160,n,r.target,s,i);break;case 34067:const l=AA(i);o.framebufferTexture2D(36160,n,l,r.handle,s);break;case 3553:o.framebufferTexture2D(36160,n,3553,r.handle,s);break;default:k(!1,"Illegal texture type")}o.bindTexture(r.target,null),this.attachments[n]=r}_setReadBuffer(e){const n=tS(this.gl);n?n.readBuffer(e):k(e===36064||e===1029,Xg),this.readBuffer=e}_setDrawBuffers(e){const{gl:n}=this,r=Ve(n);if(r)r.drawBuffers(e);else{const i=n.getExtension("WEBGL_draw_buffers");i?i.drawBuffersWEBGL(e):k(e.length===1&&(e[0]===36064||e[0]===1029),Xg)}this.drawBuffers=e}_getAttachmentParameterFallback(e){const n=bA(this.gl);switch(e){case 36052:return n.WEBGL2?null:0;case 33298:case 33299:case 33300:case 33301:case 33302:case 33303:return n.WEBGL2?null:8;case 33297:return n.WEBGL2?null:5125;case 33296:return!n.WEBGL2&&!n.EXT_sRGB?9729:null;default:return null}}_createHandle(){return this.gl.createFramebuffer()}_deleteHandle(){this.gl.deleteFramebuffer(this.handle)}_bindHandle(e){return this.gl.bindFramebuffer(36160,e)}}function AA(t){return t<34069?t+34069:t}function xA(t){return(Te.STATUS||{})[t]||"Framebuffer error ".concat(t)}const PA=[36049,36048,33296,33298,33299,33300,33301,33302,33303];Te.ATTACHMENT_PARAMETERS=PA;function LA(t,e){k(t instanceof Rt||t instanceof q_||t instanceof hA);const n=t.constructor,{gl:r,width:i,height:s,format:o,type:a,dataFormat:l,border:u,mipmaps:c}=t,f=Object.assign({width:i,height:s,format:o,type:a,dataFormat:l,border:u,mipmaps:c},e);return new n(r,f)}function CA(t,e){const{gl:n,width:r,height:i,id:s}=t;return new Te(n,Object.assign({},e,{id:"framebuffer-for-".concat(s),width:r,height:i,attachments:{36064:t}}))}function na(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"unnamed";const n=/#define[\s*]SHADER_NAME[\s*]([A-Za-z0-9_-]+)[\s*]/,r=t.match(n);return r?r[1]:e}const MA=35632,RA=35633;function IA(t){switch(t){case MA:return"fragment";case RA:return"vertex";default:return"unknown type"}}function OA(t,e,n,r){const i=t.split(/\r?\n/),s={},o={},a=r||na(e)||"(unnamed)",l="".concat(IA(n)," shader ").concat(a);for(let c=0;c<i.length;c++){const f=i[c];if(f.length<=1)continue;const h=f.split(":"),p=h[0],E=parseInt(h[2],10);if(isNaN(E))throw new Error("GLSL compilation error in ".concat(l,": ").concat(t));p!=="WARNING"?s[E]=f:o[E]=f}const u=kA(e);return{shaderName:l,errors:Yg(s,u),warnings:Yg(o,u)}}function Yg(t,e){let n="";for(let r=0;r<e.length;r++){const i=e[r];if(!(!t[r+3]&&!t[r+2]&&!t[r+1])&&(n+="".concat(i,`
`),t[r+1])){const s=t[r+1],o=s.split(":",3),a=o[0],l=parseInt(o[1],10)||0,u=s.substring(o.join(":").length+1).trim();n+=tv("^^^ ".concat(a,": ").concat(u,`

`),l)}}return n}function kA(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:": ";const r=t.split(/\r?\n/),i=String(r.length+e-1).length;return r.map((s,o)=>{const a=String(o+e),l=a.length;return tv(a,i-l)+n+s})}function tv(t,e){let n="";for(let r=0;r<e;++r)n+=" ";return"".concat(n).concat(t)}function nv(t){let e=100;const n=t.match(/[^\s]+/g);if(n.length>=2&&n[0]==="#version"){const r=parseInt(n[1],10);Number.isFinite(r)&&(e=r)}return e}const NA="Shader: GLSL source code must be a JavaScript string";class ks extends vn{get[Symbol.toStringTag](){return"Shader"}static getTypeName(e){switch(e){case 35633:return"vertex-shader";case 35632:return"fragment-shader";default:return k(!1),"unknown"}}constructor(e,n){cl(e),k(typeof n.source=="string",NA);const r=na(n.source,null)||n.id||Xt("unnamed ".concat(ks.getTypeName(n.shaderType)));super(e,{id:r}),this.shaderType=n.shaderType,this.source=n.source,this.initialize(n)}initialize(e){let{source:n}=e;const r=na(n,null);r&&(this.id=Xt(r)),this._compile(n)}getParameter(e){return this.gl.getShaderParameter(this.handle,e)}toString(){return"".concat(ks.getTypeName(this.shaderType),":").concat(this.id)}getName(){return na(this.source)||"unnamed-shader"}getSource(){return this.gl.getShaderSource(this.handle)}getTranslatedSource(){const e=this.gl.getExtension("WEBGL_debug_shaders");return e?e.getTranslatedShaderSource(this.handle):"No translated source available. WEBGL_debug_shaders not implemented"}_compile(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.source;if(e.startsWith("#version ")||(e=`#version 100
`.concat(e)),this.source=e,this.gl.shaderSource(this.handle,this.source),this.gl.compileShader(this.handle),!this.getParameter(35713)){const r=this.gl.getShaderInfoLog(this.handle),{shaderName:i,errors:s,warnings:o}=OA(r,this.source,this.shaderType,this.id);throw U.error("GLSL compilation errors in ".concat(i,`
`).concat(s))(),U.warn("GLSL compilation warnings in ".concat(i,`
`).concat(o))(),new Error("GLSL compilation errors in ".concat(i))}}_deleteHandle(){this.gl.deleteShader(this.handle)}_getOptsFromHandle(){return{type:this.getParameter(35663),source:this.getSource()}}}class lu extends ks{get[Symbol.toStringTag](){return"VertexShader"}constructor(e,n){typeof n=="string"&&(n={source:n}),super(e,Object.assign({},n,{shaderType:35633}))}_createHandle(){return this.gl.createShader(35633)}}class uu extends ks{get[Symbol.toStringTag](){return"FragmentShader"}constructor(e,n){typeof n=="string"&&(n={source:n}),super(e,Object.assign({},n,{shaderType:35632}))}_createHandle(){return this.gl.createShader(35632)}}const DA={5126:ne.bind(null,"uniform1fv",Ke,1,ke),35664:ne.bind(null,"uniform2fv",Ke,2,ke),35665:ne.bind(null,"uniform3fv",Ke,3,ke),35666:ne.bind(null,"uniform4fv",Ke,4,ke),5124:ne.bind(null,"uniform1iv",Tn,1,ke),35667:ne.bind(null,"uniform2iv",Tn,2,ke),35668:ne.bind(null,"uniform3iv",Tn,3,ke),35669:ne.bind(null,"uniform4iv",Tn,4,ke),35670:ne.bind(null,"uniform1iv",Tn,1,ke),35671:ne.bind(null,"uniform2iv",Tn,2,ke),35672:ne.bind(null,"uniform3iv",Tn,3,ke),35673:ne.bind(null,"uniform4iv",Tn,4,ke),35674:ne.bind(null,"uniformMatrix2fv",Ke,4,en),35675:ne.bind(null,"uniformMatrix3fv",Ke,9,en),35676:ne.bind(null,"uniformMatrix4fv",Ke,16,en),35678:Pe,35680:Pe,5125:ne.bind(null,"uniform1uiv",Ro,1,ke),36294:ne.bind(null,"uniform2uiv",Ro,2,ke),36295:ne.bind(null,"uniform3uiv",Ro,3,ke),36296:ne.bind(null,"uniform4uiv",Ro,4,ke),35685:ne.bind(null,"uniformMatrix2x3fv",Ke,6,en),35686:ne.bind(null,"uniformMatrix2x4fv",Ke,8,en),35687:ne.bind(null,"uniformMatrix3x2fv",Ke,6,en),35688:ne.bind(null,"uniformMatrix3x4fv",Ke,12,en),35689:ne.bind(null,"uniformMatrix4x2fv",Ke,8,en),35690:ne.bind(null,"uniformMatrix4x3fv",Ke,12,en),35678:Pe,35680:Pe,35679:Pe,35682:Pe,36289:Pe,36292:Pe,36293:Pe,36298:Pe,36299:Pe,36300:Pe,36303:Pe,36306:Pe,36307:Pe,36308:Pe,36311:Pe},FA={},UA={},BA={},$g=[0];function rh(t,e,n,r){e===1&&typeof t=="boolean"&&(t=t?1:0),Number.isFinite(t)&&($g[0]=t,t=$g);const i=t.length;if(i%e&&U.warn("Uniform size should be multiples of ".concat(e),t)(),t instanceof n)return t;let s=r[i];s||(s=new n(i),r[i]=s);for(let o=0;o<i;o++)s[o]=t[o];return s}function Ke(t,e){return rh(t,e,Float32Array,FA)}function Tn(t,e){return rh(t,e,Int32Array,UA)}function Ro(t,e){return rh(t,e,Uint32Array,BA)}function qg(t,e,n){const r=DA[n.type];if(!r)throw new Error("Unknown GLSL uniform type ".concat(n.type));return r().bind(null,t,e)}function zA(t){if(t[t.length-1]!=="]")return{name:t,length:1,isArray:!1};const e=/([^[]*)(\[[0-9]+\])?/,n=t.match(e);if(!n||n.length<2)throw new Error("Failed to parse GLSL uniform name ".concat(t));return{name:n[1],length:n[2]||1,isArray:!!n[2]}}function VA(t,e,n){for(const r in t){const i=t[r];if((!n||!!n[r])&&!jA(i))throw e=e?"".concat(e," "):"",console.error("".concat(e," Bad uniform ").concat(r),i),new Error("".concat(e," Bad uniform ").concat(r))}return!0}function jA(t){return Array.isArray(t)||ArrayBuffer.isView(t)?HA(t):isFinite(t)||t===!0||t===!1||t instanceof gi||t instanceof qr?!0:t instanceof Te?!!t.texture:!1}function GA(t,e,n){if(Array.isArray(n)||ArrayBuffer.isView(n))if(t[e]){const r=t[e];for(let i=0,s=n.length;i<s;++i)r[i]=n[i]}else t[e]=n.slice();else t[e]=n}function HA(t){if(t.length===0)return!1;const e=Math.min(t.length,16);for(let n=0;n<e;++n)if(!Number.isFinite(t[n]))return!1;return!0}function Pe(){let t=null;return(e,n,r)=>{const i=t!==r;return i&&(e.uniform1i(n,r),t=r),i}}function ne(t,e,n,r){let i=null,s=null;return(o,a,l)=>{const u=e(l,n),c=u.length;let f=!1;if(i===null)i=new Float32Array(c),s=c,f=!0;else{k(s===c,"Uniform length cannot change.");for(let h=0;h<c;++h)if(u[h]!==i[h]){f=!0;break}}return f&&(r(o,t,a,u),i.set(u)),f}}function ke(t,e,n,r){t[e](n,r)}function en(t,e,n,r){t[e](n,!1,r)}const WA=5120,XA=5121,YA=5122,$A=5123,Zg=0,Io=1,qA=2,ZA=3,Oo=4,QA=5,KA=6,ye=5126,JA=35664,ex=35665,tx=35666,Wi=5124,nx=35667,rx=35668,ix=35669,Xi=5125,sx=36294,ox=36295,ax=36296,lx=35670,ux=35671,cx=35672,fx=35673,hx=35674,dx=35675,gx=35676,px=35685,mx=35686,_x=35687,vx=35688,yx=35689,Ex=35690,Mc={[ye]:[ye,1,"float"],[JA]:[ye,2,"vec2"],[ex]:[ye,3,"vec3"],[tx]:[ye,4,"vec4"],[Wi]:[Wi,1,"int"],[nx]:[Wi,2,"ivec2"],[rx]:[Wi,3,"ivec3"],[ix]:[Wi,4,"ivec4"],[Xi]:[Xi,1,"uint"],[sx]:[Xi,2,"uvec2"],[ox]:[Xi,3,"uvec3"],[ax]:[Xi,4,"uvec4"],[lx]:[ye,1,"bool"],[ux]:[ye,2,"bvec2"],[cx]:[ye,3,"bvec3"],[fx]:[ye,4,"bvec4"],[hx]:[ye,8,"mat2"],[px]:[ye,8,"mat2x3"],[mx]:[ye,8,"mat2x4"],[dx]:[ye,12,"mat3"],[_x]:[ye,12,"mat3x2"],[vx]:[ye,12,"mat3x4"],[gx]:[ye,16,"mat4"],[yx]:[ye,16,"mat4x2"],[Ex]:[ye,16,"mat4x3"]};function wx(t){switch(t){case Zg:return Zg;case Io:return Io;case ZA:return Io;case qA:return Io;case Oo:return Oo;case QA:return Oo;case KA:return Oo;default:return k(!1),0}}function Qg(t){const e=Mc[t];if(!e)return null;const[n,r]=e;return{type:n,components:r}}function rv(t,e){switch(t){case WA:case XA:case YA:case $A:t=ye;break}for(const n in Mc){const[r,i,s]=Mc[n];if(r===t&&i===e)return{glType:n,name:s}}return null}class Tx{constructor(e){this.id=e.id,this.attributeInfos=[],this.attributeInfosByName={},this.attributeInfosByLocation=[],this.varyingInfos=[],this.varyingInfosByName={},Object.seal(this),this._readAttributesFromProgram(e),this._readVaryingsFromProgram(e)}getAttributeInfo(e){const n=Number(e);return Number.isFinite(n)?this.attributeInfosByLocation[n]:this.attributeInfosByName[e]||null}getAttributeLocation(e){const n=this.getAttributeInfo(e);return n?n.location:-1}getAttributeAccessor(e){const n=this.getAttributeInfo(e);return n?n.accessor:null}getVaryingInfo(e){const n=Number(e);return Number.isFinite(n)?this.varyingInfos[n]:this.varyingInfosByName[e]||null}getVaryingIndex(e){const n=this.getVaryingInfo();return n?n.location:-1}getVaryingAccessor(e){const n=this.getVaryingInfo();return n?n.accessor:null}_readAttributesFromProgram(e){const{gl:n}=e,r=n.getProgramParameter(e.handle,35721);for(let i=0;i<r;i++){const{name:s,type:o,size:a}=n.getActiveAttrib(e.handle,i),l=n.getAttribLocation(e.handle,s);l>=0&&this._addAttribute(l,s,o,a)}this.attributeInfos.sort((i,s)=>i.location-s.location)}_readVaryingsFromProgram(e){const{gl:n}=e;if(!H(n))return;const r=n.getProgramParameter(e.handle,35971);for(let i=0;i<r;i++){const{name:s,type:o,size:a}=n.getTransformFeedbackVarying(e.handle,i);this._addVarying(i,s,o,a)}this.varyingInfos.sort((i,s)=>i.location-s.location)}_addAttribute(e,n,r,i){const{type:s,components:o}=Qg(r),a={type:s,size:i*o};this._inferProperties(e,n,a);const l={location:e,name:n,accessor:new nt(a)};this.attributeInfos.push(l),this.attributeInfosByLocation[e]=l,this.attributeInfosByName[l.name]=l}_inferProperties(e,n,r){/instance/i.test(n)&&(r.divisor=1)}_addVarying(e,n,r,i){const{type:s,components:o}=Qg(r),a=new nt({type:s,size:i*o}),l={location:e,name:n,accessor:a};this.varyingInfos.push(l),this.varyingInfosByName[l.name]=l}}const Kg=4,bx=35981,Sx=["setVertexArray","setAttributes","setBuffers","unsetBuffers","use","getUniformCount","getUniformInfo","getUniformLocation","getUniformValue","getVarying","getFragDataLocation","getAttachedShaders","getAttributeCount","getAttributeLocation","getAttributeInfo"];class iv extends vn{get[Symbol.toStringTag](){return"Program"}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.stubRemovedMethods("Program","v6.0",Sx),this._isCached=!1,this.initialize(n),Object.seal(this),this._setId(n.id)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{hash:n,vs:r,fs:i,varyings:s,bufferMode:o=bx}=e;return this.hash=n||"",this.vs=typeof r=="string"?new lu(this.gl,{id:"".concat(e.id,"-vs"),source:r}):r,this.fs=typeof i=="string"?new uu(this.gl,{id:"".concat(e.id,"-fs"),source:i}):i,k(this.vs instanceof lu),k(this.fs instanceof uu),this.uniforms={},this._textureUniforms={},s&&s.length>0&&(Ve(this.gl),this.varyings=s,this.gl2.transformFeedbackVaryings(this.handle,s,o)),this._compileAndLink(),this._readUniformLocationsFromLinkedProgram(),this.configuration=new Tx(this),this.setProps(e)}delete(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this._isCached?this:super.delete(e)}setProps(e){return"uniforms"in e&&this.setUniforms(e.uniforms),this}draw(e){let{logPriority:n,drawMode:r=4,vertexCount:i,offset:s=0,start:o,end:a,isIndexed:l=!1,indexType:u=5123,instanceCount:c=0,isInstanced:f=c>0,vertexArray:h=null,transformFeedback:p,framebuffer:E,parameters:w={},uniforms:S,samplers:_}=e;if((S||_)&&(U.deprecated("Program.draw({uniforms})","Program.setUniforms(uniforms)")(),this.setUniforms(S||{})),U.priority>=n){const m=E?E.id:"default",y="mode=".concat(jn(this.gl,r)," verts=").concat(i," ")+"instances=".concat(c," indexType=").concat(jn(this.gl,u)," ")+"isInstanced=".concat(f," isIndexed=").concat(l," ")+"Framebuffer=".concat(m);U.log(n,y)()}return k(h),this.gl.useProgram(this.handle),!this._areTexturesRenderable()||i===0||f&&c===0?!1:(h.bindForDraw(i,c,()=>{if(E!==void 0&&(w=Object.assign({},w,{framebuffer:E})),p){const m=wx(r);p.begin(m)}this._bindTextures(),Ct(this.gl,w,()=>{l&&f?this.gl2.drawElementsInstanced(r,i,u,s,c):l&&H(this.gl)&&!isNaN(o)&&!isNaN(a)?this.gl2.drawRangeElements(r,o,a,i,u,s):l?this.gl.drawElements(r,i,u,s):f?this.gl2.drawArraysInstanced(r,s,i,c):this.gl.drawArrays(r,s,i)}),p&&p.end()}),!0)}setUniforms(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};U.priority>=2&&VA(e,this.id,this._uniformSetters),this.gl.useProgram(this.handle);for(const n in e){const r=e[n],i=this._uniformSetters[n];if(i){let s=r,o=!1;if(s instanceof Te&&(s=s.texture),s instanceof gi)if(o=this.uniforms[n]!==r,o){i.textureIndex===void 0&&(i.textureIndex=this._textureIndexCounter++);const a=s,{textureIndex:l}=i;a.bind(l),s=l,this._textureUniforms[n]=a}else s=i.textureIndex;else this._textureUniforms[n]&&delete this._textureUniforms[n];(i(s)||o)&&GA(this.uniforms,n,r)}}return this}_areTexturesRenderable(){let e=!0;for(const n in this._textureUniforms){const r=this._textureUniforms[n];r.update(),e=e&&r.loaded}return e}_bindTextures(){for(const e in this._textureUniforms){const n=this._uniformSetters[e].textureIndex;this._textureUniforms[e].bind(n)}}_createHandle(){return this.gl.createProgram()}_deleteHandle(){this.gl.deleteProgram(this.handle)}_getOptionsFromHandle(e){const n=this.gl.getAttachedShaders(e),r={};for(const i of n)switch(this.gl.getShaderParameter(this.handle,35663)){case 35633:r.vs=new lu({handle:i});break;case 35632:r.fs=new uu({handle:i});break}return r}_getParameter(e){return this.gl.getProgramParameter(this.handle,e)}_setId(e){if(!e){const n=this._getName();this.id=Xt(n)}}_getName(){let e=this.vs.getName()||this.fs.getName();return e=e.replace(/shader/i,""),e=e?"".concat(e,"-program"):"program",e}_compileAndLink(){const{gl:e}=this;if(e.attachShader(this.handle,this.vs.handle),e.attachShader(this.handle,this.fs.handle),U.time(Kg,"linkProgram for ".concat(this._getName()))(),e.linkProgram(this.handle),U.timeEnd(Kg,"linkProgram for ".concat(this._getName()))(),e.debug||U.level>0){if(!e.getProgramParameter(this.handle,35714))throw new Error("Error linking: ".concat(e.getProgramInfoLog(this.handle)));if(e.validateProgram(this.handle),!e.getProgramParameter(this.handle,35715))throw new Error("Error validating: ".concat(e.getProgramInfoLog(this.handle)))}}_readUniformLocationsFromLinkedProgram(){const{gl:e}=this;this._uniformSetters={},this._uniformCount=this._getParameter(35718);for(let n=0;n<this._uniformCount;n++){const r=this.gl.getActiveUniform(this.handle,n),{name:i}=zA(r.name);let s=e.getUniformLocation(this.handle,i);if(this._uniformSetters[i]=qg(e,s,r),r.size>1)for(let o=0;o<r.size;o++)s=e.getUniformLocation(this.handle,"".concat(i,"[").concat(o,"]")),this._uniformSetters["".concat(i,"[").concat(o,"]")]=qg(e,s,r)}this._textureIndexCounter=0}getActiveUniforms(e,n){return this.gl2.getActiveUniforms(this.handle,e,n)}getUniformBlockIndex(e){return this.gl2.getUniformBlockIndex(this.handle,e)}getActiveUniformBlockParameter(e,n){return this.gl2.getActiveUniformBlockParameter(this.handle,e,n)}uniformBlockBinding(e,n){this.gl2.uniformBlockBinding(this.handle,e,n)}}const Ax=34918,xx=34919,Px=35007,Lx=36795,Cx=35976,Mx=35887,Rx=36202;class Na extends vn{get[Symbol.toStringTag](){return"Query"}static isSupported(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=H(e),i=J_(e,ie.TIMER_QUERY);let s=r||i;for(const o of n)switch(o){case"queries":s=s&&r;break;case"timers":s=s&&i;break;default:k(!1)}return s}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.target=null,this._queryPending=!1,this._pollingPromise=null,Object.seal(this)}beginTimeElapsedQuery(){return this.begin(Px)}beginOcclusionQuery(){let{conservative:e=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.begin(e?Rx:Mx)}beginTransformFeedbackQuery(){return this.begin(Cx)}begin(e){return this._queryPending?this:(this.target=e,this.gl2.beginQuery(this.target,this.handle),this)}end(){return this._queryPending?this:(this.target&&(this.gl2.endQuery(this.target),this.target=null,this._queryPending=!0),this)}isResultAvailable(){if(!this._queryPending)return!1;const e=this.gl2.getQueryParameter(this.handle,xx);return e&&(this._queryPending=!1),e}isTimerDisjoint(){return this.gl2.getParameter(Lx)}getResult(){return this.gl2.getQueryParameter(this.handle,Ax)}getTimerMilliseconds(){return this.getResult()/1e6}createPoll(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Number.POSITIVE_INFINITY;if(this._pollingPromise)return this._pollingPromise;let n=0;return this._pollingPromise=new Promise((r,i)=>{const s=()=>{this.isResultAvailable()?(r(this.getResult()),this._pollingPromise=null):n++>e?(i("Timed out"),this._pollingPromise=null):requestAnimationFrame(s)};requestAnimationFrame(s)}),this._pollingPromise}_createHandle(){return Na.isSupported(this.gl)?this.gl2.createQuery():null}_deleteHandle(){this.gl2.deleteQuery(this.handle)}}class sv extends vn{get[Symbol.toStringTag](){return"TransformFeedback"}static isSupported(e){return H(e)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Ve(e),super(e,n),this.initialize(n),this.stubRemovedMethods("TransformFeedback","v6.0",["pause","resume"]),Object.seal(this)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.buffers={},this.unused={},this.configuration=null,this.bindOnUse=!0,di(this.buffers)||this.bind(()=>this._unbindBuffers()),this.setProps(e),this}setProps(e){"program"in e&&(this.configuration=e.program&&e.program.configuration),"configuration"in e&&(this.configuration=e.configuration),"bindOnUse"in e&&(e=e.bindOnUse),"buffers"in e&&this.setBuffers(e.buffers)}setBuffers(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.bind(()=>{for(const n in e)this.setBuffer(n,e[n])}),this}setBuffer(e,n){const r=this._getVaryingIndex(e),{buffer:i,byteSize:s,byteOffset:o}=this._getBufferParams(n);return r<0?(this.unused[e]=i,U.warn("".concat(this.id," unused varying buffer ").concat(e))(),this):(this.buffers[r]=n,this.bindOnUse||this._bindBuffer(r,i,o,s),this)}begin(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.gl.bindTransformFeedback(36386,this.handle),this._bindBuffers(),this.gl.beginTransformFeedback(e),this}end(){return this.gl.endTransformFeedback(),this._unbindBuffers(),this.gl.bindTransformFeedback(36386,null),this}_getBufferParams(e){let n,r,i;return e instanceof J?i=e:(i=e.buffer,r=e.byteSize,n=e.byteOffset),(n!==void 0||r!==void 0)&&(n=n||0,r=r||i.byteLength-n),{buffer:i,byteOffset:n,byteSize:r}}_getVaryingInfo(e){return this.configuration&&this.configuration.getVaryingInfo(e)}_getVaryingIndex(e){if(this.configuration)return this.configuration.getVaryingInfo(e).location;const n=Number(e);return Number.isFinite(n)?n:-1}_bindBuffers(){if(this.bindOnUse)for(const e in this.buffers){const{buffer:n,byteSize:r,byteOffset:i}=this._getBufferParams(this.buffers[e]);this._bindBuffer(e,n,i,r)}}_unbindBuffers(){if(this.bindOnUse)for(const e in this.buffers)this._bindBuffer(e,null)}_bindBuffer(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i=arguments.length>3?arguments[3]:void 0;const s=n&&n.handle;return!s||i===void 0?this.gl.bindBufferBase(35982,e,s):this.gl.bindBufferRange(35982,e,s,r,i),this}_createHandle(){return this.gl.createTransformFeedback()}_deleteHandle(){this.gl.deleteTransformFeedback(this.handle)}_bindHandle(e){this.gl.bindTransformFeedback(36386,this.handle)}}let ko=null;function Ix(t){return(!ko||ko.byteLength<t)&&(ko=new ArrayBuffer(t)),ko}function Ox(t,e){const n=Ix(t.BYTES_PER_ELEMENT*e);return new t(n,0,e)}function kx(t){let{target:e,source:n,start:r=0,count:i=1}=t;const s=n.length,o=i*s;let a=0;for(let l=r;a<s;a++)e[l++]=n[a];for(;a<o;)a<o-a?(e.copyWithin(r+a,r,r+a),a*=2):(e.copyWithin(r+a,r,r+o-a),a=o);return e}const Nx="elements must be GL.ELEMENT_ARRAY_BUFFER";class Je extends vn{get[Symbol.toStringTag](){return"VertexArrayObject"}static isSupported(e){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:{}).constantAttributeZero?H(e)||A_()==="Chrome":!0}static getDefaultArray(e){return e.luma=e.luma||{},e.luma.defaultVertexArray||(e.luma.defaultVertexArray=new Je(e,{handle:null,isDefaultArray:!0})),e.luma.defaultVertexArray}static getMaxAttributes(e){return Je.MAX_ATTRIBUTES=Je.MAX_ATTRIBUTES||e.getParameter(34921),Je.MAX_ATTRIBUTES}static setConstant(e,n,r){switch(r.constructor){case Float32Array:Je._setConstantFloatArray(e,n,r);break;case Int32Array:Je._setConstantIntArray(e,n,r);break;case Uint32Array:Je._setConstantUintArray(e,n,r);break;default:k(!1)}}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r=n.id||n.program&&n.program.id;super(e,Object.assign({},n,{id:r})),this.buffer=null,this.bufferValue=null,this.isDefaultArray=n.isDefaultArray||!1,this.gl2=e,this.initialize(n),Object.seal(this)}delete(){return super.delete(),this.buffer&&this.buffer.delete(),this}get MAX_ATTRIBUTES(){return Je.getMaxAttributes(this.gl)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.setProps(e)}setProps(e){return this}setElementBuffer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return k(!e||e.target===34963,Nx),this.bind(()=>{this.gl.bindBuffer(34963,e?e.handle:null)}),this}setBuffer(e,n,r){if(n.target===34963)return this.setElementBuffer(n,r);const{size:i,type:s,stride:o,offset:a,normalized:l,integer:u,divisor:c}=r,{gl:f,gl2:h}=this;return e=Number(e),this.bind(()=>{f.bindBuffer(34962,n.handle),u?(k(H(f)),h.vertexAttribIPointer(e,i,s,o,a)):f.vertexAttribPointer(e,i,s,l,o,a),f.enableVertexAttribArray(e),h.vertexAttribDivisor(e,c||0)}),this}enable(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return!n&&e===0&&!Je.isSupported(this.gl,{constantAttributeZero:!0})||(e=Number(e),this.bind(()=>n?this.gl.enableVertexAttribArray(e):this.gl.disableVertexAttribArray(e))),this}getConstantBuffer(e,n){const r=this._normalizeConstantArrayValue(n),i=r.byteLength*e,s=r.length*e;let o=!this.buffer;if(this.buffer=this.buffer||new J(this.gl,i),o=o||this.buffer.reallocate(i),o=o||!this._compareConstantArrayValues(r,this.bufferValue),o){const a=Ox(n.constructor,s);kx({target:a,source:r,start:0,count:s}),this.buffer.subData(a),this.bufferValue=n}return this.buffer}_normalizeConstantArrayValue(e){return Array.isArray(e)?new Float32Array(e):e}_compareConstantArrayValues(e,n){if(!e||!n||e.length!==n.length||e.constructor!==n.constructor)return!1;for(let r=0;r<e.length;++r)if(e[r]!==n[r])return!1;return!0}static _setConstantFloatArray(e,n,r){switch(r.length){case 1:e.vertexAttrib1fv(n,r);break;case 2:e.vertexAttrib2fv(n,r);break;case 3:e.vertexAttrib3fv(n,r);break;case 4:e.vertexAttrib4fv(n,r);break;default:k(!1)}}static _setConstantIntArray(e,n,r){switch(k(H(e)),r.length){case 1:e.vertexAttribI1iv(n,r);break;case 2:e.vertexAttribI2iv(n,r);break;case 3:e.vertexAttribI3iv(n,r);break;case 4:e.vertexAttribI4iv(n,r);break;default:k(!1)}}static _setConstantUintArray(e,n,r){switch(k(H(e)),r.length){case 1:e.vertexAttribI1uiv(n,r);break;case 2:e.vertexAttribI2uiv(n,r);break;case 3:e.vertexAttribI3uiv(n,r);break;case 4:e.vertexAttribI4uiv(n,r);break;default:k(!1)}}_createHandle(){return this.gl.createVertexArray()}_deleteHandle(e){return this.gl2.deleteVertexArray(e),[this.elements]}_bindHandle(e){this.gl2.bindVertexArray(e)}_getParameter(e,n){let{location:r}=n;return k(Number.isFinite(r)),this.bind(()=>{switch(e){case 34373:return this.gl.getVertexAttribOffset(r,e);default:return this.gl.getVertexAttrib(r,e)}})}}const Dx="VertexArray: attributes must be Buffers or constants (i.e. typed array)",Fx=/^(.+)__LOCATION_([0-9]+)$/,Ux=["setBuffers","setGeneric","clearBindings","setLocations","setGenericValues","setDivisor","enable","disable"];class Bx{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r=n.id||n.program&&n.program.id;this.id=r,this.gl=e,this.configuration=null,this.elements=null,this.elementsAccessor=null,this.values=null,this.accessors=null,this.unused=null,this.drawParams=null,this.buffer=null,this.attributes={},this.vertexArrayObject=new Je(e),W_(this,"VertexArray","v6.0",Ux),this.initialize(n),Object.seal(this)}delete(){this.buffer&&this.buffer.delete(),this.vertexArrayObject.delete()}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.reset(),this.configuration=null,this.bindOnUse=!1,this.setProps(e)}reset(){this.elements=null,this.elementsAccessor=null;const{MAX_ATTRIBUTES:e}=this.vertexArrayObject;return this.values=new Array(e).fill(null),this.accessors=new Array(e).fill(null),this.unused={},this.drawParams=null,this}setProps(e){return"program"in e&&(this.configuration=e.program&&e.program.configuration),"configuration"in e&&(this.configuration=e.configuration),"attributes"in e&&this.setAttributes(e.attributes),"elements"in e&&this.setElementBuffer(e.elements),"bindOnUse"in e&&(e=e.bindOnUse),this}clearDrawParams(){this.drawParams=null}getDrawParams(){return this.drawParams=this.drawParams||this._updateDrawParams(),this.drawParams}setAttributes(e){return Object.assign(this.attributes,e),this.vertexArrayObject.bind(()=>{for(const n in e){const r=e[n];this._setAttribute(n,r)}this.gl.bindBuffer(34962,null)}),this}setElementBuffer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this.elements=e,this.elementsAccessor=n,this.clearDrawParams(),this.vertexArrayObject.setElementBuffer(e,n),this}setBuffer(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(n.target===34963)return this.setElementBuffer(n,r);const{location:i,accessor:s}=this._resolveLocationAndAccessor(e,n,n.accessor,r);return i>=0&&(this.values[i]=n,this.accessors[i]=s,this.clearDrawParams(),this.vertexArrayObject.setBuffer(i,n,s)),this}setConstant(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const{location:i,accessor:s}=this._resolveLocationAndAccessor(e,n,Object.assign({size:n.length},r));return i>=0&&(n=this.vertexArrayObject._normalizeConstantArrayValue(n),this.values[i]=n,this.accessors[i]=s,this.clearDrawParams(),this.vertexArrayObject.enable(i,!1)),this}unbindBuffers(){return this.vertexArrayObject.bind(()=>{this.elements&&this.vertexArrayObject.setElementBuffer(null),this.buffer=this.buffer||new J(this.gl,{accessor:{size:4}});for(let e=0;e<this.vertexArrayObject.MAX_ATTRIBUTES;e++)this.values[e]instanceof J&&(this.gl.disableVertexAttribArray(e),this.gl.bindBuffer(34962,this.buffer.handle),this.gl.vertexAttribPointer(e,1,5126,!1,0,0))}),this}bindBuffers(){return this.vertexArrayObject.bind(()=>{this.elements&&this.setElementBuffer(this.elements);for(let e=0;e<this.vertexArrayObject.MAX_ATTRIBUTES;e++){const n=this.values[e];n instanceof J&&this.setBuffer(e,n)}}),this}bindForDraw(e,n,r){let i;return this.vertexArrayObject.bind(()=>{this._setConstantAttributes(e,n),i=r()}),i}_resolveLocationAndAccessor(e,n,r,i){const s={location:-1,accessor:null},{location:o,name:a}=this._getAttributeIndex(e);if(!Number.isFinite(o)||o<0)return this.unused[e]=n,U.once(3,()=>"unused value ".concat(e," in ").concat(this.id))(),s;const l=this._getAttributeInfo(a||o);if(!l)return s;const u=this.accessors[o]||{},c=nt.resolve(l.accessor,u,r,i),{size:f,type:h}=c;return k(Number.isFinite(f)&&Number.isFinite(h)),{location:o,accessor:c}}_getAttributeInfo(e){return this.configuration&&this.configuration.getAttributeInfo(e)}_getAttributeIndex(e){const n=Number(e);if(Number.isFinite(n))return{location:n};const r=Fx.exec(e),i=r?r[1]:e,s=r?Number(r[2]):0;return this.configuration?{location:this.configuration.getAttributeLocation(i)+s,name:i}:{location:-1}}_setAttribute(e,n){if(n instanceof J)this.setBuffer(e,n);else if(Array.isArray(n)&&n.length&&n[0]instanceof J){const r=n[0],i=n[1];this.setBuffer(e,r,i)}else if(ArrayBuffer.isView(n)||Array.isArray(n)){const r=n;this.setConstant(e,r)}else if(n.buffer instanceof J){const r=n;this.setBuffer(e,r.buffer,r)}else throw new Error(Dx)}_setConstantAttributes(e,n){const r=Math.max(e|0,n|0);let i=this.values[0];ArrayBuffer.isView(i)&&this._setConstantAttributeZero(i,r);for(let s=1;s<this.vertexArrayObject.MAX_ATTRIBUTES;s++)i=this.values[s],ArrayBuffer.isView(i)&&this._setConstantAttribute(s,i)}_setConstantAttributeZero(e,n){if(Je.isSupported(this.gl,{constantAttributeZero:!0})){this._setConstantAttribute(0,e);return}const r=this.vertexArrayObject.getConstantBuffer(n,e);this.vertexArrayObject.setBuffer(0,r,this.accessors[0])}_setConstantAttribute(e,n){Je.setConstant(this.gl,e,n)}_updateDrawParams(){const e={isIndexed:!1,isInstanced:!1,indexCount:1/0,vertexCount:1/0,instanceCount:1/0};for(let n=0;n<this.vertexArrayObject.MAX_ATTRIBUTES;n++)this._updateDrawParamsForLocation(e,n);return this.elements&&(e.elementCount=this.elements.getElementCount(this.elements.accessor),e.isIndexed=!0,e.indexType=this.elementsAccessor.type||this.elements.accessor.type,e.indexOffset=this.elementsAccessor.offset||0),e.indexCount===1/0&&(e.indexCount=0),e.vertexCount===1/0&&(e.vertexCount=0),e.instanceCount===1/0&&(e.instanceCount=0),e}_updateDrawParamsForLocation(e,n){const r=this.values[n],i=this.accessors[n];if(!r)return;const{divisor:s}=i,o=s>0;if(e.isInstanced=e.isInstanced||o,r instanceof J){const a=r;if(o){const l=a.getVertexCount(i);e.instanceCount=Math.min(e.instanceCount,l)}else{const l=a.getVertexCount(i);e.vertexCount=Math.min(e.vertexCount,l)}}}setElements(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return U.deprecated("setElements","setElementBuffer")(),this.setElementBuffer(e,n)}}function zx(t,e){const{maxElts:n=16,size:r=1}=e;let i="[";for(let o=0;o<t.length&&o<n;++o)o>0&&(i+=",".concat(o%r===0?" ":"")),i+=Ns(t[o],e);const s=t.length>n?"...":"]";return"".concat(i).concat(s)}function Ns(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=1e-16,{isInteger:r=!1}=e;if(Array.isArray(t)||ArrayBuffer.isView(t))return zx(t,e);if(!Number.isFinite(t))return String(t);if(Math.abs(t)<n)return r?"0":"0.";if(r||Math.abs(t)>100&&Math.abs(t)<1e4)return t.toFixed(0);const i=t.toPrecision(2);return i.indexOf(".0")===i.length-2?i.slice(0,-1):i}function Jg(t){let{header:e="Uniforms",program:n,uniforms:r,undefinedOnly:i=!1}=t;k(n);const s=".*_.*",o=".*Matrix",a=n._uniformSetters,l={},u=Object.keys(a).sort();let c=0;for(const p of u)!p.match(s)&&!p.match(o)&&cu({table:l,header:e,uniforms:r,uniformName:p,undefinedOnly:i})&&c++;for(const p of u)p.match(o)&&cu({table:l,header:e,uniforms:r,uniformName:p,undefinedOnly:i})&&c++;for(const p of u)l[p]||cu({table:l,header:e,uniforms:r,uniformName:p,undefinedOnly:i})&&c++;let f=0;const h={};if(!i)for(const p in r){const E=r[p];l[p]||(f++,h[p]={Type:"NOT USED: ".concat(E),[e]:Ns(E)})}return{table:l,count:c,unusedTable:h,unusedCount:f}}function cu(t){let{table:e,header:n,uniforms:r,uniformName:i,undefinedOnly:s}=t;const o=r[i],a=Vx(o);return!s||!a?(e[i]={[n]:a?Ns(o):"N/A","Uniform Type":a?o:"NOT PROVIDED"},!0):!1}function Vx(t){return t!=null}function jx(t){let{vertexArray:e,header:n="Attributes"}=t;if(!e.configuration)return{};const r={};e.elements&&(r.ELEMENT_ARRAY_BUFFER=ep(e,e.elements,null,n));const i=e.values;for(const s in i){const o=e._getAttributeInfo(s);if(o){let a="".concat(s,": ").concat(o.name);const l=e.accessors[o.location];l&&(a="".concat(s,": ").concat(Gx(o.name,l))),r[a]=ep(e,i[s],l,n)}}return r}function ep(t,e,n,r){const{gl:i}=t;if(!e)return{[r]:"null","Format ":"N/A"};let s="NOT PROVIDED",o=1,a=0,l=0,u,c,f;if(n&&(s=n.type,o=n.size,s=String(s).replace("Array",""),u=s.indexOf("nt")!==-1),e instanceof J){const h=e,{data:p,changed:E}=h.getDebugData();c=E?"*":"",f=p,l=h.byteLength,a=l/p.BYTES_PER_ELEMENT/o;let w;if(n){const S=n.divisor>0;w="".concat(S?"I ":"P "," ").concat(a," (x").concat(o,"=").concat(l," bytes ").concat(jn(i,s),")")}else u=!0,w="".concat(l," bytes");return{[r]:"".concat(c).concat(Ns(f,{size:o,isInteger:u})),"Format ":w}}return f=e,o=e.length,s=String(e.constructor.name).replace("Array",""),u=s.indexOf("nt")!==-1,{[r]:"".concat(Ns(f,{size:o,isInteger:u})," (constant)"),"Format ":"".concat(o,"x").concat(s," (constant)")}}function Gx(t,e){const{type:n,size:r}=e,i=rv(n,r);return i?"".concat(t," (").concat(i.name,")"):t}function Hx(t){const e={},n="Accessors for ".concat(t.id);for(const r of t.attributeInfos)if(r){const i=tp(r);e["in ".concat(i)]={[n]:JSON.stringify(r.accessor)}}for(const r of t.varyingInfos)if(r){const i=tp(r);e["out ".concat(i)]={[n]:JSON.stringify(r.accessor)}}return e}function tp(t){const{type:e,size:n}=t.accessor,r=rv(e,n);return r?"".concat(r.name," ").concat(t.name):t.name}const np=_n()&&typeof document<"u";let Wx=0;class Xx{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{onCreateContext:n=S=>H_(S),onAddHTML:r=null,onInitialize:i=()=>{},onRender:s=()=>{},onFinalize:o=()=>{},onError:a,gl:l=null,glOptions:u={},debug:c=!1,createFramebuffer:f=!1,autoResizeViewport:h=!0,autoResizeDrawingBuffer:p=!0,stats:E=ar.get("animation-loop-".concat(Wx++))}=e;let{useDevicePixels:w=!0}=e;"useDevicePixelRatio"in e&&(U.deprecated("useDevicePixelRatio","useDevicePixels")(),w=e.useDevicePixelRatio),this.props={onCreateContext:n,onAddHTML:r,onInitialize:i,onRender:s,onFinalize:o,onError:a,gl:l,glOptions:u,debug:c,createFramebuffer:f},this.gl=l,this.needsRedraw=null,this.timeline=null,this.stats=E,this.cpuTime=this.stats.get("CPU Time"),this.gpuTime=this.stats.get("GPU Time"),this.frameRate=this.stats.get("Frame Rate"),this._initialized=!1,this._running=!1,this._animationFrameId=null,this._nextFramePromise=null,this._resolveNextFrame=null,this._cpuStartTime=0,this.setProps({autoResizeViewport:h,autoResizeDrawingBuffer:p,useDevicePixels:w}),this.start=this.start.bind(this),this.stop=this.stop.bind(this),this._pageLoadPromise=null,this._onMousemove=this._onMousemove.bind(this),this._onMouseleave=this._onMouseleave.bind(this)}delete(){this.stop(),this._setDisplay(null)}setNeedsRedraw(e){return k(typeof e=="string"),this.needsRedraw=this.needsRedraw||e,this}setProps(e){return"autoResizeViewport"in e&&(this.autoResizeViewport=e.autoResizeViewport),"autoResizeDrawingBuffer"in e&&(this.autoResizeDrawingBuffer=e.autoResizeDrawingBuffer),"useDevicePixels"in e&&(this.useDevicePixels=e.useDevicePixels),this}start(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(this._running)return this;this._running=!0;const n=this._getPageLoadPromise().then(()=>!this._running||this._initialized?null:(this._createWebGLContext(e),this._createFramebuffer(),this._startEventHandling(),this._initializeCallbackData(),this._updateCallbackData(),this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._gpuTimeQuery=Na.isSupported(this.gl,["timers"])?new Na(this.gl):null,this._initialized=!0,this.onInitialize(this.animationProps))).then(r=>{this._running&&(this._addCallbackData(r||{}),r!==!1&&this._startLoop())});return this.props.onError&&n.catch(this.props.onError),this}redraw(){return this.isContextLost()?this:(this._beginTimers(),this._setupFrame(),this._updateCallbackData(),this._renderFrame(this.animationProps),this._clearNeedsRedraw(),this.offScreen&&this.gl.commit&&this.gl.commit(),this._resolveNextFrame&&(this._resolveNextFrame(this),this._nextFramePromise=null,this._resolveNextFrame=null),this._endTimers(),this)}stop(){return this._running&&(this._finalizeCallbackData(),this._cancelAnimationFrame(this._animationFrameId),this._nextFramePromise=null,this._resolveNextFrame=null,this._animationFrameId=null,this._running=!1),this}attachTimeline(e){return this.timeline=e,this.timeline}detachTimeline(){this.timeline=null}waitForRender(){return this.setNeedsRedraw("waitForRender"),this._nextFramePromise||(this._nextFramePromise=new Promise(e=>{this._resolveNextFrame=e})),this._nextFramePromise}async toDataURL(){return this.setNeedsRedraw("toDataURL"),await this.waitForRender(),this.gl.canvas.toDataURL()}isContextLost(){return this.gl.isContextLost()}onCreateContext(){return this.props.onCreateContext(...arguments)}onInitialize(){return this.props.onInitialize(...arguments)}onRender(){return this.props.onRender(...arguments)}onFinalize(){return this.props.onFinalize(...arguments)}getHTMLControlValue(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;const r=document.getElementById(e);return r?Number(r.value):n}setViewParameters(){return U.removed("AnimationLoop.setViewParameters","AnimationLoop.setProps")(),this}_startLoop(){const e=()=>{this._running&&(this.redraw(),this._animationFrameId=this._requestAnimationFrame(e))};this._cancelAnimationFrame(this._animationFrameId),this._animationFrameId=this._requestAnimationFrame(e)}_getPageLoadPromise(){return this._pageLoadPromise||(this._pageLoadPromise=np?new Promise((e,n)=>{if(np&&document.readyState==="complete"){e(document);return}window.addEventListener("load",()=>{e(document)})}):Promise.resolve({})),this._pageLoadPromise}_setDisplay(e){this.display&&(this.display.delete(),this.display.animationLoop=null),e&&(e.animationLoop=this),this.display=e}_cancelAnimationFrame(e){return this.display&&this.display.cancelAnimationFrame?this.display.cancelAnimationFrame(e):JS(e)}_requestAnimationFrame(e){if(this._running)return this.display&&this.display.requestAnimationFrame?this.display.requestAnimationFrame(e):KS(e)}_renderFrame(){if(this.display){this.display._renderFrame(...arguments);return}this.onRender(...arguments)}_clearNeedsRedraw(){this.needsRedraw=null}_setupFrame(){this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._resizeFramebuffer()}_initializeCallbackData(){this.animationProps={gl:this.gl,stop:this.stop,canvas:this.gl.canvas,framebuffer:this.framebuffer,useDevicePixels:this.useDevicePixels,needsRedraw:null,startTime:Date.now(),engineTime:0,tick:0,tock:0,time:0,_timeline:this.timeline,_loop:this,_animationLoop:this,_mousePosition:null}}_updateCallbackData(){const{width:e,height:n,aspect:r}=this._getSizeAndAspect();(e!==this.animationProps.width||n!==this.animationProps.height)&&this.setNeedsRedraw("drawing buffer resized"),r!==this.animationProps.aspect&&this.setNeedsRedraw("drawing buffer aspect changed"),this.animationProps.width=e,this.animationProps.height=n,this.animationProps.aspect=r,this.animationProps.needsRedraw=this.needsRedraw,this.animationProps.engineTime=Date.now()-this.animationProps.startTime,this.timeline&&this.timeline.update(this.animationProps.engineTime),this.animationProps.tick=Math.floor(this.animationProps.time/1e3*60),this.animationProps.tock++,this.animationProps.time=this.timeline?this.timeline.getTime():this.animationProps.engineTime,this.animationProps._offScreen=this.offScreen}_finalizeCallbackData(){this.onFinalize(this.animationProps)}_addCallbackData(e){typeof e=="object"&&e!==null&&(this.animationProps=Object.assign({},this.animationProps,e))}_createWebGLContext(e){if(this.offScreen=e.canvas&&typeof OffscreenCanvas<"u"&&e.canvas instanceof OffscreenCanvas,e=Object.assign({},e,this.props.glOptions),this.gl=this.props.gl?eh(this.props.gl,e):this.onCreateContext(e),!ul(this.gl))throw new Error("AnimationLoop.onCreateContext - illegal context returned");BS(this.gl),this._createInfoDiv()}_createInfoDiv(){if(this.gl.canvas&&this.props.onAddHTML){const e=document.createElement("div");document.body.appendChild(e),e.style.position="relative";const n=document.createElement("div");n.style.position="absolute",n.style.left="10px",n.style.bottom="10px",n.style.width="300px",n.style.background="white",e.appendChild(this.gl.canvas),e.appendChild(n);const r=this.props.onAddHTML(n);r&&(n.innerHTML=r)}}_getSizeAndAspect(){const e=this.gl.drawingBufferWidth,n=this.gl.drawingBufferHeight;let r=1;const{canvas:i}=this.gl;return i&&i.clientHeight?r=i.clientWidth/i.clientHeight:e>0&&n>0&&(r=e/n),{width:e,height:n,aspect:r}}_resizeViewport(){this.autoResizeViewport&&this.gl.viewport(0,0,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight)}_resizeCanvasDrawingBuffer(){this.autoResizeDrawingBuffer&&HS(this.gl,{useDevicePixels:this.useDevicePixels})}_createFramebuffer(){this.props.createFramebuffer&&(this.framebuffer=new Te(this.gl))}_resizeFramebuffer(){this.framebuffer&&this.framebuffer.resize({width:this.gl.drawingBufferWidth,height:this.gl.drawingBufferHeight})}_beginTimers(){this.frameRate.timeEnd(),this.frameRate.timeStart(),this._gpuTimeQuery&&this._gpuTimeQuery.isResultAvailable()&&!this._gpuTimeQuery.isTimerDisjoint()&&this.stats.get("GPU Time").addTime(this._gpuTimeQuery.getTimerMilliseconds()),this._gpuTimeQuery&&this._gpuTimeQuery.beginTimeElapsedQuery(),this.cpuTime.timeStart()}_endTimers(){this.cpuTime.timeEnd(),this._gpuTimeQuery&&this._gpuTimeQuery.end()}_startEventHandling(){const{canvas:e}=this.gl;e&&(e.addEventListener("mousemove",this._onMousemove),e.addEventListener("mouseleave",this._onMouseleave))}_onMousemove(e){this.animationProps._mousePosition=[e.offsetX,e.offsetY]}_onMouseleave(e){this.animationProps._mousePosition=null}}const Zs="vs",ih="fs";function ot(t,e){if(!t)throw new Error(e||"shadertools: assertion failed.")}const fu={number:{validate(t,e){return Number.isFinite(t)&&(!("max"in e)||t<=e.max)&&(!("min"in e)||t>=e.min)}},array:{validate(t,e){return Array.isArray(t)||ArrayBuffer.isView(t)}}};function Yx(t){const e={};for(const n in t){const r=t[n],i=$x(r);e[n]=i}return e}function $x(t){let e=rp(t);return e==="object"?t?"type"in t?Object.assign({},t,fu[t.type]):"value"in t?(e=rp(t.value),Object.assign({type:e},t,fu[e])):{type:"object",value:t}:{type:"object",value:null}:Object.assign({type:e,value:t},fu[e])}function rp(t){return Array.isArray(t)||ArrayBuffer.isView(t)?"array":typeof t}const qx="vs",Zx="fs";class ip{constructor(e){let{name:n,vs:r,fs:i,dependencies:s=[],uniforms:o,getUniforms:a,deprecations:l=[],defines:u={},inject:c={},vertexShader:f,fragmentShader:h}=e;ot(typeof n=="string"),this.name=n,this.vs=r||f,this.fs=i||h,this.getModuleUniforms=a,this.dependencies=s,this.deprecations=this._parseDeprecationDefinitions(l),this.defines=u,this.injections=Qx(c),o&&(this.uniforms=Yx(o))}getModuleSource(e){let n;switch(e){case qx:n=this.vs||"";break;case Zx:n=this.fs||"";break;default:ot(!1)}return"#define MODULE_".concat(this.name.toUpperCase().replace(/[^0-9a-z]/gi,"_"),`
`).concat(n,"// END MODULE_").concat(this.name,`

`)}getUniforms(e,n){return this.getModuleUniforms?this.getModuleUniforms(e,n):this.uniforms?this._defaultGetUniforms(e):{}}getDefines(){return this.defines}checkDeprecations(e,n){this.deprecations.forEach(r=>{r.regex.test(e)&&(r.deprecated?n.deprecated(r.old,r.new)():n.removed(r.old,r.new)())})}_parseDeprecationDefinitions(e){return e.forEach(n=>{switch(n.type){case"function":n.regex=new RegExp("\\b".concat(n.old,"\\("));break;default:n.regex=new RegExp("".concat(n.type," ").concat(n.old,";"))}}),e}_defaultGetUniforms(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n={},r=this.uniforms;for(const i in r){const s=r[i];i in e&&!s.private?(s.validate&&ot(s.validate(e[i],s),"".concat(this.name,": invalid ").concat(i)),n[i]=e[i]):n[i]=s.value}return n}}function Qx(t){const e={vs:{},fs:{}};for(const n in t){let r=t[n];const i=n.slice(0,2);typeof r=="string"&&(r={order:0,injection:r}),e[i][n]=r}return e}function Kx(t){return Jx(av(t))}function Jx(t){const e={},n={};return ov({modules:t,level:0,moduleMap:e,moduleDepth:n}),Object.keys(n).sort((r,i)=>n[i]-n[r]).map(r=>e[r])}function ov(t){let{modules:e,level:n,moduleMap:r,moduleDepth:i}=t;if(n>=5)throw new Error("Possible loop in shader dependency graph");for(const s of e)r[s.name]=s,(i[s.name]===void 0||i[s.name]<n)&&(i[s.name]=n);for(const s of e)s.dependencies&&ov({modules:s.dependencies,level:n+1,moduleMap:r,moduleDepth:i})}function av(t,e){return t.map(n=>(n instanceof ip||(ot(typeof n!="string","Shader module use by name is deprecated. Import shader module '".concat(n,"' and use it directly.")),ot(n.name,"shader module has no name"),n=new ip(n),n.dependencies=av(n.dependencies)),n))}function eP(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=typeof window<"u"?window.navigator||{}:{},n=t.userAgent||e.userAgent||"",r=n.indexOf("MSIE ")!==-1,i=n.indexOf("Trident/")!==-1;return r||i}const tP=7936,nP=7937,rP=7938,iP=35724,sh={GLSL_FRAG_DATA:["WEBGL_draw_buffers",!0],GLSL_FRAG_DEPTH:["EXT_frag_depth",!0],GLSL_DERIVATIVES:["OES_standard_derivatives",!0],GLSL_TEXTURE_LOD:["EXT_shader_texture_lod",!0]},rr={};Object.keys(sh).forEach(t=>{rr[t]=t});function sP(t){return typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?!0:!!(t&&t._version===2)}function oP(t){const e=t.getExtension("WEBGL_debug_renderer_info"),n=t.getParameter(e&&e.UNMASKED_VENDOR_WEBGL||tP),r=t.getParameter(e&&e.UNMASKED_RENDERER_WEBGL||nP);return{gpuVendor:aP(n,r),vendor:n,renderer:r,version:t.getParameter(rP),shadingLanguageVersion:t.getParameter(iP)}}function aP(t,e){return t.match(/NVIDIA/i)||e.match(/NVIDIA/i)?"NVIDIA":t.match(/INTEL/i)||e.match(/INTEL/i)?"INTEL":t.match(/AMD/i)||e.match(/AMD/i)||t.match(/ATI/i)||e.match(/ATI/i)?"AMD":"UNKNOWN GPU"}const hu={};function sp(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const r=sh[e];if(ot(r,e),!eP(n))return!0;if(e in hu)return hu[e];const i=r[0],s=n.behavior||"enable",o="#extension GL_".concat(i," : ").concat(s,`
void main(void) {}`),a=t.createShader(35633);t.shaderSource(a,o),t.compileShader(a);const l=t.getShaderParameter(a,35713);return t.deleteShader(a),hu[e]=l,l}function lP(t,e){const n=sh[e];ot(n,e);const r=sP(t)&&n[1]||n[0],i=typeof r=="string"?!!t.getExtension(r):r;return ot(i===!1||i===!0),i}function No(t,e){return e=Array.isArray(e)?e:[e],e.every(n=>lP(t,n))}function uP(t){switch(oP(t).gpuVendor.toLowerCase()){case"nvidia":return`#define NVIDIA_GPU
// Nvidia optimizes away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
`;case"intel":return`#define INTEL_GPU
// Intel optimizes away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
// Intel's built-in 'tan' function doesn't have acceptable precision
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`;case"amd":return`#define AMD_GPU
`;default:return`#define DEFAULT_GPU
// Prevent driver from optimizing away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
// Intel's built-in 'tan' function doesn't have acceptable precision
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`}}function cP(t,e,n){let r=`#if (__VERSION__ > 120)

# define FEATURE_GLSL_DERIVATIVES
# define FEATURE_GLSL_DRAW_BUFFERS
# define FEATURE_GLSL_FRAG_DEPTH
# define FEATURE_GLSL_TEXTURE_LOD

// DEPRECATED FLAGS, remove in v9
# define FRAG_DEPTH
# define DERIVATIVES
# define DRAW_BUFFERS
# define TEXTURE_LOD

#endif // __VERSION
`;return No(t,rr.GLSL_FRAG_DEPTH)&&(r+=`
// FRAG_DEPTH => gl_FragDepth is available
#ifdef GL_EXT_frag_depth
#extension GL_EXT_frag_depth : enable
# define FEATURE_GLSL_FRAG_DEPTH
# define FRAG_DEPTH
# define gl_FragDepth gl_FragDepthEXT
#endif
`),No(t,rr.GLSL_DERIVATIVES)&&sp(t,rr.GLSL_DERIVATIVES)&&(r+=`
// DERIVATIVES => dxdF, dxdY and fwidth are available
#ifdef GL_OES_standard_derivatives
#extension GL_OES_standard_derivatives : enable
# define FEATURE_GLSL_DERIVATIVES
# define DERIVATIVES
#endif
`),No(t,rr.GLSL_FRAG_DATA)&&sp(t,rr.GLSL_FRAG_DATA,{behavior:"require"})&&(r+=`
// DRAW_BUFFERS => gl_FragData[] is available
#ifdef GL_EXT_draw_buffers
#extension GL_EXT_draw_buffers : require
#define FEATURE_GLSL_DRAW_BUFFERS
#define DRAW_BUFFERS
#endif
`),No(t,rr.GLSL_TEXTURE_LOD)&&(r+=`// TEXTURE_LOD => texture2DLod etc are available
#ifdef GL_EXT_shader_texture_lod
#extension GL_EXT_shader_texture_lod : enable

# define FEATURE_GLSL_TEXTURE_LOD
# define TEXTURE_LOD

#endif
`),r}const fP=`#ifdef MODULE_LOGDEPTH
  logdepth_adjustPosition(gl_Position);
#endif
`,hP=`#ifdef MODULE_MATERIAL
  gl_FragColor = material_filterColor(gl_FragColor);
#endif

#ifdef MODULE_LIGHTING
  gl_FragColor = lighting_filterColor(gl_FragColor);
#endif

#ifdef MODULE_FOG
  gl_FragColor = fog_filterColor(gl_FragColor);
#endif

#ifdef MODULE_PICKING
  gl_FragColor = picking_filterHighlightColor(gl_FragColor);
  gl_FragColor = picking_filterPickingColor(gl_FragColor);
#endif

#ifdef MODULE_LOGDEPTH
  logdepth_setFragDepth();
#endif
`,dP={[Zs]:fP,[ih]:hP},ra="__LUMA_INJECT_DECLARATIONS__",op=/void\s+main\s*\([^)]*\)\s*\{\n?/,ap=/}\n?[^{}]*$/,du=[];function lp(t,e,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const i=e===Zs;for(const s in n){const o=n[s];o.sort((l,u)=>l.order-u.order),du.length=o.length;for(let l=0,u=o.length;l<u;++l)du[l]=o[l].injection;const a="".concat(du.join(`
`),`
`);switch(s){case"vs:#decl":i&&(t=t.replace(ra,a));break;case"vs:#main-start":i&&(t=t.replace(op,l=>l+a));break;case"vs:#main-end":i&&(t=t.replace(ap,l=>a+l));break;case"fs:#decl":i||(t=t.replace(ra,a));break;case"fs:#main-start":i||(t=t.replace(op,l=>l+a));break;case"fs:#main-end":i||(t=t.replace(ap,l=>a+l));break;default:t=t.replace(s,l=>l+a)}}return t=t.replace(ra,""),r&&(t=t.replace(/\}\s*$/,s=>s+dP[e])),t}function Rc(t){const e={};return ot(Array.isArray(t)&&t.length>1),t.forEach(n=>{for(const r in n)e[r]=e[r]?"".concat(e[r],`
`).concat(n[r]):n[r]}),e}function pi(t){return new RegExp("\\b".concat(t,"[ \\t]+(\\w+[ \\t]+\\w+(\\[\\w+\\])?;)"),"g")}const lv=[[/^(#version[ \t]+(100|300[ \t]+es))?[ \t]*\n/,`#version 300 es
`],[/\btexture(2D|2DProj|Cube)Lod(EXT)?\(/g,"textureLod("],[/\btexture(2D|2DProj|Cube)(EXT)?\(/g,"texture("]],gP=[...lv,[pi("attribute"),"in $1"],[pi("varying"),"out $1"]],pP=[...lv,[pi("varying"),"in $1"]],uv=[[/^#version[ \t]+300[ \t]+es/,"#version 100"],[/\btexture(2D|2DProj|Cube)Lod\(/g,"texture$1LodEXT("],[/\btexture\(/g,"texture2D("],[/\btextureLod\(/g,"texture2DLodEXT("]],mP=[...uv,[pi("in"),"attribute $1"],[pi("out"),"varying $1"]],_P=[...uv,[pi("in"),"varying $1"]],Ic="gl_FragColor",Oc=/\bout[ \t]+vec4[ \t]+(\w+)[ \t]*;\n?/,vP=/void\s+main\s*\([^)]*\)\s*\{\n?/;function yP(t,e,n){switch(e){case 300:return n?Da(t,gP):EP(t);case 100:return n?Da(t,mP):wP(t);default:throw new Error("unknown GLSL version ".concat(e))}}function Da(t,e){for(const[n,r]of e)t=t.replace(n,r);return t}function EP(t){t=Da(t,pP);const e=t.match(Oc);if(e){const n=e[1];t=t.replace(new RegExp("\\b".concat(Ic,"\\b"),"g"),n)}else{const n="fragmentColor";t=t.replace(vP,r=>"out vec4 ".concat(n,`;
`).concat(r)).replace(new RegExp("\\b".concat(Ic,"\\b"),"g"),n)}return t}function wP(t){t=Da(t,_P);const e=t.match(Oc);if(e){const n=e[1];t=t.replace(Oc,"").replace(new RegExp("\\b".concat(n,"\\b"),"g"),Ic)}return t}const TP=`

`.concat(ra,`

`),cv={[Zs]:"vertex",[ih]:"fragment"},bP=`precision highp float;

`;function SP(t,e){const{vs:n,fs:r}=e,i=Kx(e.modules||[]);return{gl:t,vs:up(t,Object.assign({},e,{source:n,type:Zs,modules:i})),fs:up(t,Object.assign({},e,{source:r,type:ih,modules:i})),getUniforms:AP(i)}}function up(t,e){let{id:n,source:r,type:i,modules:s,defines:o={},hookFunctions:a=[],inject:l={},transpileToGLSL100:u=!1,prologue:c=!0,log:f}=e;ot(typeof r=="string","shader source must be a string");const h=i===Zs,p=r.split(`
`);let E=100,w="",S=r;p[0].indexOf("#version ")===0?(E=300,w=p[0],S=p.slice(1).join(`
`)):w="#version ".concat(E);const _={};s.forEach(L=>{Object.assign(_,L.getDefines())}),Object.assign(_,o);let m=c?"".concat(w,`
`).concat(PP({id:n,source:r,type:i}),`
`).concat(xP({type:i}),`
`).concat(uP(t),`
`).concat(cP(t),`
`).concat(LP(_),`
`).concat(h?"":bP,`
`):"".concat(w,`
`);const y=MP(a),b={},x={},P={};for(const L in l){const C=typeof l[L]=="string"?{injection:l[L],order:0}:l[L],O=L.match(/^(v|f)s:(#)?([\w-]+)$/);if(O){const I=O[2],B=O[3];I?B==="decl"?x[L]=[C]:P[L]=[C]:b[L]=[C]}else P[L]=[C]}for(const L of s){f&&L.checkDeprecations(S,f);const C=L.getModuleSource(i,E);m+=C;const O=L.injections[i];for(const I in O){const B=I.match(/^(v|f)s:#([\w-]+)$/);if(B){const K=B[2]==="decl"?x:P;K[I]=K[I]||[],K[I].push(O[I])}else b[I]=b[I]||[],b[I].push(O[I])}}return m+=TP,m=lp(m,i,x),m+=CP(y[i],b),m+=S,m=lp(m,i,P),m=yP(m,u?100:E,h),m}function AP(t){return function(n){const r={};for(const i of t){const s=i.getUniforms(n,r);Object.assign(r,s)}return r}}function xP(t){let{type:e}=t;return`
#define SHADER_TYPE_`.concat(cv[e].toUpperCase(),`
`)}function PP(t){let{id:e,source:n,type:r}=t;return e&&typeof e=="string"&&n.indexOf("SHADER_NAME")===-1?`
#define SHADER_NAME `.concat(e,"_").concat(cv[r],`

`):""}function LP(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=0,n="";for(const r in t){e===0&&(n+=`
// APPLICATION DEFINES
`),e++;const i=t[r];(i||Number.isFinite(i))&&(n+="#define ".concat(r.toUpperCase()," ").concat(t[r],`
`))}return e===0&&(n+=`
`),n}function CP(t,e){let n="";for(const r in t){const i=t[r];if(n+="void ".concat(i.signature,` {
`),i.header&&(n+="  ".concat(i.header)),e[r]){const s=e[r];s.sort((o,a)=>o.order-a.order);for(const o of s)n+="  ".concat(o.injection,`
`)}i.footer&&(n+="  ".concat(i.footer)),n+=`}
`}return n}function MP(t){const e={vs:{},fs:{}};return t.forEach(n=>{let r;typeof n!="string"?(r=n,n=r.hook):r={},n=n.trim();const[i,s]=n.split(":"),o=n.replace(/\(.+/,"");e[i][o]=Object.assign(r,{signature:s})}),e}const RP="void main() {gl_FragColor = vec4(0);}",fv=`out vec4 transform_output;
void main() {
  transform_output = vec4(0);
}`,IP=`#version 300 es
`.concat(fv);function hv(t,e){e=Array.isArray(e)?e:[e];const n=t.replace(/^\s+/,"").split(/\s+/),[r,i,s]=n;if(!e.includes(r)||!i||!s)return null;const o=s.split(";")[0];return{qualifier:r,type:i,name:o}}function dv(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{version:e=100,input:n,inputType:r,output:i}=t;if(!n)return e===300?IP:e>300?"#version ".concat(e,`
`).concat(fv):RP;const s=NP(n,r);return e>=300?"#version ".concat(e," ").concat(e===300?"es":"",`
in `).concat(r," ").concat(n,`;
out vec4 `).concat(i,`;
void main() {
  `).concat(i," = ").concat(s,`;
}`):"varying ".concat(r," ").concat(n,`;
void main() {
  gl_FragColor = `).concat(s,`;
}`)}function OP(t){switch(t){case"float":return"x";case"vec2":return"xy";case"vec3":return"xyz";case"vec4":return"xyzw";default:return ot(!1),null}}function kP(t){switch(t){case"float":return 1;case"vec2":return 2;case"vec3":return 3;case"vec4":return 4;default:return ot(!1),null}}function NP(t,e){switch(e){case"float":return"vec4(".concat(t,", 0.0, 0.0, 1.0)");case"vec2":return"vec4(".concat(t,", 0.0, 1.0)");case"vec3":return"vec4(".concat(t,", 1.0)");case"vec4":return t;default:return ot(!1),null}}const DP=`#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND
const float TWO_PI = 6.2831854820251465;
const float PI_2 = 1.5707963705062866;
const float PI_16 = 0.1963495463132858;

const float SIN_TABLE_0 = 0.19509032368659973;
const float SIN_TABLE_1 = 0.3826834261417389;
const float SIN_TABLE_2 = 0.5555702447891235;
const float SIN_TABLE_3 = 0.7071067690849304;

const float COS_TABLE_0 = 0.9807852506637573;
const float COS_TABLE_1 = 0.9238795042037964;
const float COS_TABLE_2 = 0.8314695954322815;
const float COS_TABLE_3 = 0.7071067690849304;

const float INVERSE_FACTORIAL_3 = 1.666666716337204e-01;
const float INVERSE_FACTORIAL_5 = 8.333333767950535e-03;
const float INVERSE_FACTORIAL_7 = 1.9841270113829523e-04;
const float INVERSE_FACTORIAL_9 = 2.75573188446287533e-06;

float sin_taylor_fp32(float a) {
  float r, s, t, x;

  if (a == 0.0) {
    return 0.0;
  }

  x = -a * a;
  s = a;
  r = a;

  r = r * x;
  t = r * INVERSE_FACTORIAL_3;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_5;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_7;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_9;
  s = s + t;

  return s;
}

void sincos_taylor_fp32(float a, out float sin_t, out float cos_t) {
  if (a == 0.0) {
    sin_t = 0.0;
    cos_t = 1.0;
  }
  sin_t = sin_taylor_fp32(a);
  cos_t = sqrt(1.0 - sin_t * sin_t);
}

float tan_taylor_fp32(float a) {
    float sin_a;
    float cos_a;

    if (a == 0.0) {
        return 0.0;
    }
    float z = floor(a / TWO_PI);
    float r = a - TWO_PI * z;

    float t;
    float q = floor(r / PI_2 + 0.5);
    int j = int(q);

    if (j < -2 || j > 2) {
        return 1.0 / 0.0;
    }

    t = r - PI_2 * q;

    q = floor(t / PI_16 + 0.5);
    int k = int(q);
    int abs_k = int(abs(float(k)));

    if (abs_k > 4) {
        return 1.0 / 0.0;
    } else {
        t = t - PI_16 * q;
    }

    float u = 0.0;
    float v = 0.0;

    float sin_t, cos_t;
    float s, c;
    sincos_taylor_fp32(t, sin_t, cos_t);

    if (k == 0) {
        s = sin_t;
        c = cos_t;
    } else {
        if (abs(float(abs_k) - 1.0) < 0.5) {
            u = COS_TABLE_0;
            v = SIN_TABLE_0;
        } else if (abs(float(abs_k) - 2.0) < 0.5) {
            u = COS_TABLE_1;
            v = SIN_TABLE_1;
        } else if (abs(float(abs_k) - 3.0) < 0.5) {
            u = COS_TABLE_2;
            v = SIN_TABLE_2;
        } else if (abs(float(abs_k) - 4.0) < 0.5) {
            u = COS_TABLE_3;
            v = SIN_TABLE_3;
        }
        if (k > 0) {
            s = u * sin_t + v * cos_t;
            c = u * cos_t - v * sin_t;
        } else {
            s = u * sin_t - v * cos_t;
            c = u * cos_t + v * sin_t;
        }
    }

    if (j == 0) {
        sin_a = s;
        cos_a = c;
    } else if (j == 1) {
        sin_a = c;
        cos_a = -s;
    } else if (j == -1) {
        sin_a = -c;
        cos_a = s;
    } else {
        sin_a = -s;
        cos_a = -c;
    }
    return sin_a / cos_a;
}
#endif

float tan_fp32(float a) {
#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND
  return tan_taylor_fp32(a);
#else
  return tan(a);
#endif
}
`,FP={name:"fp32",vs:DP,fs:null};function cp(t,e){if(!t)throw new Error("math.gl assertion ".concat(e))}const it={EPSILON:1e-12,debug:!1,precision:4,printTypes:!1,printDegrees:!1,printRowMajor:!0};function UP(t,{precision:e=it.precision}={}){return t=BP(t),"".concat(parseFloat(t.toPrecision(e)))}function mi(t){return Array.isArray(t)||ArrayBuffer.isView(t)&&!(t instanceof DataView)}function In(t,e,n){return VP(t,r=>Math.max(e,Math.min(n,r)))}function Fa(t,e,n){return mi(t)?t.map((r,i)=>Fa(r,e[i],n)):n*e+(1-n)*t}function Ds(t,e,n){const r=it.EPSILON;n&&(it.EPSILON=n);try{if(t===e)return!0;if(mi(t)&&mi(e)){if(t.length!==e.length)return!1;for(let i=0;i<t.length;++i)if(!Ds(t[i],e[i]))return!1;return!0}return t&&t.equals?t.equals(e):e&&e.equals?e.equals(t):typeof t=="number"&&typeof e=="number"?Math.abs(t-e)<=it.EPSILON*Math.max(1,Math.abs(t),Math.abs(e)):!1}finally{it.EPSILON=r}}function BP(t){return Math.round(t/it.EPSILON)*it.EPSILON}function zP(t){return t.clone?t.clone():new Array(t.length)}function VP(t,e,n){if(mi(t)){const r=t;n=n||zP(r);for(let i=0;i<n.length&&i<r.length;++i)n[i]=e(t[i],i,n);return n}return e(t)}function jP(t){function e(){var n=Reflect.construct(t,Array.from(arguments));return Object.setPrototypeOf(n,Object.getPrototypeOf(this)),n}return e.prototype=Object.create(t.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t,e}class gv extends jP(Array){clone(){return new this.constructor().copy(this)}fromArray(e,n=0){for(let r=0;r<this.ELEMENTS;++r)this[r]=e[r+n];return this.check()}toArray(e=[],n=0){for(let r=0;r<this.ELEMENTS;++r)e[n+r]=this[r];return e}from(e){return Array.isArray(e)?this.copy(e):this.fromObject(e)}to(e){return e===this?this:mi(e)?this.toArray(e):this.toObject(e)}toTarget(e){return e?this.to(e):this}toFloat32Array(){return new Float32Array(this)}toString(){return this.formatString(it)}formatString(e){let n="";for(let r=0;r<this.ELEMENTS;++r)n+=(r>0?", ":"")+UP(this[r],e);return"".concat(e.printTypes?this.constructor.name:"","[").concat(n,"]")}equals(e){if(!e||this.length!==e.length)return!1;for(let n=0;n<this.ELEMENTS;++n)if(!Ds(this[n],e[n]))return!1;return!0}exactEquals(e){if(!e||this.length!==e.length)return!1;for(let n=0;n<this.ELEMENTS;++n)if(this[n]!==e[n])return!1;return!0}negate(){for(let e=0;e<this.ELEMENTS;++e)this[e]=-this[e];return this.check()}lerp(e,n,r){if(r===void 0)return this.lerp(this,e,n);for(let i=0;i<this.ELEMENTS;++i){const s=e[i];this[i]=s+r*(n[i]-s)}return this.check()}min(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(e[n],this[n]);return this.check()}max(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.max(e[n],this[n]);return this.check()}clamp(e,n){for(let r=0;r<this.ELEMENTS;++r)this[r]=Math.min(Math.max(this[r],e[r]),n[r]);return this.check()}add(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]+=n[r];return this.check()}subtract(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]-=n[r];return this.check()}scale(e){if(typeof e=="number")for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;else for(let n=0;n<this.ELEMENTS&&n<e.length;++n)this[n]*=e[n];return this.check()}multiplyByScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;return this.check()}check(){if(it.debug&&!this.validate())throw new Error("math.gl: ".concat(this.constructor.name," some fields set to invalid numbers'"));return this}validate(){let e=this.length===this.ELEMENTS;for(let n=0;n<this.ELEMENTS;++n)e=e&&Number.isFinite(this[n]);return e}sub(e){return this.subtract(e)}setScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=e;return this.check()}addScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]+=e;return this.check()}subScalar(e){return this.addScalar(-e)}multiplyScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;return this.check()}divideScalar(e){return this.multiplyByScalar(1/e)}clampScalar(e,n){for(let r=0;r<this.ELEMENTS;++r)this[r]=Math.min(Math.max(this[r],e),n);return this.check()}get elements(){return this}}function GP(t,e){if(t.length!==e)return!1;for(let n=0;n<t.length;++n)if(!Number.isFinite(t[n]))return!1;return!0}function tt(t){if(!Number.isFinite(t))throw new Error("Invalid number ".concat(t));return t}function gu(t,e,n=""){if(it.debug&&!GP(t,e))throw new Error("math.gl: ".concat(n," some fields set to invalid numbers'"));return t}class HP extends gv{get x(){return this[0]}set x(e){this[0]=tt(e)}get y(){return this[1]}set y(e){this[1]=tt(e)}len(){return Math.sqrt(this.lengthSquared())}magnitude(){return this.len()}lengthSquared(){let e=0;for(let n=0;n<this.ELEMENTS;++n)e+=this[n]*this[n];return e}magnitudeSquared(){return this.lengthSquared()}distance(e){return Math.sqrt(this.distanceSquared(e))}distanceSquared(e){let n=0;for(let r=0;r<this.ELEMENTS;++r){const i=this[r]-e[r];n+=i*i}return tt(n)}dot(e){let n=0;for(let r=0;r<this.ELEMENTS;++r)n+=this[r]*e[r];return tt(n)}normalize(){const e=this.magnitude();if(e!==0)for(let n=0;n<this.ELEMENTS;++n)this[n]/=e;return this.check()}multiply(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]*=n[r];return this.check()}divide(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]/=n[r];return this.check()}lengthSq(){return this.lengthSquared()}distanceTo(e){return this.distance(e)}distanceToSquared(e){return this.distanceSquared(e)}getComponent(e){return cp(e>=0&&e<this.ELEMENTS,"index is out of range"),tt(this[e])}setComponent(e,n){return cp(e>=0&&e<this.ELEMENTS,"index is out of range"),this[e]=n,this.check()}addVectors(e,n){return this.copy(e).add(n)}subVectors(e,n){return this.copy(e).subtract(n)}multiplyVectors(e,n){return this.copy(e).multiply(n)}addScaledVector(e,n){return this.add(new this.constructor(e).multiplyScalar(n))}}var ia=1e-6,_i=typeof Float32Array<"u"?Float32Array:Array;Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});function WP(){var t=new _i(2);return _i!=Float32Array&&(t[0]=0,t[1]=0),t}function fp(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t}function XP(t,e){return t[0]=-e[0],t[1]=-e[1],t}function pv(t,e,n,r){var i=e[0],s=e[1];return t[0]=i+r*(n[0]-i),t[1]=s+r*(n[1]-s),t}function YP(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[4]*i+n[12],t[1]=n[1]*r+n[5]*i+n[13],t}(function(){var t=WP();return function(e,n,r,i,s,o){var a,l;for(n||(n=2),r||(r=0),i?l=Math.min(i*n+r,e.length):l=e.length,a=r;a<l;a+=n)t[0]=e[a],t[1]=e[a+1],s(t,t,o),e[a]=t[0],e[a+1]=t[1];return e}})();function $P(t,e,n){const r=e[0],i=e[1],s=n[3]*r+n[7]*i||1;return t[0]=(n[0]*r+n[4]*i)/s,t[1]=(n[1]*r+n[5]*i)/s,t}function mv(t,e,n){const r=e[0],i=e[1],s=e[2],o=n[3]*r+n[7]*i+n[11]*s||1;return t[0]=(n[0]*r+n[4]*i+n[8]*s)/o,t[1]=(n[1]*r+n[5]*i+n[9]*s)/o,t[2]=(n[2]*r+n[6]*i+n[10]*s)/o,t}function qP(t,e,n){const r=e[0],i=e[1];return t[0]=n[0]*r+n[2]*i,t[1]=n[1]*r+n[3]*i,t[2]=e[2],t}function ZP(){var t=new _i(3);return _i!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function QP(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}function KP(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function JP(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function e2(t,e,n){var r=e[0],i=e[1],s=e[2],o=n[0],a=n[1],l=n[2];return t[0]=i*l-s*a,t[1]=s*o-r*l,t[2]=r*a-i*o,t}function _v(t,e,n){var r=e[0],i=e[1],s=e[2],o=n[3]*r+n[7]*i+n[11]*s+n[15];return o=o||1,t[0]=(n[0]*r+n[4]*i+n[8]*s+n[12])/o,t[1]=(n[1]*r+n[5]*i+n[9]*s+n[13])/o,t[2]=(n[2]*r+n[6]*i+n[10]*s+n[14])/o,t}function t2(t,e,n){var r=e[0],i=e[1],s=e[2];return t[0]=r*n[0]+i*n[3]+s*n[6],t[1]=r*n[1]+i*n[4]+s*n[7],t[2]=r*n[2]+i*n[5]+s*n[8],t}function n2(t,e,n){var r=n[0],i=n[1],s=n[2],o=n[3],a=e[0],l=e[1],u=e[2],c=i*u-s*l,f=s*a-r*u,h=r*l-i*a,p=i*h-s*f,E=s*c-r*h,w=r*f-i*c,S=o*2;return c*=S,f*=S,h*=S,p*=2,E*=2,w*=2,t[0]=a+c+p,t[1]=l+f+E,t[2]=u+h+w,t}function r2(t,e,n,r){var i=[],s=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],s[0]=i[0],s[1]=i[1]*Math.cos(r)-i[2]*Math.sin(r),s[2]=i[1]*Math.sin(r)+i[2]*Math.cos(r),t[0]=s[0]+n[0],t[1]=s[1]+n[1],t[2]=s[2]+n[2],t}function i2(t,e,n,r){var i=[],s=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],s[0]=i[2]*Math.sin(r)+i[0]*Math.cos(r),s[1]=i[1],s[2]=i[2]*Math.cos(r)-i[0]*Math.sin(r),t[0]=s[0]+n[0],t[1]=s[1]+n[1],t[2]=s[2]+n[2],t}function s2(t,e,n,r){var i=[],s=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],s[0]=i[0]*Math.cos(r)-i[1]*Math.sin(r),s[1]=i[0]*Math.sin(r)+i[1]*Math.cos(r),s[2]=i[2],t[0]=s[0]+n[0],t[1]=s[1]+n[1],t[2]=s[2]+n[2],t}function o2(t,e){var n=t[0],r=t[1],i=t[2],s=e[0],o=e[1],a=e[2],l=Math.sqrt(n*n+r*r+i*i),u=Math.sqrt(s*s+o*o+a*a),c=l*u,f=c&&JP(t,e)/c;return Math.acos(Math.min(Math.max(f,-1),1))}var a2=QP;(function(){var t=ZP();return function(e,n,r,i,s,o){var a,l;for(n||(n=3),r||(r=0),i?l=Math.min(i*n+r,e.length):l=e.length,a=r;a<l;a+=n)t[0]=e[a],t[1]=e[a+1],t[2]=e[a+2],s(t,t,o),e[a]=t[0],e[a+1]=t[1],e[a+2]=t[2];return e}})();const pu=[0,0,0];let Do;class Yt extends HP{static get ZERO(){return Do||(Do=new Yt(0,0,0),Object.freeze(Do)),Do}constructor(e=0,n=0,r=0){super(-0,-0,-0),arguments.length===1&&mi(e)?this.copy(e):(it.debug&&(tt(e),tt(n),tt(r)),this[0]=e,this[1]=n,this[2]=r)}set(e,n,r){return this[0]=e,this[1]=n,this[2]=r,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this.check()}fromObject(e){return it.debug&&(tt(e.x),tt(e.y),tt(e.z)),this[0]=e.x,this[1]=e.y,this[2]=e.z,this.check()}toObject(e){return e.x=this[0],e.y=this[1],e.z=this[2],e}get ELEMENTS(){return 3}get z(){return this[2]}set z(e){this[2]=tt(e)}angle(e){return o2(this,e)}cross(e){return e2(this,this,e),this.check()}rotateX({radians:e,origin:n=pu}){return r2(this,this,n,e),this.check()}rotateY({radians:e,origin:n=pu}){return i2(this,this,n,e),this.check()}rotateZ({radians:e,origin:n=pu}){return s2(this,this,n,e),this.check()}transform(e){return this.transformAsPoint(e)}transformAsPoint(e){return _v(this,this,e),this.check()}transformAsVector(e){return mv(this,this,e),this.check()}transformByMatrix3(e){return t2(this,this,e),this.check()}transformByMatrix2(e){return qP(this,this,e),this.check()}transformByQuaternion(e){return n2(this,this,e),this.check()}}class l2 extends gv{toString(){let e="[";if(it.printRowMajor){e+="row-major:";for(let n=0;n<this.RANK;++n)for(let r=0;r<this.RANK;++r)e+=" ".concat(this[r*this.RANK+n])}else{e+="column-major:";for(let n=0;n<this.ELEMENTS;++n)e+=" ".concat(this[n])}return e+="]",e}getElementIndex(e,n){return n*this.RANK+e}getElement(e,n){return this[n*this.RANK+e]}setElement(e,n,r){return this[n*this.RANK+e]=tt(r),this}getColumn(e,n=new Array(this.RANK).fill(-0)){const r=e*this.RANK;for(let i=0;i<this.RANK;++i)n[i]=this[r+i];return n}setColumn(e,n){const r=e*this.RANK;for(let i=0;i<this.RANK;++i)this[r+i]=n[i];return this}}function u2(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function c2(t,e){if(t===e){var n=e[1],r=e[2],i=e[3],s=e[6],o=e[7],a=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=r,t[9]=s,t[11]=e[14],t[12]=i,t[13]=o,t[14]=a}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function kc(t,e){var n=e[0],r=e[1],i=e[2],s=e[3],o=e[4],a=e[5],l=e[6],u=e[7],c=e[8],f=e[9],h=e[10],p=e[11],E=e[12],w=e[13],S=e[14],_=e[15],m=n*a-r*o,y=n*l-i*o,b=n*u-s*o,x=r*l-i*a,P=r*u-s*a,L=i*u-s*l,C=c*w-f*E,O=c*S-h*E,I=c*_-p*E,B=f*S-h*w,$=f*_-p*w,K=h*_-p*S,X=m*K-y*$+b*B+x*I-P*O+L*C;return X?(X=1/X,t[0]=(a*K-l*$+u*B)*X,t[1]=(i*$-r*K-s*B)*X,t[2]=(w*L-S*P+_*x)*X,t[3]=(h*P-f*L-p*x)*X,t[4]=(l*I-o*K-u*O)*X,t[5]=(n*K-i*I+s*O)*X,t[6]=(S*b-E*L-_*y)*X,t[7]=(c*L-h*b+p*y)*X,t[8]=(o*$-a*I+u*C)*X,t[9]=(r*I-n*$-s*C)*X,t[10]=(E*P-w*b+_*m)*X,t[11]=(f*b-c*P-p*m)*X,t[12]=(a*O-o*B-l*C)*X,t[13]=(n*B-r*O+i*C)*X,t[14]=(w*y-E*x-S*m)*X,t[15]=(c*x-f*y+h*m)*X,t):null}function f2(t){var e=t[0],n=t[1],r=t[2],i=t[3],s=t[4],o=t[5],a=t[6],l=t[7],u=t[8],c=t[9],f=t[10],h=t[11],p=t[12],E=t[13],w=t[14],S=t[15],_=e*o-n*s,m=e*a-r*s,y=e*l-i*s,b=n*a-r*o,x=n*l-i*o,P=r*l-i*a,L=u*E-c*p,C=u*w-f*p,O=u*S-h*p,I=c*w-f*E,B=c*S-h*E,$=f*S-h*w;return _*$-m*B+y*I+b*O-x*C+P*L}function cr(t,e,n){var r=e[0],i=e[1],s=e[2],o=e[3],a=e[4],l=e[5],u=e[6],c=e[7],f=e[8],h=e[9],p=e[10],E=e[11],w=e[12],S=e[13],_=e[14],m=e[15],y=n[0],b=n[1],x=n[2],P=n[3];return t[0]=y*r+b*a+x*f+P*w,t[1]=y*i+b*l+x*h+P*S,t[2]=y*s+b*u+x*p+P*_,t[3]=y*o+b*c+x*E+P*m,y=n[4],b=n[5],x=n[6],P=n[7],t[4]=y*r+b*a+x*f+P*w,t[5]=y*i+b*l+x*h+P*S,t[6]=y*s+b*u+x*p+P*_,t[7]=y*o+b*c+x*E+P*m,y=n[8],b=n[9],x=n[10],P=n[11],t[8]=y*r+b*a+x*f+P*w,t[9]=y*i+b*l+x*h+P*S,t[10]=y*s+b*u+x*p+P*_,t[11]=y*o+b*c+x*E+P*m,y=n[12],b=n[13],x=n[14],P=n[15],t[12]=y*r+b*a+x*f+P*w,t[13]=y*i+b*l+x*h+P*S,t[14]=y*s+b*u+x*p+P*_,t[15]=y*o+b*c+x*E+P*m,t}function Ua(t,e,n){var r=n[0],i=n[1],s=n[2],o,a,l,u,c,f,h,p,E,w,S,_;return e===t?(t[12]=e[0]*r+e[4]*i+e[8]*s+e[12],t[13]=e[1]*r+e[5]*i+e[9]*s+e[13],t[14]=e[2]*r+e[6]*i+e[10]*s+e[14],t[15]=e[3]*r+e[7]*i+e[11]*s+e[15]):(o=e[0],a=e[1],l=e[2],u=e[3],c=e[4],f=e[5],h=e[6],p=e[7],E=e[8],w=e[9],S=e[10],_=e[11],t[0]=o,t[1]=a,t[2]=l,t[3]=u,t[4]=c,t[5]=f,t[6]=h,t[7]=p,t[8]=E,t[9]=w,t[10]=S,t[11]=_,t[12]=o*r+c*i+E*s+e[12],t[13]=a*r+f*i+w*s+e[13],t[14]=l*r+h*i+S*s+e[14],t[15]=u*r+p*i+_*s+e[15]),t}function oh(t,e,n){var r=n[0],i=n[1],s=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*s,t[9]=e[9]*s,t[10]=e[10]*s,t[11]=e[11]*s,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function h2(t,e,n,r){var i=r[0],s=r[1],o=r[2],a=Math.hypot(i,s,o),l,u,c,f,h,p,E,w,S,_,m,y,b,x,P,L,C,O,I,B,$,K,X,qt;return a<ia?null:(a=1/a,i*=a,s*=a,o*=a,l=Math.sin(n),u=Math.cos(n),c=1-u,f=e[0],h=e[1],p=e[2],E=e[3],w=e[4],S=e[5],_=e[6],m=e[7],y=e[8],b=e[9],x=e[10],P=e[11],L=i*i*c+u,C=s*i*c+o*l,O=o*i*c-s*l,I=i*s*c-o*l,B=s*s*c+u,$=o*s*c+i*l,K=i*o*c+s*l,X=s*o*c-i*l,qt=o*o*c+u,t[0]=f*L+w*C+y*O,t[1]=h*L+S*C+b*O,t[2]=p*L+_*C+x*O,t[3]=E*L+m*C+P*O,t[4]=f*I+w*B+y*$,t[5]=h*I+S*B+b*$,t[6]=p*I+_*B+x*$,t[7]=E*I+m*B+P*$,t[8]=f*K+w*X+y*qt,t[9]=h*K+S*X+b*qt,t[10]=p*K+_*X+x*qt,t[11]=E*K+m*X+P*qt,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function vv(t,e,n){var r=Math.sin(n),i=Math.cos(n),s=e[4],o=e[5],a=e[6],l=e[7],u=e[8],c=e[9],f=e[10],h=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=s*i+u*r,t[5]=o*i+c*r,t[6]=a*i+f*r,t[7]=l*i+h*r,t[8]=u*i-s*r,t[9]=c*i-o*r,t[10]=f*i-a*r,t[11]=h*i-l*r,t}function d2(t,e,n){var r=Math.sin(n),i=Math.cos(n),s=e[0],o=e[1],a=e[2],l=e[3],u=e[8],c=e[9],f=e[10],h=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=s*i-u*r,t[1]=o*i-c*r,t[2]=a*i-f*r,t[3]=l*i-h*r,t[8]=s*r+u*i,t[9]=o*r+c*i,t[10]=a*r+f*i,t[11]=l*r+h*i,t}function yv(t,e,n){var r=Math.sin(n),i=Math.cos(n),s=e[0],o=e[1],a=e[2],l=e[3],u=e[4],c=e[5],f=e[6],h=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=s*i+u*r,t[1]=o*i+c*r,t[2]=a*i+f*r,t[3]=l*i+h*r,t[4]=u*i-s*r,t[5]=c*i-o*r,t[6]=f*i-a*r,t[7]=h*i-l*r,t}function g2(t,e){var n=e[0],r=e[1],i=e[2],s=e[3],o=n+n,a=r+r,l=i+i,u=n*o,c=r*o,f=r*a,h=i*o,p=i*a,E=i*l,w=s*o,S=s*a,_=s*l;return t[0]=1-f-E,t[1]=c+_,t[2]=h-S,t[3]=0,t[4]=c-_,t[5]=1-u-E,t[6]=p+w,t[7]=0,t[8]=h+S,t[9]=p-w,t[10]=1-u-f,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function p2(t,e,n,r,i,s,o){var a=1/(n-e),l=1/(i-r),u=1/(s-o);return t[0]=s*2*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s*2*l,t[6]=0,t[7]=0,t[8]=(n+e)*a,t[9]=(i+r)*l,t[10]=(o+s)*u,t[11]=-1,t[12]=0,t[13]=0,t[14]=o*s*2*u,t[15]=0,t}function m2(t,e,n,r,i){var s=1/Math.tan(e/2),o;return t[0]=s/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,i!=null&&i!==1/0?(o=1/(r-i),t[10]=(i+r)*o,t[14]=2*i*r*o):(t[10]=-1,t[14]=-2*r),t}var _2=m2;function v2(t,e,n,r,i,s,o){var a=1/(e-n),l=1/(r-i),u=1/(s-o);return t[0]=-2*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*u,t[11]=0,t[12]=(e+n)*a,t[13]=(i+r)*l,t[14]=(o+s)*u,t[15]=1,t}var y2=v2;function E2(t,e,n,r){var i,s,o,a,l,u,c,f,h,p,E=e[0],w=e[1],S=e[2],_=r[0],m=r[1],y=r[2],b=n[0],x=n[1],P=n[2];return Math.abs(E-b)<ia&&Math.abs(w-x)<ia&&Math.abs(S-P)<ia?u2(t):(c=E-b,f=w-x,h=S-P,p=1/Math.hypot(c,f,h),c*=p,f*=p,h*=p,i=m*h-y*f,s=y*c-_*h,o=_*f-m*c,p=Math.hypot(i,s,o),p?(p=1/p,i*=p,s*=p,o*=p):(i=0,s=0,o=0),a=f*o-h*s,l=h*i-c*o,u=c*s-f*i,p=Math.hypot(a,l,u),p?(p=1/p,a*=p,l*=p,u*=p):(a=0,l=0,u=0),t[0]=i,t[1]=a,t[2]=c,t[3]=0,t[4]=s,t[5]=l,t[6]=f,t[7]=0,t[8]=o,t[9]=u,t[10]=h,t[11]=0,t[12]=-(i*E+s*w+o*S),t[13]=-(a*E+l*w+u*S),t[14]=-(c*E+f*w+h*S),t[15]=1,t)}function w2(){var t=new _i(4);return _i!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function T2(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t}function Qs(t,e,n){var r=e[0],i=e[1],s=e[2],o=e[3];return t[0]=n[0]*r+n[4]*i+n[8]*s+n[12]*o,t[1]=n[1]*r+n[5]*i+n[9]*s+n[13]*o,t[2]=n[2]*r+n[6]*i+n[10]*s+n[14]*o,t[3]=n[3]*r+n[7]*i+n[11]*s+n[15]*o,t}(function(){var t=w2();return function(e,n,r,i,s,o){var a,l;for(n||(n=4),r||(r=0),i?l=Math.min(i*n+r,e.length):l=e.length,a=r;a<l;a+=n)t[0]=e[a],t[1]=e[a+1],t[2]=e[a+2],t[3]=e[a+3],s(t,t,o),e[a]=t[0],e[a+1]=t[1],e[a+2]=t[2],e[a+3]=t[3];return e}})();var Nc;(function(t){t[t.COL0ROW0=0]="COL0ROW0",t[t.COL0ROW1=1]="COL0ROW1",t[t.COL0ROW2=2]="COL0ROW2",t[t.COL0ROW3=3]="COL0ROW3",t[t.COL1ROW0=4]="COL1ROW0",t[t.COL1ROW1=5]="COL1ROW1",t[t.COL1ROW2=6]="COL1ROW2",t[t.COL1ROW3=7]="COL1ROW3",t[t.COL2ROW0=8]="COL2ROW0",t[t.COL2ROW1=9]="COL2ROW1",t[t.COL2ROW2=10]="COL2ROW2",t[t.COL2ROW3=11]="COL2ROW3",t[t.COL3ROW0=12]="COL3ROW0",t[t.COL3ROW1=13]="COL3ROW1",t[t.COL3ROW2=14]="COL3ROW2",t[t.COL3ROW3=15]="COL3ROW3"})(Nc||(Nc={}));const b2=45*Math.PI/180,S2=1,mu=.1,_u=500,A2=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);class $t extends l2{static get IDENTITY(){return P2()}static get ZERO(){return x2()}get ELEMENTS(){return 16}get RANK(){return 4}get INDICES(){return Nc}constructor(e){super(-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0),arguments.length===1&&Array.isArray(e)?this.copy(e):this.identity()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this[9]=e[9],this[10]=e[10],this[11]=e[11],this[12]=e[12],this[13]=e[13],this[14]=e[14],this[15]=e[15],this.check()}set(e,n,r,i,s,o,a,l,u,c,f,h,p,E,w,S){return this[0]=e,this[1]=n,this[2]=r,this[3]=i,this[4]=s,this[5]=o,this[6]=a,this[7]=l,this[8]=u,this[9]=c,this[10]=f,this[11]=h,this[12]=p,this[13]=E,this[14]=w,this[15]=S,this.check()}setRowMajor(e,n,r,i,s,o,a,l,u,c,f,h,p,E,w,S){return this[0]=e,this[1]=s,this[2]=u,this[3]=p,this[4]=n,this[5]=o,this[6]=c,this[7]=E,this[8]=r,this[9]=a,this[10]=f,this[11]=w,this[12]=i,this[13]=l,this[14]=h,this[15]=S,this.check()}toRowMajor(e){return e[0]=this[0],e[1]=this[4],e[2]=this[8],e[3]=this[12],e[4]=this[1],e[5]=this[5],e[6]=this[9],e[7]=this[13],e[8]=this[2],e[9]=this[6],e[10]=this[10],e[11]=this[14],e[12]=this[3],e[13]=this[7],e[14]=this[11],e[15]=this[15],e}identity(){return this.copy(A2)}fromObject(e){return this.check()}fromQuaternion(e){return g2(this,e),this.check()}frustum(e){const{left:n,right:r,bottom:i,top:s,near:o=mu,far:a=_u}=e;return a===1/0?L2(this,n,r,i,s,o):p2(this,n,r,i,s,o,a),this.check()}lookAt(e){const{eye:n,center:r=[0,0,0],up:i=[0,1,0]}=e;return E2(this,n,r,i),this.check()}ortho(e){const{left:n,right:r,bottom:i,top:s,near:o=mu,far:a=_u}=e;return y2(this,n,r,i,s,o,a),this.check()}orthographic(e){const{fovy:n=b2,aspect:r=S2,focalDistance:i=1,near:s=mu,far:o=_u}=e;hp(n);const a=n/2,l=i*Math.tan(a),u=l*r;return this.ortho({left:-u,right:u,bottom:-l,top:l,near:s,far:o})}perspective(e){const{fovy:n=45*Math.PI/180,aspect:r=1,near:i=.1,far:s=500}=e;return hp(n),_2(this,n,r,i,s),this.check()}determinant(){return f2(this)}getScale(e=[-0,-0,-0]){return e[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),e[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),e[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),e}getTranslation(e=[-0,-0,-0]){return e[0]=this[12],e[1]=this[13],e[2]=this[14],e}getRotation(e,n){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],n=n||[-0,-0,-0];const r=this.getScale(n),i=1/r[0],s=1/r[1],o=1/r[2];return e[0]=this[0]*i,e[1]=this[1]*s,e[2]=this[2]*o,e[3]=0,e[4]=this[4]*i,e[5]=this[5]*s,e[6]=this[6]*o,e[7]=0,e[8]=this[8]*i,e[9]=this[9]*s,e[10]=this[10]*o,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}getRotationMatrix3(e,n){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0],n=n||[-0,-0,-0];const r=this.getScale(n),i=1/r[0],s=1/r[1],o=1/r[2];return e[0]=this[0]*i,e[1]=this[1]*s,e[2]=this[2]*o,e[3]=this[4]*i,e[4]=this[5]*s,e[5]=this[6]*o,e[6]=this[8]*i,e[7]=this[9]*s,e[8]=this[10]*o,e}transpose(){return c2(this,this),this.check()}invert(){return kc(this,this),this.check()}multiplyLeft(e){return cr(this,e,this),this.check()}multiplyRight(e){return cr(this,this,e),this.check()}rotateX(e){return vv(this,this,e),this.check()}rotateY(e){return d2(this,this,e),this.check()}rotateZ(e){return yv(this,this,e),this.check()}rotateXYZ(e){return this.rotateX(e[0]).rotateY(e[1]).rotateZ(e[2])}rotateAxis(e,n){return h2(this,this,e,n),this.check()}scale(e){return oh(this,this,Array.isArray(e)?e:[e,e,e]),this.check()}translate(e){return Ua(this,this,e),this.check()}transform(e,n){return e.length===4?(n=Qs(n||[-0,-0,-0,-0],e,this),gu(n,4),n):this.transformAsPoint(e,n)}transformAsPoint(e,n){const{length:r}=e;let i;switch(r){case 2:i=YP(n||[-0,-0],e,this);break;case 3:i=_v(n||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return gu(i,e.length),i}transformAsVector(e,n){let r;switch(e.length){case 2:r=$P(n||[-0,-0],e,this);break;case 3:r=mv(n||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return gu(r,e.length),r}transformPoint(e,n){return this.transformAsPoint(e,n)}transformVector(e,n){return this.transformAsPoint(e,n)}transformDirection(e,n){return this.transformAsVector(e,n)}makeRotationX(e){return this.identity().rotateX(e)}makeTranslation(e,n,r){return this.identity().translate([e,n,r])}}let Fo,Uo;function x2(){return Fo||(Fo=new $t([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Object.freeze(Fo)),Fo}function P2(){return Uo||(Uo=new $t,Object.freeze(Uo)),Uo}function hp(t){if(t>Math.PI*2)throw Error("expected radians")}function L2(t,e,n,r,i,s){const o=2*s/(n-e),a=2*s/(i-r),l=(n+e)/(n-e),u=(i+r)/(i-r),c=-1,f=-1,h=-2*s;return t[0]=o,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=l,t[9]=u,t[10]=c,t[11]=f,t[12]=0,t[13]=0,t[14]=h,t[15]=0,t}const dp=`#if (defined(SHADER_TYPE_FRAGMENT) && defined(LIGHTING_FRAGMENT)) || (defined(SHADER_TYPE_VERTEX) && defined(LIGHTING_VERTEX))

struct AmbientLight {
 vec3 color;
};

struct PointLight {
 vec3 color;
 vec3 position;
 vec3 attenuation;
};

struct DirectionalLight {
  vec3 color;
  vec3 direction;
};

uniform AmbientLight lighting_uAmbientLight;
uniform PointLight lighting_uPointLight[MAX_LIGHTS];
uniform DirectionalLight lighting_uDirectionalLight[MAX_LIGHTS];
uniform int lighting_uPointLightCount;
uniform int lighting_uDirectionalLightCount;

uniform bool lighting_uEnabled;

float getPointLightAttenuation(PointLight pointLight, float distance) {
  return pointLight.attenuation.x
       + pointLight.attenuation.y * distance
       + pointLight.attenuation.z * distance * distance;
}

#endif
`,C2={lightSources:{}};function vu(){let{color:t=[0,0,0],intensity:e=1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return t.map(n=>n*e/255)}function M2(t){let{ambientLight:e,pointLights:n=[],directionalLights:r=[]}=t;const i={};return e?i["lighting_uAmbientLight.color"]=vu(e):i["lighting_uAmbientLight.color"]=[0,0,0],n.forEach((s,o)=>{i["lighting_uPointLight[".concat(o,"].color")]=vu(s),i["lighting_uPointLight[".concat(o,"].position")]=s.position,i["lighting_uPointLight[".concat(o,"].attenuation")]=s.attenuation||[1,0,0]}),i.lighting_uPointLightCount=n.length,r.forEach((s,o)=>{i["lighting_uDirectionalLight[".concat(o,"].color")]=vu(s),i["lighting_uDirectionalLight[".concat(o,"].direction")]=s.direction}),i.lighting_uDirectionalLightCount=r.length,i}function Ev(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:C2;if("lightSources"in t){const{ambientLight:e,pointLights:n,directionalLights:r}=t.lightSources||{};return e||n&&n.length>0||r&&r.length>0?Object.assign({},M2({ambientLight:e,pointLights:n,directionalLights:r}),{lighting_uEnabled:!0}):{lighting_uEnabled:!1}}if("lights"in t){const e={pointLights:[],directionalLights:[]};for(const n of t.lights||[])switch(n.type){case"ambient":e.ambientLight=n;break;case"directional":e.directionalLights.push(n);break;case"point":e.pointLights.push(n);break}return Ev({lightSources:e})}return{}}const wv={name:"lights",vs:dp,fs:dp,getUniforms:Ev,defines:{MAX_LIGHTS:3}},R2=new Uint8Array([0,255,255,255]),I2={pickingSelectedColor:null,pickingHighlightColor:R2,pickingActive:!1,pickingAttribute:!1};function O2(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:I2;const e={};if(t.pickingSelectedColor!==void 0)if(!t.pickingSelectedColor)e.picking_uSelectedColorValid=0;else{const n=t.pickingSelectedColor.slice(0,3);e.picking_uSelectedColorValid=1,e.picking_uSelectedColor=n}if(t.pickingHighlightColor){const n=Array.from(t.pickingHighlightColor,r=>r/255);Number.isFinite(n[3])||(n[3]=1),e.picking_uHighlightColor=n}return t.pickingActive!==void 0&&(e.picking_uActive=!!t.pickingActive,e.picking_uAttribute=!!t.pickingAttribute),e}const k2=`uniform bool picking_uActive;
uniform bool picking_uAttribute;
uniform vec3 picking_uSelectedColor;
uniform bool picking_uSelectedColorValid;

out vec4 picking_vRGBcolor_Avalid;

const float COLOR_SCALE = 1. / 255.;

bool picking_isColorValid(vec3 color) {
  return dot(color, vec3(1.0)) > 0.001;
}

bool isVertexPicked(vec3 vertexColor) {
  return
    picking_uSelectedColorValid &&
    !picking_isColorValid(abs(vertexColor - picking_uSelectedColor));
}

void picking_setPickingColor(vec3 pickingColor) {
  if (picking_uActive) {
    picking_vRGBcolor_Avalid.a = float(picking_isColorValid(pickingColor));

    if (!picking_uAttribute) {
      picking_vRGBcolor_Avalid.rgb = pickingColor * COLOR_SCALE;
    }
  } else {
    picking_vRGBcolor_Avalid.a = float(isVertexPicked(pickingColor));
  }
}

void picking_setPickingAttribute(float value) {
  if (picking_uAttribute) {
    picking_vRGBcolor_Avalid.r = value;
  }
}
void picking_setPickingAttribute(vec2 value) {
  if (picking_uAttribute) {
    picking_vRGBcolor_Avalid.rg = value;
  }
}
void picking_setPickingAttribute(vec3 value) {
  if (picking_uAttribute) {
    picking_vRGBcolor_Avalid.rgb = value;
  }
}
`,N2=`uniform bool picking_uActive;
uniform vec3 picking_uSelectedColor;
uniform vec4 picking_uHighlightColor;

in vec4 picking_vRGBcolor_Avalid;
vec4 picking_filterHighlightColor(vec4 color) {
  if (picking_uActive) {
    return color;
  }
  bool selected = bool(picking_vRGBcolor_Avalid.a);

  if (selected) {
    float highLightAlpha = picking_uHighlightColor.a;
    float blendedAlpha = highLightAlpha + color.a * (1.0 - highLightAlpha);
    float highLightRatio = highLightAlpha / blendedAlpha;

    vec3 blendedRGB = mix(color.rgb, picking_uHighlightColor.rgb, highLightRatio);
    return vec4(blendedRGB, blendedAlpha);
  } else {
    return color;
  }
}
vec4 picking_filterPickingColor(vec4 color) {
  if (picking_uActive) {
    if (picking_vRGBcolor_Avalid.a == 0.0) {
      discard;
    }
    return picking_vRGBcolor_Avalid;
  }
  return color;
}
vec4 picking_filterColor(vec4 color) {
  vec4 highightColor = picking_filterHighlightColor(color);
  return picking_filterPickingColor(highightColor);
}

`,D2={name:"picking",vs:k2,fs:N2,getUniforms:O2},Tv=`
uniform float lighting_uAmbient;
uniform float lighting_uDiffuse;
uniform float lighting_uShininess;
uniform vec3  lighting_uSpecularColor;

vec3 lighting_getLightColor(vec3 surfaceColor, vec3 light_direction, vec3 view_direction, vec3 normal_worldspace, vec3 color) {
    vec3 halfway_direction = normalize(light_direction + view_direction);
    float lambertian = dot(light_direction, normal_worldspace);
    float specular = 0.0;
    if (lambertian > 0.0) {
      float specular_angle = max(dot(normal_worldspace, halfway_direction), 0.0);
      specular = pow(specular_angle, lighting_uShininess);
    }
    lambertian = max(lambertian, 0.0);
    return (lambertian * lighting_uDiffuse * surfaceColor + specular * lighting_uSpecularColor) * color;
}

vec3 lighting_getLightColor(vec3 surfaceColor, vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {
  vec3 lightColor = surfaceColor;

  if (lighting_uEnabled) {
    vec3 view_direction = normalize(cameraPosition - position_worldspace);
    lightColor = lighting_uAmbient * surfaceColor * lighting_uAmbientLight.color;

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uPointLightCount) {
        break;
      }
      PointLight pointLight = lighting_uPointLight[i];
      vec3 light_position_worldspace = pointLight.position;
      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);
      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);
    }

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uDirectionalLightCount) {
        break;
      }
      DirectionalLight directionalLight = lighting_uDirectionalLight[i];
      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);
    }
  }
  return lightColor;
}

vec3 lighting_getSpecularLightColor(vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {
  vec3 lightColor = vec3(0, 0, 0);
  vec3 surfaceColor = vec3(0, 0, 0);

  if (lighting_uEnabled) {
    vec3 view_direction = normalize(cameraPosition - position_worldspace);

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uPointLightCount) {
        break;
      }
      PointLight pointLight = lighting_uPointLight[i];
      vec3 light_position_worldspace = pointLight.position;
      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);
      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);
    }

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uDirectionalLightCount) {
        break;
      }
      DirectionalLight directionalLight = lighting_uDirectionalLight[i];
      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);
    }
  }
  return lightColor;
}
`,F2={};function U2(t){const{ambient:e=.35,diffuse:n=.6,shininess:r=32,specularColor:i=[30,30,30]}=t;return{lighting_uAmbient:e,lighting_uDiffuse:n,lighting_uShininess:r,lighting_uSpecularColor:i.map(s=>s/255)}}function bv(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:F2;if(!("material"in t))return{};const{material:e}=t;return e?U2(e):{lighting_uEnabled:!1}}const B2={name:"gouraud-lighting",dependencies:[wv],vs:Tv,defines:{LIGHTING_VERTEX:1},getUniforms:bv},z2={name:"phong-lighting",dependencies:[wv],fs:Tv,defines:{LIGHTING_FRAGMENT:1},getUniforms:bv},V2=`attribute float transform_elementID;
vec2 transform_getPixelSizeHalf(vec2 size) {
  return vec2(1.) / (2. * size);
}

vec2 transform_getPixelIndices(vec2 texSize, vec2 pixelSizeHalf) {
  float yIndex = floor((transform_elementID / texSize[0]) + pixelSizeHalf[1]);
  float xIndex = transform_elementID - (yIndex * texSize[0]);
  return vec2(xIndex, yIndex);
}
vec2 transform_getTexCoord(vec2 size) {
  vec2 pixelSizeHalf = transform_getPixelSizeHalf(size);
  vec2 indices = transform_getPixelIndices(size, pixelSizeHalf);
  vec2 coord = indices / size + pixelSizeHalf;
  return coord;
}
vec2 transform_getPos(vec2 size) {
  vec2 texCoord = transform_getTexCoord(size);
  vec2 pos = (texCoord * (2.0, 2.0)) - (1., 1.);
  return pos;
}
vec4 transform_getInput(sampler2D texSampler, vec2 size) {
  vec2 texCoord = transform_getTexCoord(size);
  vec4 textureColor = texture2D(texSampler, texCoord);
  return textureColor;
}
`,j2={name:"transform",vs:V2,fs:null};class Ks{static getDefaultProgramManager(e){return e.luma=e.luma||{},e.luma.defaultProgramManager=e.luma.defaultProgramManager||new Ks(e),e.luma.defaultProgramManager}constructor(e){this.gl=e,this._programCache={},this._getUniforms={},this._registeredModules={},this._hookFunctions=[],this._defaultModules=[],this._hashes={},this._hashCounter=0,this.stateHash=0,this._useCounts={}}addDefaultModule(e){this._defaultModules.find(n=>n.name===e.name)||this._defaultModules.push(e),this.stateHash++}removeDefaultModule(e){const n=typeof e=="string"?e:e.name;this._defaultModules=this._defaultModules.filter(r=>r.name!==n),this.stateHash++}addShaderHook(e,n){n&&(e=Object.assign(n,{hook:e})),this._hookFunctions.push(e),this.stateHash++}get(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{vs:n="",fs:r="",defines:i={},inject:s={},varyings:o=[],bufferMode:a=35981,transpileToGLSL100:l=!1}=e,u=this._getModuleList(e.modules),c=this._getHash(n),f=this._getHash(r),h=u.map(y=>this._getHash(y.name)).sort(),p=o.map(y=>this._getHash(y)),E=Object.keys(i).sort(),w=Object.keys(s).sort(),S=[],_=[];for(const y of E)S.push(this._getHash(y)),S.push(this._getHash(i[y]));for(const y of w)_.push(this._getHash(y)),_.push(this._getHash(s[y]));const m="".concat(c,"/").concat(f,"D").concat(S.join("/"),"M").concat(h.join("/"),"I").concat(_.join("/"),"V").concat(p.join("/"),"H").concat(this.stateHash,"B").concat(a).concat(l?"T":"");if(!this._programCache[m]){const y=SP(this.gl,{vs:n,fs:r,modules:u,inject:s,defines:i,hookFunctions:this._hookFunctions,transpileToGLSL100:l});this._programCache[m]=new iv(this.gl,{hash:m,vs:y.vs,fs:y.fs,varyings:o,bufferMode:a}),this._getUniforms[m]=y.getUniforms||(b=>{}),this._useCounts[m]=0}return this._useCounts[m]++,this._programCache[m]}getUniforms(e){return this._getUniforms[e.hash]||null}release(e){const n=e.hash;this._useCounts[n]--,this._useCounts[n]===0&&(this._programCache[n].delete(),delete this._programCache[n],delete this._getUniforms[n],delete this._useCounts[n])}_getHash(e){return this._hashes[e]===void 0&&(this._hashes[e]=this._hashCounter++),this._hashes[e]}_getModuleList(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const n=new Array(this._defaultModules.length+e.length),r={};let i=0;for(let s=0,o=this._defaultModules.length;s<o;++s){const a=this._defaultModules[s],l=a.name;n[i++]=a,r[l]=!0}for(let s=0,o=e.length;s<o;++s){const a=e[s],l=a.name;r[l]||(n[i++]=a,r[l]=!0)}return n.length=i,n}}const G2={POSITION:"positions",NORMAL:"normals",COLOR_0:"colors",TEXCOORD_0:"texCoords",TEXCOORD_1:"texCoords1",TEXCOORD_2:"texCoords2"};function H2(t,e,n){const r={};let i=e.indices;for(const s in e.attributes){const o=e.attributes[s],a=W2(s,n);if(s==="indices")i=o;else if(o.constant)r[a]=o.value;else{const l=o.value,u={...o};delete u.value,r[a]=[new J(t,l),u],X2(s,u)}}if(i){const s=i.value||i;k(s instanceof Uint16Array||s instanceof Uint32Array,'attribute array for "indices" must be of integer type');const o={size:1,isIndexed:i.isIndexed===void 0?!0:i.isIndexed};r.indices=[new J(t,{data:s,target:34963}),o]}return r}function W2(t,e){const{attributeMap:n=G2}=e||{};return n&&n[t]||t}function X2(t,e){let n;switch(t){case"texCoords":case"texCoord1":case"texCoord2":case"texCoord3":n="uvs";break;case"vertices":case"positions":case"normals":case"pickingColors":n="vectors";break}switch(n){case"vectors":e.size=e.size||3;break;case"uvs":e.size=e.size||2;break}k(Number.isFinite(e.size),"attribute ".concat(t," needs size"))}const Ir=2,Y2=1e4,$2="Model needs drawMode and vertexCount",gp=()=>{},q2={};class Sv{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{id:r=Xt("model")}=n;k(ul(e)),this.id=r,this.gl=e,this.id=n.id||Xt("Model"),this.lastLogTime=0,this.animated=!1,this.initialize(n)}initialize(e){this.props={},this.programManager=e.programManager||Ks.getDefaultProgramManager(this.gl),this._programManagerState=-1,this._managedProgram=!1;const{program:n=null,vs:r,fs:i,modules:s,defines:o,inject:a,varyings:l,bufferMode:u,transpileToGLSL100:c}=e;this.programProps={program:n,vs:r,fs:i,modules:s,defines:o,inject:a,varyings:l,bufferMode:u,transpileToGLSL100:c},this.program=null,this.vertexArray=null,this._programDirty=!0,this.userData={},this.needsRedraw=!0,this._attributes={},this.attributes={},this.uniforms={},this.pickable=!0,this._checkProgram(),this.setUniforms(Object.assign({},this.getModuleUniforms(e.moduleSettings))),this.drawMode=e.drawMode!==void 0?e.drawMode:4,this.vertexCount=e.vertexCount||0,this.geometryBuffers={},this.isInstanced=e.isInstanced||e.instanced||e.instanceCount>0,this._setModelProps(e),this.geometry={},k(this.drawMode!==void 0&&Number.isFinite(this.vertexCount),$2)}setProps(e){this._setModelProps(e)}delete(){for(const e in this._attributes)this._attributes[e]!==this.attributes[e]&&this._attributes[e].delete();this._managedProgram&&(this.programManager.release(this.program),this._managedProgram=!1),this.vertexArray.delete(),this._deleteGeometryBuffers()}getDrawMode(){return this.drawMode}getVertexCount(){return this.vertexCount}getInstanceCount(){return this.instanceCount}getAttributes(){return this.attributes}getProgram(){return this.program}setProgram(e){const{program:n,vs:r,fs:i,modules:s,defines:o,inject:a,varyings:l,bufferMode:u,transpileToGLSL100:c}=e;this.programProps={program:n,vs:r,fs:i,modules:s,defines:o,inject:a,varyings:l,bufferMode:u,transpileToGLSL100:c},this._programDirty=!0}getUniforms(){return this.uniforms}setDrawMode(e){return this.drawMode=e,this}setVertexCount(e){return k(Number.isFinite(e)),this.vertexCount=e,this}setInstanceCount(e){return k(Number.isFinite(e)),this.instanceCount=e,this}setGeometry(e){return this.drawMode=e.drawMode,this.vertexCount=e.getVertexCount(),this._deleteGeometryBuffers(),this.geometryBuffers=H2(this.gl,e),this.vertexArray.setAttributes(this.geometryBuffers),this}setAttributes(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(di(e))return this;const n={};for(const r in e){const i=e[r];n[r]=i.getValue?i.getValue():i}return this.vertexArray.setAttributes(n),this}setUniforms(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return Object.assign(this.uniforms,e),this}getModuleUniforms(e){this._checkProgram();const n=this.programManager.getUniforms(this.program);return n?n(e):{}}updateModuleSettings(e){const n=this.getModuleUniforms(e||{});return this.setUniforms(n)}clear(e){return nh(this.program.gl,e),this}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._checkProgram();const{moduleSettings:n=null,framebuffer:r,uniforms:i={},attributes:s={},transformFeedback:o=this.transformFeedback,parameters:a={},vertexArray:l=this.vertexArray}=e;this.setAttributes(s),this.updateModuleSettings(n),this.setUniforms(i);let u;U.priority>=Ir&&(u=this._logDrawCallStart(Ir));const c=this.vertexArray.getDrawParams(),{isIndexed:f=c.isIndexed,indexType:h=c.indexType,indexOffset:p=c.indexOffset,vertexArrayInstanced:E=c.isInstanced}=this.props;E&&!this.isInstanced&&U.warn("Found instanced attributes on non-instanced model",this.id)();const{isInstanced:w,instanceCount:S}=this,{onBeforeRender:_=gp,onAfterRender:m=gp}=this.props;_(),this.program.setUniforms(this.uniforms);const y=this.program.draw(Object.assign(q2,e,{logPriority:u,uniforms:null,framebuffer:r,parameters:a,drawMode:this.getDrawMode(),vertexCount:this.getVertexCount(),vertexArray:l,transformFeedback:o,isIndexed:f,indexType:h,isInstanced:w,instanceCount:S,offset:f?p:0}));return m(),U.priority>=Ir&&this._logDrawCallEnd(u,l,r),y}transform(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{discard:n=!0,feedbackBuffers:r,unbindModels:i=[]}=e;let{parameters:s}=e;r&&this._setFeedbackBuffers(r),n&&(s=Object.assign({},s,{35977:n})),i.forEach(o=>o.vertexArray.unbindBuffers());try{this.draw(Object.assign({},e,{parameters:s}))}finally{i.forEach(o=>o.vertexArray.bindBuffers())}return this}render(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return U.warn("Model.render() is deprecated. Use Model.setUniforms() and Model.draw()")(),this.setUniforms(e).draw()}_setModelProps(e){Object.assign(this.props,e),"uniforms"in e&&this.setUniforms(e.uniforms),"pickable"in e&&(this.pickable=e.pickable),"instanceCount"in e&&(this.instanceCount=e.instanceCount),"geometry"in e&&this.setGeometry(e.geometry),"attributes"in e&&this.setAttributes(e.attributes),"_feedbackBuffers"in e&&this._setFeedbackBuffers(e._feedbackBuffers)}_checkProgram(){if(!(this._programDirty||this.programManager.stateHash!==this._programManagerState))return;let{program:n}=this.programProps;if(n)this._managedProgram=!1;else{const{vs:r,fs:i,modules:s,inject:o,defines:a,varyings:l,bufferMode:u,transpileToGLSL100:c}=this.programProps;n=this.programManager.get({vs:r,fs:i,modules:s,inject:o,defines:a,varyings:l,bufferMode:u,transpileToGLSL100:c}),this.program&&this._managedProgram&&this.programManager.release(this.program),this._programManagerState=this.programManager.stateHash,this._managedProgram=!0}k(n instanceof iv,"Model needs a program"),this._programDirty=!1,n!==this.program&&(this.program=n,this.vertexArray?this.vertexArray.setProps({program:this.program,attributes:this.vertexArray.attributes}):this.vertexArray=new Bx(this.gl,{program:this.program}),this.setUniforms(Object.assign({},this.getModuleUniforms())))}_deleteGeometryBuffers(){for(const e in this.geometryBuffers){const n=this.geometryBuffers[e][0]||this.geometryBuffers[e];n instanceof J&&n.delete()}}_setAnimationProps(e){this.animated&&k(e,"Model.draw(): animated uniforms but no animationProps")}_setFeedbackBuffers(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(di(e))return this;const{gl:n}=this.program;return this.transformFeedback=this.transformFeedback||new sv(n,{program:this.program}),this.transformFeedback.setBuffers(e),this}_logDrawCallStart(e){const n=e>3?0:Y2;if(!(Date.now()-this.lastLogTime<n))return this.lastLogTime=Date.now(),U.group(Ir,">>> DRAWING MODEL ".concat(this.id),{collapsed:U.level<=2})(),e}_logDrawCallEnd(e,n,r,i){if(e===void 0)return;const s=jx({vertexArray:n,header:"".concat(this.id," attributes"),attributes:this._attributes}),{table:o,unusedTable:a,unusedCount:l}=Jg({header:"".concat(this.id," uniforms"),program:this.program,uniforms:Object.assign({},this.program.uniforms,r)}),{table:u,count:c}=Jg({header:"".concat(this.id," uniforms"),program:this.program,uniforms:Object.assign({},this.program.uniforms,r),undefinedOnly:!0});c>0&&U.log("MISSING UNIFORMS",Object.keys(u))(),l>0&&U.log("UNUSED UNIFORMS",Object.keys(a))();const f=Hx(this.vertexArray.configuration);U.table(e,s)(),U.table(e,o)(),U.table(e+1,f)(),i&&i.log({logLevel:Ir,message:"Rendered to ".concat(i.id)}),U.groupEnd(Ir)()}}class Z2{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.currentIndex=0,this.feedbackMap={},this.varyings=null,this.bindings=[],this.resources={},this._initialize(n),Object.seal(this)}setupResources(e){for(const n of this.bindings)this._setupTransformFeedback(n,e)}updateModelProps(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{varyings:n}=this;return n.length>0&&(e=Object.assign({},e,{varyings:n})),e}getDrawOptions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=this.bindings[this.currentIndex],{sourceBuffers:r,transformFeedback:i}=n;return{attributes:Object.assign({},r,e.attributes),transformFeedback:i}}swap(){return this.feedbackMap?(this.currentIndex=this._getNextIndex(),!0):!1}update(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setupBuffers(e)}getBuffer(e){const{feedbackBuffers:n}=this.bindings[this.currentIndex],r=e?n[e]:null;return r?r instanceof J?r:r.buffer:null}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{varyingName:n}=e,r=this.getBuffer(n);return r?r.getData():null}delete(){for(const e in this.resources)this.resources[e].delete()}_initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setupBuffers(e),this.varyings=e.varyings||Object.keys(this.bindings[this.currentIndex].feedbackBuffers),this.varyings.length>0&&k(H(this.gl))}_getFeedbackBuffers(e){const{sourceBuffers:n={}}=e,r={};if(this.bindings[this.currentIndex]&&Object.assign(r,this.bindings[this.currentIndex].feedbackBuffers),this.feedbackMap)for(const i in this.feedbackMap){const s=this.feedbackMap[i];i in n&&(r[s]=i)}Object.assign(r,e.feedbackBuffers);for(const i in r){const s=r[i];if(typeof s=="string"){const o=n[s],{byteLength:a,usage:l,accessor:u}=o;r[i]=this._createNewBuffer(i,{byteLength:a,usage:l,accessor:u})}}return r}_setupBuffers(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceBuffers:n=null}=e;Object.assign(this.feedbackMap,e.feedbackMap);const r=this._getFeedbackBuffers(e);this._updateBindings({sourceBuffers:n,feedbackBuffers:r})}_setupTransformFeedback(e,n){let{model:r}=n;const{program:i}=r;e.transformFeedback=new sv(this.gl,{program:i,buffers:e.feedbackBuffers})}_updateBindings(e){if(this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],e),this.feedbackMap){const{sourceBuffers:n,feedbackBuffers:r}=this._swapBuffers(this.bindings[this.currentIndex]),i=this._getNextIndex();this.bindings[i]=this._updateBinding(this.bindings[i],{sourceBuffers:n,feedbackBuffers:r})}}_updateBinding(e,n){return e?(Object.assign(e.sourceBuffers,n.sourceBuffers),Object.assign(e.feedbackBuffers,n.feedbackBuffers),e.transformFeedback&&e.transformFeedback.setBuffers(e.feedbackBuffers),e):{sourceBuffers:Object.assign({},n.sourceBuffers),feedbackBuffers:Object.assign({},n.feedbackBuffers)}}_swapBuffers(e){if(!this.feedbackMap)return null;const n=Object.assign({},e.sourceBuffers),r=Object.assign({},e.feedbackBuffers);for(const i in this.feedbackMap){const s=this.feedbackMap[i];n[i]=e.feedbackBuffers[s],r[s]=e.sourceBuffers[i],k(r[s]instanceof J)}return{sourceBuffers:n,feedbackBuffers:r}}_createNewBuffer(e,n){const r=new J(this.gl,n);return this.resources[e]&&this.resources[e].delete(),this.resources[e]=r,r}_getNextIndex(){return(this.currentIndex+1)%2}}const Q2="transform_uSampler_",Ba="transform_uSize_",pp="transform_position";function K2(t){let{vs:e,sourceTextureMap:n,targetTextureVarying:r,targetTexture:i}=t,o=Object.keys(n).length,a=null;const l={};let u=e,c={};if(o>0||r){const f=u.split(`
`),h=f.slice();if(f.forEach((p,E,w)=>{if(o>0){const S=rL(p,n);if(S){const{updatedLine:_,inject:m}=S;h[E]=_,c=Rc([c,m]),Object.assign(l,S.samplerTextureMap),o--}}r&&!a&&(a=nL(p,r))}),r){k(i);const p="".concat(Ba).concat(r),E="uniform vec2 ".concat(p,`;
`),w="     vec2 ".concat(pp," = transform_getPos(").concat(p,`);
     gl_Position = vec4(`).concat(pp,`, 0, 1.);
`);c=Rc([c,{"vs:#decl":E,"vs:#main-start":w}])}u=h.join(`
`)}return{vs:u,targetTextureType:a,inject:c,samplerTextureMap:l}}function J2(t){let{sourceTextureMap:e,targetTextureVarying:n,targetTexture:r}=t;const i={};let s,o;n&&({width:s,height:o}=r,i["".concat(Ba).concat(n)]=[s,o]);for(const a in e)({width:s,height:o}=e[a]),i["".concat(Ba).concat(a)]=[s,o];return i}function eL(t){return hv(t,["attribute","in"])}function tL(t){const e="".concat(Q2).concat(t),n="".concat(Ba).concat(t),r="  uniform sampler2D ".concat(e,`;
  uniform vec2 `).concat(n,";");return{samplerName:e,sizeName:n,uniformDeclerations:r}}function nL(t,e){const n=hv(t,["varying","out"]);return n&&n.name===e?n.type:null}function rL(t,e){const n={},r=eL(t);if(!r)return null;const{type:i,name:s}=r;if(s&&e[s]){const o="// ".concat(t," => Replaced by Transform with a sampler"),{samplerName:a,sizeName:l,uniformDeclerations:u}=tL(s),c=OP(i),f="  ".concat(i," ").concat(s," = transform_getInput(").concat(a,", ").concat(l,").").concat(c,`;
`);return n[a]=s,{updatedLine:o,inject:{"vs:#decl":u,"vs:#main-start":f},samplerTextureMap:n}}return null}const iL={10241:9728,10240:9728,10242:33071,10243:33071},sL="transform_output";class oL{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.id=this.currentIndex=0,this._swapTexture=null,this.targetTextureVarying=null,this.targetTextureType=null,this.samplerTextureMap=null,this.bindings=[],this.resources={},this._initialize(n),Object.seal(this)}updateModelProps(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=this._processVertexShader(e);return Object.assign({},e,n)}getDrawOptions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceBuffers:n,sourceTextures:r,framebuffer:i,targetTexture:s}=this.bindings[this.currentIndex],o=Object.assign({},n,e.attributes),a=Object.assign({},e.uniforms),l=Object.assign({},e.parameters);let u=e.discard;if(this.hasSourceTextures||this.hasTargetTexture){o.transform_elementID=this.elementIDBuffer;for(const f in this.samplerTextureMap){const h=this.samplerTextureMap[f];a[f]=r[h]}this._setSourceTextureParameters();const c=J2({sourceTextureMap:r,targetTextureVarying:this.targetTextureVarying,targetTexture:s});Object.assign(a,c)}return this.hasTargetTexture&&(u=!1,l.viewport=[0,0,i.width,i.height]),{attributes:o,framebuffer:i,uniforms:a,discard:u,parameters:l}}swap(){return this._swapTexture?(this.currentIndex=this._getNextIndex(),!0):!1}update(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setupTextures(e)}getTargetTexture(){const{targetTexture:e}=this.bindings[this.currentIndex];return e}getData(){let{packed:e=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{framebuffer:n}=this.bindings[this.currentIndex],r=fl(n);if(!e)return r;const i=r.constructor,s=kP(this.targetTextureType),o=new i(r.length*s/4);let a=0;for(let l=0;l<r.length;l+=4)for(let u=0;u<s;u++)o[a++]=r[l+u];return o}getFramebuffer(){return this.bindings[this.currentIndex].framebuffer}delete(){this.ownTexture&&this.ownTexture.delete(),this.elementIDBuffer&&this.elementIDBuffer.delete()}_initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{_targetTextureVarying:n,_swapTexture:r}=e;this._swapTexture=r,this.targetTextureVarying=n,this.hasTargetTexture=n,this._setupTextures(e)}_createTargetTexture(e){const{sourceTextures:n,textureOrReference:r}=e;if(r instanceof Rt)return r;const i=n[r];return i?(this._targetRefTexName=r,this._createNewTexture(i)):null}_setupTextures(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceBuffers:n,_sourceTextures:r={},_targetTexture:i}=e,s=this._createTargetTexture({sourceTextures:r,textureOrReference:i});this.hasSourceTextures=this.hasSourceTextures||r&&Object.keys(r).length>0,this._updateBindings({sourceBuffers:n,sourceTextures:r,targetTexture:s}),"elementCount"in e&&this._updateElementIDBuffer(e.elementCount)}_updateElementIDBuffer(e){if(typeof e!="number"||this.elementCount>=e)return;const n=new Float32Array(e);n.forEach((r,i,s)=>{s[i]=i}),this.elementIDBuffer?this.elementIDBuffer.setData({data:n}):this.elementIDBuffer=new J(this.gl,{data:n,accessor:{size:1}}),this.elementCount=e}_updateBindings(e){if(this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],e),this._swapTexture){const{sourceTextures:n,targetTexture:r}=this._swapTextures(this.bindings[this.currentIndex]),i=this._getNextIndex();this.bindings[i]=this._updateBinding(this.bindings[i],{sourceTextures:n,targetTexture:r})}}_updateBinding(e,n){const{sourceBuffers:r,sourceTextures:i,targetTexture:s}=n;if(e||(e={sourceBuffers:{},sourceTextures:{},targetTexture:null}),Object.assign(e.sourceTextures,i),Object.assign(e.sourceBuffers,r),s){e.targetTexture=s;const{width:o,height:a}=s,{framebuffer:l}=e;l?(l.update({attachments:{36064:s},resizeAttachments:!1}),l.resize({width:o,height:a})):e.framebuffer=new Te(this.gl,{id:"transform-framebuffer",width:o,height:a,attachments:{36064:s}})}return e}_setSourceTextureParameters(){const e=this.currentIndex,{sourceTextures:n}=this.bindings[e];for(const r in n)n[r].setParameters(iL)}_swapTextures(e){if(!this._swapTexture)return null;const n=Object.assign({},e.sourceTextures);n[this._swapTexture]=e.targetTexture;const r=e.sourceTextures[this._swapTexture];return{sourceTextures:n,targetTexture:r}}_createNewTexture(e){const n=LA(e,{parameters:{10241:9728,10240:9728,10242:33071,10243:33071},pixelStore:{37440:!1}});return this.ownTexture&&this.ownTexture.delete(),this.ownTexture=n,n}_getNextIndex(){return(this.currentIndex+1)%2}_processVertexShader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceTextures:n,targetTexture:r}=this.bindings[this.currentIndex],{vs:i,uniforms:s,targetTextureType:o,inject:a,samplerTextureMap:l}=K2({vs:e.vs,sourceTextureMap:n,targetTextureVarying:this.targetTextureVarying,targetTexture:r}),u=Rc([e.inject||{},a]);this.targetTextureType=o,this.samplerTextureMap=l;const c=e._fs||dv({version:nv(i),input:this.targetTextureVarying,inputType:o,output:sL}),f=this.hasSourceTextures||this.targetTextureVarying?[j2].concat(e.modules||[]):e.modules;return{vs:i,fs:c,modules:f,uniforms:s,inject:u}}}class ah{static isSupported(e){return H(e)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.model=null,this.elementCount=0,this.bufferTransform=null,this.textureTransform=null,this.elementIDBuffer=null,this._initialize(n),Object.seal(this)}delete(){const{model:e,bufferTransform:n,textureTransform:r}=this;e&&e.delete(),n&&n.delete(),r&&r.delete()}run(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{clearRenderTarget:n=!0}=e,r=this._updateDrawOptions(e);n&&r.framebuffer&&r.framebuffer.clear({color:!0}),this.model.transform(r)}swap(){let e=!1;const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const r of n)e=e||r.swap();k(e,"Nothing to swap")}getBuffer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return this.bufferTransform&&this.bufferTransform.getBuffer(e)}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const r of n){const i=r.getData(e);if(i)return i}return null}getFramebuffer(){return this.textureTransform&&this.textureTransform.getFramebuffer()}update(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};"elementCount"in e&&this.model.setVertexCount(e.elementCount);const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const r of n)r.update(e)}_initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{gl:n}=this;this._buildResourceTransforms(n,e),e=this._updateModelProps(e),this.model=new Sv(n,Object.assign({},e,{fs:e.fs||dv({version:nv(e.vs)}),id:e.id||"transform-model",drawMode:e.drawMode||0,vertexCount:e.elementCount})),this.bufferTransform&&this.bufferTransform.setupResources({model:this.model})}_updateModelProps(e){let n=Object.assign({},e);const r=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const i of r)n=i.updateModelProps(n);return n}_buildResourceTransforms(e,n){aL(n)&&(this.bufferTransform=new Z2(e,n)),lL(n)&&(this.textureTransform=new oL(e,n)),k(this.bufferTransform||this.textureTransform,"must provide source/feedback buffers or source/target textures")}_updateDrawOptions(e){let n=Object.assign({},e);const r=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const i of r)n=Object.assign(n,i.getDrawOptions(n));return n}}function aL(t){return!!(!di(t.feedbackBuffers)||!di(t.feedbackMap)||t.varyings&&t.varyings.length>0)}function lL(t){return!!(!di(t._sourceTextures)||t._targetTexture||t._targetTextureVarying)}const mp={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6};class Av{static get DRAW_MODE(){return mp}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{id:n=Xt("geometry"),drawMode:r=mp.TRIANGLES,attributes:i={},indices:s=null,vertexCount:o=null}=e;this.id=n,this.drawMode=r|0,this.attributes={},this.userData={},this._setAttributes(i,s),this.vertexCount=o||this._calculateVertexCount(this.attributes,this.indices)}get mode(){return this.drawMode}getVertexCount(){return this.vertexCount}getAttributes(){return this.indices?{indices:this.indices,...this.attributes}:this.attributes}_print(e){return"Geometry ".concat(this.id," attribute ").concat(e)}_setAttributes(e,n){n&&(this.indices=ArrayBuffer.isView(n)?{value:n,size:1}:n);for(const r in e){let i=e[r];i=ArrayBuffer.isView(i)?{value:i}:i,k(ArrayBuffer.isView(i.value),"".concat(this._print(r),": must be typed array or object with value as typed array")),(r==="POSITION"||r==="positions")&&!i.size&&(i.size=3),r==="indices"?(k(!this.indices),this.indices=i):this.attributes[r]=i}return this.indices&&this.indices.isIndexed!==void 0&&(this.indices=Object.assign({},this.indices),delete this.indices.isIndexed),this}_calculateVertexCount(e,n){if(n)return n.value.length;let r=1/0;for(const i in e){const s=e[i],{value:o,size:a,constant:l}=s;!l&&o&&a>=1&&(r=Math.min(r,o.length/a))}return k(Number.isFinite(r)),r}}const uL=new Uint16Array([0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23]),cL=new Float32Array([-1,-1,1,1,-1,1,1,1,1,-1,1,1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1,-1,-1,1,-1,-1,1,1,1,1,1,1,1,-1,-1,-1,-1,1,-1,-1,1,-1,1,-1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,-1,1,-1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1]),fL=new Float32Array([0,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0]),hL=new Float32Array([0,0,1,0,1,1,0,1,1,0,1,1,0,1,0,0,0,1,0,0,1,0,1,1,1,1,0,1,0,0,1,0,1,0,1,1,0,1,0,0,0,0,1,0,1,1,0,1]),dL={POSITION:{size:3,value:new Float32Array(cL)},NORMAL:{size:3,value:new Float32Array(fL)},TEXCOORD_0:{size:2,value:new Float32Array(hL)}};class gL extends Av{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{id:n=Xt("cube-geometry")}=e;super({...e,id:n,indices:{size:1,value:new Uint16Array(uL)},attributes:{...dL,...e.attributes}})}}let pL=1,mL=1;class xv{constructor(){this.time=0,this.channels=new Map,this.animations=new Map,this.playing=!1,this.lastEngineTime=-1}addChannel(e){const{delay:n=0,duration:r=Number.POSITIVE_INFINITY,rate:i=1,repeat:s=1}=e,o=pL++,a={time:0,delay:n,duration:r,rate:i,repeat:s};return this._setChannelTime(a,this.time),this.channels.set(o,a),o}removeChannel(e){this.channels.delete(e);for(const[n,r]of this.animations)r.channel===e&&this.detachAnimation(n)}isFinished(e){const n=this.channels.get(e);return n===void 0?!1:this.time>=n.delay+n.duration*n.repeat}getTime(e){if(e===void 0)return this.time;const n=this.channels.get(e);return n===void 0?-1:n.time}setTime(e){this.time=Math.max(0,e);const n=this.channels.values();for(const i of n)this._setChannelTime(i,this.time);const r=this.animations.values();for(const i of r){const{animation:s,channel:o}=i;s.setTime(this.getTime(o))}}play(){this.playing=!0}pause(){this.playing=!1,this.lastEngineTime=-1}reset(){this.setTime(0)}attachAnimation(e,n){const r=mL++;return this.animations.set(r,{animation:e,channel:n}),e.setTime(this.getTime(n)),r}detachAnimation(e){this.animations.delete(e)}update(e){this.playing&&(this.lastEngineTime===-1&&(this.lastEngineTime=e),this.setTime(this.time+(e-this.lastEngineTime)),this.lastEngineTime=e)}_setChannelTime(e,n){const r=n-e.delay,i=e.duration*e.repeat;r>=i?e.time=e.duration*e.rate:(e.time=Math.max(0,r)%e.duration,e.time*=e.rate)}}const _L=[255,255,255],vL=1;let yL=0;class EL{constructor(e={}){d(this,"id",void 0),d(this,"color",void 0),d(this,"intensity",void 0),d(this,"type","ambient");const{color:n=_L}=e,{intensity:r=vL}=e;this.id=e.id||"ambient-".concat(yL++),this.color=n,this.intensity=r}}const wL=[255,255,255],TL=1,bL=[0,0,-1];let SL=0;class _p{constructor(e={}){d(this,"id",void 0),d(this,"color",void 0),d(this,"intensity",void 0),d(this,"type","directional"),d(this,"direction",void 0),d(this,"shadow",void 0);const{color:n=wL}=e,{intensity:r=TL}=e,{direction:i=bL}=e,{_shadow:s=!1}=e;this.id=e.id||"directional-".concat(SL++),this.color=n,this.intensity=r,this.type="directional",this.direction=new Yt(i).normalize().toArray(),this.shadow=s}getProjectedLight(e){return this}}class AL{constructor(e,n={id:"pass"}){d(this,"id",void 0),d(this,"gl",void 0),d(this,"props",void 0);const{id:r}=n;this.id=r,this.gl=e,this.props={...n}}setProps(e){Object.assign(this.props,e)}render(e){}cleanup(){}}class lh extends AL{constructor(...e){super(...e),d(this,"_lastRenderIndex",-1)}render(e){const n=this.gl;return gn(n,{framebuffer:e.target}),this._drawLayers(e)}_drawLayers(e){const{target:n,moduleParameters:r,viewports:i,views:s,onViewportActive:o,clearStack:a=!0,clearCanvas:l=!0}=e;e.pass=e.pass||"unknown";const u=this.gl;l&&PL(u,n),a&&(this._lastRenderIndex=-1);const c=[];for(const f of i){const h=s&&s[f.id];o==null||o(f);const p=this._getDrawLayerParams(f,e),E=f.subViewports||[f];for(const w of E){const S=this._drawLayersInViewport(u,{target:n,moduleParameters:r,viewport:w,view:h,pass:e.pass,layers:e.layers},p);c.push(S)}}return c}_getDrawLayerParams(e,{layers:n,pass:r,isPicking:i=!1,layerFilter:s,cullRect:o,effects:a,moduleParameters:l},u=!1){const c=[],f=Pv(this._lastRenderIndex+1),h={layer:n[0],viewport:e,isPicking:i,renderPass:r,cullRect:o},p={};for(let E=0;E<n.length;E++){const w=n[E],S=this._shouldDrawLayer(w,h,s,p),_={shouldDrawLayer:S};S&&!u&&(_.layerRenderIndex=f(w,S),_.moduleParameters=this._getModuleParameters(w,a,r,l),_.layerParameters=this.getLayerParameters(w,E,e)),c[E]=_}return c}_drawLayersInViewport(e,{layers:n,moduleParameters:r,pass:i,target:s,viewport:o,view:a},l){const u=xL(e,{moduleParameters:r,target:s,viewport:o});if(a&&a.props.clear){const f=a.props.clear===!0?{color:!0,depth:!0}:a.props.clear;Ct(e,{scissorTest:!0,scissor:u},()=>nh(e,f))}const c={totalCount:n.length,visibleCount:0,compositeCount:0,pickableCount:0};gn(e,{viewport:u});for(let f=0;f<n.length;f++){const h=n[f],{shouldDrawLayer:p,layerRenderIndex:E,moduleParameters:w,layerParameters:S}=l[f];if(p&&h.props.pickable&&c.pickableCount++,h.isComposite)c.compositeCount++;else if(p){c.visibleCount++,this._lastRenderIndex=Math.max(this._lastRenderIndex,E),w.viewport=o;try{h._drawLayer({moduleParameters:w,uniforms:{layerIndex:E},parameters:S})}catch(_){h.raiseError(_,"drawing ".concat(h," to ").concat(i))}}}return c}shouldDrawLayer(e){return!0}getModuleParameters(e,n){return null}getLayerParameters(e,n,r){return e.props.parameters}_shouldDrawLayer(e,n,r,i){if(!(e.props.visible&&this.shouldDrawLayer(e)))return!1;n.layer=e;let o=e.parent;for(;o;){if(!o.props.visible||!o.filterSubLayer(n))return!1;n.layer=o,o=o.parent}if(r){const a=n.layer.id;if(a in i||(i[a]=r(n)),!i[a])return!1}return e.activateViewport(n.viewport),!0}_getModuleParameters(e,n,r,i){var s;const o=Object.assign(Object.create(((s=e.internalState)===null||s===void 0?void 0:s.propsInTransition)||e.props),{autoWrapLongitude:e.wrapLongitude,viewport:e.context.viewport,mousePosition:e.context.mousePosition,pickingActive:0,devicePixelRatio:mr(this.gl)});if(n)for(const l of n){var a;Object.assign(o,(a=l.getModuleParameters)===null||a===void 0?void 0:a.call(l,e))}return Object.assign(o,this.getModuleParameters(e,n),i)}}function Pv(t=0,e={}){const n={},r=(i,s)=>{const o=i.props._offset,a=i.id,l=i.parent&&i.parent.id;let u;if(l&&!(l in e)&&r(i.parent,!1),l in n){const c=n[l]=n[l]||Pv(e[l],e);u=c(i,s),n[a]=c}else Number.isFinite(o)?(u=o+(e[l]||0),n[a]=null):u=t;return s&&u>=t&&(t=u+1),e[a]=u,u};return r}function xL(t,{moduleParameters:e,target:n,viewport:r}){const i=n&&n.id!=="default-framebuffer",s=e&&e.devicePixelRatio||mr(t),o=i?n.height:t.drawingBufferHeight,a=r;return[a.x*s,o-(a.y+a.height)*s,a.width*s,a.height*s]}function PL(t,e){const n=e?e.width:t.drawingBufferWidth,r=e?e.height:t.drawingBufferHeight;gn(t,{viewport:[0,0,n,r]}),t.clear(16640)}class LL extends lh{constructor(e,n){super(e,n),d(this,"shadowMap",void 0),d(this,"depthBuffer",void 0),d(this,"fbo",void 0),this.shadowMap=new Rt(e,{width:1,height:1,parameters:{10241:9729,10240:9729,10242:33071,10243:33071}}),this.depthBuffer=new qr(e,{format:33189,width:1,height:1}),this.fbo=new Te(e,{id:"shadowmap",width:1,height:1,attachments:{36064:this.shadowMap,36096:this.depthBuffer}})}render(e){const n=this.fbo;Ct(this.gl,{depthRange:[0,1],depthTest:!0,blend:!1,clearColor:[1,1,1,1]},()=>{const r=e.viewports[0],i=mr(this.gl),s=r.width*i,o=r.height*i;(s!==n.width||o!==n.height)&&n.resize({width:s,height:o}),super.render({...e,target:n,pass:"shadow"})})}shouldDrawLayer(e){return e.props.shadowEnabled!==!1}getModuleParameters(){return{drawToShadowMap:!0}}delete(){this.fbo&&(this.fbo.delete(),this.fbo=null),this.shadowMap&&(this.shadowMap.delete(),this.shadowMap=null),this.depthBuffer&&(this.depthBuffer.delete(),this.depthBuffer=null)}}const Lv="#define SMOOTH_EDGE_RADIUS 0.5",CL=`
`.concat(Lv,`

struct VertexGeometry {
  vec4 position;
  vec3 worldPosition;
  vec3 worldPositionAlt;
  vec3 normal;
  vec2 uv;
  vec3 pickingColor;
} geometry = VertexGeometry(
  vec4(0.0, 0.0, 1.0, 0.0),
  vec3(0.0),
  vec3(0.0),
  vec3(0.0),
  vec2(0.0),
  vec3(0.0)
);
`),ML=`
`.concat(Lv,`

struct FragmentGeometry {
  vec2 uv;
} geometry;

float smoothedge(float edge, float x) {
  return smoothstep(edge - SMOOTH_EDGE_RADIUS, edge + SMOOTH_EDGE_RADIUS, x);
}
`),RL={name:"geometry",vs:CL,fs:ML},IL=Object.keys(q).map(t=>"const int COORDINATE_SYSTEM_".concat(t," = ").concat(q[t],";")).join(""),OL=Object.keys(jt).map(t=>"const int PROJECTION_MODE_".concat(t," = ").concat(jt[t],";")).join(""),kL=Object.keys(Is).map(t=>"const int UNIT_".concat(t.toUpperCase()," = ").concat(Is[t],";")).join(""),NL="".concat(IL,`
`).concat(OL,`
`).concat(kL,`

uniform int project_uCoordinateSystem;
uniform int project_uProjectionMode;
uniform float project_uScale;
uniform bool project_uWrapLongitude;
uniform vec3 project_uCommonUnitsPerMeter;
uniform vec3 project_uCommonUnitsPerWorldUnit;
uniform vec3 project_uCommonUnitsPerWorldUnit2;
uniform vec4 project_uCenter;
uniform mat4 project_uModelMatrix;
uniform mat4 project_uViewProjectionMatrix;
uniform vec2 project_uViewportSize;
uniform float project_uDevicePixelRatio;
uniform float project_uFocalDistance;
uniform vec3 project_uCameraPosition;
uniform vec3 project_uCoordinateOrigin;
uniform vec3 project_uCommonOrigin;
uniform bool project_uPseudoMeters;

const float TILE_SIZE = 512.0;
const float PI = 3.1415926536;
const float WORLD_SCALE = TILE_SIZE / (PI * 2.0);
const vec3 ZERO_64_LOW = vec3(0.0);
const float EARTH_RADIUS = 6370972.0;
const float GLOBE_RADIUS = 256.0;
float project_size_at_latitude(float lat) {
  float y = clamp(lat, -89.9, 89.9);
  return 1.0 / cos(radians(y));
}

float project_size() {
  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR &&
    project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT &&
    project_uPseudoMeters == false) {
    
    if (geometry.position.w == 0.0) {
      return project_size_at_latitude(geometry.worldPosition.y);
    }
  
    float y = geometry.position.y / TILE_SIZE * 2.0 - 1.0;
    float y2 = y * y;
    float y4 = y2 * y2;
    float y6 = y4 * y2;
    return 1.0 + 4.9348 * y2 + 4.0587 * y4 + 1.5642 * y6;
  }
  return 1.0;
}

float project_size_at_latitude(float meters, float lat) {
  return meters * project_uCommonUnitsPerMeter.z * project_size_at_latitude(lat);
}
float project_size(float meters) {
  return meters * project_uCommonUnitsPerMeter.z * project_size();
}

vec2 project_size(vec2 meters) {
  return meters * project_uCommonUnitsPerMeter.xy * project_size();
}

vec3 project_size(vec3 meters) {
  return meters * project_uCommonUnitsPerMeter * project_size();
}

vec4 project_size(vec4 meters) {
  return vec4(meters.xyz * project_uCommonUnitsPerMeter, meters.w);
}
mat3 project_get_orientation_matrix(vec3 up) {
  vec3 uz = normalize(up);
  vec3 ux = abs(uz.z) == 1.0 ? vec3(1.0, 0.0, 0.0) : normalize(vec3(uz.y, -uz.x, 0));
  vec3 uy = cross(uz, ux);
  return mat3(ux, uy, uz);
}

bool project_needs_rotation(vec3 commonPosition, out mat3 transform) {
  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {
    transform = project_get_orientation_matrix(commonPosition);
    return true;
  }
  return false;
}
vec3 project_normal(vec3 vector) {
  vec4 normal_modelspace = project_uModelMatrix * vec4(vector, 0.0);
  vec3 n = normalize(normal_modelspace.xyz * project_uCommonUnitsPerMeter);
  mat3 rotation;
  if (project_needs_rotation(geometry.position.xyz, rotation)) {
    n = rotation * n;
  }
  return n;
}

vec4 project_offset_(vec4 offset) {
  float dy = offset.y;
  vec3 commonUnitsPerWorldUnit = project_uCommonUnitsPerWorldUnit + project_uCommonUnitsPerWorldUnit2 * dy;
  return vec4(offset.xyz * commonUnitsPerWorldUnit, offset.w);
}
vec2 project_mercator_(vec2 lnglat) {
  float x = lnglat.x;
  if (project_uWrapLongitude) {
    x = mod(x + 180., 360.0) - 180.;
  }
  float y = clamp(lnglat.y, -89.9, 89.9);
  return vec2(
    radians(x) + PI,
    PI + log(tan_fp32(PI * 0.25 + radians(y) * 0.5))
  ) * WORLD_SCALE;
}

vec3 project_globe_(vec3 lnglatz) {
  float lambda = radians(lnglatz.x);
  float phi = radians(lnglatz.y);
  float cosPhi = cos(phi);
  float D = (lnglatz.z / EARTH_RADIUS + 1.0) * GLOBE_RADIUS;

  return vec3(
    sin(lambda) * cosPhi,
    -cos(lambda) * cosPhi,
    sin(phi)
  ) * D;
}
vec4 project_position(vec4 position, vec3 position64Low) {
  vec4 position_world = project_uModelMatrix * position;
  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR) {
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      return vec4(
        project_mercator_(position_world.xy),
        project_size_at_latitude(position_world.z, position_world.y),
        position_world.w
      );
    }
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN) {
      position_world.xyz += project_uCoordinateOrigin;
    }
  }
  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      return vec4(
        project_globe_(position_world.xyz),
        position_world.w
      );
    }
  }
  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET) {
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      if (abs(position_world.y - project_uCoordinateOrigin.y) > 0.25) {
        return vec4(
          project_mercator_(position_world.xy) - project_uCommonOrigin.xy,
          project_size(position_world.z),
          position_world.w
        );
      }
    }
  }
  if (project_uProjectionMode == PROJECTION_MODE_IDENTITY ||
    (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET &&
    (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
     project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN))) {
    position_world.xyz -= project_uCoordinateOrigin;
  }
  return project_offset_(position_world) + project_offset_(project_uModelMatrix * vec4(position64Low, 0.0));
}

vec4 project_position(vec4 position) {
  return project_position(position, ZERO_64_LOW);
}

vec3 project_position(vec3 position, vec3 position64Low) {
  vec4 projected_position = project_position(vec4(position, 1.0), position64Low);
  return projected_position.xyz;
}

vec3 project_position(vec3 position) {
  vec4 projected_position = project_position(vec4(position, 1.0), ZERO_64_LOW);
  return projected_position.xyz;
}

vec2 project_position(vec2 position) {
  vec4 projected_position = project_position(vec4(position, 0.0, 1.0), ZERO_64_LOW);
  return projected_position.xy;
}

vec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {
  return viewProjectionMatrix * position + center;
}
vec4 project_common_position_to_clipspace(vec4 position) {
  return project_common_position_to_clipspace(position, project_uViewProjectionMatrix, project_uCenter);
}
vec2 project_pixel_size_to_clipspace(vec2 pixels) {
  vec2 offset = pixels / project_uViewportSize * project_uDevicePixelRatio * 2.0;
  return offset * project_uFocalDistance;
}

float project_size_to_pixel(float meters) {
  return project_size(meters) * project_uScale;
}
float project_size_to_pixel(float size, int unit) {
  if (unit == UNIT_METERS) return project_size_to_pixel(size);
  if (unit == UNIT_COMMON) return size * project_uScale;
  return size;
}
float project_pixel_size(float pixels) {
  return pixels / project_uScale;
}
vec2 project_pixel_size(vec2 pixels) {
  return pixels / project_uScale;
}
`);function DL(t,e){if(t===e)return!0;if(Array.isArray(t)){const n=t.length;if(!e||e.length!==n)return!1;for(let r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}return!1}function Js(t){let e={},n;return r=>{for(const i in r)if(!DL(r[i],e[i])){n=t(r),e=r;break}return n}}const vp=[0,0,0,0],FL=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],Cv=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],UL=[0,0,0],Mv=[0,0,0],BL=Js(jL);function Rv(t,e,n=Mv){n.length<3&&(n=[n[0],n[1],0]);let r=n,i,s=!0;switch(e===q.LNGLAT_OFFSETS||e===q.METER_OFFSETS?i=n:i=t.isGeospatial?[Math.fround(t.longitude),Math.fround(t.latitude),0]:null,t.projectionMode){case jt.WEB_MERCATOR:(e===q.LNGLAT||e===q.CARTESIAN)&&(i=[0,0,0],s=!1);break;case jt.WEB_MERCATOR_AUTO_OFFSET:e===q.LNGLAT?r=i:e===q.CARTESIAN&&(r=[Math.fround(t.center[0]),Math.fround(t.center[1]),0],i=t.unprojectPosition(r),r[0]-=n[0],r[1]-=n[1],r[2]-=n[2]);break;case jt.IDENTITY:r=t.position.map(Math.fround),r[2]=r[2]||0;break;case jt.GLOBE:s=!1,i=null;break;default:s=!1}return{geospatialOrigin:i,shaderCoordinateOrigin:r,offsetMode:s}}function zL(t,e,n){const{viewMatrixUncentered:r,projectionMatrix:i}=t;let{viewMatrix:s,viewProjectionMatrix:o}=t,a=vp,l=vp,u=t.cameraPosition;const{geospatialOrigin:c,shaderCoordinateOrigin:f,offsetMode:h}=Rv(t,e,n);return h&&(l=t.projectPosition(c||f),u=[u[0]-l[0],u[1]-l[1],u[2]-l[2]],l[3]=1,a=Qs([],l,o),s=r||s,o=cr([],i,s),o=cr([],o,FL)),{viewMatrix:s,viewProjectionMatrix:o,projectionCenter:a,originCommon:l,cameraPosCommon:u,shaderCoordinateOrigin:f,geospatialOrigin:c}}function VL({viewport:t,devicePixelRatio:e=1,modelMatrix:n=null,coordinateSystem:r=q.DEFAULT,coordinateOrigin:i=Mv,autoWrapLongitude:s=!1}){r===q.DEFAULT&&(r=t.isGeospatial?q.LNGLAT:q.CARTESIAN);const o=BL({viewport:t,devicePixelRatio:e,coordinateSystem:r,coordinateOrigin:i});return o.project_uWrapLongitude=s,o.project_uModelMatrix=n||Cv,o}function jL({viewport:t,devicePixelRatio:e,coordinateSystem:n,coordinateOrigin:r}){const{projectionCenter:i,viewProjectionMatrix:s,originCommon:o,cameraPosCommon:a,shaderCoordinateOrigin:l,geospatialOrigin:u}=zL(t,n,r),c=t.getDistanceScales(),f=[t.width*e,t.height*e],h=Qs([],[0,0,-t.focalDistance,1],t.projectionMatrix)[3]||1,p={project_uCoordinateSystem:n,project_uProjectionMode:t.projectionMode,project_uCoordinateOrigin:l,project_uCommonOrigin:o.slice(0,3),project_uCenter:i,project_uPseudoMeters:!!t._pseudoMeters,project_uViewportSize:f,project_uDevicePixelRatio:e,project_uFocalDistance:h,project_uCommonUnitsPerMeter:c.unitsPerMeter,project_uCommonUnitsPerWorldUnit:c.unitsPerMeter,project_uCommonUnitsPerWorldUnit2:UL,project_uScale:t.scale,project_uWrapLongitude:!1,project_uViewProjectionMatrix:s,project_uModelMatrix:Cv,project_uCameraPosition:a};if(u){const E=t.getDistanceScales(u);switch(n){case q.METER_OFFSETS:p.project_uCommonUnitsPerWorldUnit=E.unitsPerMeter,p.project_uCommonUnitsPerWorldUnit2=E.unitsPerMeter2;break;case q.LNGLAT:case q.LNGLAT_OFFSETS:t._pseudoMeters||(p.project_uCommonUnitsPerMeter=E.unitsPerMeter),p.project_uCommonUnitsPerWorldUnit=E.unitsPerDegree,p.project_uCommonUnitsPerWorldUnit2=E.unitsPerDegree2;break;case q.CARTESIAN:p.project_uCommonUnitsPerWorldUnit=[1,1,E.unitsPerMeter[2]],p.project_uCommonUnitsPerWorldUnit2=[0,0,E.unitsPerMeter2[2]];break}}return p}const GL={};function HL(t=GL){return"viewport"in t?VL(t):{}}const uh={name:"project",dependencies:[FP,RL],vs:NL,getUniforms:HL};function WL(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function ri(t,e){const n=Qs([],e,t);return T2(n,n,1/n[3]),n}function yp(t,e){const n=t%e;return n<0?e+n:n}function Dc(t,e,n){return t<e?e:t>n?n:t}function XL(t){return Math.log(t)*Math.LOG2E}const ch=Math.log2||XL;function pn(t,e){if(!t)throw new Error(e||"@math.gl/web-mercator: assertion failed.")}const xt=Math.PI,Iv=xt/4,_t=xt/180,Fc=180/xt,vi=512,za=4003e4,Bo=85.051129,YL=1.5;function $L(t){return ch(t)}function Fs(t){const[e,n]=t;pn(Number.isFinite(e)),pn(Number.isFinite(n)&&n>=-90&&n<=90,"invalid latitude");const r=e*_t,i=n*_t,s=vi*(r+xt)/(2*xt),o=vi*(xt+Math.log(Math.tan(Iv+i*.5)))/(2*xt);return[s,o]}function yi(t){const[e,n]=t,r=e/vi*(2*xt)-xt,i=2*(Math.atan(Math.exp(n/vi*(2*xt)-xt))-Iv);return[r*Fc,i*Fc]}function qL(t){const{latitude:e}=t;pn(Number.isFinite(e));const n=Math.cos(e*_t);return $L(za*n)-9}function sa(t){const e=Math.cos(t*_t);return vi/za/e}function Uc(t){const{latitude:e,longitude:n,highPrecision:r=!1}=t;pn(Number.isFinite(e)&&Number.isFinite(n));const i=vi,s=Math.cos(e*_t),o=i/360,a=o/s,l=i/za/s,u={unitsPerMeter:[l,l,l],metersPerUnit:[1/l,1/l,1/l],unitsPerDegree:[o,a,l],degreesPerUnit:[1/o,1/a,1/l]};if(r){const c=_t*Math.tan(e*_t)/s,f=o*c/2,h=i/za*c,p=h/a*l;u.unitsPerDegree2=[0,f,h],u.unitsPerMeter2=[p,0,p]}return u}function Ov(t,e){const[n,r,i]=t,[s,o,a]=e,{unitsPerMeter:l,unitsPerMeter2:u}=Uc({longitude:n,latitude:r,highPrecision:!0}),c=Fs(t);c[0]+=s*(l[0]+u[0]*o),c[1]+=o*(l[1]+u[1]*o);const f=yi(c),h=(i||0)+(a||0);return Number.isFinite(i)||Number.isFinite(a)?[f[0],f[1],h]:f}function ZL(t){const{height:e,pitch:n,bearing:r,altitude:i,scale:s,center:o}=t,a=WL();Ua(a,a,[0,0,-i]),vv(a,a,-n*_t),yv(a,a,r*_t);const l=s/e;return oh(a,a,[l,l,l]),o&&Ua(a,a,KP([],o)),a}function QL(t){const{width:e,height:n,altitude:r,pitch:i=0,offset:s,center:o,scale:a,nearZMultiplier:l=1,farZMultiplier:u=1}=t;let{fovy:c=Va(YL)}=t;r!==void 0&&(c=Va(r));const f=c*_t,h=i*_t,p=kv(c);let E=p;o&&(E+=o[2]*a/Math.cos(h)/n);const w=f*(.5+(s?s[1]:0)/n),S=Math.sin(w)*E/Math.sin(Dc(Math.PI/2-h-w,.01,Math.PI-.01)),_=Math.sin(h)*S+E,m=E*10,y=Math.min(_*u,m);return{fov:f,aspect:e/n,focalDistance:p,near:l,far:y}}function Va(t){return 2*Math.atan(.5/t)*Fc}function kv(t){return .5/Math.tan(.5*t*_t)}function Nv(t,e){const[n,r,i=0]=t;return pn(Number.isFinite(n)&&Number.isFinite(r)&&Number.isFinite(i)),ri(e,[n,r,i,1])}function fh(t,e,n=0){const[r,i,s]=t;if(pn(Number.isFinite(r)&&Number.isFinite(i),"invalid pixel coordinate"),Number.isFinite(s))return ri(e,[r,i,s,1]);const o=ri(e,[r,i,0,1]),a=ri(e,[r,i,1,1]),l=o[2],u=a[2],c=l===u?0:((n||0)-l)/(u-l);return pv([],o,a,c)}function KL(t){const{width:e,height:n,bounds:r,minExtent:i=0,maxZoom:s=24,offset:o=[0,0]}=t,[[a,l],[u,c]]=r,f=JL(t.padding),h=Fs([a,Dc(c,-Bo,Bo)]),p=Fs([u,Dc(l,-Bo,Bo)]),E=[Math.max(Math.abs(p[0]-h[0]),i),Math.max(Math.abs(p[1]-h[1]),i)],w=[e-f.left-f.right-Math.abs(o[0])*2,n-f.top-f.bottom-Math.abs(o[1])*2];pn(w[0]>0&&w[1]>0);const S=w[0]/E[0],_=w[1]/E[1],m=(f.right-f.left)/2/S,y=(f.top-f.bottom)/2/_,b=[(p[0]+h[0])/2+m,(p[1]+h[1])/2+y],x=yi(b),P=Math.min(s,ch(Math.abs(Math.min(S,_))));return pn(Number.isFinite(P)),{longitude:x[0],latitude:x[1],zoom:P}}function JL(t=0){return typeof t=="number"?{top:t,bottom:t,left:t,right:t}:(pn(Number.isFinite(t.top)&&Number.isFinite(t.bottom)&&Number.isFinite(t.left)&&Number.isFinite(t.right)),t)}const Ep=Math.PI/180;function eC(t,e=0){const{width:n,height:r,unproject:i}=t,s={targetZ:e},o=i([0,r],s),a=i([n,r],s);let l,u;const c=t.fovy?.5*t.fovy*Ep:Math.atan(.5/t.altitude),f=(90-t.pitch)*Ep;return c>f-.01?(l=wp(t,0,e),u=wp(t,n,e)):(l=i([0,0],s),u=i([n,0],s)),[o,a,u,l]}function wp(t,e,n){const{pixelUnprojectionMatrix:r}=t,i=ri(r,[e,0,1,1]),s=ri(r,[e,t.height,1,1]),a=(n*t.distanceScales.unitsPerMeter[2]-i[2])/(s[2]-i[2]),l=pv([],i,s,a),u=yi(l);return u.push(n),u}const Tp=512;function tC(t){const{width:e,height:n,pitch:r=0}=t;let{longitude:i,latitude:s,zoom:o,bearing:a=0}=t;(i<-180||i>180)&&(i=yp(i+180,360)-180),(a<-180||a>180)&&(a=yp(a+180,360)-180);const l=ch(n/Tp);if(o<=l)o=l,s=0;else{const u=n/2/Math.pow(2,o),c=yi([0,u])[1];if(s<c)s=c;else{const f=yi([0,Tp-u])[1];s>f&&(s=f)}}return{width:e,height:n,longitude:i,latitude:s,zoom:o,pitch:r,bearing:a}}const nC=`
const int max_lights = 2;
uniform mat4 shadow_uViewProjectionMatrices[max_lights];
uniform vec4 shadow_uProjectCenters[max_lights];
uniform bool shadow_uDrawShadowMap;
uniform bool shadow_uUseShadowMap;
uniform int shadow_uLightId;
uniform float shadow_uLightCount;

varying vec3 shadow_vPosition[max_lights];

vec4 shadow_setVertexPosition(vec4 position_commonspace) {
  if (shadow_uDrawShadowMap) {
    return project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[shadow_uLightId], shadow_uProjectCenters[shadow_uLightId]);
  }
  if (shadow_uUseShadowMap) {
    for (int i = 0; i < max_lights; i++) {
      if(i < int(shadow_uLightCount)) {
        vec4 shadowMap_position = project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[i], shadow_uProjectCenters[i]);
        shadow_vPosition[i] = (shadowMap_position.xyz / shadowMap_position.w + 1.0) / 2.0;
      }
    }
  }
  return gl_Position;
}
`,rC=`
const int max_lights = 2;
uniform bool shadow_uDrawShadowMap;
uniform bool shadow_uUseShadowMap;
uniform sampler2D shadow_uShadowMap0;
uniform sampler2D shadow_uShadowMap1;
uniform vec4 shadow_uColor;
uniform float shadow_uLightCount;

varying vec3 shadow_vPosition[max_lights];

const vec4 bitPackShift = vec4(1.0, 255.0, 65025.0, 16581375.0);
const vec4 bitUnpackShift = 1.0 / bitPackShift;
const vec4 bitMask = vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0,  0.0);

float shadow_getShadowWeight(vec3 position, sampler2D shadowMap) {
  vec4 rgbaDepth = texture2D(shadowMap, position.xy);

  float z = dot(rgbaDepth, bitUnpackShift);
  return smoothstep(0.001, 0.01, position.z - z);
}

vec4 shadow_filterShadowColor(vec4 color) {
  if (shadow_uDrawShadowMap) {
    vec4 rgbaDepth = fract(gl_FragCoord.z * bitPackShift);
    rgbaDepth -= rgbaDepth.gbaa * bitMask;
    return rgbaDepth;
  }
  if (shadow_uUseShadowMap) {
    float shadowAlpha = 0.0;
    shadowAlpha += shadow_getShadowWeight(shadow_vPosition[0], shadow_uShadowMap0);
    if(shadow_uLightCount > 1.0) {
      shadowAlpha += shadow_getShadowWeight(shadow_vPosition[1], shadow_uShadowMap1);
    }
    shadowAlpha *= shadow_uColor.a / shadow_uLightCount;
    float blendedAlpha = shadowAlpha + color.a * (1.0 - shadowAlpha);

    return vec4(
      mix(color.rgb, shadow_uColor.rgb, shadowAlpha / blendedAlpha),
      blendedAlpha
    );
  }
  return color;
}
`,iC=Js(uC),sC=Js(cC),oC=[0,0,0,1],aC=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0];function lC(t,e){const[n,r,i]=t,s=fh([n,r,i],e);return Number.isFinite(i)?s:[s[0],s[1],0]}function uC({viewport:t,center:e}){return new $t(t.viewProjectionMatrix).invert().transform(e)}function cC({viewport:t,shadowMatrices:e}){const n=[],r=t.pixelUnprojectionMatrix,i=t.isGeospatial?void 0:1,s=[[0,0,i],[t.width,0,i],[0,t.height,i],[t.width,t.height,i],[0,0,-1],[t.width,0,-1],[0,t.height,-1],[t.width,t.height,-1]].map(o=>lC(o,r));for(const o of e){const a=o.clone().translate(new Yt(t.center).negate()),l=s.map(c=>a.transform(c)),u=new $t().ortho({left:Math.min(...l.map(c=>c[0])),right:Math.max(...l.map(c=>c[0])),bottom:Math.min(...l.map(c=>c[1])),top:Math.max(...l.map(c=>c[1])),near:Math.min(...l.map(c=>-c[2])),far:Math.max(...l.map(c=>-c[2]))});n.push(u.multiplyRight(o))}return n}function fC(t,e){const{shadowEnabled:n=!0}=t;if(!n||!t.shadowMatrices||!t.shadowMatrices.length)return{shadow_uDrawShadowMap:!1,shadow_uUseShadowMap:!1};const r={shadow_uDrawShadowMap:!!t.drawToShadowMap,shadow_uUseShadowMap:t.shadowMaps?t.shadowMaps.length>0:!1,shadow_uColor:t.shadowColor||oC,shadow_uLightId:t.shadowLightId||0,shadow_uLightCount:t.shadowMatrices.length},i=iC({viewport:t.viewport,center:e.project_uCenter}),s=[],o=sC({shadowMatrices:t.shadowMatrices,viewport:t.viewport}).slice();for(let a=0;a<t.shadowMatrices.length;a++){const l=o[a],u=l.clone().translate(new Yt(t.viewport.center).negate());e.project_uCoordinateSystem===q.LNGLAT&&e.project_uProjectionMode===jt.WEB_MERCATOR?(o[a]=u,s[a]=i):(o[a]=l.clone().multiplyRight(aC),s[a]=u.transform(i))}for(let a=0;a<o.length;a++)r["shadow_uViewProjectionMatrices[".concat(a,"]")]=o[a],r["shadow_uProjectCenters[".concat(a,"]")]=s[a],t.shadowMaps&&t.shadowMaps.length>0?r["shadow_uShadowMap".concat(a)]=t.shadowMaps[a]:r["shadow_uShadowMap".concat(a)]=t.dummyShadowMap;return r}const yu={name:"shadow",dependencies:[uh],vs:nC,fs:rC,inject:{"vs:DECKGL_FILTER_GL_POSITION":`
    position = shadow_setVertexPosition(geometry.position);
    `,"fs:DECKGL_FILTER_COLOR":`
    color = shadow_filterShadowColor(color);
    `},getUniforms:(t={},e={})=>"viewport"in t&&(t.drawToShadowMap||t.shadowMaps&&t.shadowMaps.length>0)?fC(t,e):{}},hC={color:[255,255,255],intensity:1},bp=[{color:[255,255,255],intensity:1,direction:[-1,3,-1]},{color:[255,255,255],intensity:.9,direction:[1,-8,-2.5]}],dC=[0,0,0,200/255];class Dv{constructor(e={}){d(this,"id","lighting-effect"),d(this,"props",void 0),d(this,"shadowColor",dC),d(this,"shadow",void 0),d(this,"ambientLight",void 0),d(this,"directionalLights",void 0),d(this,"pointLights",void 0),d(this,"shadowPasses",[]),d(this,"shadowMaps",[]),d(this,"dummyShadowMap",null),d(this,"programManager",void 0),d(this,"shadowMatrices",void 0),this.setProps(e)}setProps(e){this.ambientLight=null,this.directionalLights=[],this.pointLights=[];for(const n in e){const r=e[n];switch(r.type){case"ambient":this.ambientLight=r;break;case"directional":this.directionalLights.push(r);break;case"point":this.pointLights.push(r);break}}this._applyDefaultLights(),this.shadow=this.directionalLights.some(n=>n.shadow),this.props=e}preRender(e,{layers:n,layerFilter:r,viewports:i,onViewportActive:s,views:o}){if(this.shadow){this.shadowMatrices=this._calculateMatrices(),this.shadowPasses.length===0&&this._createShadowPasses(e),this.programManager||(this.programManager=Ks.getDefaultProgramManager(e),yu&&this.programManager.addDefaultModule(yu)),this.dummyShadowMap||(this.dummyShadowMap=new Rt(e,{width:1,height:1}));for(let a=0;a<this.shadowPasses.length;a++)this.shadowPasses[a].render({layers:n,layerFilter:r,viewports:i,onViewportActive:s,views:o,moduleParameters:{shadowLightId:a,dummyShadowMap:this.dummyShadowMap,shadowMatrices:this.shadowMatrices}})}}getModuleParameters(e){const n=this.shadow?{shadowMaps:this.shadowMaps,dummyShadowMap:this.dummyShadowMap,shadowColor:this.shadowColor,shadowMatrices:this.shadowMatrices}:{};return n.lightSources={ambientLight:this.ambientLight,directionalLights:this.directionalLights.map(r=>r.getProjectedLight({layer:e})),pointLights:this.pointLights.map(r=>r.getProjectedLight({layer:e}))},n}cleanup(){for(const e of this.shadowPasses)e.delete();this.shadowPasses.length=0,this.shadowMaps.length=0,this.dummyShadowMap&&(this.dummyShadowMap.delete(),this.dummyShadowMap=null),this.shadow&&this.programManager&&(this.programManager.removeDefaultModule(yu),this.programManager=null)}_calculateMatrices(){const e=[];for(const n of this.directionalLights){const r=new $t().lookAt({eye:new Yt(n.direction).negate()});e.push(r)}return e}_createShadowPasses(e){for(let n=0;n<this.directionalLights.length;n++){const r=new LL(e);this.shadowPasses[n]=r,this.shadowMaps[n]=r.shadowMap}}_applyDefaultLights(){const{ambientLight:e,pointLights:n,directionalLights:r}=this;!e&&n.length===0&&r.length===0&&(this.ambientLight=new EL(hC),this.directionalLights.push(new _p(bp[0]),new _p(bp[1])))}}class gC{constructor(e={}){d(this,"_pool",[]),d(this,"opts",{overAlloc:2,poolSize:100}),this.setOptions(e)}setOptions(e){Object.assign(this.opts,e)}allocate(e,n,{size:r=1,type:i,padding:s=0,copy:o=!1,initialize:a=!1,maxCount:l}){const u=i||e&&e.constructor||Float32Array,c=n*r+s;if(ArrayBuffer.isView(e)){if(c<=e.length)return e;if(c*e.BYTES_PER_ELEMENT<=e.buffer.byteLength)return new u(e.buffer,0,c)}let f=1/0;l&&(f=l*r+s);const h=this._allocate(u,c,a,f);return e&&o?h.set(e):a||h.fill(0,0,4),this._release(e),h}release(e){this._release(e)}_allocate(e,n,r,i){let s=Math.max(Math.ceil(n*this.opts.overAlloc),1);s>i&&(s=i);const o=this._pool,a=e.BYTES_PER_ELEMENT*s,l=o.findIndex(u=>u.byteLength>=a);if(l>=0){const u=new e(o.splice(l,1)[0],0,s);return r&&u.fill(0),u}return new e(s)}_release(e){if(!ArrayBuffer.isView(e))return;const n=this._pool,{buffer:r}=e,{byteLength:i}=r,s=n.findIndex(o=>o.byteLength>=i);s<0?n.push(r):(s>0||n.length<this.opts.poolSize)&&n.splice(s,0,r),n.length>this.opts.poolSize&&n.shift()}}const Us=new gC;function ts(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function pC(t){return[t[12],t[13],t[14]]}function mC(t){return{left:Or(t[3]+t[0],t[7]+t[4],t[11]+t[8],t[15]+t[12]),right:Or(t[3]-t[0],t[7]-t[4],t[11]-t[8],t[15]-t[12]),bottom:Or(t[3]+t[1],t[7]+t[5],t[11]+t[9],t[15]+t[13]),top:Or(t[3]-t[1],t[7]-t[5],t[11]-t[9],t[15]-t[13]),near:Or(t[3]+t[2],t[7]+t[6],t[11]+t[10],t[15]+t[14]),far:Or(t[3]-t[2],t[7]-t[6],t[11]-t[10],t[15]-t[14])}}const Sp=new Yt;function Or(t,e,n,r){Sp.set(t,e,n);const i=Sp.len();return{distance:r/i,normal:new Yt(-t/i,-e/i,-n/i)}}function _C(t){return t-Math.fround(t)}let Yi;function Eu(t,e){const{size:n=1,startIndex:r=0}=e,i=e.endIndex!==void 0?e.endIndex:t.length,s=(i-r)/n;Yi=Us.allocate(Yi,s,{type:Float32Array,size:n*2});let o=r,a=0;for(;o<i;){for(let l=0;l<n;l++){const u=t[o++];Yi[a+l]=u,Yi[a+l+n]=_C(u)}a+=n*2}return Yi.subarray(0,s*n*2)}function vC(t){let e=null,n=!1;for(const r of t)r&&(e?(n||(e=[[e[0][0],e[0][1]],[e[1][0],e[1][1]]],n=!0),e[0][0]=Math.min(e[0][0],r[0][0]),e[0][1]=Math.min(e[0][1],r[0][1]),e[1][0]=Math.max(e[1][0],r[1][0]),e[1][1]=Math.max(e[1][1],r[1][1])):e=r);return e}const yC=Math.PI/180,EC=ts(),Ap=[0,0,0],wC={unitsPerMeter:[1,1,1],metersPerUnit:[1,1,1]};function TC({width:t,height:e,orthographic:n,fovyRadians:r,focalDistance:i,padding:s,near:o,far:a}){const l=t/e,u=n?new $t().orthographic({fovy:r,aspect:l,focalDistance:i,near:o,far:a}):new $t().perspective({fovy:r,aspect:l,near:o,far:a});if(s){const{left:c=0,right:f=0,top:h=0,bottom:p=0}=s,E=In((c+t-f)/2,0,t)-t/2,w=In((h+e-p)/2,0,e)-e/2;u[8]-=E*2/t,u[9]+=w*2/e}return u}class Ai{constructor(e={}){d(this,"id",void 0),d(this,"x",void 0),d(this,"y",void 0),d(this,"width",void 0),d(this,"height",void 0),d(this,"padding",void 0),d(this,"isGeospatial",void 0),d(this,"zoom",void 0),d(this,"focalDistance",void 0),d(this,"position",void 0),d(this,"modelMatrix",void 0),d(this,"distanceScales",void 0),d(this,"scale",void 0),d(this,"center",void 0),d(this,"cameraPosition",void 0),d(this,"projectionMatrix",void 0),d(this,"viewMatrix",void 0),d(this,"viewMatrixUncentered",void 0),d(this,"viewMatrixInverse",void 0),d(this,"viewProjectionMatrix",void 0),d(this,"pixelProjectionMatrix",void 0),d(this,"pixelUnprojectionMatrix",void 0),d(this,"resolution",void 0),d(this,"_frustumPlanes",{}),this.id=e.id||this.constructor.displayName||"viewport",this.x=e.x||0,this.y=e.y||0,this.width=e.width||1,this.height=e.height||1,this.zoom=e.zoom||0,this.padding=e.padding,this.distanceScales=e.distanceScales||wC,this.focalDistance=e.focalDistance||1,this.position=e.position||Ap,this.modelMatrix=e.modelMatrix||null;const{longitude:n,latitude:r}=e;this.isGeospatial=Number.isFinite(r)&&Number.isFinite(n),this._initProps(e),this._initMatrices(e),this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}get subViewports(){return null}get metersPerPixel(){return this.distanceScales.metersPerUnit[2]/this.scale}get projectionMode(){return this.isGeospatial?this.zoom<12?jt.WEB_MERCATOR:jt.WEB_MERCATOR_AUTO_OFFSET:jt.IDENTITY}equals(e){return e instanceof Ai?this===e?!0:e.width===this.width&&e.height===this.height&&e.scale===this.scale&&Ds(e.projectionMatrix,this.projectionMatrix)&&Ds(e.viewMatrix,this.viewMatrix):!1}project(e,{topLeft:n=!0}={}){const r=this.projectPosition(e),i=Nv(r,this.pixelProjectionMatrix),[s,o]=i,a=n?o:this.height-o;return e.length===2?[s,a]:[s,a,i[2]]}unproject(e,{topLeft:n=!0,targetZ:r}={}){const[i,s,o]=e,a=n?s:this.height-s,l=r&&r*this.distanceScales.unitsPerMeter[2],u=fh([i,a,o],this.pixelUnprojectionMatrix,l),[c,f,h]=this.unprojectPosition(u);return Number.isFinite(o)?[c,f,h]:Number.isFinite(r)?[c,f,r]:[c,f]}projectPosition(e){const[n,r]=this.projectFlat(e),i=(e[2]||0)*this.distanceScales.unitsPerMeter[2];return[n,r,i]}unprojectPosition(e){const[n,r]=this.unprojectFlat(e),i=(e[2]||0)*this.distanceScales.metersPerUnit[2];return[n,r,i]}projectFlat(e){if(this.isGeospatial){const n=Fs(e);return n[1]=In(n[1],-318,830),n}return e}unprojectFlat(e){return this.isGeospatial?yi(e):e}getBounds(e={}){const n={targetZ:e.z||0},r=this.unproject([0,0],n),i=this.unproject([this.width,0],n),s=this.unproject([0,this.height],n),o=this.unproject([this.width,this.height],n);return[Math.min(r[0],i[0],s[0],o[0]),Math.min(r[1],i[1],s[1],o[1]),Math.max(r[0],i[0],s[0],o[0]),Math.max(r[1],i[1],s[1],o[1])]}getDistanceScales(e){return e?Uc({longitude:e[0],latitude:e[1],highPrecision:!0}):this.distanceScales}containsPixel({x:e,y:n,width:r=1,height:i=1}){return e<this.x+this.width&&this.x<e+r&&n<this.y+this.height&&this.y<n+i}getFrustumPlanes(){return this._frustumPlanes.near?this._frustumPlanes:(Object.assign(this._frustumPlanes,mC(this.viewProjectionMatrix)),this._frustumPlanes)}panByPosition(e,n){return null}_initProps(e){const n=e.longitude,r=e.latitude;this.isGeospatial&&(Number.isFinite(e.zoom)||(this.zoom=qL({latitude:r})+Math.log2(this.focalDistance)),this.distanceScales=e.distanceScales||Uc({latitude:r,longitude:n}));const i=Math.pow(2,this.zoom);this.scale=i;const{position:s,modelMatrix:o}=e;let a=Ap;if(s&&(a=o?new $t(o).transformAsVector(s,[]):s),this.isGeospatial){const l=this.projectPosition([n,r,0]);this.center=new Yt(a).scale(this.distanceScales.unitsPerMeter).add(l)}else this.center=this.projectPosition(a)}_initMatrices(e){const{viewMatrix:n=EC,projectionMatrix:r=null,orthographic:i=!1,fovyRadians:s,fovy:o=75,near:a=.1,far:l=1e3,padding:u=null,focalDistance:c=1}=e;this.viewMatrixUncentered=n,this.viewMatrix=new $t().multiplyRight(n).translate(new Yt(this.center).negate()),this.projectionMatrix=r||TC({width:this.width,height:this.height,orthographic:i,fovyRadians:s||o*yC,focalDistance:c,padding:u,near:a,far:l});const f=ts();cr(f,f,this.projectionMatrix),cr(f,f,this.viewMatrix),this.viewProjectionMatrix=f,this.viewMatrixInverse=kc([],this.viewMatrix)||this.viewMatrix,this.cameraPosition=pC(this.viewMatrixInverse);const h=ts(),p=ts();oh(h,h,[this.width/2,-this.height/2,1]),Ua(h,h,[1,-1,0]),cr(p,h,this.viewProjectionMatrix),this.pixelProjectionMatrix=p,this.pixelUnprojectionMatrix=kc(ts(),this.pixelProjectionMatrix),this.pixelUnprojectionMatrix||Z.warn("Pixel project matrix not invertible")()}}d(Ai,"displayName","Viewport");class _r extends Ai{constructor(e={}){const{latitude:n=0,longitude:r=0,zoom:i=0,pitch:s=0,bearing:o=0,nearZMultiplier:a=.1,farZMultiplier:l=1.01,nearZ:u,farZ:c,orthographic:f=!1,projectionMatrix:h,repeat:p=!1,worldOffset:E=0,position:w,padding:S,legacyMeterSizes:_=!1}=e;let{width:m,height:y,altitude:b=1.5}=e;const x=Math.pow(2,i);m=m||1,y=y||1;let P,L=null;if(h)b=h[5]/2,P=Va(b);else{e.fovy?(P=e.fovy,b=kv(P)):P=Va(b);let O;if(S){const{top:I=0,bottom:B=0}=S;O=[0,In((I+y-B)/2,0,y)-y/2]}L=QL({width:m,height:y,scale:x,center:w&&[0,0,w[2]*sa(n)],offset:O,pitch:s,fovy:P,nearZMultiplier:a,farZMultiplier:l}),Number.isFinite(u)&&(L.near=u),Number.isFinite(c)&&(L.far=c)}let C=ZL({height:y,pitch:s,bearing:o,scale:x,altitude:b});E&&(C=new $t().translate([512*E,0,0]).multiplyLeft(C)),super({...e,width:m,height:y,viewMatrix:C,longitude:r,latitude:n,zoom:i,...L,fovy:P,focalDistance:b}),d(this,"longitude",void 0),d(this,"latitude",void 0),d(this,"pitch",void 0),d(this,"bearing",void 0),d(this,"altitude",void 0),d(this,"fovy",void 0),d(this,"orthographic",void 0),d(this,"_subViewports",void 0),d(this,"_pseudoMeters",void 0),this.latitude=n,this.longitude=r,this.zoom=i,this.pitch=s,this.bearing=o,this.altitude=b,this.fovy=P,this.orthographic=f,this._subViewports=p?[]:null,this._pseudoMeters=_,Object.freeze(this)}get subViewports(){if(this._subViewports&&!this._subViewports.length){const e=this.getBounds(),n=Math.floor((e[0]+180)/360),r=Math.ceil((e[2]-180)/360);for(let i=n;i<=r;i++){const s=i?new _r({...this,worldOffset:i}):this;this._subViewports.push(s)}}return this._subViewports}projectPosition(e){if(this._pseudoMeters)return super.projectPosition(e);const[n,r]=this.projectFlat(e),i=(e[2]||0)*sa(e[1]);return[n,r,i]}unprojectPosition(e){if(this._pseudoMeters)return super.unprojectPosition(e);const[n,r]=this.unprojectFlat(e),i=(e[2]||0)/sa(r);return[n,r,i]}addMetersToLngLat(e,n){return Ov(e,n)}panByPosition(e,n){const r=fh(n,this.pixelUnprojectionMatrix),i=this.projectFlat(e),s=fp([],i,XP([],r)),o=fp([],this.center,s),[a,l]=this.unprojectFlat(o);return{longitude:a,latitude:l}}getBounds(e={}){const n=eC(this,e.z||0);return[Math.min(n[0][0],n[1][0],n[2][0],n[3][0]),Math.min(n[0][1],n[1][1],n[2][1],n[3][1]),Math.max(n[0][0],n[1][0],n[2][0],n[3][0]),Math.max(n[0][1],n[1][1],n[2][1],n[3][1])]}fitBounds(e,n={}){const{width:r,height:i}=this,{longitude:s,latitude:o,zoom:a}=KL({width:r,height:i,bounds:e,...n});return new _r({width:r,height:i,longitude:s,latitude:o,zoom:a})}}d(_r,"displayName","WebMercatorViewport");const xp=[0,0,0];function wu(t,e,n=!1){const r=e.projectPosition(t);if(n&&e instanceof _r){const[i,s,o=0]=t,a=e.getDistanceScales([i,s]);r[2]=o*a.unitsPerMeter[2]}return r}function bC(t){const{viewport:e,modelMatrix:n,coordinateOrigin:r}=t;let{coordinateSystem:i,fromCoordinateSystem:s,fromCoordinateOrigin:o}=t;return i===q.DEFAULT&&(i=e.isGeospatial?q.LNGLAT:q.CARTESIAN),s===void 0&&(s=i),o===void 0&&(o=r),{viewport:e,coordinateSystem:i,coordinateOrigin:r,modelMatrix:n,fromCoordinateSystem:s,fromCoordinateOrigin:o}}function Fv(t,{viewport:e,modelMatrix:n,coordinateSystem:r,coordinateOrigin:i,offsetMode:s}){let[o,a,l=0]=t;switch(n&&([o,a,l]=Qs([],[o,a,l,1],n)),r){case q.LNGLAT:return wu([o,a,l],e,s);case q.LNGLAT_OFFSETS:return wu([o+i[0],a+i[1],l+(i[2]||0)],e,s);case q.METER_OFFSETS:return wu(Ov(i,[o,a,l]),e,s);case q.CARTESIAN:default:return e.isGeospatial?[o+i[0],a+i[1],l+i[2]]:e.projectPosition([o,a,l])}}function SC(t,e){const{viewport:n,coordinateSystem:r,coordinateOrigin:i,modelMatrix:s,fromCoordinateSystem:o,fromCoordinateOrigin:a}=bC(e),{autoOffset:l=!0}=e,{geospatialOrigin:u=xp,shaderCoordinateOrigin:c=xp,offsetMode:f=!1}=l?Rv(n,r,i):{},h=Fv(t,{viewport:n,modelMatrix:s,coordinateSystem:o,coordinateOrigin:a,offsetMode:f});if(f){const p=n.projectPosition(u||c);a2(h,h,p)}return h}const Pp={blendFunc:[1,0,32771,0],blendEquation:32774};class Uv extends lh{constructor(...e){super(...e),d(this,"pickZ",void 0),d(this,"_colorEncoderState",null)}render(e){return"pickingFBO"in e?this._drawPickingBuffer(e):super.render(e)}_drawPickingBuffer({layers:e,layerFilter:n,views:r,viewports:i,onViewportActive:s,pickingFBO:o,deviceRect:{x:a,y:l,width:u,height:c},cullRect:f,effects:h,pass:p="picking",pickZ:E,moduleParameters:w}){const S=this.gl;this.pickZ=E;const _=this._resetColorEncoder(E),m=Ct(S,{scissorTest:!0,scissor:[a,l,u,c],clearColor:[0,0,0,0],depthMask:!0,depthTest:!0,depthRange:[0,1],colorMask:[!0,!0,!0,!0],...Pp,blend:!E},()=>super.render({target:o,layers:e,layerFilter:n,views:r,viewports:i,onViewportActive:s,cullRect:f,effects:h==null?void 0:h.filter(b=>b.useInPicking),pass:p,isPicking:!0,moduleParameters:w}));return this._colorEncoderState=null,{decodePickingColor:_&&xC.bind(null,_),stats:m}}shouldDrawLayer(e){const{pickable:n,operation:r}=e.props;return n&&r.includes("draw")||r.includes("terrain")||r.includes("mask")}getModuleParameters(){return{pickingActive:1,pickingAttribute:this.pickZ,lightSources:{}}}getLayerParameters(e,n,r){const i={...e.props.parameters},{pickable:s,operation:o}=e.props;return this._colorEncoderState?s&&o.includes("draw")&&(Object.assign(i,Pp),i.blend=!0,i.blendColor=AC(this._colorEncoderState,e,r)):i.blend=!1,o.includes("terrain")&&(i.blend=!1),i}_resetColorEncoder(e){return this._colorEncoderState=e?null:{byLayer:new Map,byAlpha:[]},this._colorEncoderState}}function AC(t,e,n){const{byLayer:r,byAlpha:i}=t;let s,o=r.get(e);return o?(o.viewports.push(n),s=o.a):(s=r.size+1,s<=255?(o={a:s,layer:e,viewports:[n]},r.set(e,o),i[s]=o):(Z.warn("Too many pickable layers, only picking the first 255")(),s=0)),[0,0,0,s/255]}function xC(t,e){const n=t.byAlpha[e[3]];return n&&{pickedLayer:n.layer,pickedViewports:n.viewports,pickedObjectIndex:n.layer.decodePickingColor(e)}}const Dr={NO_STATE:"Awaiting state",MATCHED:"Matched. State transferred from previous layer",INITIALIZED:"Initialized",AWAITING_GC:"Discarded. Awaiting garbage collection",AWAITING_FINALIZATION:"No longer matched. Awaiting garbage collection",FINALIZED:"Finalized! Awaiting garbage collection"},ja=Symbol.for("component"),Gn=Symbol.for("propTypes"),Tu=Symbol.for("deprecatedProps"),ii=Symbol.for("asyncPropDefaults"),vr=Symbol.for("asyncPropOriginal"),On=Symbol.for("asyncPropResolved");function Ei(t,e=()=>!0){return Array.isArray(t)?Bv(t,e,[]):e(t)?[t]:[]}function Bv(t,e,n){let r=-1;for(;++r<t.length;){const i=t[r];Array.isArray(i)?Bv(i,e,n):e(i)&&n.push(i)}return n}function PC({target:t,source:e,start:n=0,count:r=1}){const i=e.length,s=r*i;let o=0;for(let a=n;o<i;o++)t[a++]=e[o];for(;o<s;)o<s-o?(t.copyWithin(n+o,n,n+o),o*=2):(t.copyWithin(n+o,n,n+s-o),o=s);return t}class LC{constructor(e,n,r){d(this,"id",void 0),d(this,"context",void 0),d(this,"isLoaded",void 0),d(this,"persistent",void 0),d(this,"_loadCount",0),d(this,"_subscribers",new Set),d(this,"_data",void 0),d(this,"_loader",void 0),d(this,"_error",void 0),d(this,"_content",void 0),this.id=e,this.context=r,this.setData(n)}subscribe(e){this._subscribers.add(e)}unsubscribe(e){this._subscribers.delete(e)}inUse(){return this._subscribers.size>0}delete(){}getData(){return this.isLoaded?this._error?Promise.reject(this._error):this._content:this._loader.then(()=>this.getData())}setData(e,n){if(e===this._data&&!n)return;this._data=e;const r=++this._loadCount;let i=e;typeof e=="string"&&(i=Tc(e)),i instanceof Promise?(this.isLoaded=!1,this._loader=i.then(s=>{this._loadCount===r&&(this.isLoaded=!0,this._error=void 0,this._content=s)}).catch(s=>{this._loadCount===r&&(this.isLoaded=!0,this._error=s||!0)})):(this.isLoaded=!0,this._error=void 0,this._content=e);for(const s of this._subscribers)s.onChange(this.getData())}}class CC{constructor({gl:e,protocol:n}){d(this,"protocol",void 0),d(this,"_context",void 0),d(this,"_resources",void 0),d(this,"_consumers",void 0),d(this,"_pruneRequest",void 0),this.protocol=n||"resource://",this._context={gl:e,resourceManager:this},this._resources={},this._consumers={},this._pruneRequest=null}contains(e){return e.startsWith(this.protocol)?!0:e in this._resources}add({resourceId:e,data:n,forceUpdate:r=!1,persistent:i=!0}){let s=this._resources[e];s?s.setData(n,r):(s=new LC(e,n,this._context),this._resources[e]=s),s.persistent=i}remove(e){const n=this._resources[e];n&&(n.delete(),delete this._resources[e])}unsubscribe({consumerId:e}){const n=this._consumers[e];if(n){for(const r in n){const i=n[r],s=this._resources[i.resourceId];s&&s.unsubscribe(i)}delete this._consumers[e],this.prune()}}subscribe({resourceId:e,onChange:n,consumerId:r,requestId:i="default"}){const{_resources:s,protocol:o}=this;e.startsWith(o)&&(e=e.replace(o,""),s[e]||this.add({resourceId:e,data:null,persistent:!1}));const a=s[e];if(this._track(r,i,a,n),a)return a.getData()}prune(){this._pruneRequest||(this._pruneRequest=setTimeout(()=>this._prune(),0))}finalize(){for(const e in this._resources)this._resources[e].delete()}_track(e,n,r,i){const s=this._consumers,o=s[e]=s[e]||{},a=o[n]||{},l=a.resourceId&&this._resources[a.resourceId];l&&(l.unsubscribe(a),this.prune()),r&&(o[n]=a,a.onChange=i,a.resourceId=r.id,r.subscribe(a))}_prune(){this._pruneRequest=null;for(const e of Object.keys(this._resources)){const n=this._resources[e];!n.persistent&&!n.inUse()&&(n.delete(),delete this._resources[e])}}}const MC=`
vec4 project_position_to_clipspace(
  vec3 position, vec3 position64Low, vec3 offset, out vec4 commonPosition
) {
  vec3 projectedPosition = project_position(position, position64Low);
  mat3 rotation;
  if (project_needs_rotation(projectedPosition, rotation)) {
    // offset is specified as ENU
    // when in globe projection, rotate offset so that the ground alighs with the surface of the globe
    offset = rotation * offset;
  }
  commonPosition = vec4(projectedPosition + offset, 1.0);
  return project_common_position_to_clipspace(commonPosition);
}

vec4 project_position_to_clipspace(
  vec3 position, vec3 position64Low, vec3 offset
) {
  vec4 commonPosition;
  return project_position_to_clipspace(position, position64Low, offset, commonPosition);
}
`,RC={name:"project32",dependencies:[uh],vs:MC},IC={inject:{"vs:DECKGL_FILTER_GL_POSITION":`
    // for picking depth values
    picking_setPickingAttribute(position.z / position.w);
  `,"vs:DECKGL_FILTER_COLOR":`
  picking_setPickingColor(geometry.pickingColor);
  `,"fs:#decl":`
uniform bool picking_uAttribute;
  `,"fs:DECKGL_FILTER_COLOR":{order:99,injection:`
  // use highlight color if this fragment belongs to the selected object.
  color = picking_filterHighlightColor(color);

  // use picking color if rendering to picking FBO.
  color = picking_filterPickingColor(color);
    `}},...D2},OC=[uh],kC=["vs:DECKGL_FILTER_SIZE(inout vec3 size, VertexGeometry geometry)","vs:DECKGL_FILTER_GL_POSITION(inout vec4 position, VertexGeometry geometry)","vs:DECKGL_FILTER_COLOR(inout vec4 color, VertexGeometry geometry)","fs:DECKGL_FILTER_COLOR(inout vec4 color, FragmentGeometry geometry)"];function NC(t){const e=Ks.getDefaultProgramManager(t);for(const n of OC)e.addDefaultModule(n);for(const n of kC)e.addShaderHook(n);return e}const DC="layerManager.setLayers",FC="layerManager.activateViewport";class UC{constructor(e,{deck:n,stats:r,viewport:i,timeline:s}={}){d(this,"layers",void 0),d(this,"context",void 0),d(this,"resourceManager",void 0),d(this,"_lastRenderedLayers",[]),d(this,"_needsRedraw",!1),d(this,"_needsUpdate",!1),d(this,"_nextLayers",null),d(this,"_debug",!1),d(this,"activateViewport",o=>{Ne(FC,this,o),o&&(this.context.viewport=o)}),this.layers=[],this.resourceManager=new CC({gl:e,protocol:"deck://"}),this.context={mousePosition:null,userData:{},layerManager:this,gl:e,deck:n,programManager:e&&NC(e),stats:r||new Wf({id:"deck.gl"}),viewport:i||new Ai({id:"DEFAULT-INITIAL-VIEWPORT"}),timeline:s||new xv,resourceManager:this.resourceManager,onError:void 0},Object.seal(this)}finalize(){this.resourceManager.finalize();for(const e of this.layers)this._finalizeLayer(e)}needsRedraw(e={clearRedrawFlags:!1}){let n=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);for(const r of this.layers){const i=r.getNeedsRedraw(e);n=n||i}return n}needsUpdate(){return this._nextLayers&&this._nextLayers!==this._lastRenderedLayers?"layers changed":this._needsUpdate}setNeedsRedraw(e){this._needsRedraw=this._needsRedraw||e}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e}getLayers({layerIds:e}={}){return e?this.layers.filter(n=>e.find(r=>n.id.indexOf(r)===0)):this.layers}setProps(e){"debug"in e&&(this._debug=e.debug),"userData"in e&&(this.context.userData=e.userData),"layers"in e&&(this._nextLayers=e.layers),"onError"in e&&(this.context.onError=e.onError)}setLayers(e,n){Ne(DC,this,n,e),this._lastRenderedLayers=e;const r=Ei(e,Boolean);for(const i of r)i.context=this.context;this._updateLayers(this.layers,r)}updateLayers(){const e=this.needsUpdate();e&&(this.setNeedsRedraw("updating layers: ".concat(e)),this.setLayers(this._nextLayers||this._lastRenderedLayers,e)),this._nextLayers=null}_handleError(e,n,r){r.raiseError(n,"".concat(e," of ").concat(r))}_updateLayers(e,n){const r={};for(const o of e)r[o.id]?Z.warn("Multiple old layers with same id ".concat(o.id))():r[o.id]=o;const i=[];this._updateSublayersRecursively(n,r,i),this._finalizeOldLayers(r);let s=!1;for(const o of i)if(o.hasUniformTransition()){s="Uniform transition in ".concat(o);break}this._needsUpdate=s,this.layers=i}_updateSublayersRecursively(e,n,r){for(const i of e){i.context=this.context;const s=n[i.id];s===null&&Z.warn("Multiple new layers with same id ".concat(i.id))(),n[i.id]=null;let o=null;try{this._debug&&s!==i&&i.validateProps(),s?(this._transferLayerState(s,i),this._updateLayer(i)):this._initializeLayer(i),r.push(i),o=i.isComposite?i.getSubLayers():null}catch(a){this._handleError("matching",a,i)}o&&this._updateSublayersRecursively(o,n,r)}}_finalizeOldLayers(e){for(const n in e){const r=e[n];r&&this._finalizeLayer(r)}}_initializeLayer(e){try{e._initialize(),e.lifecycle=Dr.INITIALIZED}catch(n){this._handleError("initialization",n,e)}}_transferLayerState(e,n){n._transferState(e),n.lifecycle=Dr.MATCHED,n!==e&&(e.lifecycle=Dr.AWAITING_GC)}_updateLayer(e){try{e._update()}catch(n){this._handleError("update",n,e)}}_finalizeLayer(e){this._needsRedraw=this._needsRedraw||"finalized ".concat(e),e.lifecycle=Dr.AWAITING_FINALIZATION;try{e._finalize(),e.lifecycle=Dr.FINALIZED}catch(n){this._handleError("finalization",n,e)}}}function Gt(t,e,n){if(t===e)return!0;if(!n||!t||!e)return!1;if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(!Gt(t[r],e[r],n-1))return!1;return!0}if(Array.isArray(e))return!1;if(typeof t=="object"&&typeof e=="object"){const r=Object.keys(t),i=Object.keys(e);if(r.length!==i.length)return!1;for(const s of r)if(!e.hasOwnProperty(s)||!Gt(t[s],e[s],n-1))return!1;return!0}return!1}class BC{constructor(e){d(this,"width",void 0),d(this,"height",void 0),d(this,"views",void 0),d(this,"viewState",void 0),d(this,"controllers",void 0),d(this,"timeline",void 0),d(this,"_viewports",void 0),d(this,"_viewportMap",void 0),d(this,"_isUpdating",void 0),d(this,"_needsRedraw",void 0),d(this,"_needsUpdate",void 0),d(this,"_eventManager",void 0),d(this,"_eventCallbacks",void 0),this.views=[],this.width=100,this.height=100,this.viewState={},this.controllers={},this.timeline=e.timeline,this._viewports=[],this._viewportMap={},this._isUpdating=!1,this._needsRedraw="First render",this._needsUpdate="Initialize",this._eventManager=e.eventManager,this._eventCallbacks={onViewStateChange:e.onViewStateChange,onInteractionStateChange:e.onInteractionStateChange},Object.seal(this),this.setProps(e)}finalize(){for(const e in this.controllers){const n=this.controllers[e];n&&n.finalize()}this.controllers={}}needsRedraw(e={clearRedrawFlags:!1}){const n=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),n}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e,this._needsRedraw=this._needsRedraw||e}updateViewStates(){for(const e in this.controllers){const n=this.controllers[e];n&&n.updateTransition()}}getViewports(e){return e?this._viewports.filter(n=>n.containsPixel(e)):this._viewports}getViews(){const e={};return this.views.forEach(n=>{e[n.id]=n}),e}getView(e){return this.views.find(n=>n.id===e)}getViewState(e){const n=typeof e=="string"?this.getView(e):e,r=n&&this.viewState[n.getViewStateId()]||this.viewState;return n?n.filterViewState(r):r}getViewport(e){return this._viewportMap[e]}unproject(e,n){const r=this.getViewports(),i={x:e[0],y:e[1]};for(let s=r.length-1;s>=0;--s){const o=r[s];if(o.containsPixel(i)){const a=e.slice();return a[0]-=o.x,a[1]-=o.y,o.unproject(a,n)}}return null}setProps(e){e.views&&this._setViews(e.views),e.viewState&&this._setViewState(e.viewState),("width"in e||"height"in e)&&this._setSize(e.width,e.height),this._isUpdating||this._update()}_update(){this._isUpdating=!0,this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._isUpdating=!1}_setSize(e,n){(e!==this.width||n!==this.height)&&(this.width=e,this.height=n,this.setNeedsUpdate("Size changed"))}_setViews(e){e=Ei(e,Boolean),this._diffViews(e,this.views)&&this.setNeedsUpdate("views changed"),this.views=e}_setViewState(e){e?(!Gt(e,this.viewState,3)&&this.setNeedsUpdate("viewState changed"),this.viewState=e):Z.warn("missing `viewState` or `initialViewState`")()}_onViewStateChange(e,n){this._eventCallbacks.onViewStateChange&&this._eventCallbacks.onViewStateChange({...n,viewId:e})}_createController(e,n){const r=n.type;return new r({timeline:this.timeline,eventManager:this._eventManager,onViewStateChange:this._onViewStateChange.bind(this,n.id),onStateChange:this._eventCallbacks.onInteractionStateChange,makeViewport:s=>{var o;return(o=this.getView(e.id))===null||o===void 0?void 0:o.makeViewport({viewState:s,width:this.width,height:this.height})}})}_updateController(e,n,r,i){const s=e.controller;if(s&&r){const o={...n,...s,id:e.id,x:r.x,y:r.y,width:r.width,height:r.height};return(!i||i.constructor!==s.type)&&(i=this._createController(e,o)),i&&i.setProps(o),i}return null}_rebuildViewports(){const{views:e}=this,n=this.controllers;this._viewports=[],this.controllers={};let r=!1;for(let i=e.length;i--;){const s=e[i],o=this.getViewState(s),a=s.makeViewport({viewState:o,width:this.width,height:this.height});let l=n[s.id];const u=!!s.controller;u&&!l&&(r=!0),(r||!u)&&l&&(l.finalize(),l=null),this.controllers[s.id]=this._updateController(s,o,a,l),a&&this._viewports.unshift(a)}for(const i in n){const s=n[i];s&&!this.controllers[i]&&s.finalize()}this._buildViewportMap()}_buildViewportMap(){this._viewportMap={},this._viewports.forEach(e=>{e.id&&(this._viewportMap[e.id]=this._viewportMap[e.id]||e)})}_diffViews(e,n){return e.length!==n.length?!0:e.some((r,i)=>!e[i].equals(n[i]))}}const zC=/([0-9]+\.?[0-9]*)(%|px)/;function bn(t){switch(typeof t){case"number":return{position:t,relative:!1};case"string":const e=zC.exec(t);if(e&&e.length>=3){const n=e[2]==="%",r=parseFloat(e[1]);return{position:n?r/100:r,relative:n}}default:throw new Error("Could not parse position string ".concat(t))}}function Sn(t,e){return t.relative?Math.round(t.position*e):t.position}function _e(t,e){if(!t)throw new Error(e||"deck.gl: assertion failed.")}class VC{constructor(e){d(this,"id",void 0),d(this,"viewportInstance",void 0),d(this,"_x",void 0),d(this,"_y",void 0),d(this,"_width",void 0),d(this,"_height",void 0),d(this,"_padding",void 0),d(this,"props",void 0);const{id:n,x:r=0,y:i=0,width:s="100%",height:o="100%",padding:a=null,viewportInstance:l}=e||{};_e(!l||l instanceof Ai),this.viewportInstance=l,this.id=n||this.constructor.displayName||"view",this.props={...e,id:this.id},this._x=bn(r),this._y=bn(i),this._width=bn(s),this._height=bn(o),this._padding=a&&{left:bn(a.left||0),right:bn(a.right||0),top:bn(a.top||0),bottom:bn(a.bottom||0)},this.equals=this.equals.bind(this),Object.seal(this)}equals(e){return this===e?!0:this.viewportInstance?e.viewportInstance?this.viewportInstance.equals(e.viewportInstance):!1:this.ViewportType===e.ViewportType&&Gt(this.props,e.props,2)}makeViewport({width:e,height:n,viewState:r}){if(this.viewportInstance)return this.viewportInstance;r=this.filterViewState(r);const i=this.getDimensions({width:e,height:n});return!i.height||!i.width?null:new this.ViewportType({...r,...this.props,...i})}getViewStateId(){const{viewState:e}=this.props;return typeof e=="string"?e:(e==null?void 0:e.id)||this.id}filterViewState(e){if(this.props.viewState&&typeof this.props.viewState=="object"){if(!this.props.viewState.id)return this.props.viewState;const n={...e};for(const r in this.props.viewState)r!=="id"&&(n[r]=this.props.viewState[r]);return n}return e}getDimensions({width:e,height:n}){const r={x:Sn(this._x,e),y:Sn(this._y,n),width:Sn(this._width,e),height:Sn(this._height,n)};return this._padding&&(r.padding={left:Sn(this._padding.left,e),top:Sn(this._padding.top,n),right:Sn(this._padding.right,e),bottom:Sn(this._padding.bottom,n)}),r}get controller(){const e=this.props.controller;return e?e===!0?{type:this.ControllerType}:typeof e=="function"?{type:e}:{type:this.ControllerType,...e}:null}}class eo{constructor(e){d(this,"_inProgress",void 0),d(this,"_handle",void 0),d(this,"_timeline",void 0),d(this,"time",void 0),d(this,"settings",void 0),this._inProgress=!1,this._handle=null,this._timeline=e,this.time=0,this.settings={duration:0}}get inProgress(){return this._inProgress}start(e){var n,r;this.cancel(),this.settings=e,this._inProgress=!0,(n=(r=this.settings).onStart)===null||n===void 0||n.call(r,this)}end(){if(this._inProgress){var e,n;this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1,(e=(n=this.settings).onEnd)===null||e===void 0||e.call(n,this)}}cancel(){if(this._inProgress){var e,n;(e=(n=this.settings).onInterrupt)===null||e===void 0||e.call(n,this),this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1}}update(){var e,n;if(!this._inProgress)return!1;if(this._handle===null){const{_timeline:r,settings:i}=this;this._handle=r.addChannel({delay:r.getTime(),duration:i.duration})}return this.time=this._timeline.getTime(this._handle),this._onUpdate(),(e=(n=this.settings).onUpdate)===null||e===void 0||e.call(n,this),this._timeline.isFinished(this._handle)&&this.end(),!0}_onUpdate(){}}const Lp=()=>{},Bc={BREAK:1,SNAP_TO_END:2,IGNORE:3},jC=t=>t,GC=Bc.BREAK;class HC{constructor(e){d(this,"getControllerState",void 0),d(this,"props",void 0),d(this,"propsInTransition",void 0),d(this,"transition",void 0),d(this,"onViewStateChange",void 0),d(this,"onStateChange",void 0),d(this,"_onTransitionUpdate",n=>{const{time:r,settings:{interpolator:i,startProps:s,endProps:o,duration:a,easing:l}}=n,u=l(r/a),c=i.interpolateProps(s,o,u);this.propsInTransition=this.getControllerState({...this.props,...c}).getViewportProps(),this.onViewStateChange({viewState:this.propsInTransition,oldViewState:this.props})}),this.getControllerState=e.getControllerState,this.propsInTransition=null,this.transition=new eo(e.timeline),this.onViewStateChange=e.onViewStateChange||Lp,this.onStateChange=e.onStateChange||Lp}finalize(){this.transition.cancel()}getViewportInTransition(){return this.propsInTransition}processViewStateChange(e){let n=!1;const r=this.props;if(this.props=e,!r||this._shouldIgnoreViewportChange(r,e))return!1;if(this._isTransitionEnabled(e)){let i=r;if(this.transition.inProgress){const{interruption:s,endProps:o}=this.transition.settings;i={...r,...s===Bc.SNAP_TO_END?o:this.propsInTransition||r}}this._triggerTransition(i,e),n=!0}else this.transition.cancel();return n}updateTransition(){this.transition.update()}_isTransitionEnabled(e){const{transitionDuration:n,transitionInterpolator:r}=e;return(n>0||n==="auto")&&!!r}_isUpdateDueToCurrentTransition(e){return this.transition.inProgress&&this.propsInTransition?this.transition.settings.interpolator.arePropsEqual(e,this.propsInTransition):!1}_shouldIgnoreViewportChange(e,n){return this.transition.inProgress?this.transition.settings.interruption===Bc.IGNORE||this._isUpdateDueToCurrentTransition(n):this._isTransitionEnabled(n)?n.transitionInterpolator.arePropsEqual(e,n):!0}_triggerTransition(e,n){const r=this.getControllerState(e),i=this.getControllerState(n).shortestPathFrom(r),s=n.transitionInterpolator,o=s.getDuration?s.getDuration(e,n):n.transitionDuration;if(o===0)return;const a=s.initializeProps(e,i);this.propsInTransition={};const l={duration:o,easing:n.transitionEasing||jC,interpolator:s,interruption:n.transitionInterruption||GC,startProps:a.start,endProps:a.end,onStart:n.onTransitionStart,onUpdate:this._onTransitionUpdate,onInterrupt:this._onTransitionEnd(n.onTransitionInterrupt),onEnd:this._onTransitionEnd(n.onTransitionEnd)};this.transition.start(l),this.onStateChange({inTransition:!0}),this.updateTransition()}_onTransitionEnd(e){return n=>{this.propsInTransition=null,this.onStateChange({inTransition:!1,isZooming:!1,isPanning:!1,isRotating:!1}),e==null||e(n)}}}class WC{constructor(e){d(this,"_propsToCompare",void 0),d(this,"_propsToExtract",void 0),d(this,"_requiredProps",void 0);const{compare:n,extract:r,required:i}=e;this._propsToCompare=n,this._propsToExtract=r||n,this._requiredProps=i}arePropsEqual(e,n){for(const r of this._propsToCompare)if(!(r in e)||!(r in n)||!Ds(e[r],n[r]))return!1;return!0}initializeProps(e,n){const r={},i={};for(const s of this._propsToExtract)(s in e||s in n)&&(r[s]=e[s],i[s]=n[s]);return this._checkRequiredProps(r),this._checkRequiredProps(i),{start:r,end:i}}getDuration(e,n){return n.transitionDuration}_checkRequiredProps(e){this._requiredProps&&this._requiredProps.forEach(n=>{const r=e[n];_e(Number.isFinite(r)||Array.isArray(r),"".concat(n," is required for transition"))})}}const XC=["longitude","latitude","zoom","bearing","pitch"],YC=["longitude","latitude","zoom"];class zv extends WC{constructor(e={}){const n=Array.isArray(e)?e:e.transitionProps,r=Array.isArray(e)?{}:e;r.transitionProps=Array.isArray(n)?{compare:n,required:n}:n||{compare:XC,required:YC},super(r.transitionProps),d(this,"opts",void 0),this.opts=r}initializeProps(e,n){const r=super.initializeProps(e,n),{makeViewport:i,around:s}=this.opts;if(i&&s){const o=i(e),a=i(n),l=o.unproject(s);r.start.around=s,Object.assign(r.end,{around:a.project(l),aroundPosition:l,width:n.width,height:n.height})}return r}interpolateProps(e,n,r){const i={};for(const s of this._propsToExtract)i[s]=Fa(e[s]||0,n[s]||0,r);if(n.aroundPosition&&this.opts.makeViewport){const s=this.opts.makeViewport({...n,...i});Object.assign(i,s.panByPosition(n.aroundPosition,Fa(e.around,n.around,r)))}return i}}const An={transitionDuration:0},$C=300,zo=t=>1-(1-t)*(1-t),kr={WHEEL:["wheel"],PAN:["panstart","panmove","panend"],PINCH:["pinchstart","pinchmove","pinchend"],TRIPLE_PAN:["tripanstart","tripanmove","tripanend"],DOUBLE_TAP:["doubletap"],KEYBOARD:["keydown"]},Jn={};class qC{constructor(e){d(this,"props",void 0),d(this,"state",{}),d(this,"transitionManager",void 0),d(this,"eventManager",void 0),d(this,"onViewStateChange",void 0),d(this,"onStateChange",void 0),d(this,"makeViewport",void 0),d(this,"_controllerState",void 0),d(this,"_events",{}),d(this,"_interactionState",{isDragging:!1}),d(this,"_customEvents",[]),d(this,"_eventStartBlocked",null),d(this,"_panMove",!1),d(this,"invertPan",!1),d(this,"dragMode","rotate"),d(this,"inertia",0),d(this,"scrollZoom",!0),d(this,"dragPan",!0),d(this,"dragRotate",!0),d(this,"doubleClickZoom",!0),d(this,"touchZoom",!0),d(this,"touchRotate",!1),d(this,"keyboard",!0),this.transitionManager=new HC({...e,getControllerState:n=>new this.ControllerState(n),onViewStateChange:this._onTransition.bind(this),onStateChange:this._setInteractionState.bind(this)}),this.handleEvent=this.handleEvent.bind(this),this.eventManager=e.eventManager,this.onViewStateChange=e.onViewStateChange||(()=>{}),this.onStateChange=e.onStateChange||(()=>{}),this.makeViewport=e.makeViewport}set events(e){this.toggleEvents(this._customEvents,!1),this.toggleEvents(e,!0),this._customEvents=e,this.props&&this.setProps(this.props)}finalize(){for(const n in this._events)if(this._events[n]){var e;(e=this.eventManager)===null||e===void 0||e.off(n,this.handleEvent)}this.transitionManager.finalize()}handleEvent(e){this._controllerState=void 0;const n=this._eventStartBlocked;switch(e.type){case"panstart":return n?!1:this._onPanStart(e);case"panmove":return this._onPan(e);case"panend":return this._onPanEnd(e);case"pinchstart":return n?!1:this._onPinchStart(e);case"pinchmove":return this._onPinch(e);case"pinchend":return this._onPinchEnd(e);case"tripanstart":return n?!1:this._onTriplePanStart(e);case"tripanmove":return this._onTriplePan(e);case"tripanend":return this._onTriplePanEnd(e);case"doubletap":return this._onDoubleTap(e);case"wheel":return this._onWheel(e);case"keydown":return this._onKeyDown(e);default:return!1}}get controllerState(){return this._controllerState=this._controllerState||new this.ControllerState({makeViewport:this.makeViewport,...this.props,...this.state}),this._controllerState}getCenter(e){const{x:n,y:r}=this.props,{offsetCenter:i}=e;return[i.x-n,i.y-r]}isPointInBounds(e,n){const{width:r,height:i}=this.props;if(n&&n.handled)return!1;const s=e[0]>=0&&e[0]<=r&&e[1]>=0&&e[1]<=i;return s&&n&&n.stopPropagation(),s}isFunctionKeyPressed(e){const{srcEvent:n}=e;return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}isDragging(){return this._interactionState.isDragging||!1}blockEvents(e){const n=setTimeout(()=>{this._eventStartBlocked===n&&(this._eventStartBlocked=null)},e);this._eventStartBlocked=n}setProps(e){e.dragMode&&(this.dragMode=e.dragMode),this.props=e,"transitionInterpolator"in e||(e.transitionInterpolator=this._getTransitionProps().transitionInterpolator),this.transitionManager.processViewStateChange(e);const{inertia:n}=e;this.inertia=Number.isFinite(n)?n:n===!0?$C:0;const{scrollZoom:r=!0,dragPan:i=!0,dragRotate:s=!0,doubleClickZoom:o=!0,touchZoom:a=!0,touchRotate:l=!1,keyboard:u=!0}=e,c=!!this.onViewStateChange;this.toggleEvents(kr.WHEEL,c&&r),this.toggleEvents(kr.PAN,c),this.toggleEvents(kr.PINCH,c&&(a||l)),this.toggleEvents(kr.TRIPLE_PAN,c&&l),this.toggleEvents(kr.DOUBLE_TAP,c&&o),this.toggleEvents(kr.KEYBOARD,c&&u),this.scrollZoom=r,this.dragPan=i,this.dragRotate=s,this.doubleClickZoom=o,this.touchZoom=a,this.touchRotate=l,this.keyboard=u}updateTransition(){this.transitionManager.updateTransition()}toggleEvents(e,n){this.eventManager&&e.forEach(r=>{this._events[r]!==n&&(this._events[r]=n,n?this.eventManager.on(r,this.handleEvent):this.eventManager.off(r,this.handleEvent))})}updateViewport(e,n=null,r={}){const i={...e.getViewportProps(),...n},s=this.controllerState!==e;if(this.state=e.getState(),this._setInteractionState(r),s){const o=this.controllerState&&this.controllerState.getViewportProps();this.onViewStateChange&&this.onViewStateChange({viewState:i,interactionState:this._interactionState,oldViewState:o})}}_onTransition(e){this.onViewStateChange({...e,interactionState:this._interactionState})}_setInteractionState(e){Object.assign(this._interactionState,e),this.onStateChange(this._interactionState)}_onPanStart(e){const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;let r=this.isFunctionKeyPressed(e)||e.rightButton||!1;(this.invertPan||this.dragMode==="pan")&&(r=!r);const i=this.controllerState[r?"panStart":"rotateStart"]({pos:n});return this._panMove=r,this.updateViewport(i,An,{isDragging:!0}),!0}_onPan(e){return this.isDragging()?this._panMove?this._onPanMove(e):this._onPanRotate(e):!1}_onPanEnd(e){return this.isDragging()?this._panMove?this._onPanMoveEnd(e):this._onPanRotateEnd(e):!1}_onPanMove(e){if(!this.dragPan)return!1;const n=this.getCenter(e),r=this.controllerState.pan({pos:n});return this.updateViewport(r,An,{isDragging:!0,isPanning:!0}),!0}_onPanMoveEnd(e){const{inertia:n}=this;if(this.dragPan&&n&&e.velocity){const r=this.getCenter(e),i=[r[0]+e.velocityX*n/2,r[1]+e.velocityY*n/2],s=this.controllerState.pan({pos:i}).panEnd();this.updateViewport(s,{...this._getTransitionProps(),transitionDuration:n,transitionEasing:zo},{isDragging:!1,isPanning:!0})}else{const r=this.controllerState.panEnd();this.updateViewport(r,null,{isDragging:!1,isPanning:!1})}return!0}_onPanRotate(e){if(!this.dragRotate)return!1;const n=this.getCenter(e),r=this.controllerState.rotate({pos:n});return this.updateViewport(r,An,{isDragging:!0,isRotating:!0}),!0}_onPanRotateEnd(e){const{inertia:n}=this;if(this.dragRotate&&n&&e.velocity){const r=this.getCenter(e),i=[r[0]+e.velocityX*n/2,r[1]+e.velocityY*n/2],s=this.controllerState.rotate({pos:i}).rotateEnd();this.updateViewport(s,{...this._getTransitionProps(),transitionDuration:n,transitionEasing:zo},{isDragging:!1,isRotating:!0})}else{const r=this.controllerState.rotateEnd();this.updateViewport(r,null,{isDragging:!1,isRotating:!1})}return!0}_onWheel(e){if(!this.scrollZoom)return!1;const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;e.srcEvent.preventDefault();const{speed:r=.01,smooth:i=!1}=this.scrollZoom===!0?{}:this.scrollZoom,{delta:s}=e;let o=2/(1+Math.exp(-Math.abs(s*r)));s<0&&o!==0&&(o=1/o);const a=this.controllerState.zoom({pos:n,scale:o});return this.updateViewport(a,{...this._getTransitionProps({around:n}),transitionDuration:i?250:1},{isZooming:!0,isPanning:!0}),!0}_onTriplePanStart(e){const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;const r=this.controllerState.rotateStart({pos:n});return this.updateViewport(r,An,{isDragging:!0}),!0}_onTriplePan(e){if(!this.touchRotate||!this.isDragging())return!1;const n=this.getCenter(e);n[0]-=e.deltaX;const r=this.controllerState.rotate({pos:n});return this.updateViewport(r,An,{isDragging:!0,isRotating:!0}),!0}_onTriplePanEnd(e){if(!this.isDragging())return!1;const{inertia:n}=this;if(this.touchRotate&&n&&e.velocityY){const r=this.getCenter(e),i=[r[0],r[1]+=e.velocityY*n/2],s=this.controllerState.rotate({pos:i});this.updateViewport(s,{...this._getTransitionProps(),transitionDuration:n,transitionEasing:zo},{isDragging:!1,isRotating:!0}),this.blockEvents(n)}else{const r=this.controllerState.rotateEnd();this.updateViewport(r,null,{isDragging:!1,isRotating:!1})}return!0}_onPinchStart(e){const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;const r=this.controllerState.zoomStart({pos:n}).rotateStart({pos:n});return Jn._startPinchRotation=e.rotation,Jn._lastPinchEvent=e,this.updateViewport(r,An,{isDragging:!0}),!0}_onPinch(e){if(!this.touchZoom&&!this.touchRotate||!this.isDragging())return!1;let n=this.controllerState;if(this.touchZoom){const{scale:r}=e,i=this.getCenter(e);n=n.zoom({pos:i,scale:r})}if(this.touchRotate){const{rotation:r}=e;n=n.rotate({deltaAngleX:Jn._startPinchRotation-r})}return this.updateViewport(n,An,{isDragging:!0,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:this.touchRotate}),Jn._lastPinchEvent=e,!0}_onPinchEnd(e){if(!this.isDragging())return!1;const{inertia:n}=this,{_lastPinchEvent:r}=Jn;if(this.touchZoom&&n&&r&&e.scale!==r.scale){const i=this.getCenter(e);let s=this.controllerState.rotateEnd();const o=Math.log2(e.scale),a=(o-Math.log2(r.scale))/(e.deltaTime-r.deltaTime),l=Math.pow(2,o+a*n/2);s=s.zoom({pos:i,scale:l}).zoomEnd(),this.updateViewport(s,{...this._getTransitionProps({around:i}),transitionDuration:n,transitionEasing:zo},{isDragging:!1,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:!1}),this.blockEvents(n)}else{const i=this.controllerState.zoomEnd().rotateEnd();this.updateViewport(i,null,{isDragging:!1,isPanning:!1,isZooming:!1,isRotating:!1})}return Jn._startPinchRotation=null,Jn._lastPinchEvent=null,!0}_onDoubleTap(e){if(!this.doubleClickZoom)return!1;const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;const r=this.isFunctionKeyPressed(e),i=this.controllerState.zoom({pos:n,scale:r?.5:2});return this.updateViewport(i,this._getTransitionProps({around:n}),{isZooming:!0,isPanning:!0}),this.blockEvents(100),!0}_onKeyDown(e){if(!this.keyboard)return!1;const n=this.isFunctionKeyPressed(e),{zoomSpeed:r,moveSpeed:i,rotateSpeedX:s,rotateSpeedY:o}=this.keyboard===!0?{}:this.keyboard,{controllerState:a}=this;let l;const u={};switch(e.srcEvent.code){case"Minus":l=n?a.zoomOut(r).zoomOut(r):a.zoomOut(r),u.isZooming=!0;break;case"Equal":l=n?a.zoomIn(r).zoomIn(r):a.zoomIn(r),u.isZooming=!0;break;case"ArrowLeft":n?(l=a.rotateLeft(s),u.isRotating=!0):(l=a.moveLeft(i),u.isPanning=!0);break;case"ArrowRight":n?(l=a.rotateRight(s),u.isRotating=!0):(l=a.moveRight(i),u.isPanning=!0);break;case"ArrowUp":n?(l=a.rotateUp(o),u.isRotating=!0):(l=a.moveUp(i),u.isPanning=!0);break;case"ArrowDown":n?(l=a.rotateDown(o),u.isRotating=!0):(l=a.moveDown(i),u.isPanning=!0);break;default:return!1}return this.updateViewport(l,this._getTransitionProps(),u),!0}_getTransitionProps(e){const{transition:n}=this;return!n||!n.transitionInterpolator?An:e?{...n,transitionInterpolator:new zv({...e,...n.transitionInterpolator.opts,makeViewport:this.controllerState.makeViewport})}:n}}class ZC{constructor(e,n){d(this,"_viewportProps",void 0),d(this,"_state",void 0),this._viewportProps=this.applyConstraints(e),this._state=n}getViewportProps(){return this._viewportProps}getState(){return this._state}}const Cp=5,QC=1.2;class KC extends ZC{constructor(e){const{width:n,height:r,latitude:i,longitude:s,zoom:o,bearing:a=0,pitch:l=0,altitude:u=1.5,position:c=[0,0,0],maxZoom:f=20,minZoom:h=0,maxPitch:p=60,minPitch:E=0,startPanLngLat:w,startZoomLngLat:S,startRotatePos:_,startBearing:m,startPitch:y,startZoom:b,normalize:x=!0}=e;_e(Number.isFinite(s)),_e(Number.isFinite(i)),_e(Number.isFinite(o)),super({width:n,height:r,latitude:i,longitude:s,zoom:o,bearing:a,pitch:l,altitude:u,maxZoom:f,minZoom:h,maxPitch:p,minPitch:E,normalize:x,position:c},{startPanLngLat:w,startZoomLngLat:S,startRotatePos:_,startBearing:m,startPitch:y,startZoom:b}),d(this,"makeViewport",void 0),this.makeViewport=e.makeViewport}panStart({pos:e}){return this._getUpdatedState({startPanLngLat:this._unproject(e)})}pan({pos:e,startPos:n}){const r=this.getState().startPanLngLat||this._unproject(n);if(!r)return this;const s=this.makeViewport(this.getViewportProps()).panByPosition(r,e);return this._getUpdatedState(s)}panEnd(){return this._getUpdatedState({startPanLngLat:null})}rotateStart({pos:e}){return this._getUpdatedState({startRotatePos:e,startBearing:this.getViewportProps().bearing,startPitch:this.getViewportProps().pitch})}rotate({pos:e,deltaAngleX:n=0,deltaAngleY:r=0}){const{startRotatePos:i,startBearing:s,startPitch:o}=this.getState();if(!i||s===void 0||o===void 0)return this;let a;return e?a=this._getNewRotation(e,i,o,s):a={bearing:s+n,pitch:o+r},this._getUpdatedState(a)}rotateEnd(){return this._getUpdatedState({startBearing:null,startPitch:null})}zoomStart({pos:e}){return this._getUpdatedState({startZoomLngLat:this._unproject(e),startZoom:this.getViewportProps().zoom})}zoom({pos:e,startPos:n,scale:r}){let{startZoom:i,startZoomLngLat:s}=this.getState();if(s||(i=this.getViewportProps().zoom,s=this._unproject(n)||this._unproject(e)),!s)return this;const{maxZoom:o,minZoom:a}=this.getViewportProps();let l=i+Math.log2(r);l=In(l,a,o);const u=this.makeViewport({...this.getViewportProps(),zoom:l});return this._getUpdatedState({zoom:l,...u.panByPosition(s,e)})}zoomEnd(){return this._getUpdatedState({startZoomLngLat:null,startZoom:null})}zoomIn(e=2){return this._zoomFromCenter(e)}zoomOut(e=2){return this._zoomFromCenter(1/e)}moveLeft(e=100){return this._panFromCenter([e,0])}moveRight(e=100){return this._panFromCenter([-e,0])}moveUp(e=100){return this._panFromCenter([0,e])}moveDown(e=100){return this._panFromCenter([0,-e])}rotateLeft(e=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing-e})}rotateRight(e=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing+e})}rotateUp(e=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch+e})}rotateDown(e=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch-e})}shortestPathFrom(e){const n=e.getViewportProps(),r={...this.getViewportProps()},{bearing:i,longitude:s}=r;return Math.abs(i-n.bearing)>180&&(r.bearing=i<0?i+360:i-360),Math.abs(s-n.longitude)>180&&(r.longitude=s<0?s+360:s-360),r}applyConstraints(e){const{maxZoom:n,minZoom:r,zoom:i}=e;e.zoom=In(i,r,n);const{maxPitch:s,minPitch:o,pitch:a}=e;e.pitch=In(a,o,s);const{normalize:l=!0}=e;return l&&Object.assign(e,tC(e)),e}_zoomFromCenter(e){const{width:n,height:r}=this.getViewportProps();return this.zoom({pos:[n/2,r/2],scale:e})}_panFromCenter(e){const{width:n,height:r}=this.getViewportProps();return this.pan({startPos:[n/2,r/2],pos:[n/2+e[0],r/2+e[1]]})}_getUpdatedState(e){return new this.constructor({makeViewport:this.makeViewport,...this.getViewportProps(),...this.getState(),...e})}_unproject(e){const n=this.makeViewport(this.getViewportProps());return e&&n.unproject(e)}_getNewRotation(e,n,r,i){const s=e[0]-n[0],o=e[1]-n[1],a=e[1],l=n[1],{width:u,height:c}=this.getViewportProps(),f=s/u;let h=0;o>0?Math.abs(c-l)>Cp&&(h=o/(l-c)*QC):o<0&&l>Cp&&(h=1-a/l),h=In(h,-1,1);const{minPitch:p,maxPitch:E}=this.getViewportProps(),w=i+180*f;let S=r;return h>0?S=r+h*(E-r):h<0&&(S=r-h*(p-r)),{pitch:S,bearing:w}}}class JC extends qC{constructor(...e){super(...e),d(this,"ControllerState",KC),d(this,"transition",{transitionDuration:300,transitionInterpolator:new zv({transitionProps:{compare:["longitude","latitude","zoom","bearing","pitch","position"],required:["longitude","latitude","zoom"]}})}),d(this,"dragMode","pan")}setProps(e){e.position=e.position||[0,0,0];const n=this.props;super.setProps(e),(!n||n.height!==e.height)&&this.updateViewport(new this.ControllerState({makeViewport:this.makeViewport,...e,...this.state}))}}class hh extends VC{get ViewportType(){return _r}get ControllerType(){return JC}}d(hh,"displayName","MapView");const e3=new Dv;function t3(t,e){var n,r;const i=(n=t.order)!==null&&n!==void 0?n:1/0,s=(r=e.order)!==null&&r!==void 0?r:1/0;return i-s}class n3{constructor(){d(this,"effects",void 0),d(this,"_resolvedEffects",[]),d(this,"_defaultEffects",[]),d(this,"_needsRedraw",void 0),this.effects=[],this._needsRedraw="Initial render",this._setEffects([])}addDefaultEffect(e){const n=this._defaultEffects;if(!n.find(r=>r.id===e.id)){const r=n.findIndex(i=>t3(i,e)>0);r<0?n.push(e):n.splice(r,0,e),this._setEffects(this.effects)}}setProps(e){"effects"in e&&(Gt(e.effects,this.effects,1)||this._setEffects(e.effects))}needsRedraw(e={clearRedrawFlags:!1}){const n=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),n}getEffects(){return this._resolvedEffects}_setEffects(e){const n={};for(const i of this.effects)n[i.id]=i;const r=[];for(const i of e){const s=n[i.id];s&&s!==i?s.setProps?(s.setProps(i.props),r.push(s)):(s.cleanup(),r.push(i)):r.push(i),delete n[i.id]}for(const i in n)n[i].cleanup();this.effects=r,this._resolvedEffects=r.concat(this._defaultEffects),e.some(i=>i instanceof Dv)||this._resolvedEffects.push(e3),this._needsRedraw="effects changed"}finalize(){for(const e of this._resolvedEffects)e.cleanup();this.effects.length=0,this._resolvedEffects.length=0,this._defaultEffects.length=0}}class r3 extends lh{shouldDrawLayer(e){const{operation:n}=e.props;return n.includes("draw")||n.includes("terrain")}}const i3="deckRenderer.renderLayers";class s3{constructor(e){d(this,"gl",void 0),d(this,"layerFilter",void 0),d(this,"drawPickingColors",void 0),d(this,"drawLayersPass",void 0),d(this,"pickLayersPass",void 0),d(this,"renderCount",void 0),d(this,"_needsRedraw",void 0),d(this,"renderBuffers",void 0),d(this,"lastPostProcessEffect",void 0),this.gl=e,this.layerFilter=null,this.drawPickingColors=!1,this.drawLayersPass=new r3(e),this.pickLayersPass=new Uv(e),this.renderCount=0,this._needsRedraw="Initial render",this.renderBuffers=[],this.lastPostProcessEffect=null}setProps(e){this.layerFilter!==e.layerFilter&&(this.layerFilter=e.layerFilter,this._needsRedraw="layerFilter changed"),this.drawPickingColors!==e.drawPickingColors&&(this.drawPickingColors=e.drawPickingColors,this._needsRedraw="drawPickingColors changed")}renderLayers(e){if(!e.viewports.length)return;const n=this.drawPickingColors?this.pickLayersPass:this.drawLayersPass,r={layerFilter:this.layerFilter,isPicking:this.drawPickingColors,...e,target:e.target||Te.getDefaultFramebuffer(this.gl)};r.effects&&this._preRender(r.effects,r);const i=this.lastPostProcessEffect?this.renderBuffers[0]:r.target,s=n.render({...r,target:i});r.effects&&this._postRender(r.effects,r),this.renderCount++,Ne(i3,this,s,e)}needsRedraw(e={clearRedrawFlags:!1}){const n=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),n}finalize(){const{renderBuffers:e}=this;for(const n of e)n.delete();e.length=0}_preRender(e,n){this.lastPostProcessEffect=null,n.preRenderStats=n.preRenderStats||{};for(const r of e)n.preRenderStats[r.id]=r.preRender(this.gl,n),r.postRender&&(this.lastPostProcessEffect=r.id);this.lastPostProcessEffect&&this._resizeRenderBuffers()}_resizeRenderBuffers(){const{renderBuffers:e}=this;e.length===0&&e.push(new Te(this.gl),new Te(this.gl));for(const n of e)n.resize()}_postRender(e,n){const{renderBuffers:r}=this,i={...n,inputBuffer:r[0],swapBuffer:r[1],target:null};for(const s of e)if(s.postRender){if(s.id===this.lastPostProcessEffect){i.target=n.target,s.postRender(this.gl,i);break}const o=s.postRender(this.gl,i);i.inputBuffer=o,i.swapBuffer=o===r[0]?r[1]:r[0]}}}const o3={pickedColor:null,pickedObjectIndex:-1};function a3({pickedColors:t,decodePickingColor:e,deviceX:n,deviceY:r,deviceRadius:i,deviceRect:s}){const{x:o,y:a,width:l,height:u}=s;let c=i*i,f=-1,h=0;for(let p=0;p<u;p++){const E=p+a-r,w=E*E;if(w>c)h+=4*l;else for(let S=0;S<l;S++){if(t[h+3]-1>=0){const m=S+o-n,y=m*m+w;y<=c&&(c=y,f=h)}h+=4}}if(f>=0){const p=t.slice(f,f+4),E=e(p);if(E){const w=Math.floor(f/4/l),S=f/4-w*l;return{...E,pickedColor:p,pickedX:o+S,pickedY:a+w}}Z.error("Picked non-existent layer. Is picking buffer corrupt?")()}return o3}function l3({pickedColors:t,decodePickingColor:e}){const n=new Map;if(t){for(let r=0;r<t.length;r+=4)if(t[r+3]-1>=0){const s=t.slice(r,r+4),o=s.join(",");if(!n.has(o)){const a=e(s);a?n.set(o,{...a,color:s}):Z.error("Picked non-existent layer. Is picking buffer corrupt?")()}}}return Array.from(n.values())}function Vv({pickInfo:t,viewports:e,pixelRatio:n,x:r,y:i,z:s}){let o=e[0];e.length>1&&(o=c3((t==null?void 0:t.pickedViewports)||e,{x:r,y:i}));let a;if(o){const l=[r-o.x,i-o.y];s!==void 0&&(l[2]=s),a=o.unproject(l)}return{color:null,layer:null,viewport:o,index:-1,picked:!1,x:r,y:i,pixel:[r,i],coordinate:a,devicePixel:t&&"pickedX"in t?[t.pickedX,t.pickedY]:void 0,pixelRatio:n}}function u3(t){const{pickInfo:e,lastPickedInfo:n,mode:r,layers:i}=t,{pickedColor:s,pickedLayer:o,pickedObjectIndex:a}=e,l=o?[o]:[];if(r==="hover"){const f=n.index,h=n.layerId,p=o?o.props.id:null;if(p!==h||a!==f){if(p!==h){const E=i.find(w=>w.props.id===h);E&&l.unshift(E)}n.layerId=p,n.index=a,n.info=null}}const u=Vv(t),c=new Map;return c.set(null,u),l.forEach(f=>{let h={...u};f===o&&(h.color=s,h.index=a,h.picked=!0),h=jv({layer:f,info:h,mode:r});const p=h.layer;f===o&&r==="hover"&&(n.info=h),c.set(p.id,h),r==="hover"&&p.updateAutoHighlight(h)}),c}function jv({layer:t,info:e,mode:n}){for(;t&&e;){const r=e.layer||null;e.sourceLayer=r,e.layer=t,e=t.getPickingInfo({info:e,mode:n,sourceLayer:r}),t=t.parent}return e}function c3(t,e){for(let n=t.length-1;n>=0;n--){const r=t[n];if(r.containsPixel(e))return r}return t[0]}class f3{constructor(e){d(this,"gl",void 0),d(this,"pickingFBO",void 0),d(this,"depthFBO",void 0),d(this,"pickLayersPass",void 0),d(this,"layerFilter",void 0),d(this,"lastPickedInfo",void 0),d(this,"_pickable",!0),this.gl=e,this.pickLayersPass=new Uv(e),this.lastPickedInfo={index:-1,layerId:null,info:null}}setProps(e){"layerFilter"in e&&(this.layerFilter=e.layerFilter),"_pickable"in e&&(this._pickable=e._pickable)}finalize(){this.pickingFBO&&this.pickingFBO.delete(),this.depthFBO&&(this.depthFBO.color.delete(),this.depthFBO.delete())}pickObject(e){return this._pickClosestObject(e)}pickObjects(e){return this._pickVisibleObjects(e)}getLastPickedObject({x:e,y:n,layers:r,viewports:i},s=this.lastPickedInfo.info){const o=s&&s.layer&&s.layer.id,a=s&&s.viewport&&s.viewport.id,l=o?r.find(h=>h.id===o):null,u=a&&i.find(h=>h.id===a)||i[0],c=u&&u.unproject([e-u.x,n-u.y]);return{...s,...{x:e,y:n,viewport:u,coordinate:c,layer:l}}}_resizeBuffer(){var e,n;const{gl:r}=this;if(!this.pickingFBO&&(this.pickingFBO=new Te(r),Te.isSupported(r,{colorBufferFloat:!0}))){const i=new Te(r);i.attach({36064:new Rt(r,{format:H(r)?34836:6408,type:5126})}),this.depthFBO=i}(e=this.pickingFBO)===null||e===void 0||e.resize({width:r.canvas.width,height:r.canvas.height}),(n=this.depthFBO)===null||n===void 0||n.resize({width:r.canvas.width,height:r.canvas.height})}_getPickable(e){if(this._pickable===!1)return null;const n=e.filter(r=>this.pickLayersPass.shouldDrawLayer(r)&&!r.isComposite);return n.length?n:null}_pickClosestObject({layers:e,views:n,viewports:r,x:i,y:s,radius:o=0,depth:a=1,mode:l="query",unproject3D:u,onViewportActive:c,effects:f}){const h=this._getPickable(e),p=mr(this.gl);if(!h)return{result:[],emptyInfo:Vv({viewports:r,x:i,y:s,pixelRatio:p})};this._resizeBuffer();const E=su(this.gl,[i,s],!0),w=[E.x+Math.floor(E.width/2),E.y+Math.floor(E.height/2)],S=Math.round(o*p),{width:_,height:m}=this.pickingFBO,y=this._getPickingRect({deviceX:w[0],deviceY:w[1],deviceRadius:S,deviceWidth:_,deviceHeight:m}),b={x:i-o,y:s-o,width:o*2+1,height:o*2+1};let x;const P=[],L=new Set;for(let C=0;C<a;C++){let O;if(y){const B=this._drawAndSample({layers:h,views:n,viewports:r,onViewportActive:c,deviceRect:y,cullRect:b,effects:f,pass:"picking:".concat(l)});O=a3({...B,deviceX:w[0],deviceY:w[1],deviceRadius:S,deviceRect:y})}else O={pickedColor:null,pickedObjectIndex:-1};let I;if(O.pickedLayer&&u&&this.depthFBO){const{pickedColors:B}=this._drawAndSample({layers:[O.pickedLayer],views:n,viewports:r,onViewportActive:c,deviceRect:{x:O.pickedX,y:O.pickedY,width:1,height:1},cullRect:b,effects:f,pass:"picking:".concat(l,":z")},!0);B[3]&&(I=B[0])}O.pickedLayer&&C+1<a&&(L.add(O.pickedLayer),O.pickedLayer.disablePickingIndex(O.pickedObjectIndex)),x=u3({pickInfo:O,lastPickedInfo:this.lastPickedInfo,mode:l,layers:h,viewports:r,x:i,y:s,z:I,pixelRatio:p});for(const B of x.values())B.layer&&P.push(B);if(!O.pickedColor)break}for(const C of L)C.restorePickingColors();return{result:P,emptyInfo:x.get(null)}}_pickVisibleObjects({layers:e,views:n,viewports:r,x:i,y:s,width:o=1,height:a=1,mode:l="query",maxObjects:u=null,onViewportActive:c,effects:f}){const h=this._getPickable(e);if(!h)return[];this._resizeBuffer();const p=mr(this.gl),E=su(this.gl,[i,s],!0),w=E.x,S=E.y+E.height,_=su(this.gl,[i+o,s+a],!0),m=_.x+_.width,y=_.y,b={x:w,y,width:m-w,height:S-y},x=this._drawAndSample({layers:h,views:n,viewports:r,onViewportActive:c,deviceRect:b,cullRect:{x:i,y:s,width:o,height:a},effects:f,pass:"picking:".concat(l)}),P=l3(x),L=new Map,C=Number.isFinite(u);for(let I=0;I<P.length;I++){var O;if(C&&u&&L.size>=u)break;const B=P[I];let $={color:B.pickedColor,layer:null,index:B.pickedObjectIndex,picked:!0,x:i,y:s,pixelRatio:p};$=jv({layer:B.pickedLayer,info:$,mode:l});const K=(O=$.object)!==null&&O!==void 0?O:"".concat($.layer.id,"[").concat($.index,"]");L.has(K)||L.set(K,$)}return Array.from(L.values())}_drawAndSample({layers:e,views:n,viewports:r,onViewportActive:i,deviceRect:s,cullRect:o,effects:a,pass:l},u=!1){const c=u?this.depthFBO:this.pickingFBO,f={layers:e,layerFilter:this.layerFilter,views:n,viewports:r,onViewportActive:i,pickingFBO:c,deviceRect:s,cullRect:o,effects:a,pass:l,pickZ:u,preRenderStats:{}};for(const m of a)m.useInPicking&&(f.preRenderStats[m.id]=m.preRender(this.gl,f));const{decodePickingColor:h}=this.pickLayersPass.render(f),{x:p,y:E,width:w,height:S}=s,_=new(u?Float32Array:Uint8Array)(w*S*4);return fl(c,{sourceX:p,sourceY:E,sourceWidth:w,sourceHeight:S,target:_}),{pickedColors:_,decodePickingColor:h}}_getPickingRect({deviceX:e,deviceY:n,deviceRadius:r,deviceWidth:i,deviceHeight:s}){const o=Math.max(0,e-r),a=Math.max(0,n-r),l=Math.min(i,e+r+1)-o,u=Math.min(s,n+r+1)-a;return l<=0||u<=0?null:{x:o,y:a,width:l,height:u}}}const h3={zIndex:"1",position:"absolute",pointerEvents:"none",color:"#a0a7b4",backgroundColor:"#29323c",padding:"10px",top:"0",left:"0",display:"none"};class d3{constructor(e){d(this,"el",null),d(this,"isVisible",!1);const n=e.parentElement;n&&(this.el=document.createElement("div"),this.el.className="deck-tooltip",Object.assign(this.el.style,h3),n.appendChild(this.el))}setTooltip(e,n,r){const i=this.el;if(i){if(typeof e=="string")i.innerText=e;else if(e)e.text&&(i.innerText=e.text),e.html&&(i.innerHTML=e.html),e.className&&(i.className=e.className);else{this.isVisible=!1,i.style.display="none";return}this.isVisible=!0,i.style.display="block",i.style.transform="translate(".concat(n,"px, ").concat(r,"px)"),e&&typeof e=="object"&&"style"in e&&Object.assign(i.style,e.style)}}remove(){this.el&&(this.el.remove(),this.el=null)}}var Gv={exports:{}};/*! Hammer.JS - v2.0.7 - 2016-04-22
 * http://hammerjs.github.io/
 *
 * Copyright (c) 2016 Jorik Tangelder;
 * Licensed under the MIT license */(function(t){(function(e,n,r,i){var s=["","webkit","Moz","MS","ms","o"],o=n.createElement("div"),a="function",l=Math.round,u=Math.abs,c=Date.now;function f(g,v,T){return setTimeout(y(g,T),v)}function h(g,v,T){return Array.isArray(g)?(p(g,T[v],T),!0):!1}function p(g,v,T){var A;if(g)if(g.forEach)g.forEach(v,T);else if(g.length!==i)for(A=0;A<g.length;)v.call(T,g[A],A,g),A++;else for(A in g)g.hasOwnProperty(A)&&v.call(T,g[A],A,g)}function E(g,v,T){var A="DEPRECATED METHOD: "+v+`
`+T+` AT 
`;return function(){var M=new Error("get-stack-trace"),N=M&&M.stack?M.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",G=e.console&&(e.console.warn||e.console.log);return G&&G.call(e.console,A,N),g.apply(this,arguments)}}var w;typeof Object.assign!="function"?w=function(v){if(v===i||v===null)throw new TypeError("Cannot convert undefined or null to object");for(var T=Object(v),A=1;A<arguments.length;A++){var M=arguments[A];if(M!==i&&M!==null)for(var N in M)M.hasOwnProperty(N)&&(T[N]=M[N])}return T}:w=Object.assign;var S=E(function(v,T,A){for(var M=Object.keys(T),N=0;N<M.length;)(!A||A&&v[M[N]]===i)&&(v[M[N]]=T[M[N]]),N++;return v},"extend","Use `assign`."),_=E(function(v,T){return S(v,T,!0)},"merge","Use `assign`.");function m(g,v,T){var A=v.prototype,M;M=g.prototype=Object.create(A),M.constructor=g,M._super=A,T&&w(M,T)}function y(g,v){return function(){return g.apply(v,arguments)}}function b(g,v){return typeof g==a?g.apply(v&&v[0]||i,v):g}function x(g,v){return g===i?v:g}function P(g,v,T){p(I(v),function(A){g.addEventListener(A,T,!1)})}function L(g,v,T){p(I(v),function(A){g.removeEventListener(A,T,!1)})}function C(g,v){for(;g;){if(g==v)return!0;g=g.parentNode}return!1}function O(g,v){return g.indexOf(v)>-1}function I(g){return g.trim().split(/\s+/g)}function B(g,v,T){if(g.indexOf&&!T)return g.indexOf(v);for(var A=0;A<g.length;){if(T&&g[A][T]==v||!T&&g[A]===v)return A;A++}return-1}function $(g){return Array.prototype.slice.call(g,0)}function K(g,v,T){for(var A=[],M=[],N=0;N<g.length;){var G=v?g[N][v]:g[N];B(M,G)<0&&A.push(g[N]),M[N]=G,N++}return T&&(v?A=A.sort(function(xe,Ue){return xe[v]>Ue[v]}):A=A.sort()),A}function X(g,v){for(var T,A,M=v[0].toUpperCase()+v.slice(1),N=0;N<s.length;){if(T=s[N],A=T?T+M:v,A in g)return A;N++}return i}var qt=1;function xi(){return qt++}function Ar(g){var v=g.ownerDocument||g;return v.defaultView||v.parentWindow||e}var D=/mobile|tablet|ip(ad|hone|od)|android/i,V="ontouchstart"in e,j=X(e,"PointerEvent")!==i,le=V&&D.test(navigator.userAgent),oe="touch",xr="pen",Et="mouse",Pi="kinect",Zt=25,pe=1,qn=2,me=4,We=8,no=1,Li=2,Ci=4,Mi=8,Ri=16,It=Li|Ci,Zn=Mi|Ri,bh=It|Zn,Sh=["x","y"],ro=["clientX","clientY"];function ct(g,v){var T=this;this.manager=g,this.callback=v,this.element=g.element,this.target=g.options.inputTarget,this.domHandler=function(A){b(g.options.enable,[g])&&T.handler(A)},this.init()}ct.prototype={handler:function(){},init:function(){this.evEl&&P(this.element,this.evEl,this.domHandler),this.evTarget&&P(this.target,this.evTarget,this.domHandler),this.evWin&&P(Ar(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&L(this.element,this.evEl,this.domHandler),this.evTarget&&L(this.target,this.evTarget,this.domHandler),this.evWin&&L(Ar(this.element),this.evWin,this.domHandler)}};function vy(g){var v,T=g.options.inputClass;return T?v=T:j?v=ml:le?v=oo:V?v=_l:v=so,new v(g,yy)}function yy(g,v,T){var A=T.pointers.length,M=T.changedPointers.length,N=v&pe&&A-M===0,G=v&(me|We)&&A-M===0;T.isFirst=!!N,T.isFinal=!!G,N&&(g.session={}),T.eventType=v,Ey(g,T),g.emit("hammer.input",T),g.recognize(T),g.session.prevInput=T}function Ey(g,v){var T=g.session,A=v.pointers,M=A.length;T.firstInput||(T.firstInput=Ah(v)),M>1&&!T.firstMultiple?T.firstMultiple=Ah(v):M===1&&(T.firstMultiple=!1);var N=T.firstInput,G=T.firstMultiple,be=G?G.center:N.center,xe=v.center=xh(A);v.timeStamp=c(),v.deltaTime=v.timeStamp-N.timeStamp,v.angle=pl(be,xe),v.distance=io(be,xe),wy(T,v),v.offsetDirection=Lh(v.deltaX,v.deltaY);var Ue=Ph(v.deltaTime,v.deltaX,v.deltaY);v.overallVelocityX=Ue.x,v.overallVelocityY=Ue.y,v.overallVelocity=u(Ue.x)>u(Ue.y)?Ue.x:Ue.y,v.scale=G?Sy(G.pointers,A):1,v.rotation=G?by(G.pointers,A):0,v.maxPointers=T.prevInput?v.pointers.length>T.prevInput.maxPointers?v.pointers.length:T.prevInput.maxPointers:v.pointers.length,Ty(T,v);var kt=g.element;C(v.srcEvent.target,kt)&&(kt=v.srcEvent.target),v.target=kt}function wy(g,v){var T=v.center,A=g.offsetDelta||{},M=g.prevDelta||{},N=g.prevInput||{};(v.eventType===pe||N.eventType===me)&&(M=g.prevDelta={x:N.deltaX||0,y:N.deltaY||0},A=g.offsetDelta={x:T.x,y:T.y}),v.deltaX=M.x+(T.x-A.x),v.deltaY=M.y+(T.y-A.y)}function Ty(g,v){var T=g.lastInterval||v,A=v.timeStamp-T.timeStamp,M,N,G,be;if(v.eventType!=We&&(A>Zt||T.velocity===i)){var xe=v.deltaX-T.deltaX,Ue=v.deltaY-T.deltaY,kt=Ph(A,xe,Ue);N=kt.x,G=kt.y,M=u(kt.x)>u(kt.y)?kt.x:kt.y,be=Lh(xe,Ue),g.lastInterval=v}else M=T.velocity,N=T.velocityX,G=T.velocityY,be=T.direction;v.velocity=M,v.velocityX=N,v.velocityY=G,v.direction=be}function Ah(g){for(var v=[],T=0;T<g.pointers.length;)v[T]={clientX:l(g.pointers[T].clientX),clientY:l(g.pointers[T].clientY)},T++;return{timeStamp:c(),pointers:v,center:xh(v),deltaX:g.deltaX,deltaY:g.deltaY}}function xh(g){var v=g.length;if(v===1)return{x:l(g[0].clientX),y:l(g[0].clientY)};for(var T=0,A=0,M=0;M<v;)T+=g[M].clientX,A+=g[M].clientY,M++;return{x:l(T/v),y:l(A/v)}}function Ph(g,v,T){return{x:v/g||0,y:T/g||0}}function Lh(g,v){return g===v?no:u(g)>=u(v)?g<0?Li:Ci:v<0?Mi:Ri}function io(g,v,T){T||(T=Sh);var A=v[T[0]]-g[T[0]],M=v[T[1]]-g[T[1]];return Math.sqrt(A*A+M*M)}function pl(g,v,T){T||(T=Sh);var A=v[T[0]]-g[T[0]],M=v[T[1]]-g[T[1]];return Math.atan2(M,A)*180/Math.PI}function by(g,v){return pl(v[1],v[0],ro)+pl(g[1],g[0],ro)}function Sy(g,v){return io(v[0],v[1],ro)/io(g[0],g[1],ro)}var Ay={mousedown:pe,mousemove:qn,mouseup:me},xy="mousedown",Py="mousemove mouseup";function so(){this.evEl=xy,this.evWin=Py,this.pressed=!1,ct.apply(this,arguments)}m(so,ct,{handler:function(v){var T=Ay[v.type];T&pe&&v.button===0&&(this.pressed=!0),T&qn&&v.which!==1&&(T=me),this.pressed&&(T&me&&(this.pressed=!1),this.callback(this.manager,T,{pointers:[v],changedPointers:[v],pointerType:Et,srcEvent:v}))}});var Ly={pointerdown:pe,pointermove:qn,pointerup:me,pointercancel:We,pointerout:We},Cy={2:oe,3:xr,4:Et,5:Pi},Ch="pointerdown",Mh="pointermove pointerup pointercancel";e.MSPointerEvent&&!e.PointerEvent&&(Ch="MSPointerDown",Mh="MSPointerMove MSPointerUp MSPointerCancel");function ml(){this.evEl=Ch,this.evWin=Mh,ct.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}m(ml,ct,{handler:function(v){var T=this.store,A=!1,M=v.type.toLowerCase().replace("ms",""),N=Ly[M],G=Cy[v.pointerType]||v.pointerType,be=G==oe,xe=B(T,v.pointerId,"pointerId");N&pe&&(v.button===0||be)?xe<0&&(T.push(v),xe=T.length-1):N&(me|We)&&(A=!0),!(xe<0)&&(T[xe]=v,this.callback(this.manager,N,{pointers:T,changedPointers:[v],pointerType:G,srcEvent:v}),A&&T.splice(xe,1))}});var My={touchstart:pe,touchmove:qn,touchend:me,touchcancel:We},Ry="touchstart",Iy="touchstart touchmove touchend touchcancel";function Rh(){this.evTarget=Ry,this.evWin=Iy,this.started=!1,ct.apply(this,arguments)}m(Rh,ct,{handler:function(v){var T=My[v.type];if(T===pe&&(this.started=!0),!!this.started){var A=Oy.call(this,v,T);T&(me|We)&&A[0].length-A[1].length===0&&(this.started=!1),this.callback(this.manager,T,{pointers:A[0],changedPointers:A[1],pointerType:oe,srcEvent:v})}}});function Oy(g,v){var T=$(g.touches),A=$(g.changedTouches);return v&(me|We)&&(T=K(T.concat(A),"identifier",!0)),[T,A]}var ky={touchstart:pe,touchmove:qn,touchend:me,touchcancel:We},Ny="touchstart touchmove touchend touchcancel";function oo(){this.evTarget=Ny,this.targetIds={},ct.apply(this,arguments)}m(oo,ct,{handler:function(v){var T=ky[v.type],A=Dy.call(this,v,T);A&&this.callback(this.manager,T,{pointers:A[0],changedPointers:A[1],pointerType:oe,srcEvent:v})}});function Dy(g,v){var T=$(g.touches),A=this.targetIds;if(v&(pe|qn)&&T.length===1)return A[T[0].identifier]=!0,[T,T];var M,N,G=$(g.changedTouches),be=[],xe=this.target;if(N=T.filter(function(Ue){return C(Ue.target,xe)}),v===pe)for(M=0;M<N.length;)A[N[M].identifier]=!0,M++;for(M=0;M<G.length;)A[G[M].identifier]&&be.push(G[M]),v&(me|We)&&delete A[G[M].identifier],M++;if(be.length)return[K(N.concat(be),"identifier",!0),be]}var Fy=2500,Ih=25;function _l(){ct.apply(this,arguments);var g=y(this.handler,this);this.touch=new oo(this.manager,g),this.mouse=new so(this.manager,g),this.primaryTouch=null,this.lastTouches=[]}m(_l,ct,{handler:function(v,T,A){var M=A.pointerType==oe,N=A.pointerType==Et;if(!(N&&A.sourceCapabilities&&A.sourceCapabilities.firesTouchEvents)){if(M)Uy.call(this,T,A);else if(N&&By.call(this,A))return;this.callback(v,T,A)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});function Uy(g,v){g&pe?(this.primaryTouch=v.changedPointers[0].identifier,Oh.call(this,v)):g&(me|We)&&Oh.call(this,v)}function Oh(g){var v=g.changedPointers[0];if(v.identifier===this.primaryTouch){var T={x:v.clientX,y:v.clientY};this.lastTouches.push(T);var A=this.lastTouches,M=function(){var N=A.indexOf(T);N>-1&&A.splice(N,1)};setTimeout(M,Fy)}}function By(g){for(var v=g.srcEvent.clientX,T=g.srcEvent.clientY,A=0;A<this.lastTouches.length;A++){var M=this.lastTouches[A],N=Math.abs(v-M.x),G=Math.abs(T-M.y);if(N<=Ih&&G<=Ih)return!0}return!1}var kh=X(o.style,"touchAction"),Nh=kh!==i,Dh="compute",Fh="auto",vl="manipulation",Qn="none",Ii="pan-x",Oi="pan-y",ao=Vy();function yl(g,v){this.manager=g,this.set(v)}yl.prototype={set:function(g){g==Dh&&(g=this.compute()),Nh&&this.manager.element.style&&ao[g]&&(this.manager.element.style[kh]=g),this.actions=g.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var g=[];return p(this.manager.recognizers,function(v){b(v.options.enable,[v])&&(g=g.concat(v.getTouchAction()))}),zy(g.join(" "))},preventDefaults:function(g){var v=g.srcEvent,T=g.offsetDirection;if(this.manager.session.prevented){v.preventDefault();return}var A=this.actions,M=O(A,Qn)&&!ao[Qn],N=O(A,Oi)&&!ao[Oi],G=O(A,Ii)&&!ao[Ii];if(M){var be=g.pointers.length===1,xe=g.distance<2,Ue=g.deltaTime<250;if(be&&xe&&Ue)return}if(!(G&&N)&&(M||N&&T&It||G&&T&Zn))return this.preventSrc(v)},preventSrc:function(g){this.manager.session.prevented=!0,g.preventDefault()}};function zy(g){if(O(g,Qn))return Qn;var v=O(g,Ii),T=O(g,Oi);return v&&T?Qn:v||T?v?Ii:Oi:O(g,vl)?vl:Fh}function Vy(){if(!Nh)return!1;var g={},v=e.CSS&&e.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(T){g[T]=v?e.CSS.supports("touch-action",T):!0}),g}var lo=1,ft=2,Pr=4,yn=8,Qt=yn,ki=16,Ot=32;function Kt(g){this.options=w({},this.defaults,g||{}),this.id=xi(),this.manager=null,this.options.enable=x(this.options.enable,!0),this.state=lo,this.simultaneous={},this.requireFail=[]}Kt.prototype={defaults:{},set:function(g){return w(this.options,g),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(g){if(h(g,"recognizeWith",this))return this;var v=this.simultaneous;return g=uo(g,this),v[g.id]||(v[g.id]=g,g.recognizeWith(this)),this},dropRecognizeWith:function(g){return h(g,"dropRecognizeWith",this)?this:(g=uo(g,this),delete this.simultaneous[g.id],this)},requireFailure:function(g){if(h(g,"requireFailure",this))return this;var v=this.requireFail;return g=uo(g,this),B(v,g)===-1&&(v.push(g),g.requireFailure(this)),this},dropRequireFailure:function(g){if(h(g,"dropRequireFailure",this))return this;g=uo(g,this);var v=B(this.requireFail,g);return v>-1&&this.requireFail.splice(v,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(g){return!!this.simultaneous[g.id]},emit:function(g){var v=this,T=this.state;function A(M){v.manager.emit(M,g)}T<yn&&A(v.options.event+Uh(T)),A(v.options.event),g.additionalEvent&&A(g.additionalEvent),T>=yn&&A(v.options.event+Uh(T))},tryEmit:function(g){if(this.canEmit())return this.emit(g);this.state=Ot},canEmit:function(){for(var g=0;g<this.requireFail.length;){if(!(this.requireFail[g].state&(Ot|lo)))return!1;g++}return!0},recognize:function(g){var v=w({},g);if(!b(this.options.enable,[this,v])){this.reset(),this.state=Ot;return}this.state&(Qt|ki|Ot)&&(this.state=lo),this.state=this.process(v),this.state&(ft|Pr|yn|ki)&&this.tryEmit(v)},process:function(g){},getTouchAction:function(){},reset:function(){}};function Uh(g){return g&ki?"cancel":g&yn?"end":g&Pr?"move":g&ft?"start":""}function Bh(g){return g==Ri?"down":g==Mi?"up":g==Li?"left":g==Ci?"right":""}function uo(g,v){var T=v.manager;return T?T.get(g):g}function wt(){Kt.apply(this,arguments)}m(wt,Kt,{defaults:{pointers:1},attrTest:function(g){var v=this.options.pointers;return v===0||g.pointers.length===v},process:function(g){var v=this.state,T=g.eventType,A=v&(ft|Pr),M=this.attrTest(g);return A&&(T&We||!M)?v|ki:A||M?T&me?v|yn:v&ft?v|Pr:ft:Ot}});function co(){wt.apply(this,arguments),this.pX=null,this.pY=null}m(co,wt,{defaults:{event:"pan",threshold:10,pointers:1,direction:bh},getTouchAction:function(){var g=this.options.direction,v=[];return g&It&&v.push(Oi),g&Zn&&v.push(Ii),v},directionTest:function(g){var v=this.options,T=!0,A=g.distance,M=g.direction,N=g.deltaX,G=g.deltaY;return M&v.direction||(v.direction&It?(M=N===0?no:N<0?Li:Ci,T=N!=this.pX,A=Math.abs(g.deltaX)):(M=G===0?no:G<0?Mi:Ri,T=G!=this.pY,A=Math.abs(g.deltaY))),g.direction=M,T&&A>v.threshold&&M&v.direction},attrTest:function(g){return wt.prototype.attrTest.call(this,g)&&(this.state&ft||!(this.state&ft)&&this.directionTest(g))},emit:function(g){this.pX=g.deltaX,this.pY=g.deltaY;var v=Bh(g.direction);v&&(g.additionalEvent=this.options.event+v),this._super.emit.call(this,g)}});function El(){wt.apply(this,arguments)}m(El,wt,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[Qn]},attrTest:function(g){return this._super.attrTest.call(this,g)&&(Math.abs(g.scale-1)>this.options.threshold||this.state&ft)},emit:function(g){if(g.scale!==1){var v=g.scale<1?"in":"out";g.additionalEvent=this.options.event+v}this._super.emit.call(this,g)}});function wl(){Kt.apply(this,arguments),this._timer=null,this._input=null}m(wl,Kt,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[Fh]},process:function(g){var v=this.options,T=g.pointers.length===v.pointers,A=g.distance<v.threshold,M=g.deltaTime>v.time;if(this._input=g,!A||!T||g.eventType&(me|We)&&!M)this.reset();else if(g.eventType&pe)this.reset(),this._timer=f(function(){this.state=Qt,this.tryEmit()},v.time,this);else if(g.eventType&me)return Qt;return Ot},reset:function(){clearTimeout(this._timer)},emit:function(g){this.state===Qt&&(g&&g.eventType&me?this.manager.emit(this.options.event+"up",g):(this._input.timeStamp=c(),this.manager.emit(this.options.event,this._input)))}});function Tl(){wt.apply(this,arguments)}m(Tl,wt,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[Qn]},attrTest:function(g){return this._super.attrTest.call(this,g)&&(Math.abs(g.rotation)>this.options.threshold||this.state&ft)}});function bl(){wt.apply(this,arguments)}m(bl,wt,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:It|Zn,pointers:1},getTouchAction:function(){return co.prototype.getTouchAction.call(this)},attrTest:function(g){var v=this.options.direction,T;return v&(It|Zn)?T=g.overallVelocity:v&It?T=g.overallVelocityX:v&Zn&&(T=g.overallVelocityY),this._super.attrTest.call(this,g)&&v&g.offsetDirection&&g.distance>this.options.threshold&&g.maxPointers==this.options.pointers&&u(T)>this.options.velocity&&g.eventType&me},emit:function(g){var v=Bh(g.offsetDirection);v&&this.manager.emit(this.options.event+v,g),this.manager.emit(this.options.event,g)}});function fo(){Kt.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}m(fo,Kt,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[vl]},process:function(g){var v=this.options,T=g.pointers.length===v.pointers,A=g.distance<v.threshold,M=g.deltaTime<v.time;if(this.reset(),g.eventType&pe&&this.count===0)return this.failTimeout();if(A&&M&&T){if(g.eventType!=me)return this.failTimeout();var N=this.pTime?g.timeStamp-this.pTime<v.interval:!0,G=!this.pCenter||io(this.pCenter,g.center)<v.posThreshold;this.pTime=g.timeStamp,this.pCenter=g.center,!G||!N?this.count=1:this.count+=1,this._input=g;var be=this.count%v.taps;if(be===0)return this.hasRequireFailures()?(this._timer=f(function(){this.state=Qt,this.tryEmit()},v.interval,this),ft):Qt}return Ot},failTimeout:function(){return this._timer=f(function(){this.state=Ot},this.options.interval,this),Ot},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==Qt&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}});function Jt(g,v){return v=v||{},v.recognizers=x(v.recognizers,Jt.defaults.preset),new Sl(g,v)}Jt.VERSION="2.0.7",Jt.defaults={domEvents:!1,touchAction:Dh,enable:!0,inputTarget:null,inputClass:null,preset:[[Tl,{enable:!1}],[El,{enable:!1},["rotate"]],[bl,{direction:It}],[co,{direction:It},["swipe"]],[fo],[fo,{event:"doubletap",taps:2},["tap"]],[wl]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var jy=1,zh=2;function Sl(g,v){this.options=w({},Jt.defaults,v||{}),this.options.inputTarget=this.options.inputTarget||g,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=g,this.input=vy(this),this.touchAction=new yl(this,this.options.touchAction),Vh(this,!0),p(this.options.recognizers,function(T){var A=this.add(new T[0](T[1]));T[2]&&A.recognizeWith(T[2]),T[3]&&A.requireFailure(T[3])},this)}Sl.prototype={set:function(g){return w(this.options,g),g.touchAction&&this.touchAction.update(),g.inputTarget&&(this.input.destroy(),this.input.target=g.inputTarget,this.input.init()),this},stop:function(g){this.session.stopped=g?zh:jy},recognize:function(g){var v=this.session;if(!v.stopped){this.touchAction.preventDefaults(g);var T,A=this.recognizers,M=v.curRecognizer;(!M||M&&M.state&Qt)&&(M=v.curRecognizer=null);for(var N=0;N<A.length;)T=A[N],v.stopped!==zh&&(!M||T==M||T.canRecognizeWith(M))?T.recognize(g):T.reset(),!M&&T.state&(ft|Pr|yn)&&(M=v.curRecognizer=T),N++}},get:function(g){if(g instanceof Kt)return g;for(var v=this.recognizers,T=0;T<v.length;T++)if(v[T].options.event==g)return v[T];return null},add:function(g){if(h(g,"add",this))return this;var v=this.get(g.options.event);return v&&this.remove(v),this.recognizers.push(g),g.manager=this,this.touchAction.update(),g},remove:function(g){if(h(g,"remove",this))return this;if(g=this.get(g),g){var v=this.recognizers,T=B(v,g);T!==-1&&(v.splice(T,1),this.touchAction.update())}return this},on:function(g,v){if(g!==i&&v!==i){var T=this.handlers;return p(I(g),function(A){T[A]=T[A]||[],T[A].push(v)}),this}},off:function(g,v){if(g!==i){var T=this.handlers;return p(I(g),function(A){v?T[A]&&T[A].splice(B(T[A],v),1):delete T[A]}),this}},emit:function(g,v){this.options.domEvents&&Gy(g,v);var T=this.handlers[g]&&this.handlers[g].slice();if(!(!T||!T.length)){v.type=g,v.preventDefault=function(){v.srcEvent.preventDefault()};for(var A=0;A<T.length;)T[A](v),A++}},destroy:function(){this.element&&Vh(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}};function Vh(g,v){var T=g.element;if(T.style){var A;p(g.options.cssProps,function(M,N){A=X(T.style,N),v?(g.oldCssProps[A]=T.style[A],T.style[A]=M):T.style[A]=g.oldCssProps[A]||""}),v||(g.oldCssProps={})}}function Gy(g,v){var T=n.createEvent("Event");T.initEvent(g,!0,!0),T.gesture=v,v.target.dispatchEvent(T)}w(Jt,{INPUT_START:pe,INPUT_MOVE:qn,INPUT_END:me,INPUT_CANCEL:We,STATE_POSSIBLE:lo,STATE_BEGAN:ft,STATE_CHANGED:Pr,STATE_ENDED:yn,STATE_RECOGNIZED:Qt,STATE_CANCELLED:ki,STATE_FAILED:Ot,DIRECTION_NONE:no,DIRECTION_LEFT:Li,DIRECTION_RIGHT:Ci,DIRECTION_UP:Mi,DIRECTION_DOWN:Ri,DIRECTION_HORIZONTAL:It,DIRECTION_VERTICAL:Zn,DIRECTION_ALL:bh,Manager:Sl,Input:ct,TouchAction:yl,TouchInput:oo,MouseInput:so,PointerEventInput:ml,TouchMouseInput:_l,SingleTouchInput:Rh,Recognizer:Kt,AttrRecognizer:wt,Tap:fo,Pan:co,Swipe:bl,Pinch:El,Rotate:Tl,Press:wl,on:P,off:L,each:p,merge:_,extend:S,assign:w,inherit:m,bindFn:y,prefixed:X});var Hy=typeof e<"u"?e:typeof self<"u"?self:{};Hy.Hammer=Jt,typeof i=="function"&&i.amd?i(function(){return Jt}):t.exports?t.exports=Jt:e[r]=Jt})(window,document,"Hammer")})(Gv);var to=Gv.exports;const g3=rm(to),Ft=Wy({__proto__:null,default:g3},[to]),Hv=1,Wv=2,zc=4,p3={mousedown:Hv,mousemove:Wv,mouseup:zc};function m3(t,e){for(let n=0;n<t.length;n++)if(e(t[n]))return!0;return!1}function _3(t){const e=t.prototype.handler;t.prototype.handler=function(r){const i=this.store;r.button>0&&r.type==="pointerdown"&&(m3(i,s=>s.pointerId===r.pointerId)||i.push(r)),e.call(this,r)}}function v3(t){t.prototype.handler=function(n){let r=p3[n.type];r&Hv&&n.button>=0&&(this.pressed=!0),r&Wv&&n.which===0&&(r=zc),this.pressed&&(r&zc&&(this.pressed=!1),this.callback(this.manager,r,{pointers:[n],changedPointers:[n],pointerType:"mouse",srcEvent:n}))}}_3(to.PointerEventInput);v3(to.MouseInput);const y3=to.Manager;class hl{constructor(e,n,r){this.element=e,this.callback=n,this.options={enable:!0,...r}}}const E3=Ft?[[Ft.Pan,{event:"tripan",pointers:3,threshold:0,enable:!1}],[Ft.Rotate,{enable:!1}],[Ft.Pinch,{enable:!1}],[Ft.Swipe,{enable:!1}],[Ft.Pan,{threshold:0,enable:!1}],[Ft.Press,{enable:!1}],[Ft.Tap,{event:"doubletap",taps:2,enable:!1}],[Ft.Tap,{event:"anytap",enable:!1}],[Ft.Tap,{enable:!1}]]:null,Mp={tripan:["rotate","pinch","pan"],rotate:["pinch"],pinch:["pan"],pan:["press","doubletap","anytap","tap"],doubletap:["anytap"],anytap:["tap"]},w3={doubletap:["tap"]},T3={pointerdown:"pointerdown",pointermove:"pointermove",pointerup:"pointerup",touchstart:"pointerdown",touchmove:"pointermove",touchend:"pointerup",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup"},dh={KEY_EVENTS:["keydown","keyup"],MOUSE_EVENTS:["mousedown","mousemove","mouseup","mouseover","mouseout","mouseleave"],WHEEL_EVENTS:["wheel","mousewheel"]},b3={tap:"tap",anytap:"anytap",doubletap:"doubletap",press:"press",pinch:"pinch",pinchin:"pinch",pinchout:"pinch",pinchstart:"pinch",pinchmove:"pinch",pinchend:"pinch",pinchcancel:"pinch",rotate:"rotate",rotatestart:"rotate",rotatemove:"rotate",rotateend:"rotate",rotatecancel:"rotate",tripan:"tripan",tripanstart:"tripan",tripanmove:"tripan",tripanup:"tripan",tripandown:"tripan",tripanleft:"tripan",tripanright:"tripan",tripanend:"tripan",tripancancel:"tripan",pan:"pan",panstart:"pan",panmove:"pan",panup:"pan",pandown:"pan",panleft:"pan",panright:"pan",panend:"pan",pancancel:"pan",swipe:"swipe",swipeleft:"swipe",swiperight:"swipe",swipeup:"swipe",swipedown:"swipe"},Rp={click:"tap",anyclick:"anytap",dblclick:"doubletap",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup",mouseover:"pointerover",mouseout:"pointerout",mouseleave:"pointerleave"},S3=typeof navigator<"u"&&navigator.userAgent?navigator.userAgent.toLowerCase():"",Zr=typeof window<"u"?window:global;let Vc=!1;try{const t={get passive(){return Vc=!0,!0}};Zr.addEventListener("test",null,t),Zr.removeEventListener("test",null)}catch{Vc=!1}const A3=S3.indexOf("firefox")!==-1,{WHEEL_EVENTS:x3}=dh,Ip="wheel",Op=4.000244140625,P3=40,L3=.25;class C3 extends hl{constructor(e,n,r){super(e,n,r),this.handleEvent=i=>{if(!this.options.enable)return;let s=i.deltaY;Zr.WheelEvent&&(A3&&i.deltaMode===Zr.WheelEvent.DOM_DELTA_PIXEL&&(s/=Zr.devicePixelRatio),i.deltaMode===Zr.WheelEvent.DOM_DELTA_LINE&&(s*=P3)),s!==0&&s%Op===0&&(s=Math.floor(s/Op)),i.shiftKey&&s&&(s=s*L3),this.callback({type:Ip,center:{x:i.clientX,y:i.clientY},delta:-s,srcEvent:i,pointerType:"mouse",target:i.target})},this.events=(this.options.events||[]).concat(x3),this.events.forEach(i=>e.addEventListener(i,this.handleEvent,Vc?{passive:!1}:!1))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,n){e===Ip&&(this.options.enable=n)}}const{MOUSE_EVENTS:M3}=dh,kp="pointermove",Np="pointerover",Dp="pointerout",Fp="pointerenter",Up="pointerleave";class R3 extends hl{constructor(e,n,r){super(e,n,r),this.handleEvent=s=>{this.handleOverEvent(s),this.handleOutEvent(s),this.handleEnterEvent(s),this.handleLeaveEvent(s),this.handleMoveEvent(s)},this.pressed=!1;const{enable:i}=this.options;this.enableMoveEvent=i,this.enableLeaveEvent=i,this.enableEnterEvent=i,this.enableOutEvent=i,this.enableOverEvent=i,this.events=(this.options.events||[]).concat(M3),this.events.forEach(s=>e.addEventListener(s,this.handleEvent))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,n){e===kp&&(this.enableMoveEvent=n),e===Np&&(this.enableOverEvent=n),e===Dp&&(this.enableOutEvent=n),e===Fp&&(this.enableEnterEvent=n),e===Up&&(this.enableLeaveEvent=n)}handleOverEvent(e){this.enableOverEvent&&e.type==="mouseover"&&this._emit(Np,e)}handleOutEvent(e){this.enableOutEvent&&e.type==="mouseout"&&this._emit(Dp,e)}handleEnterEvent(e){this.enableEnterEvent&&e.type==="mouseenter"&&this._emit(Fp,e)}handleLeaveEvent(e){this.enableLeaveEvent&&e.type==="mouseleave"&&this._emit(Up,e)}handleMoveEvent(e){if(this.enableMoveEvent)switch(e.type){case"mousedown":e.button>=0&&(this.pressed=!0);break;case"mousemove":e.which===0&&(this.pressed=!1),this.pressed||this._emit(kp,e);break;case"mouseup":this.pressed=!1;break}}_emit(e,n){this.callback({type:e,center:{x:n.clientX,y:n.clientY},srcEvent:n,pointerType:"mouse",target:n.target})}}const{KEY_EVENTS:I3}=dh,Bp="keydown",zp="keyup";class O3 extends hl{constructor(e,n,r){super(e,n,r),this.handleEvent=i=>{const s=i.target||i.srcElement;s.tagName==="INPUT"&&s.type==="text"||s.tagName==="TEXTAREA"||(this.enableDownEvent&&i.type==="keydown"&&this.callback({type:Bp,srcEvent:i,key:i.key,target:i.target}),this.enableUpEvent&&i.type==="keyup"&&this.callback({type:zp,srcEvent:i,key:i.key,target:i.target}))},this.enableDownEvent=this.options.enable,this.enableUpEvent=this.options.enable,this.events=(this.options.events||[]).concat(I3),e.tabIndex=this.options.tabIndex||0,e.style.outline="none",this.events.forEach(i=>e.addEventListener(i,this.handleEvent))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,n){e===Bp&&(this.enableDownEvent=n),e===zp&&(this.enableUpEvent=n)}}const Vp="contextmenu";class k3 extends hl{constructor(e,n,r){super(e,n,r),this.handleEvent=i=>{this.options.enable&&this.callback({type:Vp,center:{x:i.clientX,y:i.clientY},srcEvent:i,pointerType:"mouse",target:i.target})},e.addEventListener("contextmenu",this.handleEvent)}destroy(){this.element.removeEventListener("contextmenu",this.handleEvent)}enableEventType(e,n){e===Vp&&(this.options.enable=n)}}const jc=1,Ga=2,Gc=4,N3={pointerdown:jc,pointermove:Ga,pointerup:Gc,mousedown:jc,mousemove:Ga,mouseup:Gc},D3=1,F3=2,U3=3,B3=0,z3=1,V3=2,j3=1,G3=2,H3=4;function W3(t){const e=N3[t.srcEvent.type];if(!e)return null;const{buttons:n,button:r,which:i}=t.srcEvent;let s=!1,o=!1,a=!1;return e===Gc||e===Ga&&!Number.isFinite(n)?(s=i===D3,o=i===F3,a=i===U3):e===Ga?(s=!!(n&j3),o=!!(n&H3),a=!!(n&G3)):e===jc&&(s=r===B3,o=r===z3,a=r===V3),{leftButton:s,middleButton:o,rightButton:a}}function X3(t,e){const n=t.center;if(!n)return null;const r=e.getBoundingClientRect(),i=r.width/e.offsetWidth||1,s=r.height/e.offsetHeight||1,o={x:(n.x-r.left-e.clientLeft)/i,y:(n.y-r.top-e.clientTop)/s};return{center:n,offsetCenter:o}}const bu={srcElement:"root",priority:0};class Y3{constructor(e){this.handleEvent=n=>{if(this.isEmpty())return;const r=this._normalizeEvent(n);let i=n.srcEvent.target;for(;i&&i!==r.rootElement;){if(this._emit(r,i),r.handled)return;i=i.parentNode}this._emit(r,"root")},this.eventManager=e,this.handlers=[],this.handlersByElement=new Map,this._active=!1}isEmpty(){return!this._active}add(e,n,r,i=!1,s=!1){const{handlers:o,handlersByElement:a}=this;let l=bu;typeof r=="string"||r&&r.addEventListener?l={...bu,srcElement:r}:r&&(l={...bu,...r});let u=a.get(l.srcElement);u||(u=[],a.set(l.srcElement,u));const c={type:e,handler:n,srcElement:l.srcElement,priority:l.priority};i&&(c.once=!0),s&&(c.passive=!0),o.push(c),this._active=this._active||!c.passive;let f=u.length-1;for(;f>=0&&!(u[f].priority>=c.priority);)f--;u.splice(f+1,0,c)}remove(e,n){const{handlers:r,handlersByElement:i}=this;for(let s=r.length-1;s>=0;s--){const o=r[s];if(o.type===e&&o.handler===n){r.splice(s,1);const a=i.get(o.srcElement);a.splice(a.indexOf(o),1),a.length===0&&i.delete(o.srcElement)}}this._active=r.some(s=>!s.passive)}_emit(e,n){const r=this.handlersByElement.get(n);if(r){let i=!1;const s=()=>{e.handled=!0},o=()=>{e.handled=!0,i=!0},a=[];for(let l=0;l<r.length;l++){const{type:u,handler:c,once:f}=r[l];if(c({...e,type:u,stopPropagation:s,stopImmediatePropagation:o}),f&&a.push(r[l]),i)break}for(let l=0;l<a.length;l++){const{type:u,handler:c}=a[l];this.remove(u,c)}}}_normalizeEvent(e){const n=this.eventManager.getElement();return{...e,...W3(e),...X3(e,n),preventDefault:()=>{e.srcEvent.preventDefault()},stopImmediatePropagation:null,stopPropagation:null,handled:!1,rootElement:n}}}const $3={events:null,recognizers:null,recognizerOptions:{},Manager:y3,touchAction:"none",tabIndex:0};class q3{constructor(e=null,n){this._onBasicInput=i=>{const{srcEvent:s}=i,o=T3[s.type];o&&this.manager.emit(o,i)},this._onOtherEvent=i=>{this.manager.emit(i.type,i)},this.options={...$3,...n},this.events=new Map,this.setElement(e);const{events:r}=this.options;r&&this.on(r)}getElement(){return this.element}setElement(e){if(this.element&&this.destroy(),this.element=e,!e)return;const{options:n}=this,r=n.Manager;this.manager=new r(e,{touchAction:n.touchAction,recognizers:n.recognizers||E3}).on("hammer.input",this._onBasicInput),n.recognizers||Object.keys(Mp).forEach(i=>{const s=this.manager.get(i);s&&Mp[i].forEach(o=>{s.recognizeWith(o)})});for(const i in n.recognizerOptions){const s=this.manager.get(i);if(s){const o=n.recognizerOptions[i];delete o.enable,s.set(o)}}this.wheelInput=new C3(e,this._onOtherEvent,{enable:!1}),this.moveInput=new R3(e,this._onOtherEvent,{enable:!1}),this.keyInput=new O3(e,this._onOtherEvent,{enable:!1,tabIndex:n.tabIndex}),this.contextmenuInput=new k3(e,this._onOtherEvent,{enable:!1});for(const[i,s]of this.events)s.isEmpty()||(this._toggleRecognizer(s.recognizerName,!0),this.manager.on(i,s.handleEvent))}destroy(){this.element&&(this.wheelInput.destroy(),this.moveInput.destroy(),this.keyInput.destroy(),this.contextmenuInput.destroy(),this.manager.destroy(),this.wheelInput=null,this.moveInput=null,this.keyInput=null,this.contextmenuInput=null,this.manager=null,this.element=null)}on(e,n,r){this._addEventHandler(e,n,r,!1)}once(e,n,r){this._addEventHandler(e,n,r,!0)}watch(e,n,r){this._addEventHandler(e,n,r,!1,!0)}off(e,n){this._removeEventHandler(e,n)}_toggleRecognizer(e,n){const{manager:r}=this;if(!r)return;const i=r.get(e);if(i&&i.options.enable!==n){i.set({enable:n});const s=w3[e];s&&!this.options.recognizers&&s.forEach(o=>{const a=r.get(o);n?(a.requireFailure(e),i.dropRequireFailure(o)):a.dropRequireFailure(e)})}this.wheelInput.enableEventType(e,n),this.moveInput.enableEventType(e,n),this.keyInput.enableEventType(e,n),this.contextmenuInput.enableEventType(e,n)}_addEventHandler(e,n,r,i,s){if(typeof e!="string"){r=n;for(const c in e)this._addEventHandler(c,e[c],r,i,s);return}const{manager:o,events:a}=this,l=Rp[e]||e;let u=a.get(l);u||(u=new Y3(this),a.set(l,u),u.recognizerName=b3[l]||l,o&&o.on(l,u.handleEvent)),u.add(e,n,r,i,s),u.isEmpty()||this._toggleRecognizer(u.recognizerName,!0)}_removeEventHandler(e,n){if(typeof e!="string"){for(const o in e)this._removeEventHandler(o,e[o]);return}const{events:r}=this,i=Rp[e]||e,s=r.get(i);if(s&&(s.remove(e,n),s.isEmpty())){const{recognizerName:o}=s;let a=!1;for(const l of r.values())if(l.recognizerName===o&&!l.isEmpty()){a=!0;break}a||this._toggleRecognizer(o,!1)}}}function er(){}const Z3=({isDragging:t})=>t?"grabbing":"grab",Xv={id:"",width:"100%",height:"100%",style:null,viewState:null,initialViewState:null,pickingRadius:0,layerFilter:null,glOptions:{},parameters:{},parent:null,gl:null,canvas:null,layers:[],effects:[],views:null,controller:null,useDevicePixels:!0,touchAction:"none",eventRecognizerOptions:{},_framebuffer:null,_animate:!1,_pickable:!0,_typedArrayManagerProps:{},_customRender:null,onWebGLInitialized:er,onResize:er,onViewStateChange:er,onInteractionStateChange:er,onBeforeRender:er,onAfterRender:er,onLoad:er,onError:t=>Z.error(t.message,t.cause)(),onHover:null,onClick:null,onDragStart:null,onDrag:null,onDragEnd:null,_onMetrics:null,getCursor:Z3,getTooltip:null,debug:!1,drawPickingColors:!1};class Bs{constructor(e){d(this,"props",void 0),d(this,"width",0),d(this,"height",0),d(this,"userData",{}),d(this,"canvas",null),d(this,"viewManager",null),d(this,"layerManager",null),d(this,"effectManager",null),d(this,"deckRenderer",null),d(this,"deckPicker",null),d(this,"eventManager",null),d(this,"tooltip",null),d(this,"metrics",void 0),d(this,"animationLoop",void 0),d(this,"stats",void 0),d(this,"viewState",void 0),d(this,"cursorState",void 0),d(this,"_needsRedraw",void 0),d(this,"_pickRequest",void 0),d(this,"_lastPointerDownInfo",null),d(this,"_metricsCounter",void 0),d(this,"_onPointerMove",n=>{const{_pickRequest:r}=this;if(n.type==="pointerleave")r.x=-1,r.y=-1,r.radius=0;else{if(n.leftButton||n.rightButton)return;{const i=n.offsetCenter;if(!i)return;r.x=i.x,r.y=i.y,r.radius=this.props.pickingRadius}}this.layerManager&&(this.layerManager.context.mousePosition={x:r.x,y:r.y}),r.event=n}),d(this,"_onEvent",n=>{const r=xg[n.type],i=n.offsetCenter;if(!r||!i||!this.layerManager)return;const s=this.layerManager.getLayers(),o=this.deckPicker.getLastPickedObject({x:i.x,y:i.y,layers:s,viewports:this.getViewports(i)},this._lastPointerDownInfo),{layer:a}=o,l=a&&(a[r.handler]||a.props[r.handler]),u=this.props[r.handler];let c=!1;l&&(c=l.call(a,o,n)),!c&&u&&u(o,n)}),d(this,"_onPointerDown",n=>{const r=n.offsetCenter,i=this._pick("pickObject","pickObject Time",{x:r.x,y:r.y,radius:this.props.pickingRadius});this._lastPointerDownInfo=i.result[0]||i.emptyInfo}),this.props={...Xv,...e},e=this.props,this._needsRedraw="Initial render",this._pickRequest={mode:"hover",x:-1,y:-1,radius:0,event:null},this.cursorState={isHovering:!1,isDragging:!1},e.viewState&&e.initialViewState&&Z.warn("View state tracking is disabled. Use either `initialViewState` for auto update or `viewState` for manual update.")(),A_()==="IE"&&Z.warn("IE 11 is not supported")(),this.viewState=e.initialViewState,e.gl||typeof document<"u"&&(this.canvas=this._createCanvas(e)),this.animationLoop=this._createAnimationLoop(e),this.stats=new Wf({id:"deck.gl"}),this.metrics={fps:0,setPropsTime:0,updateAttributesTime:0,framesRedrawn:0,pickTime:0,pickCount:0,gpuTime:0,gpuTimePerFrame:0,cpuTime:0,cpuTimePerFrame:0,bufferMemory:0,textureMemory:0,renderbufferMemory:0,gpuMemory:0},this._metricsCounter=0,this.setProps(e),e._typedArrayManagerProps&&Us.setOptions(e._typedArrayManagerProps),this.animationLoop.start()}finalize(){var e,n,r,i,s,o,a,l;if((e=this.animationLoop)===null||e===void 0||e.stop(),this.animationLoop=null,this._lastPointerDownInfo=null,(n=this.layerManager)===null||n===void 0||n.finalize(),this.layerManager=null,(r=this.viewManager)===null||r===void 0||r.finalize(),this.viewManager=null,(i=this.effectManager)===null||i===void 0||i.finalize(),this.effectManager=null,(s=this.deckRenderer)===null||s===void 0||s.finalize(),this.deckRenderer=null,(o=this.deckPicker)===null||o===void 0||o.finalize(),this.deckPicker=null,(a=this.eventManager)===null||a===void 0||a.destroy(),this.eventManager=null,(l=this.tooltip)===null||l===void 0||l.remove(),this.tooltip=null,!this.props.canvas&&!this.props.gl&&this.canvas){var u;(u=this.canvas.parentElement)===null||u===void 0||u.removeChild(this.canvas),this.canvas=null}}setProps(e){this.stats.get("setProps Time").timeStart(),"onLayerHover"in e&&Z.removed("onLayerHover","onHover")(),"onLayerClick"in e&&Z.removed("onLayerClick","onClick")(),e.initialViewState&&!Gt(this.props.initialViewState,e.initialViewState,3)&&(this.viewState=e.initialViewState),Object.assign(this.props,e),this._setCanvasSize(this.props);const n=Object.create(this.props);Object.assign(n,{views:this._getViews(),width:this.width,height:this.height,viewState:this._getViewState()}),this.animationLoop.setProps(n),this.layerManager&&(this.viewManager.setProps(n),this.layerManager.activateViewport(this.getViewports()[0]),this.layerManager.setProps(n),this.effectManager.setProps(n),this.deckRenderer.setProps(n),this.deckPicker.setProps(n)),this.stats.get("setProps Time").timeEnd()}needsRedraw(e={clearRedrawFlags:!1}){if(!this.layerManager)return!1;if(this.props._animate)return"Deck._animate";let n=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);const r=this.viewManager.needsRedraw(e),i=this.layerManager.needsRedraw(e),s=this.effectManager.needsRedraw(e),o=this.deckRenderer.needsRedraw(e);return n=n||r||i||s||o,n}redraw(e){if(!this.layerManager)return;let n=this.needsRedraw({clearRedrawFlags:!0});n=e||n,n&&(this.stats.get("Redraw Count").incrementCount(),this.props._customRender?this.props._customRender(n):this._drawLayers(n))}get isInitialized(){return this.viewManager!==null}getViews(){return _e(this.viewManager),this.viewManager.views}getViewports(e){return _e(this.viewManager),this.viewManager.getViewports(e)}getCanvas(){return this.canvas}pickObject(e){const n=this._pick("pickObject","pickObject Time",e).result;return n.length?n[0]:null}pickMultipleObjects(e){return e.depth=e.depth||10,this._pick("pickObject","pickMultipleObjects Time",e).result}pickObjects(e){return this._pick("pickObjects","pickObjects Time",e)}_addResources(e,n=!1){for(const r in e)this.layerManager.resourceManager.add({resourceId:r,data:e[r],forceUpdate:n})}_removeResources(e){for(const n of e)this.layerManager.resourceManager.remove(n)}_addDefaultEffect(e){this.effectManager.addDefaultEffect(e)}_pick(e,n,r){_e(this.deckPicker);const{stats:i}=this;i.get("Pick Count").incrementCount(),i.get(n).timeStart();const s=this.deckPicker[e]({layers:this.layerManager.getLayers(r),views:this.viewManager.getViews(),viewports:this.getViewports(r),onViewportActive:this.layerManager.activateViewport,effects:this.effectManager.getEffects(),...r});return i.get(n).timeEnd(),s}_createCanvas(e){let n=e.canvas;return typeof n=="string"&&(n=document.getElementById(n),_e(n)),n||(n=document.createElement("canvas"),n.id=e.id||"deckgl-overlay",(e.parent||document.body).appendChild(n)),Object.assign(n.style,e.style),n}_setCanvasSize(e){if(!this.canvas)return;const{width:n,height:r}=e;if(n||n===0){const s=Number.isFinite(n)?"".concat(n,"px"):n;this.canvas.style.width=s}if(r||r===0){var i;const s=Number.isFinite(r)?"".concat(r,"px"):r;this.canvas.style.position=((i=e.style)===null||i===void 0?void 0:i.position)||"absolute",this.canvas.style.height=s}}_updateCanvasSize(){var e,n;const{canvas:r}=this;if(!r)return;const i=(e=r.clientWidth)!==null&&e!==void 0?e:r.width,s=(n=r.clientHeight)!==null&&n!==void 0?n:r.height;if(i!==this.width||s!==this.height){var o,a;this.width=i,this.height=s,(o=this.viewManager)===null||o===void 0||o.setProps({width:i,height:s}),(a=this.layerManager)===null||a===void 0||a.activateViewport(this.getViewports()[0]),this.props.onResize({width:i,height:s})}}_createAnimationLoop(e){const{width:n,height:r,gl:i,glOptions:s,debug:o,onError:a,onBeforeRender:l,onAfterRender:u,useDevicePixels:c}=e;return new Xx({width:n,height:r,useDevicePixels:c,autoResizeDrawingBuffer:!i,autoResizeViewport:!1,gl:i,onCreateContext:f=>H_({...s,...f,canvas:this.canvas,debug:o,onContextLost:()=>this._onContextLost()}),onInitialize:f=>this._setGLContext(f.gl),onRender:this._onRenderFrame.bind(this),onBeforeRender:l,onAfterRender:u,onError:a})}_getViewState(){return this.props.viewState||this.viewState}_getViews(){let e=this.props.views||[new hh({id:"default-view"})];return e=Array.isArray(e)?e:[e],e.length&&this.props.controller&&(e[0].props.controller=this.props.controller),e}_onContextLost(){const{onError:e}=this.props;this.animationLoop&&e&&e(new Error("WebGL context is lost"))}_pickAndCallback(){const{_pickRequest:e}=this;if(e.event){const{result:r,emptyInfo:i}=this._pick("pickObject","pickObject Time",e);this.cursorState.isHovering=r.length>0;let s=i,o=!1;for(const a of r){var n;s=a,o=((n=a.layer)===null||n===void 0?void 0:n.onHover(a,e.event))||o}if(!o&&this.props.onHover&&this.props.onHover(s,e.event),this.props.getTooltip&&this.tooltip){const a=this.props.getTooltip(s);this.tooltip.setTooltip(a,s.x,s.y)}e.event=null}}_updateCursor(){const e=this.props.parent||this.canvas;e&&(e.style.cursor=this.props.getCursor(this.cursorState))}_setGLContext(e){if(this.layerManager)return;this.canvas||(this.canvas=e.canvas,eh(e,{enable:!0,copyState:!0})),this.tooltip=new d3(this.canvas),gn(e,{blend:!0,blendFunc:[770,771,1,771],polygonOffsetFill:!0,depthTest:!0,depthFunc:515}),this.props.onWebGLInitialized(e);const n=new xv;n.play(),this.animationLoop.attachTimeline(n),this.eventManager=new q3(this.props.parent||e.canvas,{touchAction:this.props.touchAction,recognizerOptions:this.props.eventRecognizerOptions,events:{pointerdown:this._onPointerDown,pointermove:this._onPointerMove,pointerleave:this._onPointerMove}});for(const i in xg)this.eventManager.on(i,this._onEvent);this.viewManager=new BC({timeline:n,eventManager:this.eventManager,onViewStateChange:this._onViewStateChange.bind(this),onInteractionStateChange:this._onInteractionStateChange.bind(this),views:this._getViews(),viewState:this._getViewState(),width:this.width,height:this.height});const r=this.viewManager.getViewports()[0];this.layerManager=new UC(e,{deck:this,stats:this.stats,viewport:r,timeline:n}),this.effectManager=new n3,this.deckRenderer=new s3(e),this.deckPicker=new f3(e),this.setProps(this.props),this._updateCanvasSize(),this.props.onLoad()}_drawLayers(e,n){const{gl:r}=this.layerManager.context;gn(r,this.props.parameters),this.props.onBeforeRender({gl:r}),this.deckRenderer.renderLayers({target:this.props._framebuffer,layers:this.layerManager.getLayers(),viewports:this.viewManager.getViewports(),onViewportActive:this.layerManager.activateViewport,views:this.viewManager.getViews(),pass:"screen",effects:this.effectManager.getEffects(),...n}),this.props.onAfterRender({gl:r})}_onRenderFrame(e){this._getFrameStats(),this._metricsCounter++%60===0&&(this._getMetrics(),this.stats.reset(),Z.table(4,this.metrics)(),this.props._onMetrics&&this.props._onMetrics(this.metrics)),this._updateCanvasSize(),this._updateCursor(),this.tooltip.isVisible&&this.viewManager.needsRedraw()&&this.tooltip.setTooltip(null),this.layerManager.updateLayers(),this._pickAndCallback(),this.redraw(),this.viewManager&&this.viewManager.updateViewStates()}_onViewStateChange(e){const n=this.props.onViewStateChange(e)||e.viewState;this.viewState&&(this.viewState={...this.viewState,[e.viewId]:n},this.props.viewState||this.viewManager&&this.viewManager.setProps({viewState:this.viewState}))}_onInteractionStateChange(e){this.cursorState.isDragging=e.isDragging||!1,this.props.onInteractionStateChange(e)}_getFrameStats(){const{stats:e}=this;e.get("frameRate").timeEnd(),e.get("frameRate").timeStart();const n=this.animationLoop.stats;e.get("GPU Time").addTime(n.get("GPU Time").lastTiming),e.get("CPU Time").addTime(n.get("CPU Time").lastTiming)}_getMetrics(){const{metrics:e,stats:n}=this;e.fps=n.get("frameRate").getHz(),e.setPropsTime=n.get("setProps Time").time,e.updateAttributesTime=n.get("Update Attributes").time,e.framesRedrawn=n.get("Redraw Count").count,e.pickTime=n.get("pickObject Time").time+n.get("pickMultipleObjects Time").time+n.get("pickObjects Time").time,e.pickCount=n.get("Pick Count").count,e.gpuTime=n.get("GPU Time").time,e.cpuTime=n.get("CPU Time").time,e.gpuTimePerFrame=n.get("GPU Time").getAverageTime(),e.cpuTimePerFrame=n.get("CPU Time").getAverageTime();const r=ar.get("Memory Usage");e.bufferMemory=r.get("Buffer Memory").count,e.textureMemory=r.get("Texture Memory").count,e.renderbufferMemory=r.get("Renderbuffer Memory").count,e.gpuMemory=r.get("GPU Memory").count}}d(Bs,"defaultProps",Xv);d(Bs,"VERSION",Kb);class Su{constructor(e,n){d(this,"opts",void 0),d(this,"source",void 0),this.opts=n,this.source=e}get value(){return this.source.value}getValue(){const e=this.source.getBuffer(),n=this.getAccessor();if(e)return[e,n];const{value:r}=this.source,{size:i}=n;let s=r;if(r&&r.length!==i){s=new Float32Array(i);const o=n.elementOffset||0;for(let a=0;a<i;++a)s[a]=r[o+a]}return s}getAccessor(){return{...this.source.getAccessor(),...this.opts}}}function Q3(t){switch(t){case 5126:return Float32Array;case 5130:return Float64Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return Uint8ClampedArray;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Unknown GL type")}}function oa(t){return t.stride||t.size*t.bytesPerElement}function Yv(t,e){e.offset&&Z.removed("shaderAttribute.offset","vertexOffset, elementOffset")();const n=oa(t),r=e.vertexOffset!==void 0?e.vertexOffset:t.vertexOffset||0,i=e.elementOffset||0,s=r*n+i*t.bytesPerElement+(t.offset||0);return{...e,offset:s,stride:n}}function K3(t,e){const n=Yv(t,e);return{high:n,low:{...n,offset:n.offset+t.size*4}}}class J3{constructor(e,n,r){d(this,"gl",void 0),d(this,"id",void 0),d(this,"size",void 0),d(this,"settings",void 0),d(this,"value",void 0),d(this,"doublePrecision",void 0),d(this,"_buffer",void 0),d(this,"state",void 0),this.gl=e,this.id=n.id||"",this.size=n.size||1;const i=n.logicalType||n.type,s=i===5130;let{defaultValue:o}=n;o=Number.isFinite(o)?[o]:o||new Array(this.size).fill(0);let a;s?a=5126:!i&&n.isIndexed?a=e&&K_(e,ie.ELEMENT_INDEX_UINT32)?5125:5123:a=i||5126;let l=Q3(i||a||5126);this.doublePrecision=s,s&&n.fp64===!1&&(l=Float32Array),this.value=null,this.settings={...n,defaultType:l,defaultValue:o,logicalType:i,type:a,size:this.size,bytesPerElement:l.BYTES_PER_ELEMENT},this.state={...r,externalBuffer:null,bufferAccessor:this.settings,allocatedValue:null,numInstances:0,bounds:null,constant:!1},this._buffer=null}get isConstant(){return this.state.constant}get buffer(){if(!this._buffer){const{isIndexed:e,type:n}=this.settings;this._buffer=new J(this.gl,{id:this.id,target:e?34963:34962,accessor:{type:n}})}return this._buffer}get byteOffset(){const e=this.getAccessor();return e.vertexOffset?e.vertexOffset*oa(e):0}get numInstances(){return this.state.numInstances}set numInstances(e){this.state.numInstances=e}delete(){this._buffer&&(this._buffer.delete(),this._buffer=null),Us.release(this.state.allocatedValue)}getShaderAttributes(e,n){if(this.doublePrecision){const r={},i=this.value instanceof Float64Array,s=K3(this.getAccessor(),n||{});return r[e]=new Su(this,s.high),r["".concat(e,"64Low")]=i?new Su(this,s.low):new Float32Array(this.size),r}if(n){const r=Yv(this.getAccessor(),n);return{[e]:new Su(this,r)}}return{[e]:this}}getBuffer(){return this.state.constant?null:this.state.externalBuffer||this._buffer}getValue(){return this.state.constant?this.value:[this.getBuffer(),this.getAccessor()]}getAccessor(){return this.state.bufferAccessor}getBounds(){if(this.state.bounds)return this.state.bounds;let e=null;if(this.state.constant&&this.value){const n=Array.from(this.value);e=[n,n]}else{const{value:n,numInstances:r,size:i}=this,s=r*i;if(n&&s&&n.length>=s){const o=new Array(i).fill(1/0),a=new Array(i).fill(-1/0);for(let l=0;l<s;)for(let u=0;u<i;u++){const c=n[l++];c<o[u]&&(o[u]=c),c>a[u]&&(a[u]=c)}e=[o,a]}}return this.state.bounds=e,e}setData(e){const{state:n}=this;let r;ArrayBuffer.isView(e)?r={value:e}:e instanceof J?r={buffer:e}:r=e;const i={...this.settings,...r};if(n.bufferAccessor=i,n.bounds=null,r.constant){let s=r.value;if(s=this._normalizeValue(s,[],0),this.settings.normalized&&(s=this.normalizeConstant(s)),!(!n.constant||!this._areValuesEqual(s,this.value)))return!1;n.externalBuffer=null,n.constant=!0,this.value=s}else if(r.buffer){const s=r.buffer;n.externalBuffer=s,n.constant=!1,this.value=r.value||null;const o=r.value instanceof Float64Array;i.type=r.type||s.accessor.type,i.bytesPerElement=s.accessor.BYTES_PER_ELEMENT*(o?2:1),i.stride=oa(i)}else if(r.value){this._checkExternalBuffer(r);let s=r.value;n.externalBuffer=null,n.constant=!1,this.value=s,i.bytesPerElement=s.BYTES_PER_ELEMENT,i.stride=oa(i);const{buffer:o,byteOffset:a}=this;this.doublePrecision&&s instanceof Float64Array&&(s=Eu(s,i));const l=s.byteLength+a+i.stride*2;o.byteLength<l&&o.reallocate(l),o.setAccessor(null),o.subData({data:s,offset:a}),i.type=r.type||o.accessor.type}return!0}updateSubBuffer(e={}){this.state.bounds=null;const n=this.value,{startOffset:r=0,endOffset:i}=e;this.buffer.subData({data:this.doublePrecision&&n instanceof Float64Array?Eu(n,{size:this.size,startIndex:r,endIndex:i}):n.subarray(r,i),offset:r*n.BYTES_PER_ELEMENT+this.byteOffset})}allocate(e,n=!1){const{state:r}=this,i=r.allocatedValue,s=Us.allocate(i,e+1,{size:this.size,type:this.settings.defaultType,copy:n});this.value=s;const{buffer:o,byteOffset:a}=this;return o.byteLength<s.byteLength+a&&(o.reallocate(s.byteLength+a),n&&i&&o.subData({data:i instanceof Float64Array?Eu(i,this):i,offset:a})),r.allocatedValue=s,r.constant=!1,r.externalBuffer=null,r.bufferAccessor=this.settings,!0}_checkExternalBuffer(e){const{value:n}=e;if(!ArrayBuffer.isView(n))throw new Error("Attribute ".concat(this.id," value is not TypedArray"));const r=this.settings.defaultType;let i=!1;if(this.doublePrecision&&(i=n.BYTES_PER_ELEMENT<4),i)throw new Error("Attribute ".concat(this.id," does not support ").concat(n.constructor.name));!(n instanceof r)&&this.settings.normalized&&!("normalized"in e)&&Z.warn("Attribute ".concat(this.id," is normalized"))()}normalizeConstant(e){switch(this.settings.type){case 5120:return new Float32Array(e).map(n=>(n+128)/255*2-1);case 5122:return new Float32Array(e).map(n=>(n+32768)/65535*2-1);case 5121:return new Float32Array(e).map(n=>n/255);case 5123:return new Float32Array(e).map(n=>n/65535);default:return e}}_normalizeValue(e,n,r){const{defaultValue:i,size:s}=this.settings;if(Number.isFinite(e))return n[r]=e,n;if(!e){let o=s;for(;--o>=0;)n[r+o]=i[o];return n}switch(s){case 4:n[r+3]=Number.isFinite(e[3])?e[3]:i[3];case 3:n[r+2]=Number.isFinite(e[2])?e[2]:i[2];case 2:n[r+1]=Number.isFinite(e[1])?e[1]:i[1];case 1:n[r+0]=Number.isFinite(e[0])?e[0]:i[0];break;default:let o=s;for(;--o>=0;)n[r+o]=Number.isFinite(e[o])?e[o]:i[o]}return n}_areValuesEqual(e,n){if(!e||!n)return!1;const{size:r}=this;for(let i=0;i<r;i++)if(e[i]!==n[i])return!1;return!0}}const jp=[],Gp=[];function $v(t,e=0,n=1/0){let r=jp;const i={index:-1,data:t,target:[]};return t?typeof t[Symbol.iterator]=="function"?r=t:t.length>0&&(Gp.length=t.length,r=Gp):r=jp,(e>0||Number.isFinite(n))&&(r=(Array.isArray(r)?r:Array.from(r)).slice(e,n),i.index=e-1),{iterable:r,objectInfo:i}}function qv(t){return t&&t[Symbol.asyncIterator]}function eM(t,e){const{size:n,stride:r,offset:i,startIndices:s,nested:o}=e,a=t.BYTES_PER_ELEMENT,l=r?r/a:n,u=i?i/a:0,c=Math.floor((t.length-u)/l);return(f,{index:h,target:p})=>{if(!s){const _=h*l+u;for(let m=0;m<n;m++)p[m]=t[_+m];return p}const E=s[h],w=s[h+1]||c;let S;if(o){S=new Array(w-E);for(let _=E;_<w;_++){const m=_*l+u;p=new Array(n);for(let y=0;y<n;y++)p[y]=t[m+y];S[_-E]=p}}else if(l===n)S=t.subarray(E*n+u,w*n+u);else{S=new t.constructor((w-E)*n);let _=0;for(let m=E;m<w;m++){const y=m*l+u;for(let b=0;b<n;b++)S[_++]=t[y+b]}}return S}}const tM=[],aa=[[0,1/0]];function nM(t,e){if(t===aa||(e[0]<0&&(e[0]=0),e[0]>=e[1]))return t;const n=[],r=t.length;let i=0;for(let s=0;s<r;s++){const o=t[s];o[1]<e[0]?(n.push(o),i=s+1):o[0]>e[1]?n.push(o):e=[Math.min(o[0],e[0]),Math.max(o[1],e[1])]}return n.splice(i,0,e),n}function Au(t){const{source:e,target:n,start:r=0,size:i,getData:s}=t,o=t.end||n.length,a=e.length,l=o-r;if(a>l){n.set(e.subarray(0,l),r);return}if(n.set(e,r),!s)return;let u=a;for(;u<l;){const c=s(u,e);for(let f=0;f<i;f++)n[r+u]=c[f]||0,u++}}function rM({source:t,target:e,size:n,getData:r,sourceStartIndices:i,targetStartIndices:s}){if(!Array.isArray(s))return Au({source:t,target:e,size:n,getData:r}),e;let o=0,a=0;const l=r&&((c,f)=>r(c+a,f)),u=Math.min(i.length,s.length);for(let c=1;c<u;c++){const f=i[c]*n,h=s[c]*n;Au({source:t.subarray(o,f),target:e,start:a,end:h,size:n,getData:l}),o=f,a=h}return a<e.length&&Au({source:[],target:e,start:a,size:n,getData:l}),e}const iM={interpolation:{duration:0,easing:t=>t},spring:{stiffness:.05,damping:.5}};function Zv(t,e){if(!t)return null;Number.isFinite(t)&&(t={type:"interpolation",duration:t});const n=t.type||"interpolation";return{...iM[n],...e,...t,type:n}}function Qv(t,e){const n=e.getBuffer();return n?[n,{divisor:0,size:e.size,normalized:e.settings.normalized}]:e.value}function Kv(t){switch(t){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4";default:throw new Error('No defined attribute type for size "'.concat(t,'"'))}}function Jv(t){t.push(t.shift())}function gh(t,e){const{doublePrecision:n,settings:r,value:i,size:s}=t,o=n&&i instanceof Float64Array?2:1;return(r.noAlloc?i.length:e*s)*o}function ey({buffer:t,numInstances:e,attribute:n,fromLength:r,fromStartIndices:i,getData:s=o=>o}){const o=n.doublePrecision&&n.value instanceof Float64Array?2:1,a=n.size*o,l=n.byteOffset,u=n.startIndices,c=i&&u,f=gh(n,e),h=n.isConstant;if(!c&&r>=f)return;const p=h?n.value:n.getBuffer().getData({srcByteOffset:l});if(n.settings.normalized&&!h){const _=s;s=(m,y)=>n.normalizeConstant(_(m,y))}const E=h?(_,m)=>s(p,m):(_,m)=>s(p.subarray(_,_+a),m),w=t.getData({length:r}),S=new Float32Array(f);rM({source:w,target:S,sourceStartIndices:i,targetStartIndices:u,size:a,getData:E}),t.byteLength<S.byteLength+l&&t.reallocate(S.byteLength+l),t.subData({data:S,offset:l})}class ph extends J3{constructor(e,n){super(e,n,{startIndices:null,lastExternalBuffer:null,binaryValue:null,binaryAccessor:null,needsUpdate:!0,needsRedraw:!1,updateRanges:aa}),d(this,"constant",!1),this.settings.update=n.update||(n.accessor?this._autoUpdater:void 0),Object.seal(this.settings),Object.seal(this.state),this._validateAttributeUpdaters()}get startIndices(){return this.state.startIndices}set startIndices(e){this.state.startIndices=e}needsUpdate(){return this.state.needsUpdate}needsRedraw({clearChangedFlags:e=!1}={}){const n=this.state.needsRedraw;return this.state.needsRedraw=n&&!e,n}getUpdateTriggers(){const{accessor:e}=this.settings;return[this.id].concat(typeof e!="function"&&e||[])}supportsTransition(){return!!this.settings.transition}getTransitionSetting(e){if(!e||!this.supportsTransition())return null;const{accessor:n}=this.settings,r=this.settings.transition,i=Array.isArray(n)?e[n.find(s=>e[s])]:e[n];return Zv(i,r)}setNeedsUpdate(e=this.id,n){if(this.state.needsUpdate=this.state.needsUpdate||e,this.setNeedsRedraw(e),n){const{startRow:r=0,endRow:i=1/0}=n;this.state.updateRanges=nM(this.state.updateRanges,[r,i])}else this.state.updateRanges=aa}clearNeedsUpdate(){this.state.needsUpdate=!1,this.state.updateRanges=tM}setNeedsRedraw(e=this.id){this.state.needsRedraw=this.state.needsRedraw||e}allocate(e){const{state:n,settings:r}=this;return r.noAlloc?!1:r.update?(super.allocate(e,n.updateRanges!==aa),!0):!1}updateBuffer({numInstances:e,data:n,props:r,context:i}){if(!this.needsUpdate())return!1;const{state:{updateRanges:s},settings:{update:o,noAlloc:a}}=this;let l=!0;if(o){for(const[u,c]of s)o.call(i,this,{data:n,startRow:u,endRow:c,props:r,numInstances:e});if(this.value)if(this.constant||this.buffer.byteLength<this.value.byteLength+this.byteOffset)this.setData({value:this.value,constant:this.constant}),this.constant=!1;else for(const[u,c]of s){const f=Number.isFinite(u)?this.getVertexOffset(u):0,h=Number.isFinite(c)?this.getVertexOffset(c):a||!Number.isFinite(e)?this.value.length:e*this.size;super.updateSubBuffer({startOffset:f,endOffset:h})}this._checkAttributeArray()}else l=!1;return this.clearNeedsUpdate(),this.setNeedsRedraw(),l}setConstantValue(e){return e===void 0||typeof e=="function"?!1:(this.setData({constant:!0,value:e})&&this.setNeedsRedraw(),this.clearNeedsUpdate(),!0)}setExternalBuffer(e){const{state:n}=this;return e?(this.clearNeedsUpdate(),n.lastExternalBuffer===e||(n.lastExternalBuffer=e,this.setNeedsRedraw(),this.setData(e)),!0):(n.lastExternalBuffer=null,!1)}setBinaryValue(e,n=null){const{state:r,settings:i}=this;if(!e)return r.binaryValue=null,r.binaryAccessor=null,!1;if(i.noAlloc)return!1;if(r.binaryValue===e)return this.clearNeedsUpdate(),!0;if(r.binaryValue=e,this.setNeedsRedraw(),i.transform||n!==this.startIndices){ArrayBuffer.isView(e)&&(e={value:e});const o=e;_e(ArrayBuffer.isView(o.value),"invalid ".concat(i.accessor));const a=!!o.size&&o.size!==this.size;return r.binaryAccessor=eM(o.value,{size:o.size||this.size,stride:o.stride,offset:o.offset,startIndices:n,nested:a}),!1}return this.clearNeedsUpdate(),this.setData(e),!0}getVertexOffset(e){const{startIndices:n}=this;return(n?e<n.length?n[e]:this.numInstances:e)*this.size}getShaderAttributes(){const e=this.settings.shaderAttributes||{[this.id]:null},n={};for(const r in e)Object.assign(n,super.getShaderAttributes(r,e[r]));return n}_autoUpdater(e,{data:n,startRow:r,endRow:i,props:s,numInstances:o}){if(e.constant)return;const{settings:a,state:l,value:u,size:c,startIndices:f}=e,{accessor:h,transform:p}=a,E=l.binaryAccessor||(typeof h=="function"?h:s[h]);_e(typeof E=="function",'accessor "'.concat(h,'" is not a function'));let w=e.getVertexOffset(r);const{iterable:S,objectInfo:_}=$v(n,r,i);for(const m of S){_.index++;let y=E(m,_);if(p&&(y=p.call(this,y)),f){const b=(_.index<f.length-1?f[_.index+1]:o)-f[_.index];if(y&&Array.isArray(y[0])){let x=w;for(const P of y)e._normalizeValue(P,u,x),x+=c}else y&&y.length>c?u.set(y,w):(e._normalizeValue(y,_.target,0),PC({target:u,source:_.target,start:w,count:b}));w+=b*c}else e._normalizeValue(y,u,w),w+=c}}_validateAttributeUpdaters(){const{settings:e}=this;if(!(e.noAlloc||typeof e.update=="function"))throw new Error("Attribute ".concat(this.id," missing update or accessor"))}_checkAttributeArray(){const{value:e}=this,n=Math.min(4,this.size);if(e&&e.length>=n){let r=!0;switch(n){case 4:r=r&&Number.isFinite(e[3]);case 3:r=r&&Number.isFinite(e[2]);case 2:r=r&&Number.isFinite(e[1]);case 1:r=r&&Number.isFinite(e[0]);break;default:r=!1}if(!r)throw new Error("Illegal attribute generated for ".concat(this.id))}}}class sM{constructor({gl:e,attribute:n,timeline:r}){d(this,"gl",void 0),d(this,"type","interpolation"),d(this,"attributeInTransition",void 0),d(this,"settings",void 0),d(this,"attribute",void 0),d(this,"transition",void 0),d(this,"currentStartIndices",void 0),d(this,"currentLength",void 0),d(this,"transform",void 0),d(this,"buffers",void 0),this.gl=e,this.transition=new eo(r),this.attribute=n,this.attributeInTransition=new ph(e,n.settings),this.currentStartIndices=n.startIndices,this.currentLength=0,this.transform=aM(e,n);const i={byteLength:0,usage:35050};this.buffers=[new J(e,i),new J(e,i)]}get inProgress(){return this.transition.inProgress}start(e,n){if(e.duration<=0){this.transition.cancel();return}this.settings=e;const{gl:r,buffers:i,attribute:s}=this;Jv(i);const o={numInstances:n,attribute:s,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:e.enter};for(const a of i)ey({buffer:a,...o});this.currentStartIndices=s.startIndices,this.currentLength=gh(s,n),this.attributeInTransition.setData({buffer:i[1],value:s.value}),this.transition.start(e),this.transform.update({elementCount:Math.floor(this.currentLength/s.size),sourceBuffers:{aFrom:i[0],aTo:Qv(r,s)},feedbackBuffers:{vCurrent:i[1]}})}update(){const e=this.transition.update();if(e){const{duration:n,easing:r}=this.settings,{time:i}=this.transition;let s=i/n;r&&(s=r(s)),this.transform.run({uniforms:{time:s}})}return e}cancel(){this.transition.cancel(),this.transform.delete();for(const e of this.buffers)e.delete();this.buffers.length=0}}const oM=`
#define SHADER_NAME interpolation-transition-vertex-shader

uniform float time;
attribute ATTRIBUTE_TYPE aFrom;
attribute ATTRIBUTE_TYPE aTo;
varying ATTRIBUTE_TYPE vCurrent;

void main(void) {
  vCurrent = mix(aFrom, aTo, time);
  gl_Position = vec4(0.0);
}
`;function aM(t,e){const n=Kv(e.size);return new ah(t,{vs:oM,defines:{ATTRIBUTE_TYPE:n},varyings:["vCurrent"]})}class lM{constructor({gl:e,attribute:n,timeline:r}){d(this,"gl",void 0),d(this,"type","spring"),d(this,"attributeInTransition",void 0),d(this,"settings",void 0),d(this,"attribute",void 0),d(this,"transition",void 0),d(this,"currentStartIndices",void 0),d(this,"currentLength",void 0),d(this,"texture",void 0),d(this,"framebuffer",void 0),d(this,"transform",void 0),d(this,"buffers",void 0),this.gl=e,this.type="spring",this.transition=new eo(r),this.attribute=n,this.attributeInTransition=new ph(e,{...n.settings,normalized:!1}),this.currentStartIndices=n.startIndices,this.currentLength=0,this.texture=cM(e),this.framebuffer=fM(e,this.texture),this.transform=uM(e,n,this.framebuffer);const i={byteLength:0,usage:35050};this.buffers=[new J(e,i),new J(e,i),new J(e,i)]}get inProgress(){return this.transition.inProgress}start(e,n){const{gl:r,buffers:i,attribute:s}=this,o={numInstances:n,attribute:s,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:e.enter};for(const a of i)ey({buffer:a,...o});this.settings=e,this.currentStartIndices=s.startIndices,this.currentLength=gh(s,n),this.attributeInTransition.setData({buffer:i[1],value:s.value}),this.transition.start({...e,duration:1/0}),this.transform.update({elementCount:Math.floor(this.currentLength/s.size),sourceBuffers:{aTo:Qv(r,s)}})}update(){const{buffers:e,transform:n,framebuffer:r,transition:i}=this;if(!i.update())return!1;const o=this.settings;return n.update({sourceBuffers:{aPrev:e[0],aCur:e[1]},feedbackBuffers:{vNext:e[2]}}),n.run({framebuffer:r,discard:!1,clearRenderTarget:!0,uniforms:{stiffness:o.stiffness,damping:o.damping},parameters:{depthTest:!1,blend:!0,viewport:[0,0,1,1],blendFunc:[1,1],blendEquation:[32776,32776]}}),Jv(e),this.attributeInTransition.setData({buffer:e[1],value:this.attribute.value}),fl(r)[0]>0||i.end(),!0}cancel(){this.transition.cancel(),this.transform.delete();for(const e of this.buffers)e.delete();this.buffers.length=0,this.texture.delete(),this.framebuffer.delete()}}function uM(t,e,n){const r=Kv(e.size);return new ah(t,{framebuffer:n,vs:`
#define SHADER_NAME spring-transition-vertex-shader

#define EPSILON 0.00001

uniform float stiffness;
uniform float damping;
attribute ATTRIBUTE_TYPE aPrev;
attribute ATTRIBUTE_TYPE aCur;
attribute ATTRIBUTE_TYPE aTo;
varying ATTRIBUTE_TYPE vNext;
varying float vIsTransitioningFlag;

ATTRIBUTE_TYPE getNextValue(ATTRIBUTE_TYPE cur, ATTRIBUTE_TYPE prev, ATTRIBUTE_TYPE dest) {
  ATTRIBUTE_TYPE velocity = cur - prev;
  ATTRIBUTE_TYPE delta = dest - cur;
  ATTRIBUTE_TYPE spring = delta * stiffness;
  ATTRIBUTE_TYPE damper = velocity * -1.0 * damping;
  return spring + damper + velocity + cur;
}

void main(void) {
  bool isTransitioning = length(aCur - aPrev) > EPSILON || length(aTo - aCur) > EPSILON;
  vIsTransitioningFlag = isTransitioning ? 1.0 : 0.0;

  vNext = getNextValue(aCur, aPrev, aTo);
  gl_Position = vec4(0, 0, 0, 1);
  gl_PointSize = 100.0;
}
`,fs:`
#define SHADER_NAME spring-transition-is-transitioning-fragment-shader

varying float vIsTransitioningFlag;

void main(void) {
  if (vIsTransitioningFlag == 0.0) {
    discard;
  }
  gl_FragColor = vec4(1.0);
}`,defines:{ATTRIBUTE_TYPE:r},varyings:["vNext"]})}function cM(t){return new Rt(t,{data:new Uint8Array(4),format:6408,type:5121,border:0,mipmaps:!1,dataFormat:6408,width:1,height:1})}function fM(t,e){return new Te(t,{id:"spring-transition-is-transitioning-framebuffer",width:1,height:1,attachments:{36064:e}})}const hM={interpolation:sM,spring:lM};class dM{constructor(e,{id:n,timeline:r}){d(this,"id",void 0),d(this,"isSupported",void 0),d(this,"gl",void 0),d(this,"timeline",void 0),d(this,"transitions",void 0),d(this,"needsRedraw",void 0),d(this,"numInstances",void 0),this.id=n,this.gl=e,this.timeline=r,this.transitions={},this.needsRedraw=!1,this.numInstances=1,this.isSupported=ah.isSupported(e)}finalize(){for(const e in this.transitions)this._removeTransition(e)}update({attributes:e,transitions:n,numInstances:r}){this.numInstances=r||1;for(const i in e){const s=e[i],o=s.getTransitionSetting(n);o&&this._updateAttribute(i,s,o)}for(const i in this.transitions){const s=e[i];(!s||!s.getTransitionSetting(n))&&this._removeTransition(i)}}hasAttribute(e){const n=this.transitions[e];return n&&n.inProgress}getAttributes(){const e={};for(const n in this.transitions){const r=this.transitions[n];r.inProgress&&(e[n]=r.attributeInTransition)}return e}run(){if(!this.isSupported||this.numInstances===0)return!1;for(const n in this.transitions)this.transitions[n].update()&&(this.needsRedraw=!0);const e=this.needsRedraw;return this.needsRedraw=!1,e}_removeTransition(e){this.transitions[e].cancel(),delete this.transitions[e]}_updateAttribute(e,n,r){const i=this.transitions[e];let s=!i||i.type!==r.type;if(s){if(!this.isSupported){Z.warn("WebGL2 not supported by this browser. Transition for ".concat(e," is disabled."))();return}i&&this._removeTransition(e);const o=hM[r.type];o?this.transitions[e]=new o({attribute:n,timeline:this.timeline,gl:this.gl}):(Z.error("unsupported transition type '".concat(r.type,"'"))(),s=!1)}(s||n.needsRedraw())&&(this.needsRedraw=!0,this.transitions[e].start(r,this.numInstances))}}const Hp="attributeManager.invalidate",gM="attributeManager.updateStart",pM="attributeManager.updateEnd",mM="attribute.updateStart",_M="attribute.allocate",vM="attribute.updateEnd";class ty{constructor(e,{id:n="attribute-manager",stats:r,timeline:i}={}){d(this,"id",void 0),d(this,"gl",void 0),d(this,"attributes",void 0),d(this,"updateTriggers",void 0),d(this,"needsRedraw",void 0),d(this,"userData",void 0),d(this,"stats",void 0),d(this,"attributeTransitionManager",void 0),d(this,"mergeBoundsMemoized",Js(vC)),this.id=n,this.gl=e,this.attributes={},this.updateTriggers={},this.needsRedraw=!0,this.userData={},this.stats=r,this.attributeTransitionManager=new dM(e,{id:"".concat(n,"-transitions"),timeline:i}),Object.seal(this)}finalize(){for(const e in this.attributes)this.attributes[e].delete();this.attributeTransitionManager.finalize()}getNeedsRedraw(e={clearRedrawFlags:!1}){const n=this.needsRedraw;return this.needsRedraw=this.needsRedraw&&!e.clearRedrawFlags,n&&this.id}setNeedsRedraw(){this.needsRedraw=!0}add(e){this._add(e)}addInstanced(e){this._add(e,{instanced:1})}remove(e){for(const n of e)this.attributes[n]!==void 0&&(this.attributes[n].delete(),delete this.attributes[n])}invalidate(e,n){const r=this._invalidateTrigger(e,n);Ne(Hp,this,e,r)}invalidateAll(e){for(const n in this.attributes)this.attributes[n].setNeedsUpdate(n,e);Ne(Hp,this,"all")}update({data:e,numInstances:n,startIndices:r=null,transitions:i,props:s={},buffers:o={},context:a={}}){let l=!1;Ne(gM,this),this.stats&&this.stats.get("Update Attributes").timeStart();for(const u in this.attributes){const c=this.attributes[u],f=c.settings.accessor;c.startIndices=r,c.numInstances=n,s[u]&&Z.removed("props.".concat(u),"data.attributes.".concat(u))(),c.setExternalBuffer(o[u])||c.setBinaryValue(typeof f=="string"?o[f]:void 0,e.startIndices)||typeof f=="string"&&!o[f]&&c.setConstantValue(s[f])||c.needsUpdate()&&(l=!0,this._updateAttribute({attribute:c,numInstances:n,data:e,props:s,context:a})),this.needsRedraw=this.needsRedraw||c.needsRedraw()}l&&Ne(pM,this,n),this.stats&&this.stats.get("Update Attributes").timeEnd(),this.attributeTransitionManager.update({attributes:this.attributes,numInstances:n,transitions:i})}updateTransition(){const{attributeTransitionManager:e}=this,n=e.run();return this.needsRedraw=this.needsRedraw||n,n}getAttributes(){return this.attributes}getBounds(e){const n=e.map(r=>{var i;return(i=this.attributes[r])===null||i===void 0?void 0:i.getBounds()});return this.mergeBoundsMemoized(n)}getChangedAttributes(e={clearChangedFlags:!1}){const{attributes:n,attributeTransitionManager:r}=this,i={...r.getAttributes()};for(const s in n){const o=n[s];o.needsRedraw(e)&&!r.hasAttribute(s)&&(i[s]=o)}return i}getShaderAttributes(e,n={}){e||(e=this.getAttributes());const r={};for(const i in e)n[i]||Object.assign(r,e[i].getShaderAttributes());return r}_add(e,n={}){for(const r in e){const i=e[r];this.attributes[r]=this._createAttribute(r,i,n)}this._mapUpdateTriggersToAttributes()}_createAttribute(e,n,r){const i={...n,id:e,size:n.isIndexed&&1||n.size||1,divisor:r.instanced?1:n.divisor||0};return new ph(this.gl,i)}_mapUpdateTriggersToAttributes(){const e={};for(const n in this.attributes)this.attributes[n].getUpdateTriggers().forEach(i=>{e[i]||(e[i]=[]),e[i].push(n)});this.updateTriggers=e}_invalidateTrigger(e,n){const{attributes:r,updateTriggers:i}=this,s=i[e];return s&&s.forEach(o=>{const a=r[o];a&&a.setNeedsUpdate(a.id,n)}),s}_updateAttribute(e){const{attribute:n,numInstances:r}=e;if(Ne(mM,n),n.constant){n.setConstantValue(n.value);return}n.allocate(r)&&Ne(_M,n,r),n.updateBuffer(e)&&(this.needsRedraw=!0,Ne(vM,n,r))}}class yM extends eo{get value(){return this._value}_onUpdate(){const{time:e,settings:{fromValue:n,toValue:r,duration:i,easing:s}}=this,o=s(e/i);this._value=Fa(n,r,o)}}const Wp=1e-5;function Xp(t,e,n,r,i){const s=e-t,a=(n-e)*i,l=-s*r;return a+l+s+e}function EM(t,e,n,r,i){if(Array.isArray(n)){const s=[];for(let o=0;o<n.length;o++)s[o]=Xp(t[o],e[o],n[o],r,i);return s}return Xp(t,e,n,r,i)}function Yp(t,e){if(Array.isArray(t)){let n=0;for(let r=0;r<t.length;r++){const i=t[r]-e[r];n+=i*i}return Math.sqrt(n)}return Math.abs(t-e)}class wM extends eo{get value(){return this._currValue}_onUpdate(){const{fromValue:e,toValue:n,damping:r,stiffness:i}=this.settings,{_prevValue:s=e,_currValue:o=e}=this;let a=EM(s,o,n,r,i);const l=Yp(a,n),u=Yp(a,o);l<Wp&&u<Wp&&(a=n,this.end()),this._prevValue=o,this._currValue=a}}const TM={interpolation:yM,spring:wM};class bM{constructor(e){this.transitions=new Map,this.timeline=e}get active(){return this.transitions.size>0}add(e,n,r,i){const{transitions:s}=this;if(s.has(e)){const l=s.get(e),{value:u=l.settings.fromValue}=l;n=u,this.remove(e)}if(i=Zv(i),!i)return;const o=TM[i.type];if(!o){Z.error("unsupported transition type '".concat(i.type,"'"))();return}const a=new o(this.timeline);a.start({...i,fromValue:n,toValue:r}),s.set(e,a)}remove(e){const{transitions:n}=this;n.has(e)&&(n.get(e).cancel(),n.delete(e))}update(){const e={};for(const[n,r]of this.transitions)r.update(),e[n]=r.value,r.inProgress||this.remove(n);return e}clear(){for(const e of this.transitions.keys())this.remove(e)}}function SM(t){const e=t[Gn];for(const n in e){const r=e[n],{validate:i}=r;if(i&&!i(t[n],r))throw new Error("Invalid prop ".concat(n,": ").concat(t[n]))}}function AM(t,e){const n=mh({newProps:t,oldProps:e,propTypes:t[Gn],ignoreProps:{data:null,updateTriggers:null,extensions:null,transitions:null}}),r=PM(t,e);let i=!1;return r||(i=LM(t,e)),{dataChanged:r,propsChanged:n,updateTriggersChanged:i,extensionsChanged:CM(t,e),transitionsChanged:xM(t,e)}}function xM(t,e){if(!t.transitions)return!1;const n={},r=t[Gn];let i=!1;for(const s in t.transitions){const o=r[s],a=o&&o.type;(a==="number"||a==="color"||a==="array")&&Hc(t[s],e[s],o)&&(n[s]=!0,i=!0)}return i?n:!1}function mh({newProps:t,oldProps:e,ignoreProps:n={},propTypes:r={},triggerName:i="props"}){if(e===t)return!1;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return"".concat(i," changed shallowly");for(const s of Object.keys(t))if(!(s in n)){if(!(s in e))return"".concat(i,".").concat(s," added");const o=Hc(t[s],e[s],r[s]);if(o)return"".concat(i,".").concat(s," ").concat(o)}for(const s of Object.keys(e))if(!(s in n)){if(!(s in t))return"".concat(i,".").concat(s," dropped");if(!Object.hasOwnProperty.call(t,s)){const o=Hc(t[s],e[s],r[s]);if(o)return"".concat(i,".").concat(s," ").concat(o)}}return!1}function Hc(t,e,n){let r=n&&n.equal;return r&&!r(t,e,n)||!r&&(r=t&&e&&t.equals,r&&!r.call(t,e))?"changed deeply":!r&&e!==t?"changed shallowly":null}function PM(t,e){if(e===null)return"oldProps is null, initial diff";let n=!1;const{dataComparator:r,_dataDiff:i}=t;return r?r(t.data,e.data)||(n="Data comparator detected a change"):t.data!==e.data&&(n="A new data container was supplied"),n&&i&&(n=i(t.data,e.data)||n),n}function LM(t,e){if(e===null)return{all:!0};if("all"in t.updateTriggers&&$p(t,e,"all"))return{all:!0};const n={};let r=!1;for(const i in t.updateTriggers)i!=="all"&&$p(t,e,i)&&(n[i]=!0,r=!0);return r?n:!1}function CM(t,e){if(e===null)return!0;const n=e.extensions,{extensions:r}=t;if(r===n)return!1;if(!n||!r||r.length!==n.length)return!0;for(let i=0;i<r.length;i++)if(!r[i].equals(n[i]))return!0;return!1}function $p(t,e,n){let r=t.updateTriggers[n];r=r??{};let i=e.updateTriggers[n];return i=i??{},mh({oldProps:i,newProps:r,triggerName:n})}const MM="count(): argument not an object",RM="count(): argument not a container";function IM(t){if(!kM(t))throw new Error(MM);if(typeof t.count=="function")return t.count();if(Number.isFinite(t.size))return t.size;if(Number.isFinite(t.length))return t.length;if(OM(t))return Object.keys(t).length;throw new Error(RM)}function OM(t){return t!==null&&typeof t=="object"&&t.constructor===Object}function kM(t){return t!==null&&typeof t=="object"}function NM(t,e){if(!e)return t;const n={...t,...e};if("defines"in e&&(n.defines={...t.defines,...e.defines}),"modules"in e&&(n.modules=(t.modules||[]).concat(e.modules),e.modules.some(r=>r.name==="project64"))){const r=n.modules.findIndex(i=>i.name==="project32");r>=0&&n.modules.splice(r,1)}if("inject"in e)if(!t.inject)n.inject=e.inject;else{const r={...t.inject};for(const i in e.inject)r[i]=(r[i]||"")+e.inject[i];n.inject=r}return n}const DM={10241:9987,10240:9729,10242:33071,10243:33071},Wc={};function FM(t,e,n,r){if(n instanceof Rt)return n;n.constructor&&n.constructor.name!=="Object"&&(n={data:n});let i=null;n.compressed&&(i={10241:n.data.length>1?9985:9729});const s=new Rt(e,{...n,parameters:{...DM,...i,...r}});return Wc[s.id]=t,s}function UM(t,e){!e||!(e instanceof Rt)||Wc[e.id]===t&&(e.delete(),delete Wc[e.id])}const BM={boolean:{validate(t,e){return!0},equal(t,e,n){return!!t==!!e}},number:{validate(t,e){return Number.isFinite(t)&&(!("max"in e)||t<=e.max)&&(!("min"in e)||t>=e.min)}},color:{validate(t,e){return e.optional&&!t||Xc(t)&&(t.length===3||t.length===4)},equal(t,e,n){return Gt(t,e,1)}},accessor:{validate(t,e){const n=Ha(t);return n==="function"||n===Ha(e.value)},equal(t,e,n){return typeof e=="function"?!0:Gt(t,e,1)}},array:{validate(t,e){return e.optional&&!t||Xc(t)},equal(t,e,n){const{compare:r}=n,i=Number.isInteger(r)?r:r?1:0;return r?Gt(t,e,i):t===e}},object:{equal(t,e,n){if(n.ignore)return!0;const{compare:r}=n,i=Number.isInteger(r)?r:r?1:0;return r?Gt(t,e,i):t===e}},function:{validate(t,e){return e.optional&&!t||typeof t=="function"},equal(t,e,n){return!n.compare&&n.ignore!==!1||t===e}},data:{transform:(t,e,n)=>{const{dataTransform:r}=n.props;return r&&t?r(t):t}},image:{transform:(t,e,n)=>{const r=n.context;return!r||!r.gl?null:FM(n.id,r.gl,t,{...e.parameters,...n.props.textureParameters})},release:(t,e,n)=>{UM(n.id,t)}}};function zM(t){const e={},n={},r={};for(const[i,s]of Object.entries(t)){const o=s==null?void 0:s.deprecatedFor;if(o)r[i]=Array.isArray(o)?o:[o];else{const a=VM(i,s);e[i]=a,n[i]=a.value}}return{propTypes:e,defaultProps:n,deprecatedProps:r}}function VM(t,e){switch(Ha(e)){case"object":return $i(t,e);case"array":return $i(t,{type:"array",value:e,compare:!1});case"boolean":return $i(t,{type:"boolean",value:e});case"number":return $i(t,{type:"number",value:e});case"function":return $i(t,{type:"function",value:e,compare:!0});default:return{name:t,type:"unknown",value:e}}}function $i(t,e){return"type"in e?{name:t,...BM[e.type],...e}:"value"in e?{name:t,type:Ha(e.value),...e}:{name:t,type:"object",value:e}}function Xc(t){return Array.isArray(t)||ArrayBuffer.isView(t)}function Ha(t){return Xc(t)?"array":t===null?"null":typeof t}function jM(t,e){let n;for(let s=e.length-1;s>=0;s--){const o=e[s];"extensions"in o&&(n=o.extensions)}const r=Yc(t.constructor,n),i=Object.create(r);i[ja]=t,i[vr]={},i[On]={};for(let s=0;s<e.length;++s){const o=e[s];for(const a in o)i[a]=o[a]}return Object.freeze(i),i}const GM="_mergedDefaultProps";function Yc(t,e){let n=GM;if(e)for(const i of e){const s=i.constructor;s&&(n+=":".concat(s.extensionName||s.name))}const r=ny(t,n);return r||(t[n]=HM(t,e||[]))}function HM(t,e){if(!t.prototype)return null;const r=Object.getPrototypeOf(t),i=Yc(r),s=ny(t,"defaultProps")||{},o=zM(s),a=Object.assign(Object.create(null),i,o.defaultProps),l=Object.assign(Object.create(null),i==null?void 0:i[Gn],o.propTypes),u=Object.assign(Object.create(null),i==null?void 0:i[Tu],o.deprecatedProps);for(const c of e){const f=Yc(c.constructor);f&&(Object.assign(a,f),Object.assign(l,f[Gn]),Object.assign(u,f[Tu]))}return WM(a,t),YM(a,l),XM(a,u),a[Gn]=l,a[Tu]=u,e.length===0&&!_h(t,"_propTypes")&&(t._propTypes=l),a}function WM(t,e){const n=qM(e);Object.defineProperties(t,{id:{writable:!0,value:n}})}function XM(t,e){for(const n in e)Object.defineProperty(t,n,{enumerable:!1,set(r){const i="".concat(this.id,": ").concat(n);for(const s of e[n])_h(this,s)||(this[s]=r);Z.deprecated(i,e[n].join("/"))()}})}function YM(t,e){const n={},r={};for(const i in e){const s=e[i],{name:o,value:a}=s;s.async&&(n[o]=a,r[o]=$M(o))}t[ii]=n,t[vr]={},Object.defineProperties(t,r)}function $M(t){return{enumerable:!0,set(e){typeof e=="string"||e instanceof Promise||qv(e)?this[vr][t]=e:this[On][t]=e},get(){if(this[On]){if(t in this[On])return this[On][t]||this[ii][t];if(t in this[vr]){const e=this[ja]&&this[ja].internalState;if(e&&e.hasAsyncProp(t))return e.getAsyncProp(t)||this[ii][t]}}return this[ii][t]}}}function _h(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function ny(t,e){return _h(t,e)&&t[e]}function qM(t){const e=t.componentName;return e||Z.warn("".concat(t.name,".componentName not specified"))(),e||t.name}let ZM=0;class vh{constructor(...e){d(this,"id",void 0),d(this,"props",void 0),d(this,"count",void 0),this.props=jM(this,e),this.id=this.props.id,this.count=ZM++}clone(e){const{props:n}=this,r={};for(const i in n[ii])i in n[On]?r[i]=n[On][i]:i in n[vr]&&(r[i]=n[vr][i]);return new this.constructor({...n,...r,...e})}}d(vh,"componentName","Component");d(vh,"defaultProps",{});const QM=Object.freeze({});class KM{constructor(e){d(this,"component",void 0),d(this,"onAsyncPropUpdated",void 0),d(this,"asyncProps",void 0),d(this,"oldProps",void 0),d(this,"oldAsyncProps",void 0),this.component=e,this.asyncProps={},this.onAsyncPropUpdated=()=>{},this.oldProps=null,this.oldAsyncProps=null}finalize(){for(const e in this.asyncProps){const n=this.asyncProps[e];n&&n.type&&n.type.release&&n.type.release(n.resolvedValue,n.type,this.component)}this.asyncProps={},this.component=null,this.resetOldProps()}getOldProps(){return this.oldAsyncProps||this.oldProps||QM}resetOldProps(){this.oldAsyncProps=null,this.oldProps=this.component?this.component.props:null}hasAsyncProp(e){return e in this.asyncProps}getAsyncProp(e){const n=this.asyncProps[e];return n&&n.resolvedValue}isAsyncPropLoading(e){if(e){const n=this.asyncProps[e];return!!(n&&n.pendingLoadCount>0&&n.pendingLoadCount!==n.resolvedLoadCount)}for(const n in this.asyncProps)if(this.isAsyncPropLoading(n))return!0;return!1}reloadAsyncProp(e,n){this._watchPromise(e,Promise.resolve(n))}setAsyncProps(e){this.component=e[ja]||this.component;const n=e[On]||{},r=e[vr]||e,i=e[ii]||{};for(const s in n){const o=n[s];this._createAsyncPropData(s,i[s]),this._updateAsyncProp(s,o),n[s]=this.getAsyncProp(s)}for(const s in r){const o=r[s];this._createAsyncPropData(s,i[s]),this._updateAsyncProp(s,o)}}_fetch(e,n){return null}_onResolve(e,n){}_onError(e,n){}_updateAsyncProp(e,n){if(this._didAsyncInputValueChange(e,n)){if(typeof n=="string"&&(n=this._fetch(e,n)),n instanceof Promise){this._watchPromise(e,n);return}if(qv(n)){this._resolveAsyncIterable(e,n);return}this._setPropValue(e,n)}}_freezeAsyncOldProps(){if(!this.oldAsyncProps&&this.oldProps){this.oldAsyncProps=Object.create(this.oldProps);for(const e in this.asyncProps)Object.defineProperty(this.oldAsyncProps,e,{enumerable:!0,value:this.oldProps[e]})}}_didAsyncInputValueChange(e,n){const r=this.asyncProps[e];return n===r.resolvedValue||n===r.lastValue?!1:(r.lastValue=n,!0)}_setPropValue(e,n){this._freezeAsyncOldProps();const r=this.asyncProps[e];r&&(n=this._postProcessValue(r,n),r.resolvedValue=n,r.pendingLoadCount++,r.resolvedLoadCount=r.pendingLoadCount)}_setAsyncPropValue(e,n,r){const i=this.asyncProps[e];i&&r>=i.resolvedLoadCount&&n!==void 0&&(this._freezeAsyncOldProps(),i.resolvedValue=n,i.resolvedLoadCount=r,this.onAsyncPropUpdated(e,n))}_watchPromise(e,n){const r=this.asyncProps[e];if(r){r.pendingLoadCount++;const i=r.pendingLoadCount;n.then(s=>{this.component&&(s=this._postProcessValue(r,s),this._setAsyncPropValue(e,s,i),this._onResolve(e,s))}).catch(s=>{this._onError(e,s)})}}async _resolveAsyncIterable(e,n){if(e!=="data"){this._setPropValue(e,n);return}const r=this.asyncProps[e];if(!r)return;r.pendingLoadCount++;const i=r.pendingLoadCount;let s=[],o=0;for await(const a of n){if(!this.component)return;const{dataTransform:l}=this.component.props;l?s=l(a,s):s=s.concat(a),Object.defineProperty(s,"__diff",{enumerable:!1,value:[{startRow:o,endRow:s.length}]}),o=s.length,this._setAsyncPropValue(e,s,i)}this._onResolve(e,s)}_postProcessValue(e,n){const r=e.type;return r&&this.component&&(r.release&&r.release(e.resolvedValue,r,this.component),r.transform)?r.transform(n,r,this.component):n}_createAsyncPropData(e,n){if(!this.asyncProps[e]){const i=this.component&&this.component.props[Gn];this.asyncProps[e]={type:i&&i[e],lastValue:null,resolvedValue:n,pendingLoadCount:0,resolvedLoadCount:0}}}}class JM extends KM{constructor({attributeManager:e,layer:n}){super(n),d(this,"attributeManager",void 0),d(this,"needsRedraw",void 0),d(this,"needsUpdate",void 0),d(this,"subLayers",void 0),d(this,"usesPickingColorCache",void 0),d(this,"hasPickingBuffer",void 0),d(this,"changeFlags",void 0),d(this,"viewport",void 0),d(this,"uniformTransitions",void 0),d(this,"propsInTransition",void 0),this.attributeManager=e,this.needsRedraw=!0,this.needsUpdate=!0,this.subLayers=null,this.usesPickingColorCache=!1}get layer(){return this.component}_fetch(e,n){const r=this.layer,i=r==null?void 0:r.props.fetch;return i?i(n,{propName:e,layer:r}):super._fetch(e,n)}_onResolve(e,n){const r=this.layer;if(r){const i=r.props.onDataLoad;e==="data"&&i&&i(n,{propName:e,layer:r})}}_onError(e,n){const r=this.layer;r&&r.raiseError(n,"loading ".concat(e," of ").concat(this.layer))}}const eR="layer.changeFlag",tR="layer.initialize",nR="layer.update",rR="layer.finalize",iR="layer.matched",qp=2**24-1,sR=Object.freeze([]),oR=Js(({oldViewport:t,viewport:e})=>t.equals(e));let Ut=new Uint8ClampedArray(0);const aR={data:{type:"data",value:sR,async:!0},dataComparator:{type:"function",value:null,optional:!0},_dataDiff:{type:"function",value:t=>t&&t.__diff,optional:!0},dataTransform:{type:"function",value:null,optional:!0},onDataLoad:{type:"function",value:null,optional:!0},onError:{type:"function",value:null,optional:!0},fetch:{type:"function",value:(t,{propName:e,layer:n,loaders:r,loadOptions:i,signal:s})=>{const{resourceManager:o}=n.context;if(i=i||n.getLoadOptions(),r=r||n.props.loaders,s){var a;i={...i,fetch:{...(a=i)===null||a===void 0?void 0:a.fetch,signal:s}}}let l=o.contains(t);return!l&&!i&&(o.add({resourceId:t,data:Tc(t,r),persistent:!1}),l=!0),l?o.subscribe({resourceId:t,onChange:u=>{var c;return(c=n.internalState)===null||c===void 0?void 0:c.reloadAsyncProp(e,u)},consumerId:n.id,requestId:e}):Tc(t,r,i)}},updateTriggers:{},visible:!0,pickable:!1,opacity:{type:"number",min:0,max:1,value:1},operation:"draw",onHover:{type:"function",value:null,optional:!0},onClick:{type:"function",value:null,optional:!0},onDragStart:{type:"function",value:null,optional:!0},onDrag:{type:"function",value:null,optional:!0},onDragEnd:{type:"function",value:null,optional:!0},coordinateSystem:q.DEFAULT,coordinateOrigin:{type:"array",value:[0,0,0],compare:!0},modelMatrix:{type:"array",value:null,compare:!0,optional:!0},wrapLongitude:!1,positionFormat:"XYZ",colorFormat:"RGBA",parameters:{type:"object",value:{},optional:!0,compare:2},loadOptions:{type:"object",value:null,optional:!0,ignore:!0},transitions:null,extensions:[],loaders:{type:"array",value:[],optional:!0,ignore:!0},getPolygonOffset:{type:"function",value:({layerIndex:t})=>[0,-t*100]},highlightedObjectIndex:null,autoHighlight:!1,highlightColor:{type:"accessor",value:[0,0,128,128]}};class dl extends vh{constructor(...e){super(...e),d(this,"internalState",null),d(this,"lifecycle",Dr.NO_STATE),d(this,"context",void 0),d(this,"state",void 0),d(this,"parent",null)}static get componentName(){return Object.prototype.hasOwnProperty.call(this,"layerName")?this.layerName:""}get root(){let e=this;for(;e.parent;)e=e.parent;return e}toString(){const e=this.constructor.layerName||this.constructor.name;return"".concat(e,"({id: '").concat(this.props.id,"'})")}project(e){_e(this.internalState);const n=this.internalState.viewport||this.context.viewport,r=Fv(e,{viewport:n,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem}),[i,s,o]=Nv(r,n.pixelProjectionMatrix);return e.length===2?[i,s]:[i,s,o]}unproject(e){return _e(this.internalState),(this.internalState.viewport||this.context.viewport).unproject(e)}projectPosition(e,n){_e(this.internalState);const r=this.internalState.viewport||this.context.viewport;return SC(e,{viewport:r,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem,...n})}get isComposite(){return!1}setState(e){this.setChangeFlags({stateChanged:!0}),Object.assign(this.state,e),this.setNeedsRedraw()}setNeedsRedraw(){this.internalState&&(this.internalState.needsRedraw=!0)}setNeedsUpdate(){this.internalState&&(this.context.layerManager.setNeedsUpdate(String(this)),this.internalState.needsUpdate=!0)}get isLoaded(){return this.internalState?!this.internalState.isAsyncPropLoading():!1}get wrapLongitude(){return this.props.wrapLongitude}isPickable(){return this.props.pickable&&this.props.visible}getModels(){return this.state&&(this.state.models||this.state.model&&[this.state.model])||[]}setModuleParameters(e){for(const n of this.getModels())n.updateModuleSettings(e)}getAttributeManager(){return this.internalState&&this.internalState.attributeManager}getCurrentLayer(){return this.internalState&&this.internalState.layer}getLoadOptions(){return this.props.loadOptions}use64bitPositions(){const{coordinateSystem:e}=this.props;return e===q.DEFAULT||e===q.LNGLAT||e===q.CARTESIAN}onHover(e,n){return this.props.onHover&&this.props.onHover(e,n)||!1}onClick(e,n){return this.props.onClick&&this.props.onClick(e,n)||!1}nullPickingColor(){return[0,0,0]}encodePickingColor(e,n=[]){return n[0]=e+1&255,n[1]=e+1>>8&255,n[2]=e+1>>8>>8&255,n}decodePickingColor(e){_e(e instanceof Uint8Array);const[n,r,i]=e;return n+r*256+i*65536-1}getNumInstances(){return Number.isFinite(this.props.numInstances)?this.props.numInstances:this.state&&this.state.numInstances!==void 0?this.state.numInstances:IM(this.props.data)}getStartIndices(){return this.props.startIndices?this.props.startIndices:this.state&&this.state.startIndices?this.state.startIndices:null}getBounds(){var e;return(e=this.getAttributeManager())===null||e===void 0?void 0:e.getBounds(["positions","instancePositions"])}getShaders(e){for(const n of this.props.extensions)e=NM(e,n.getShaders.call(this,n));return e}shouldUpdateState(e){return e.changeFlags.propsOrDataChanged}updateState(e){const n=this.getAttributeManager(),{dataChanged:r}=e.changeFlags;if(r&&n)if(Array.isArray(r))for(const i of r)n.invalidateAll(i);else n.invalidateAll();if(n){const{props:i}=e,s=this.internalState.hasPickingBuffer,o=Number.isInteger(i.highlightedObjectIndex)||i.pickable||i.extensions.some(a=>a.getNeedsPickingBuffer.call(this,a));if(s!==o){this.internalState.hasPickingBuffer=o;const{pickingColors:a,instancePickingColors:l}=n.attributes,u=a||l;u&&(o&&u.constant&&(u.constant=!1,n.invalidate(u.id)),!u.value&&!o&&(u.constant=!0,u.value=[0,0,0]))}}}finalizeState(e){for(const r of this.getModels())r.delete();const n=this.getAttributeManager();n&&n.finalize(),this.context&&this.context.resourceManager.unsubscribe({consumerId:this.id}),this.internalState&&(this.internalState.uniformTransitions.clear(),this.internalState.finalize())}draw(e){for(const n of this.getModels())n.draw(e)}getPickingInfo({info:e,mode:n,sourceLayer:r}){const{index:i}=e;return i>=0&&Array.isArray(this.props.data)&&(e.object=this.props.data[i]),e}raiseError(e,n){var r,i;if(n&&(e=new Error("".concat(n,": ").concat(e.message),{cause:e})),!((r=(i=this.props).onError)!==null&&r!==void 0&&r.call(i,e))){var s,o;(s=this.context)===null||s===void 0||(o=s.onError)===null||o===void 0||o.call(s,e,this)}}getNeedsRedraw(e={clearRedrawFlags:!1}){return this._getNeedsRedraw(e)}needsUpdate(){return this.internalState?this.internalState.needsUpdate||this.hasUniformTransition()||this.shouldUpdateState(this._getUpdateParams()):!1}hasUniformTransition(){var e;return((e=this.internalState)===null||e===void 0?void 0:e.uniformTransitions.active)||!1}activateViewport(e){if(!this.internalState)return;const n=this.internalState.viewport;this.internalState.viewport=e,(!n||!oR({oldViewport:n,viewport:e}))&&(this.setChangeFlags({viewportChanged:!0}),this.isComposite?this.needsUpdate()&&this.setNeedsUpdate():this._update())}invalidateAttribute(e="all"){const n=this.getAttributeManager();n&&(e==="all"?n.invalidateAll():n.invalidate(e))}updateAttributes(e){for(const n of this.getModels())this._setModelAttributes(n,e)}_updateAttributes(){const e=this.getAttributeManager();if(!e)return;const n=this.props,r=this.getNumInstances(),i=this.getStartIndices();e.update({data:n.data,numInstances:r,startIndices:i,props:n,transitions:n.transitions,buffers:n.data.attributes,context:this});const s=e.getChangedAttributes({clearChangedFlags:!0});this.updateAttributes(s)}_updateAttributeTransition(){const e=this.getAttributeManager();e&&e.updateTransition()}_updateUniformTransition(){const{uniformTransitions:e}=this.internalState;if(e.active){const n=e.update(),r=Object.create(this.props);for(const i in n)Object.defineProperty(r,i,{value:n[i]});return r}return this.props}calculateInstancePickingColors(e,{numInstances:n}){if(e.constant)return;const r=Math.floor(Ut.length/3);if(this.internalState.usesPickingColorCache=!0,r<n){n>qp&&Z.warn("Layer has too many data objects. Picking might not be able to distinguish all objects.")(),Ut=Us.allocate(Ut,n,{size:3,copy:!0,maxCount:Math.max(n,qp)});const i=Math.floor(Ut.length/3),s=[];for(let o=r;o<i;o++)this.encodePickingColor(o,s),Ut[o*3+0]=s[0],Ut[o*3+1]=s[1],Ut[o*3+2]=s[2]}e.value=Ut.subarray(0,n*3)}_setModelAttributes(e,n){const r=this.getAttributeManager(),i=e.userData.excludeAttributes||{},s=r.getShaderAttributes(n,i);e.setAttributes(s)}disablePickingIndex(e){const n=this.props.data;if(!("attributes"in n)){this._disablePickingIndex(e);return}const{pickingColors:r,instancePickingColors:i}=this.getAttributeManager().attributes,s=r||i,o=s&&n.attributes&&n.attributes[s.id];if(o&&o.value){const a=o.value,l=this.encodePickingColor(e);for(let u=0;u<n.length;u++){const c=s.getVertexOffset(u);a[c]===l[0]&&a[c+1]===l[1]&&a[c+2]===l[2]&&this._disablePickingIndex(u)}}else this._disablePickingIndex(e)}_disablePickingIndex(e){const{pickingColors:n,instancePickingColors:r}=this.getAttributeManager().attributes,i=n||r;if(!i)return;const s=i.getVertexOffset(e),o=i.getVertexOffset(e+1);i.buffer.subData({data:new Uint8Array(o-s),offset:s})}restorePickingColors(){const{pickingColors:e,instancePickingColors:n}=this.getAttributeManager().attributes,r=e||n;r&&(this.internalState.usesPickingColorCache&&r.value.buffer!==Ut.buffer&&(r.value=Ut.subarray(0,r.value.length)),r.updateSubBuffer({startOffset:0}))}_initialize(){_e(!this.internalState),_e(Number.isFinite(this.props.coordinateSystem)),Ne(tR,this);const e=this._getAttributeManager();e&&e.addInstanced({instancePickingColors:{type:5121,size:3,noAlloc:!0,update:this.calculateInstancePickingColors}}),this.internalState=new JM({attributeManager:e,layer:this}),this._clearChangeFlags(),this.state={},Object.defineProperty(this.state,"attributeManager",{get:()=>(Z.deprecated("layer.state.attributeManager","layer.getAttributeManager()")(),e)}),this.internalState.uniformTransitions=new bM(this.context.timeline),this.internalState.onAsyncPropUpdated=this._onAsyncPropUpdated.bind(this),this.internalState.setAsyncProps(this.props),this.initializeState(this.context);for(const n of this.props.extensions)n.initializeState.call(this,this.context,n);this.setChangeFlags({dataChanged:"init",propsChanged:"init",viewportChanged:!0,extensionsChanged:!0}),this._update()}_transferState(e){Ne(iR,this,this===e);const{state:n,internalState:r}=e;this!==e&&(this.internalState=r,this.state=n,this.internalState.setAsyncProps(this.props),this._diffProps(this.props,this.internalState.getOldProps()))}_update(){const e=this.needsUpdate();if(Ne(nR,this,e),!e)return;const n=this.props,r=this.context,i=this.internalState,s=r.viewport,o=this._updateUniformTransition();i.propsInTransition=o,r.viewport=i.viewport||s,this.props=o;try{const a=this._getUpdateParams(),l=this.getModels();if(r.gl)this.updateState(a);else try{this.updateState(a)}catch{}for(const c of this.props.extensions)c.updateState.call(this,a,c);const u=this.getModels()[0]!==l[0];this._postUpdate(a,u)}finally{r.viewport=s,this.props=n,this._clearChangeFlags(),i.needsUpdate=!1,i.resetOldProps()}}_finalize(){Ne(rR,this),this.finalizeState(this.context);for(const e of this.props.extensions)e.finalizeState.call(this,this.context,e)}_drawLayer({moduleParameters:e=null,uniforms:n={},parameters:r={}}){this._updateAttributeTransition();const i=this.props,s=this.context;this.props=this.internalState.propsInTransition||i;const o=this.props.opacity;n.opacity=Math.pow(o,1/2.2);try{e&&this.setModuleParameters(e);const{getPolygonOffset:a}=this.props,l=a&&a(n)||[0,0];gn(s.gl,{polygonOffset:l}),Ct(s.gl,r,()=>{const u={moduleParameters:e,uniforms:n,parameters:r,context:s};for(const c of this.props.extensions)c.draw.call(this,u,c);this.draw(u)})}finally{this.props=i}}getChangeFlags(){var e;return(e=this.internalState)===null||e===void 0?void 0:e.changeFlags}setChangeFlags(e){if(!this.internalState)return;const{changeFlags:n}=this.internalState;for(const i in e)if(e[i]){let s=!1;switch(i){case"dataChanged":const o=e[i],a=n[i];o&&Array.isArray(a)&&(n.dataChanged=Array.isArray(o)?a.concat(o):o,s=!0);default:n[i]||(n[i]=e[i],s=!0)}s&&Ne(eR,this,i,e)}const r=!!(n.dataChanged||n.updateTriggersChanged||n.propsChanged||n.extensionsChanged);n.propsOrDataChanged=r,n.somethingChanged=r||n.viewportChanged||n.stateChanged}_clearChangeFlags(){this.internalState.changeFlags={dataChanged:!1,propsChanged:!1,updateTriggersChanged:!1,viewportChanged:!1,stateChanged:!1,extensionsChanged:!1,propsOrDataChanged:!1,somethingChanged:!1}}_diffProps(e,n){const r=AM(e,n);if(r.updateTriggersChanged)for(const s in r.updateTriggersChanged)r.updateTriggersChanged[s]&&this.invalidateAttribute(s);if(r.transitionsChanged)for(const s in r.transitionsChanged){var i;this.internalState.uniformTransitions.add(s,n[s],e[s],(i=e.transitions)===null||i===void 0?void 0:i[s])}return this.setChangeFlags(r)}validateProps(){SM(this.props)}updateAutoHighlight(e){this.props.autoHighlight&&!Number.isInteger(this.props.highlightedObjectIndex)&&this._updateAutoHighlight(e)}_updateAutoHighlight(e){const n={pickingSelectedColor:e.picked?e.color:null},{highlightColor:r}=this.props;e.picked&&typeof r=="function"&&(n.pickingHighlightColor=r(e)),this.setModuleParameters(n),this.setNeedsRedraw()}_getAttributeManager(){const e=this.context;return new ty(e.gl,{id:this.props.id,stats:e.stats,timeline:e.timeline})}_postUpdate(e,n){const{props:r,oldProps:i}=e;this.setNeedsRedraw(),this._updateAttributes();const{model:s}=this.state;s==null||s.setInstanceCount(this.getNumInstances());const{autoHighlight:o,highlightedObjectIndex:a,highlightColor:l}=r;if(n||i.autoHighlight!==o||i.highlightedObjectIndex!==a||i.highlightColor!==l){const u={};o||(u.pickingSelectedColor=null),Array.isArray(l)&&(u.pickingHighlightColor=l),(n||a!==i.highlightedObjectIndex)&&(u.pickingSelectedColor=Number.isFinite(a)&&a>=0?this.encodePickingColor(a):null),this.setModuleParameters(u)}}_getUpdateParams(){return{props:this.props,oldProps:this.internalState.getOldProps(),context:this.context,changeFlags:this.internalState.changeFlags}}_getNeedsRedraw(e){if(!this.internalState)return!1;let n=!1;n=n||this.internalState.needsRedraw&&this.id;const r=this.getAttributeManager(),i=r?r.getNeedsRedraw(e):!1;if(n=n||i,n)for(const s of this.props.extensions)s.onNeedsRedraw.call(this,s);return this.internalState.needsRedraw=this.internalState.needsRedraw&&!e.clearRedrawFlags,n}_onAsyncPropUpdated(){this._diffProps(this.props,this.internalState.getOldProps()),this.setNeedsUpdate()}}d(dl,"defaultProps",aR);d(dl,"layerName","Layer");const lR="compositeLayer.renderLayers";class ry extends dl{get isComposite(){return!0}get isLoaded(){return super.isLoaded&&this.getSubLayers().every(e=>e.isLoaded)}getSubLayers(){return this.internalState&&this.internalState.subLayers||[]}initializeState(e){}setState(e){super.setState(e),this.setNeedsUpdate()}getPickingInfo({info:e}){const{object:n}=e;return n&&n.__source&&n.__source.parent&&n.__source.parent.id===this.id&&(e.object=n.__source.object,e.index=n.__source.index),e}filterSubLayer(e){return!0}shouldRenderSubLayer(e,n){return n&&n.length}getSubLayerClass(e,n){const{_subLayerProps:r}=this.props;return r&&r[e]&&r[e].type||n}getSubLayerRow(e,n,r){return e.__source={parent:this,object:n,index:r},e}getSubLayerAccessor(e){if(typeof e=="function"){const n={index:-1,data:this.props.data,target:[]};return(r,i)=>r&&r.__source?(n.index=r.__source.index,e(r.__source.object,n)):e(r,i)}return e}getSubLayerProps(e={}){var n;const{opacity:r,pickable:i,visible:s,parameters:o,getPolygonOffset:a,highlightedObjectIndex:l,autoHighlight:u,highlightColor:c,coordinateSystem:f,coordinateOrigin:h,wrapLongitude:p,positionFormat:E,modelMatrix:w,extensions:S,fetch:_,operation:m,_subLayerProps:y}=this.props,b={id:"",updateTriggers:{},opacity:r,pickable:i,visible:s,parameters:o,getPolygonOffset:a,highlightedObjectIndex:l,autoHighlight:u,highlightColor:c,coordinateSystem:f,coordinateOrigin:h,wrapLongitude:p,positionFormat:E,modelMatrix:w,extensions:S,fetch:_,operation:m},x=y&&e.id&&y[e.id],P=x&&x.updateTriggers,L=e.id||"sublayer";if(x){const C=this.props[Gn],O=e.type?e.type._propTypes:{};for(const I in x){const B=O[I]||C[I];B&&B.type==="accessor"&&(x[I]=this.getSubLayerAccessor(x[I]))}}Object.assign(b,e,x),b.id="".concat(this.props.id,"-").concat(L),b.updateTriggers={all:(n=this.props.updateTriggers)===null||n===void 0?void 0:n.all,...e.updateTriggers,...P};for(const C of S){const O=C.getSubLayerProps.call(this,C);O&&Object.assign(b,O,{updateTriggers:Object.assign(b.updateTriggers,O.updateTriggers)})}return b}_updateAutoHighlight(e){for(const n of this.getSubLayers())n.updateAutoHighlight(e)}_getAttributeManager(){return null}_postUpdate(e,n){let r=this.internalState.subLayers;const i=!r||this.needsUpdate();if(i){const s=this.renderLayers();r=Ei(s,Boolean),this.internalState.subLayers=r}Ne(lR,this,i,r);for(const s of r)s.parent=this}}d(ry,"layerName","CompositeLayer");const Nr={SUM:1,MEAN:2,MIN:3,MAX:4};function iy(t,e){return t+e}function uR(t,e){return e>t?e:t}function cR(t,e){return e<t?e:t}function fR(t,e){if(Number.isFinite(e))return t.length?e:null;const n=t.map(e).filter(Number.isFinite);return n.length?n.reduce(iy,0)/n.length:null}function hR(t,e){if(Number.isFinite(e))return t.length?t.length*e:null;const n=t.map(e).filter(Number.isFinite);return n.length?n.reduce(iy,0):null}function dR(t,e){if(Number.isFinite(e))return t.length?e:null;const n=t.map(e).filter(Number.isFinite);return n.length?n.reduce(uR,-1/0):null}function gR(t,e){if(Number.isFinite(e))return t.length?e:null;const n=t.map(e).filter(Number.isFinite);return n.length?n.reduce(cR,1/0):null}function pR(t,e,n){const r=Nr[t]||Nr.SUM;switch(e=mR(e,n),r){case Nr.MIN:return i=>gR(i,e);case Nr.SUM:return i=>hR(i,e);case Nr.MEAN:return i=>fR(i,e);case Nr.MAX:return i=>dR(i,e);default:return null}}function mR(t,e={}){return Number.isFinite(t)?t:n=>(e.index=n.index,t(n.source,e))}function _R(t,e={}){return n=>(e.indices=n.map(r=>r.index),t(n.map(r=>r.source),e))}const vR=[[255,255,178],[254,217,118],[254,178,76],[253,141,60],[240,59,32],[189,0,38]];function yR(t,e){const n={};for(const r in t)e.includes(r)||(n[r]=t[r]);return n}class sy extends ry{constructor(...e){super(...e),d(this,"state",void 0)}initializeAggregationLayer(e){super.initializeState(this.context),this.setState({ignoreProps:yR(this.constructor._propTypes,e.data.props),dimensions:e})}updateState(e){super.updateState(e);const{changeFlags:n}=e;if(n.extensionsChanged){const r=this.getShaders({});r&&r.defines&&(r.defines.NON_INSTANCED_MODEL=1),this.updateShaders(r)}this._updateAttributes()}updateAttributes(e){this.setState({changedAttributes:e})}getAttributes(){return this.getAttributeManager().getShaderAttributes()}getModuleSettings(){const{viewport:e,mousePosition:n,gl:r}=this.context;return Object.assign(Object.create(this.props),{viewport:e,mousePosition:n,pickingActive:0,devicePixelRatio:mr(r)})}updateShaders(e){}isAggregationDirty(e,n={}){const{props:r,oldProps:i,changeFlags:s}=e,{compareAll:o=!1,dimension:a}=n,{ignoreProps:l}=this.state,{props:u,accessors:c=[]}=a,{updateTriggersChanged:f}=s;if(s.dataChanged)return!0;if(f){if(f.all)return!0;for(const h of c)if(f[h])return!0}if(o)return s.extensionsChanged?!0:mh({oldProps:i,newProps:r,ignoreProps:l,propTypes:this.constructor._propTypes});for(const h of u)if(r[h]!==i[h])return!0;return!1}isAttributeChanged(e){const{changedAttributes:n}=this.state;return e?n&&n[e]!==void 0:!ER(n)}_getAttributeManager(){return new ty(this.context.gl,{id:this.props.id,stats:this.context.stats})}}d(sy,"layerName","AggregationLayer");function ER(t){let e=!0;for(const n in t){e=!1;break}return e}function gl(t,e,n){const r=n;return r.domain=()=>t,r.range=()=>e,r}function Zp(t,e){return gl(t,e,r=>LR(t,e,r))}function wR(t,e){return gl(t,e,r=>CR(t,e,r))}function TR(t,e){const n=t.sort(oy);let r=0;const i=Math.max(1,e.length),s=new Array(i-1);for(;++r<i;)s[r-1]=bR(n,r/i);const o=a=>AR(s,e,a);return o.thresholds=()=>s,gl(t,e,o)}function oy(t,e){return t-e}function bR(t,e){const n=t.length;if(e<=0||n<2)return t[0];if(e>=1)return t[n-1];const r=(n-1)*e,i=Math.floor(r),s=t[i],o=t[i+1];return s+(o-s)*(r-i)}function SR(t,e){let n=0,r=t.length;for(;n<r;){const i=n+r>>>1;oy(t[i],e)>0?r=i:n=i+1}return n}function AR(t,e,n){return e[SR(t,n)]}function xR(t,e,n,r){const i="".concat(r);let s=e.get(i);return s===void 0&&(s=t.push(r),e.set(i,s)),n[(s-1)%n.length]}function PR(t,e){const n=new Map,r=[];for(const s of t){const o="".concat(s);n.has(o)||n.set(o,r.push(s))}return gl(t,e,s=>xR(r,n,e,s))}function LR(t,e,n){const r=t[1]-t[0];if(r<=0)return Z.warn("quantizeScale: invalid domain, returning range[0]")(),e[0];const i=r/e.length,s=Math.floor((n-t[0])/i),o=Math.max(Math.min(s,e.length-1),0);return e[o]}function CR(t,e,n){return(n-t[0])/(t[1]-t[0])*(e[1]-e[0])+e[0]}function ay(t){return t!=null}function MR(t){const e=[];return t.forEach(n=>{!e.includes(n)&&ay(n)&&e.push(n)}),e}function ly(t,e){return(typeof e=="function"?t.map(e):t).filter(ay)}function RR(t,e){return ly(t,e)}function IR(t,e){return MR(ly(t,e))}function OR(t,e,n){return Math.max(e,Math.min(n,t))}function kR(t){switch(t){case"quantize":return Zp;case"linear":return wR;case"quantile":return TR;case"ordinal":return PR;default:return Zp}}const uy=t=>t.length,NR=3402823466e29,cy=t=>t.points,fy=t=>t.index,Qp=(t,e)=>t<e?-1:t>e?1:t>=e?0:NaN,DR={getValue:uy,getPoints:cy,getIndex:fy,filterData:null};class FR{constructor(e=[],n=DR){d(this,"maxCount",void 0),d(this,"maxValue",void 0),d(this,"minValue",void 0),d(this,"totalCount",void 0),d(this,"aggregatedBins",void 0),d(this,"sortedBins",void 0),d(this,"binMap",void 0),this.aggregatedBins=this.getAggregatedBins(e,n),this._updateMinMaxValues(),this.binMap=this.getBinMap()}getAggregatedBins(e,n){const{getValue:r=uy,getPoints:i=cy,getIndex:s=fy,filterData:o}=n,a=typeof o=="function",l=e.length,u=[];let c=0;for(let f=0;f<l;f++){const h=e[f],p=i(h),E=s(h),w=a?p.filter(o):p;h.filteredPoints=a?w:null;const S=w.length?r(w):null;S!=null&&(u[c]={i:Number.isFinite(E)?E:f,value:S,counts:w.length},c++)}return u}_percentileToIndex(e){const n=this.sortedBins.length;if(n<2)return[0,0];const[r,i]=e.map(a=>OR(a,0,100)),s=Math.ceil(r/100*(n-1)),o=Math.floor(i/100*(n-1));return[s,o]}getBinMap(){const e={};for(const n of this.aggregatedBins)e[n.i]=n;return e}_updateMinMaxValues(){let e=0,n=0,r=NR,i=0;for(const s of this.aggregatedBins)e=e>s.counts?e:s.counts,n=n>s.value?n:s.value,r=r<s.value?r:s.value,i+=s.counts;this.maxCount=e,this.maxValue=n,this.minValue=r,this.totalCount=i}getValueRange(e){if(this.sortedBins||(this.sortedBins=this.aggregatedBins.sort((i,s)=>Qp(i.value,s.value))),!this.sortedBins.length)return[];let n=0,r=this.sortedBins.length-1;if(Array.isArray(e)){const i=this._percentileToIndex(e);n=i[0],r=i[1]}return[this.sortedBins[n].value,this.sortedBins[r].value]}getValueDomainByScale(e,[n=0,r=100]=[]){if(this.sortedBins||(this.sortedBins=this.aggregatedBins.sort((s,o)=>Qp(s.value,o.value))),!this.sortedBins.length)return[];const i=this._percentileToIndex([n,r]);return this._getScaleDomain(e,i)}_getScaleDomain(e,[n,r]){const i=this.sortedBins;switch(e){case"quantize":case"linear":return[i[n].value,i[r].value];case"quantile":return RR(i.slice(n,r+1),s=>s.value);case"ordinal":return IR(i,s=>s.value);default:return[i[n].value,i[r].value]}}}const hy=6378e3;function UR(t,e,n=!0){if(!n)return{xOffset:e,yOffset:e};const{yMin:r,yMax:i}=t,s=(r+i)/2;return BR(e,s)}function BR(t,e){const n=zR(t),r=VR(e,t);return{yOffset:n,xOffset:r}}function zR(t){return t/hy*(180/Math.PI)}function VR(t,e){return e/hy*(180/Math.PI)/Math.cos(t*Math.PI/180)}function jR(t,e){const n=GR(t,e),r=HR(n);return{gridHash:n.gridHash,gridOffset:n.gridOffset,data:r}}function GR(t,e){const{data:n=[],cellSize:r}=t,{attributes:i,viewport:s,projectPoints:o,numInstances:a}=e,l=i.positions.value,{size:u}=i.positions.getAccessor(),c=e.boundingBox||WR(i.positions,a),f=e.posOffset||[180,90],h=e.gridOffset||UR(c,r);if(h.xOffset<=0||h.yOffset<=0)return{gridHash:{},gridOffset:h};const{width:p,height:E}=s,w=Math.ceil(p/h.xOffset),S=Math.ceil(E/h.yOffset),_={},{iterable:m,objectInfo:y}=$v(n),b=new Array(3);for(const x of m){y.index++,b[0]=l[y.index*u],b[1]=l[y.index*u+1],b[2]=u>=3?l[y.index*u+2]:0;const[P,L]=o?s.project(b):b;if(Number.isFinite(P)&&Number.isFinite(L)){const C=Math.floor((L+f[1])/h.yOffset),O=Math.floor((P+f[0])/h.xOffset);if(!o||O>=0&&O<w&&C>=0&&C<S){const I="".concat(C,"-").concat(O);_[I]=_[I]||{count:0,points:[],lonIdx:O,latIdx:C},_[I].count+=1,_[I].points.push({source:x,index:y.index})}}}return{gridHash:_,gridOffset:h,offsets:[f[0]*-1,f[1]*-1]}}function HR({gridHash:t,gridOffset:e,offsets:n}){const r=new Array(Object.keys(t).length);let i=0;for(const s in t){const o=s.split("-"),a=parseInt(o[0],10),l=parseInt(o[1],10),u=i++;r[u]={index:u,position:[n[0]+e.xOffset*l,n[1]+e.yOffset*a],...t[s]}}return r}function WR(t,e){const n=t.value,{size:r}=t.getAccessor();let i=1/0,s=-1/0,o=1/0,a=-1/0,l,u;for(let c=0;c<e;c++)u=n[c*r],l=n[c*r+1],Number.isFinite(u)&&Number.isFinite(l)&&(i=l<i?l:i,s=l>s?l:s,o=u<o?u:o,a=u>a?u:a);return{xMin:o,xMax:a,yMin:i,yMax:s}}const XR={CLOCKWISE:1,COUNTER_CLOCKWISE:-1};function YR(t,e,n={}){return $R(t,n)!==e?(ZR(t,n),!0):!1}function $R(t,e={}){return Math.sign(qR(t,e))}function qR(t,e={}){const{start:n=0,end:r=t.length}=e,i=e.size||2;let s=0;for(let o=n,a=r-i;o<r;o+=i)s+=(t[o]-t[a])*(t[o+1]+t[a+1]),a=o;return s/2}function ZR(t,e){const{start:n=0,end:r=t.length,size:i=2}=e,s=(r-n)/i,o=Math.floor(s/2);for(let a=0;a<o;++a){const l=n+a*i,u=n+(s-1-a)*i;for(let c=0;c<i;++c){const f=t[l+c];t[l+c]=t[u+c],t[u+c]=f}}}class QR extends Av{constructor(e){const{id:n=Xt("column-geometry")}=e,{indices:r,attributes:i}=KR(e);super({...e,id:n,indices:r,attributes:i})}}function KR(t){const{radius:e,height:n=1,nradial:r=10}=t;let{vertices:i}=t;i&&(Z.assert(i.length>=r),i=i.flatMap(p=>[p[0],p[1]]),YR(i,XR.COUNTER_CLOCKWISE));const s=n>0,o=r+1,a=s?o*3+1:r,l=Math.PI*2/r,u=new Uint16Array(s?r*3*2:0),c=new Float32Array(a*3),f=new Float32Array(a*3);let h=0;if(s){for(let p=0;p<o;p++){const E=p*l,w=p%r,S=Math.sin(E),_=Math.cos(E);for(let m=0;m<2;m++)c[h+0]=i?i[w*2]:_*e,c[h+1]=i?i[w*2+1]:S*e,c[h+2]=(1/2-m)*n,f[h+0]=i?i[w*2]:_,f[h+1]=i?i[w*2+1]:S,h+=3}c[h+0]=c[h-3],c[h+1]=c[h-2],c[h+2]=c[h-1],h+=3}for(let p=s?0:1;p<o;p++){const E=Math.floor(p/2)*Math.sign(.5-p%2),w=E*l,S=(E+r)%r,_=Math.sin(w),m=Math.cos(w);c[h+0]=i?i[S*2]:m*e,c[h+1]=i?i[S*2+1]:_*e,c[h+2]=n/2,f[h+2]=1,h+=3}if(s){let p=0;for(let E=0;E<r;E++)u[p++]=E*2+0,u[p++]=E*2+2,u[p++]=E*2+0,u[p++]=E*2+1,u[p++]=E*2+1,u[p++]=E*2+3}return{indices:u,attributes:{POSITION:{size:3,value:c},NORMAL:{size:3,value:f}}}}const JR=`#version 300 es

#define SHADER_NAME column-layer-vertex-shader

in vec3 positions;
in vec3 normals;

in vec3 instancePositions;
in float instanceElevations;
in vec3 instancePositions64Low;
in vec4 instanceFillColors;
in vec4 instanceLineColors;
in float instanceStrokeWidths;

in vec3 instancePickingColors;
uniform float opacity;
uniform float radius;
uniform float angle;
uniform vec2 offset;
uniform bool extruded;
uniform bool stroked;
uniform bool isStroke;
uniform float coverage;
uniform float elevationScale;
uniform float edgeDistance;
uniform float widthScale;
uniform float widthMinPixels;
uniform float widthMaxPixels;
uniform int radiusUnits;
uniform int widthUnits;
out vec4 vColor;
#ifdef FLAT_SHADING
out vec4 position_commonspace;
#endif

void main(void) {
  geometry.worldPosition = instancePositions;

  vec4 color = isStroke ? instanceLineColors : instanceFillColors;
  mat2 rotationMatrix = mat2(cos(angle), sin(angle), -sin(angle), cos(angle));
  float elevation = 0.0;
  float strokeOffsetRatio = 1.0;

  if (extruded) {
    elevation = instanceElevations * (positions.z + 1.0) / 2.0 * elevationScale;
  } else if (stroked) {
    float widthPixels = clamp(
      project_size_to_pixel(instanceStrokeWidths * widthScale, widthUnits),
      widthMinPixels, widthMaxPixels) / 2.0;
    float halfOffset = project_pixel_size(widthPixels) / project_size(edgeDistance * coverage * radius);
    if (isStroke) {
      strokeOffsetRatio -= sign(positions.z) * halfOffset;
    } else {
      strokeOffsetRatio -= halfOffset;
    }
  }
  float shouldRender = float(color.a > 0.0 && instanceElevations >= 0.0);
  float dotRadius = radius * coverage * shouldRender;

  geometry.pickingColor = instancePickingColors;
  vec3 centroidPosition = vec3(instancePositions.xy, instancePositions.z + elevation);
  vec3 centroidPosition64Low = instancePositions64Low;
  vec2 offset = (rotationMatrix * positions.xy * strokeOffsetRatio + offset) * dotRadius;
  if (radiusUnits == UNIT_METERS) {
    offset = project_size(offset);
  }
  vec3 pos = vec3(offset, 0.);
  DECKGL_FILTER_SIZE(pos, geometry);

  gl_Position = project_position_to_clipspace(centroidPosition, centroidPosition64Low, pos, geometry.position);
  geometry.normal = project_normal(vec3(rotationMatrix * normals.xy, normals.z));
  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
  if (extruded && !isStroke) {
#ifdef FLAT_SHADING
    position_commonspace = geometry.position;
    vColor = vec4(color.rgb, color.a * opacity);
#else
    vec3 lightColor = lighting_getLightColor(color.rgb, project_uCameraPosition, geometry.position.xyz, geometry.normal);
    vColor = vec4(lightColor, color.a * opacity);
#endif
  } else {
    vColor = vec4(color.rgb, color.a * opacity);
  }
  DECKGL_FILTER_COLOR(vColor, geometry);
}
`,eI=`#version 300 es
#define SHADER_NAME column-layer-fragment-shader

precision highp float;

uniform vec3 project_uCameraPosition;
uniform bool extruded;
uniform bool isStroke;

out vec4 fragColor;

in vec4 vColor;
#ifdef FLAT_SHADING
in vec4 position_commonspace;
#endif

void main(void) {
  fragColor = vColor;
#ifdef FLAT_SHADING
  if (extruded && !isStroke && !picking_uActive) {
    vec3 normal = normalize(cross(dFdx(position_commonspace.xyz), dFdy(position_commonspace.xyz)));
    fragColor.rgb = lighting_getLightColor(vColor.rgb, project_uCameraPosition, position_commonspace.xyz, normal);
  }
#endif
  DECKGL_FILTER_COLOR(fragColor, geometry);
}
`,Wa=[0,0,0,255],tI={diskResolution:{type:"number",min:4,value:20},vertices:null,radius:{type:"number",min:0,value:1e3},angle:{type:"number",value:0},offset:{type:"array",value:[0,0]},coverage:{type:"number",min:0,max:1,value:1},elevationScale:{type:"number",min:0,value:1},radiusUnits:"meters",lineWidthUnits:"meters",lineWidthScale:1,lineWidthMinPixels:0,lineWidthMaxPixels:Number.MAX_SAFE_INTEGER,extruded:!0,wireframe:!1,filled:!0,stroked:!1,getPosition:{type:"accessor",value:t=>t.position},getFillColor:{type:"accessor",value:Wa},getLineColor:{type:"accessor",value:Wa},getLineWidth:{type:"accessor",value:1},getElevation:{type:"accessor",value:1e3},material:!0,getColor:{deprecatedFor:["getFillColor","getLineColor"]}};class yh extends dl{getShaders(){const{gl:e}=this.context,n=!H(e),r={},i=this.props.flatShading&&K_(e,ie.GLSL_DERIVATIVES);return i&&(r.FLAT_SHADING=1),super.getShaders({vs:JR,fs:eI,defines:r,transpileToGLSL100:n,modules:[RC,i?z2:B2,IC]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceElevations:{size:1,transition:!0,accessor:"getElevation"},instanceFillColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getFillColor",defaultValue:Wa},instanceLineColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getLineColor",defaultValue:Wa},instanceStrokeWidths:{size:1,accessor:"getLineWidth",transition:!0}})}updateState(e){super.updateState(e);const{props:n,oldProps:r,changeFlags:i}=e,s=i.extensionsChanged||n.flatShading!==r.flatShading;if(s){var o;const{gl:a}=this.context;(o=this.state.model)===null||o===void 0||o.delete(),this.state.model=this._getModel(a),this.getAttributeManager().invalidateAll()}(s||n.diskResolution!==r.diskResolution||n.vertices!==r.vertices||(n.extruded||n.stroked)!==(r.extruded||r.stroked))&&this._updateGeometry(n)}getGeometry(e,n,r){const i=new QR({radius:1,height:r?2:0,vertices:n,nradial:e});let s=0;if(n)for(let o=0;o<e;o++){const a=n[o],l=Math.sqrt(a[0]*a[0]+a[1]*a[1]);s+=l/e}else s=1;return this.setState({edgeDistance:Math.cos(Math.PI/e)*s}),i}_getModel(e){return new Sv(e,{...this.getShaders(),id:this.props.id,isInstanced:!0})}_updateGeometry({diskResolution:e,vertices:n,extruded:r,stroked:i}){const s=this.getGeometry(e,n,r||i);this.setState({fillVertexCount:s.attributes.POSITION.value.length/3,wireframeVertexCount:s.indices.value.length}),this.state.model.setProps({geometry:s})}draw({uniforms:e}){const{lineWidthUnits:n,lineWidthScale:r,lineWidthMinPixels:i,lineWidthMaxPixels:s,radiusUnits:o,elevationScale:a,extruded:l,filled:u,stroked:c,wireframe:f,offset:h,coverage:p,radius:E,angle:w}=this.props,{model:S,fillVertexCount:_,wireframeVertexCount:m,edgeDistance:y}=this.state;S.setUniforms(e).setUniforms({radius:E,angle:w/180*Math.PI,offset:h,extruded:l,stroked:c,coverage:p,elevationScale:a,edgeDistance:y,radiusUnits:Is[o],widthUnits:Is[n],widthScale:r,widthMinPixels:i,widthMaxPixels:s}),l&&f&&(S.setProps({isIndexed:!0}),S.setVertexCount(m).setDrawMode(1).setUniforms({isStroke:!0}).draw()),u&&(S.setProps({isIndexed:!1}),S.setVertexCount(_).setDrawMode(5).setUniforms({isStroke:!1}).draw()),!l&&c&&(S.setProps({isIndexed:!1}),S.setVertexCount(_*2/3).setDrawMode(5).setUniforms({isStroke:!0}).draw())}}d(yh,"layerName","ColumnLayer");d(yh,"defaultProps",tI);const nI={cellSize:{type:"number",min:0,value:1e3},offset:{type:"array",value:[1,1]}};class Eh extends yh{getGeometry(e){return new gL}draw({uniforms:e}){const{elevationScale:n,extruded:r,offset:i,coverage:s,cellSize:o,angle:a,radiusUnits:l}=this.props;this.state.model.setUniforms(e).setUniforms({radius:o/2,radiusUnits:Is[l],angle:a,offset:i,extruded:r,coverage:s,elevationScale:n,edgeDistance:1,isWireframe:!1}).draw()}}d(Eh,"layerName","GridCellLayer");d(Eh,"defaultProps",nI);function Kp(){}const Jp=["getBins","getDomain","getScaleFunc"],em=[{key:"fillColor",accessor:"getFillColor",pickingInfo:"colorValue",getBins:{triggers:{value:{prop:"getColorValue",updateTrigger:"getColorValue"},weight:{prop:"getColorWeight",updateTrigger:"getColorWeight"},aggregation:{prop:"colorAggregation"},filterData:{prop:"_filterData",updateTrigger:"_filterData"}}},getDomain:{triggers:{lowerPercentile:{prop:"lowerPercentile"},upperPercentile:{prop:"upperPercentile"},scaleType:{prop:"colorScaleType"}}},getScaleFunc:{triggers:{domain:{prop:"colorDomain"},range:{prop:"colorRange"}},onSet:{props:"onSetColorDomain"}},nullValue:[0,0,0,0]},{key:"elevation",accessor:"getElevation",pickingInfo:"elevationValue",getBins:{triggers:{value:{prop:"getElevationValue",updateTrigger:"getElevationValue"},weight:{prop:"getElevationWeight",updateTrigger:"getElevationWeight"},aggregation:{prop:"elevationAggregation"},filterData:{prop:"_filterData",updateTrigger:"_filterData"}}},getDomain:{triggers:{lowerPercentile:{prop:"elevationLowerPercentile"},upperPercentile:{prop:"elevationUpperPercentile"},scaleType:{prop:"elevationScaleType"}}},getScaleFunc:{triggers:{domain:{prop:"elevationDomain"},range:{prop:"elevationRange"}},onSet:{props:"onSetElevationDomain"}},nullValue:-1}],rI=t=>t.cellSize;class iI{constructor(e){this.state={layerData:{},dimensions:{}},this.changeFlags={},this.dimensionUpdaters={},this._getCellSize=e.getCellSize||rI,this._getAggregator=e.getAggregator,this._addDimension(e.dimensions||em)}static defaultDimensions(){return em}updateState(e,n){const{oldProps:r,props:i,changeFlags:s}=e;this.updateGetValueFuncs(r,i,s);const o=this.needsReProjectPoints(r,i,s);let a=!1;return s.dataChanged||o?(this.getAggregatedData(i,n),a=!0):((this.getDimensionChanges(r,i,s)||[]).forEach(u=>typeof u=="function"&&u()),a=!0),this.setState({aggregationDirty:a}),this.state}setState(e){this.state={...this.state,...e}}setDimensionState(e,n){this.setState({dimensions:{...this.state.dimensions,[e]:{...this.state.dimensions[e],...n}}})}normalizeResult(e={}){return e.hexagons?{data:e.hexagons,...e}:e.layerData?{data:e.layerData,...e}:e}getAggregatedData(e,n){const i=this._getAggregator(e)(e,n);this.setState({layerData:this.normalizeResult(i)}),this.changeFlags={layerData:!0},this.getSortedBins(e)}updateGetValueFuncs(e,n,r){for(const i in this.dimensionUpdaters){const{value:s,weight:o,aggregation:a}=this.dimensionUpdaters[i].getBins.triggers;let l=n[s.prop];this.needUpdateDimensionStep(this.dimensionUpdaters[i].getBins,e,n,r)&&(l?l=_R(l,{data:n.data}):l=pR(n[a.prop],n[o.prop],{data:n.data})),l&&this.setDimensionState(i,{getValue:l})}}needsReProjectPoints(e,n,r){return this._getCellSize(e)!==this._getCellSize(n)||this._getAggregator(e)!==this._getAggregator(n)||r.updateTriggersChanged&&(r.updateTriggersChanged.all||r.updateTriggersChanged.getPosition)}addDimension(e){this._addDimension(e)}_addDimension(e=[]){e.forEach(n=>{const{key:r}=n;this.dimensionUpdaters[r]=this.getDimensionUpdaters(n),this.state.dimensions[r]={getValue:null,domain:null,sortedBins:null,scaleFunc:Kp}})}getDimensionUpdaters({key:e,accessor:n,pickingInfo:r,getBins:i,getDomain:s,getScaleFunc:o,nullValue:a}){return{key:e,accessor:n,pickingInfo:r,getBins:{updater:this.getDimensionSortedBins,...i},getDomain:{updater:this.getDimensionValueDomain,...s},getScaleFunc:{updater:this.getDimensionScale,...o},attributeAccessor:this.getSubLayerDimensionAttribute(e,a)}}needUpdateDimensionStep(e,n,r,i){return Object.values(e.triggers).some(s=>s.updateTrigger?i.dataChanged||i.updateTriggersChanged&&(i.updateTriggersChanged.all||i.updateTriggersChanged[s.updateTrigger]):n[s.prop]!==r[s.prop])}getDimensionChanges(e,n,r){const i=[];for(const s in this.dimensionUpdaters){const o=Jp.find(a=>this.needUpdateDimensionStep(this.dimensionUpdaters[s][a],e,n,r));o&&i.push(this.dimensionUpdaters[s][o].updater.bind(this,n,this.dimensionUpdaters[s]))}return i.length?i:null}getUpdateTriggers(e){const n=e.updateTriggers||{},r={};for(const i in this.dimensionUpdaters){const{accessor:s}=this.dimensionUpdaters[i];r[s]={},Jp.forEach(o=>{Object.values(this.dimensionUpdaters[i][o].triggers).forEach(({prop:a,updateTrigger:l})=>{if(l){const u=n[l];typeof u=="object"&&!Array.isArray(u)?Object.assign(r[s],u):u!==void 0&&(r[s][a]=u)}else r[s][a]=e[a]})})}return r}getSortedBins(e){for(const n in this.dimensionUpdaters)this.getDimensionSortedBins(e,this.dimensionUpdaters[n])}getDimensionSortedBins(e,n){const{key:r}=n,{getValue:i}=this.state.dimensions[r],s=new FR(this.state.layerData.data||[],{getValue:i,filterData:e._filterData});this.setDimensionState(r,{sortedBins:s}),this.getDimensionValueDomain(e,n)}getDimensionValueDomain(e,n){const{getDomain:r,key:i}=n,{triggers:{lowerPercentile:s,upperPercentile:o,scaleType:a}}=r,l=this.state.dimensions[i].sortedBins.getValueDomainByScale(e[a.prop],[e[s.prop],e[o.prop]]);this.setDimensionState(i,{valueDomain:l}),this.getDimensionScale(e,n)}getDimensionScale(e,n){const{key:r,getScaleFunc:i,getDomain:s}=n,{domain:o,range:a}=i.triggers,{scaleType:l}=s.triggers,{onSet:u}=i,c=e[a.prop],f=e[o.prop]||this.state.dimensions[r].valueDomain,p=kR(l&&e[l.prop])(f,c);typeof u=="object"&&typeof e[u.props]=="function"&&e[u.props](p.domain()),this.setDimensionState(r,{scaleFunc:p})}getSubLayerDimensionAttribute(e,n){return r=>{const{sortedBins:i,scaleFunc:s}=this.state.dimensions[e],o=i.binMap[r.index];if(o&&o.counts===0)return n;const a=o&&o.value,l=s.domain();return a>=l[0]&&a<=l[l.length-1]?s(a):n}}getSubLayerAccessors(e){const n={};for(const r in this.dimensionUpdaters){const{accessor:i}=this.dimensionUpdaters[r];n[i]=this.getSubLayerDimensionAttribute(e,r)}return n}getPickingInfo({info:e}){const n=e.picked&&e.index>-1;let r=null;if(n){const i=this.state.layerData.data[e.index],s={};for(const o in this.dimensionUpdaters){const{pickingInfo:a}=this.dimensionUpdaters[o],{sortedBins:l}=this.state.dimensions[o],u=l.binMap[i.index]&&l.binMap[i.index].value;s[a]=u}r=Object.assign(s,i,{points:i.filteredPoints||i.points})}return e.picked=!!r,e.object=r,e}getAccessor(e){return this.dimensionUpdaters.hasOwnProperty(e)?this.dimensionUpdaters[e].attributeAccessor:Kp}}function tm(){}const sI={colorDomain:null,colorRange:vR,getColorValue:{type:"accessor",value:null},getColorWeight:{type:"accessor",value:1},colorAggregation:"SUM",lowerPercentile:{type:"number",min:0,max:100,value:0},upperPercentile:{type:"number",min:0,max:100,value:100},colorScaleType:"quantize",onSetColorDomain:tm,elevationDomain:null,elevationRange:[0,1e3],getElevationValue:{type:"accessor",value:null},getElevationWeight:{type:"accessor",value:1},elevationAggregation:"SUM",elevationLowerPercentile:{type:"number",min:0,max:100,value:0},elevationUpperPercentile:{type:"number",min:0,max:100,value:100},elevationScale:{type:"number",min:0,value:1},elevationScaleType:"linear",onSetElevationDomain:tm,gridAggregator:jR,cellSize:{type:"number",min:0,max:1e3,value:1e3},coverage:{type:"number",min:0,max:1,value:1},getPosition:{type:"accessor",value:t=>t.position},extruded:!1,material:!0,_filterData:{type:"function",value:null,optional:!0}};class wh extends sy{initializeState(){const e=new iI({getAggregator:r=>r.gridAggregator,getCellSize:r=>r.cellSize});this.state={cpuAggregator:e,aggregatorState:e.state},this.getAttributeManager().add({positions:{size:3,type:5130,accessor:"getPosition"}})}updateState(e){super.updateState(e),this.setState({aggregatorState:this.state.cpuAggregator.updateState(e,{viewport:this.context.viewport,attributes:this.getAttributes(),numInstances:this.getNumInstances()})})}getPickingInfo({info:e}){return this.state.cpuAggregator.getPickingInfo({info:e})}_onGetSublayerColor(e){return this.state.cpuAggregator.getAccessor("fillColor")(e)}_onGetSublayerElevation(e){return this.state.cpuAggregator.getAccessor("elevation")(e)}_getSublayerUpdateTriggers(){return this.state.cpuAggregator.getUpdateTriggers(this.props)}renderLayers(){const{elevationScale:e,extruded:n,cellSize:r,coverage:i,material:s,transitions:o}=this.props,{cpuAggregator:a}=this.state,l=this.getSubLayerClass("grid-cell",Eh),u=this._getSublayerUpdateTriggers();return new l({cellSize:r,coverage:i,material:s,elevationScale:e,extruded:n,getFillColor:this._onGetSublayerColor.bind(this),getElevation:this._onGetSublayerElevation.bind(this),transitions:o&&{getFillColor:o.getColorValue||o.getColorWeight,getElevation:o.getElevationValue||o.getElevationWeight}},this.getSubLayerProps({id:"grid-cell",updateTriggers:u}),{data:a.state.layerData.data})}}d(wh,"layerName","CPUGridLayer");d(wh,"defaultProps",sI);const xu=512,oI=Math.PI/180;function dy({map:t,gl:e,deck:n}){if(t.__deck)return t.__deck;const r=n==null?void 0:n.props._customRender,i=n==null?void 0:n.props.onLoad,s=py({...n==null?void 0:n.props,_customRender:()=>{t.triggerRepaint(),r==null||r("")}});let o;return(!n||n.props.gl===e)&&(Object.assign(s,{gl:e,width:null,height:null,touchAction:"unset",viewState:zs(t)}),n!=null&&n.isInitialized?nm(n,t):s.onLoad=()=>{i==null||i(),nm(o,t)}),n?(o=n,n.setProps(s),n.userData.isExternal=!0):(o=new Bs(s),t.on("remove",()=>{gy(t)})),o.userData.mapboxLayers=new Set,t.__deck=o,t.on("render",()=>{o.isInitialized&&hI(o,t)}),o}function nm(t,e){const n=()=>{t.isInitialized?dI(t,e):e.off("move",n)};e.on("move",n)}function gy(t){var e;(e=t.__deck)===null||e===void 0||e.finalize(),t.__deck=null}function py(t){return{...t,parameters:{depthMask:!0,depthTest:!0,blend:!0,blendFunc:[770,771,1,771],polygonOffsetFill:!0,depthFunc:515,blendEquation:32774,...t.parameters},views:t.views||[new hh({id:"mapbox"})]}}function aI(t,e){t.userData.mapboxLayers.add(e),Th(t)}function lI(t,e){t.userData.mapboxLayers.delete(e),Th(t)}function uI(t,e){Th(t)}function cI(t,e,n){let{currentViewport:r}=t.userData,i=!1;r||(r=my(t,e,!0),t.userData.currentViewport=r,i=!0),t.isInitialized&&t._drawLayers("mapbox-repaint",{viewports:[r],layerFilter:({layer:s})=>n.id===s.id||s.props.operation.includes("terrain"),clearStack:i,clearCanvas:!1})}function zs(t){var e;const{lng:n,lat:r}=t.getCenter(),i={longitude:(n+540)%360-180,latitude:r,zoom:t.getZoom(),bearing:t.getBearing(),pitch:t.getPitch(),padding:t.getPadding(),repeat:t.getRenderWorldCopies()};return(e=t.getTerrain)!==null&&e!==void 0&&e.call(t)&&fI(t,i),i}function fI(t,e){if(t.getFreeCameraOptions){const{position:n}=t.getFreeCameraOptions();if(!n||n.z===void 0)return;const r=t.transform.height,{longitude:i,latitude:s,pitch:o}=e,a=n.x*xu,l=(1-n.y)*xu,u=n.z*xu,c=Fs([i,s]),f=a-c[0],h=l-c[1],p=Math.sqrt(f*f+h*h),E=o*oI,w=1.5*r,S=E<.001?w*Math.cos(E)/u:w*Math.sin(E)/p;e.zoom=Math.log2(S);const _=w*Math.cos(E)/S,m=u-_;e.position=[0,0,m/sa(s)]}else typeof t.transform.elevation=="number"&&(e.position=[0,0,t.transform.elevation])}function my(t,e,n=!0){return new _r({id:"mapbox",x:0,y:0,width:t.width,height:t.height,...zs(e),nearZMultiplier:n?.02:.1,nearZ:e.transform._nearZ/e.transform.height,farZ:e.transform._farZ/e.transform.height})}function hI(t,e){const{mapboxLayers:n,isExternal:r}=t.userData;if(r){const i=Array.from(n,c=>c.id),o=Ei(t.props.layers,Boolean).some(c=>c&&!i.includes(c.id));let a=t.getViewports();const l=a.findIndex(c=>c.id==="mapbox"),u=a.length>1||l<0;(o||u)&&(l>=0&&(a=a.slice(),a[l]=my(t,e,!1)),t._drawLayers("mapbox-repaint",{viewports:a,layerFilter:c=>(!t.props.layerFilter||t.props.layerFilter(c))&&(c.viewport.id!=="mapbox"||!i.includes(c.layer.id)),clearCanvas:!1}))}t.userData.currentViewport=null}function dI(t,e){t.setProps({viewState:zs(e)}),t.needsRedraw({clearRedrawFlags:!0})}function Th(t){if(t.userData.isExternal)return;const e=[];t.userData.mapboxLayers.forEach(n=>{const r=n.props.type,i=new r(n.props);e.push(i)}),t.setProps({layers:e})}class gI{constructor(e){if(d(this,"id",void 0),d(this,"type",void 0),d(this,"renderingMode",void 0),d(this,"map",void 0),d(this,"deck",void 0),d(this,"props",void 0),!e.id)throw new Error("Layer must have an unique id");this.id=e.id,this.type="custom",this.renderingMode=e.renderingMode||"3d",this.map=null,this.deck=null,this.props=e}onAdd(e,n){this.map=e,this.deck=dy({map:e,gl:n,deck:this.props.deck}),aI(this.deck,this)}onRemove(){this.deck&&lI(this.deck,this)}setProps(e){Object.assign(this.props,e,{id:this.id}),this.deck&&uI(this.deck)}render(){cI(this.deck,this.map,this)}}const Pu="__UNDEFINED__";function Vo(t,e,n,r){if(!t||!e||!t.style||!t.style._loaded)return;const i=Ei(r,Boolean);if(n!==r){const a=Ei(n,Boolean),l=new Set(a.map(u=>u.id));for(const u of i)l.delete(u.id);for(const u of l)t.getLayer(u)&&t.removeLayer(u)}for(const a of i){const l=t.getLayer(a.id);l?l.implementation.setProps(a.props):t.addLayer(new gI({id:a.id,deck:e}),a.props.beforeId)}const s=t.style._order,o={};for(const a of i){let{beforeId:l}=a.props;(!l||!s.includes(l))&&(l=Pu),o[l]=o[l]||[],o[l].push(a.id)}for(const a in o){const l=o[a];let u=a===Pu?s.length:s.indexOf(a),c=a===Pu?void 0:a;for(let f=l.length-1;f>=0;f--){const h=l[f],p=s.indexOf(h);p!==u-1&&(t.moveLayer(h,c),p>u&&u++),u--,c=h}}}class pI{constructor(e){d(this,"_props",void 0),d(this,"_deck",void 0),d(this,"_map",void 0),d(this,"_container",void 0),d(this,"_interleaved",void 0),d(this,"_lastMouseDownPoint",void 0),d(this,"_handleStyleChange",()=>{Vo(this._map,this._deck,this._props.layers,this._props.layers)}),d(this,"_updateContainerSize",()=>{if(this._map&&this._container){const{clientWidth:i,clientHeight:s}=this._map.getContainer();Object.assign(this._container.style,{width:"".concat(i,"px"),height:"".concat(s,"px")})}}),d(this,"_updateViewState",()=>{const i=this._deck;i&&(i.setProps({viewState:zs(this._map)}),i.isInitialized&&i.redraw())}),d(this,"_handleMouseEvent",i=>{const s=this._deck;if(!s||!s.isInitialized)return;const o={type:i.type,offsetCenter:i.point,srcEvent:i},a=this._lastMouseDownPoint;switch(!i.point&&a&&(o.deltaX=i.originalEvent.clientX-a.clientX,o.deltaY=i.originalEvent.clientY-a.clientY,o.offsetCenter={x:a.x+o.deltaX,y:a.y+o.deltaY}),o.type){case"mousedown":s._onPointerDown(o),this._lastMouseDownPoint={...i.point,clientX:i.originalEvent.clientX,clientY:i.originalEvent.clientY};break;case"dragstart":o.type="panstart",s._onEvent(o);break;case"drag":o.type="panmove",s._onEvent(o);break;case"dragend":o.type="panend",s._onEvent(o);break;case"click":o.tapCount=1,s._onEvent(o);break;case"dblclick":o.type="click",o.tapCount=2,s._onEvent(o);break;case"mousemove":o.type="pointermove",s._onPointerMove(o);break;case"mouseout":o.type="pointerleave",s._onPointerMove(o);break;default:return}});const{interleaved:n=!1,...r}=e;this._interleaved=n,this._props=r}setProps(e){this._interleaved&&e.layers&&Vo(this._map,this._deck,this._props.layers,e.layers),Object.assign(this._props,e),this._deck&&this._deck.setProps(this._interleaved?py(this._props):this._props)}onAdd(e){return this._map=e,this._interleaved?this._onAddInterleaved(e):this._onAddOverlaid(e)}_onAddOverlaid(e){const n=document.createElement("div");return Object.assign(n.style,{position:"absolute",left:0,top:0,textAlign:"initial",pointerEvents:"none"}),this._container=n,this._deck=new Bs({...this._props,parent:n,viewState:zs(e)}),e.on("resize",this._updateContainerSize),e.on("render",this._updateViewState),e.on("mousedown",this._handleMouseEvent),e.on("dragstart",this._handleMouseEvent),e.on("drag",this._handleMouseEvent),e.on("dragend",this._handleMouseEvent),e.on("mousemove",this._handleMouseEvent),e.on("mouseout",this._handleMouseEvent),e.on("click",this._handleMouseEvent),e.on("dblclick",this._handleMouseEvent),this._updateContainerSize(),n}_onAddInterleaved(e){return this._deck=dy({map:e,gl:e.painter.context.gl,deck:new Bs({...this._props,gl:e.painter.context.gl})}),e.on("styledata",this._handleStyleChange),Vo(e,this._deck,[],this._props.layers),document.createElement("div")}onRemove(){const e=this._map;e&&(this._interleaved?this._onRemoveInterleaved(e):this._onRemoveOverlaid(e)),this._deck=void 0,this._map=void 0,this._container=void 0}_onRemoveOverlaid(e){var n;e.off("resize",this._updateContainerSize),e.off("render",this._updateViewState),e.off("mousedown",this._handleMouseEvent),e.off("dragstart",this._handleMouseEvent),e.off("drag",this._handleMouseEvent),e.off("dragend",this._handleMouseEvent),e.off("mousemove",this._handleMouseEvent),e.off("mouseout",this._handleMouseEvent),e.off("click",this._handleMouseEvent),e.off("dblclick",this._handleMouseEvent),(n=this._deck)===null||n===void 0||n.finalize()}_onRemoveInterleaved(e){e.off("styledata",this._handleStyleChange),Vo(e,this._deck,this._props.layers,[]),gy(e)}getDefaultPosition(){return"top-left"}pickObject(e){return _e(this._deck),this._deck.pickObject(e)}pickMultipleObjects(e){return _e(this._deck),this._deck.pickMultipleObjects(e)}pickObjects(e){return _e(this._deck),this._deck.pickObjects(e)}finalize(){this._map&&this._map.removeControl(this)}getCanvas(){return this._map?this._interleaved?this._map.getCanvas():this._deck.getCanvas():null}}const mI="https://eeon-statpop.s3.eu-central-2.amazonaws.com/statpop_2022.json",_y="pk.eyJ1Ijoibm8zM21pcyIsImEiOiJjbHZ1cGJ2eWYxYmo4MmltaG51YzZrd3dtIn0.MIsk2At_hfwQ9ZTCCb080w";console.log(_y);const _I={latitude:46.8182,longitude:8.2275,zoom:7,bearing:0,pitch:30},vI="mapbox://styles/mapbox/dark-v9",qi={en:{title:"Switzerland, population distribution",description:"This grid represents the population distribution across Switzerland. Each cell's color intensity and height corresponds to the population density in that area, providing a visual representation of demographic distribution. The standard value is 100, which corresponds to 100 x 100 meters.",cellSize:"Cell Size:",adjust:"Adjust the grid cell size.",source:"Source: Population and Households Statistics (STATPOP), Federal Statistical Office, 2022"},de:{title:"Schweiz, Bevlkerungsverteilung",description:"Das Geo-Gitter stellt die Bevlkerungs-verteilung in der Schweiz dar. Die Farbe und Hhe jeder Zelle entspricht der Bevlkerungsdichte an diesem Ort, was eine visuelle Reprsentation der demographischen Verteilung ermglicht. Der Standardwert betrgt 100, was einer Flche von 100 x 100 Metern entspricht.",cellSize:"Zellgrsse:",adjust:"Die Zellgrsse anpassen.",source:"Quelle: Statistik der Bevlkerung und der Haushalte (STATPOP), Bundesamt fr Statistik, 2022"}};function yI({onCellSizeChange:t,currentCellSize:e}){const[n,r]=z.useState("en"),i={cursor:"pointer",padding:"5px 10px",margin:"0 5px",border:"1px solid #ccc",borderRadius:"5px",backgroundColor:"white"},s={...i,backgroundColor:"#333",color:"white",borderColor:"#333"},o={WebkitAppearance:"none",width:"100%",height:"2px",backgroundColor:"#333",outline:"none",opacity:"0.7",WebkitTransition:".2s",transition:"opacity .2s"};return Ce.createElement("div",{style:{position:"absolute",top:"10px",right:"10px",backgroundColor:"white",padding:"20px",width:"300px",borderRadius:"5px",zIndex:999,fontFamily:"Lato, sans-serif",fontSize:"16px"}},Ce.createElement("button",{onClick:()=>r("en"),style:n==="en"?s:i},"EN"),Ce.createElement("button",{onClick:()=>r("de"),style:n==="de"?s:i},"DE"),Ce.createElement("h3",null,qi[n].title),Ce.createElement("div",{style:{marginTop:"20px"}},qi[n].description),Ce.createElement("div",{style:{marginTop:"20px"}},qi[n].cellSize," ",e),Ce.createElement("input",{type:"range",min:"100",max:"1000",step:"100",value:e,onChange:a=>t(a.target.value),style:o,className:"slider"}),Ce.createElement("style",null,`.slider::-webkit-slider-thumb { background-color: #333; width: 25px; height: 25px; border-radius: 50%; cursor: pointer; }
          .slider::-moz-range-thumb { background-color: #333; width: 25px; height: 25px; border-radius: 50%; cursor: pointer; }`),Ce.createElement("div",{style:{marginTop:"10px"}},qi[n].adjust),Ce.createElement("div",{style:{marginTop:"20px",fontSize:"12px"}},qi[n].source))}function EI(t){return Si(()=>new pI(t)).setProps(t),null}function wI(){const[t,e]=z.useState(100),n=new wh({id:"grid-layer",data:mI,pickable:!0,extruded:!0,cellSize:t,elevationScale:40,opacity:.3,colorAggregation:"SUM",getPosition:r=>[r.LON,r.LAT],getElevationWeight:r=>r.B22BTOT,getColorWeight:r=>r.B22BTOT,colorRange:[[255,255,204],[199,233,180],[127,205,187],[29,145,192],[8,104,172],[8,78,158],[8,48,107],[4,24,87]]});return Ce.createElement(Ce.Fragment,null,Ce.createElement(Fw,{initialViewState:_I,mapStyle:vI,mapboxAccessToken:_y},Ce.createElement(EI,{layers:[n]}),Ce.createElement(Uw,{position:"top-left"})),Ce.createElement(yI,{onCellSizeChange:r=>e(Number(r)),currentCellSize:t}))}const TI=document.body.appendChild(document.createElement("div"));p_(TI).render(Ce.createElement(wI,null));export{bI as c,rm as g};
